(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1530:function(module,exports,__webpack_require__){"use strict";__webpack_require__(104).addons.setConfig({refs:{}})},1531:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(96),__webpack_require__(46);var dist=__webpack_require__(10),public_api=__webpack_require__(104),public_api_default=__webpack_require__.n(public_api),react=__webpack_require__(0),react_default=__webpack_require__.n(react),components_dist=(__webpack_require__(152),__webpack_require__(141),__webpack_require__(14),__webpack_require__(24),__webpack_require__(25),__webpack_require__(89),__webpack_require__(90),__webpack_require__(28),__webpack_require__(31),__webpack_require__(7),__webpack_require__(15),__webpack_require__(20),__webpack_require__(16),__webpack_require__(19),__webpack_require__(21),__webpack_require__(30),__webpack_require__(17),__webpack_require__(32),__webpack_require__(42),__webpack_require__(45)),api_dist=__webpack_require__(72),core_events_dist=__webpack_require__(125),lib=__webpack_require__(1689),Panel=__webpack_require__(1695),Stack=__webpack_require__(1699),TextField=__webpack_require__(1697),DefaultButton=__webpack_require__(391);const memoizeFnAll=(fnToMemoize,shouldCacheUpdate=Object.is)=>{let cache=new Map,nextCache=new Map;return callback=>{const retValue=callback((key,...args)=>{const value=cache.get(key);if(value){const[preArgs,ret]=value;if(args2=args,objCmp=shouldCacheUpdate,(args1=preArgs).length===args2.length&&args1.every((arg1,index)=>objCmp(args2[index],arg1)))return nextCache.set(key,[args,ret]),ret}var args1,args2,objCmp;const ret=fnToMemoize(key,...args);return nextCache.set(key,[args,ret]),ret});return cache=nextCache,nextCache=new Map,retValue}};var identifierModels=__webpack_require__(366);const toFlatCommunicationIdentifier=id=>Object(identifierModels.b)(id)?id.communicationUserId:Object(identifierModels.c)(id)?id.microsoftTeamsUserId:Object(identifierModels.d)(id)?id.phoneNumber:id.id,fromFlatCommunicationIdentifier=id=>({communicationUserId:id}),getDeviceManager=state=>state.deviceManager,getCall=(state,props)=>state.calls.get(props.callId),getDisplayName=state=>{var _a;return null===(_a=state.callAgent)||void 0===_a?void 0:_a.displayName},getIdentifier=state=>state.userId;var es=__webpack_require__(53);es.a([getCall,getDeviceManager],(call,deviceManager)=>({disabled:!call,checked:!!call&&!call.isMuted})),es.a([getCall,getDeviceManager],(call,deviceManager)=>{var _a;const previewOn=void 0!==(null===(_a=deviceManager.unparentedViews.values().next().value)||void 0===_a?void 0:_a.view),localVideoFromCall=null==call?void 0:call.localVideoStreams.find(stream=>"Video"===stream.mediaStreamType);return{disabled:!deviceManager.selectedCamera,checked:call?!!localVideoFromCall:previewOn}}),es.a([getCall],call=>({checked:null==call?void 0:call.isScreenSharingOn})),es.a([getDeviceManager,getCall],deviceManager=>({microphones:deviceManager.microphones,speakers:deviceManager.speakers,cameras:deviceManager.cameras,selectedMicrophone:deviceManager.selectedMicrophone,selectedSpeaker:deviceManager.selectedSpeaker,selectedCamera:deviceManager.selectedCamera})),es.a([getDeviceManager],deviceManager=>({video:!deviceManager.deviceAccess||deviceManager.deviceAccess.video,audio:!deviceManager.deviceAccess||deviceManager.deviceAccess.audio}));var sdk_bundle=__webpack_require__(132),memoize_one_esm=__webpack_require__(103),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const areStreamsEqual=(prevStream,newStream)=>!!prevStream&&!!newStream&&prevStream.source.id===newStream.source.id,isPreviewOn=(Object(memoize_one_esm.a)((callClient,callAgent,deviceManager,call)=>{const onStartLocalVideo=()=>__awaiter(void 0,void 0,void 0,(function*(){const callId=null==call?void 0:call.id;let videoDeviceInfo=callClient.getState().deviceManager.selectedCamera;if(!videoDeviceInfo){const cameras=yield null==deviceManager?void 0:deviceManager.getCameras();videoDeviceInfo=cameras&&cameras.length>0?cameras[0]:void 0,videoDeviceInfo&&(null==deviceManager||deviceManager.selectCamera(videoDeviceInfo))}if(!callId||!videoDeviceInfo)return;const stream=new sdk_bundle.LocalVideoStream(videoDeviceInfo);call&&!call.localVideoStreams.find(s=>areStreamsEqual(s,stream))&&(yield call.startVideo(stream))})),onStartScreenShare=()=>__awaiter(void 0,void 0,void 0,(function*(){return yield null==call?void 0:call.startScreenSharing()})),onStopScreenShare=()=>__awaiter(void 0,void 0,void 0,(function*(){return yield null==call?void 0:call.stopScreenSharing()}));return{onHangUp:()=>__awaiter(void 0,void 0,void 0,(function*(){return yield null==call?void 0:call.hangUp()})),onSelectCamera:device=>__awaiter(void 0,void 0,void 0,(function*(){if(deviceManager){if(call){deviceManager.selectCamera(device);const stream=call.localVideoStreams.find(stream=>"Video"===stream.mediaStreamType);return null==stream?void 0:stream.switchSource(device)}if(!isPreviewOn(callClient.getState().deviceManager))return void deviceManager.selectCamera(device);if(callClient.getState().deviceManager.selectedCamera)for(const stream of callClient.getState().deviceManager.unparentedViews.keys())yield callClient.disposeView(void 0,void 0,stream);deviceManager.selectCamera(device),yield callClient.createView(void 0,void 0,{source:device,mediaStreamType:"Video"})}})),onSelectMicrophone:device=>__awaiter(void 0,void 0,void 0,(function*(){if(deviceManager)return deviceManager.selectMicrophone(device)})),onSelectSpeaker:device=>__awaiter(void 0,void 0,void 0,(function*(){if(deviceManager)return deviceManager.selectSpeaker(device)})),onStartCall:(participants,options)=>callAgent?callAgent.startCall(participants,options):void 0,onStartScreenShare:onStartScreenShare,onStopScreenShare:onStopScreenShare,onToggleCamera:()=>__awaiter(void 0,void 0,void 0,(function*(){if(call){const stream=call.localVideoStreams.find(stream=>"Video"===stream.mediaStreamType);stream?yield(stream=>__awaiter(void 0,void 0,void 0,(function*(){const callId=null==call?void 0:call.id;callId&&call&&call.localVideoStreams.find(s=>areStreamsEqual(s,stream))&&(yield call.stopVideo(stream),yield callClient.disposeView(callId,void 0,{source:stream.source,mediaStreamType:stream.mediaStreamType}))})))(stream):yield onStartLocalVideo()}else{const selectedCamera=callClient.getState().deviceManager.selectedCamera;if(selectedCamera){if(isPreviewOn(callClient.getState().deviceManager))for(const stream of callClient.getState().deviceManager.unparentedViews.keys())yield callClient.disposeView(void 0,void 0,stream);else yield callClient.createView(void 0,void 0,{source:selectedCamera,mediaStreamType:"Video"})}}})),onToggleMicrophone:()=>__awaiter(void 0,void 0,void 0,(function*(){if(!call)throw new Error("Please invoke onToggleMicrophone after call is started");return call.isMuted?yield call.unmute():yield call.mute()})),onToggleScreenShare:()=>__awaiter(void 0,void 0,void 0,(function*(){return(null==call?void 0:call.isScreenSharingOn)?yield onStopScreenShare():yield onStartScreenShare()})),onCreateLocalStreamView:options=>__awaiter(void 0,void 0,void 0,(function*(){if(!call||0===call.localVideoStreams.length)return;const callState=callClient.getState().calls.get(call.id);if(!callState)return;const localStream=callState.localVideoStreams.find(item=>"Video"===item.mediaStreamType);return localStream?callClient.createView(call.id,void 0,localStream,options):void 0})),onCreateRemoteStreamView:(userId,options)=>__awaiter(void 0,void 0,void 0,(function*(){if(!call)return;const callState=callClient.getState().calls.get(call.id);if(!callState)throw new Error("Call Not Found: "+call.id);const participant=Array.from(callState.remoteParticipants.values()).find(participant=>toFlatCommunicationIdentifier(participant.identifier)===userId);if(!participant||!participant.videoStreams)return;const remoteVideoStream=Array.from(participant.videoStreams.values()).find(i=>"Video"===i.mediaStreamType),screenShareStream=Array.from(participant.videoStreams.values()).find(i=>"ScreenSharing"===i.mediaStreamType);remoteVideoStream&&remoteVideoStream.isAvailable&&!remoteVideoStream.view&&callClient.createView(call.id,participant.identifier,remoteVideoStream,options),screenShareStream&&screenShareStream.isAvailable&&!screenShareStream.view&&callClient.createView(call.id,participant.identifier,screenShareStream,options)})),onParticipantRemove:userId=>{null==call||call.removeParticipant(fromFlatCommunicationIdentifier(userId))},onStartLocalVideo:onStartLocalVideo}}),deviceManager=>{var _a;return void 0!==(null===(_a=deviceManager.unparentedViews.values().next().value)||void 0===_a?void 0:_a.view)}),convertRemoteVideoStreamToVideoGalleryStream=(es.a([getIdentifier,getDisplayName,getCall],(userId,displayName,call)=>{const remoteParticipants=call&&(null==call?void 0:call.remoteParticipants)?(remoteParticipants=>remoteParticipants.map(participant=>{const isScreenSharing=Array.from(participant.videoStreams.values()).some(videoStream=>"ScreenSharing"===videoStream.mediaStreamType&&videoStream.isAvailable);return{userId:toFlatCommunicationIdentifier(participant.identifier),displayName:participant.displayName,state:participant.state,isMuted:participant.isMuted,isScreenSharing:isScreenSharing,isSpeaking:participant.isSpeaking}}))(Array.from(null==call?void 0:call.remoteParticipants.values())):[];return remoteParticipants.push({userId:userId,displayName:displayName,isScreenSharing:null==call?void 0:call.isScreenSharingOn,isMuted:null==call?void 0:call.isMuted,state:"Connected"}),{participants:remoteParticipants,myUserId:userId}}),stream=>{var _a,_b;return{id:stream.id,isAvailable:stream.isAvailable,isMirrored:null===(_a=stream.view)||void 0===_a?void 0:_a.isMirrored,renderElement:null===(_b=stream.view)||void 0===_b?void 0:_b.target}}),convertRemoteParticipantToVideoGalleryRemoteParticipant=(userId,isMuted,isSpeaking,videoStreams,displayName)=>{const rawVideoStreamsArray=Array.from(videoStreams.values());let videoStream=void 0,screenShareStream=void 0;return rawVideoStreamsArray[0]&&("Video"===rawVideoStreamsArray[0].mediaStreamType?videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0]):screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0])),rawVideoStreamsArray[1]&&("ScreenSharing"===rawVideoStreamsArray[1].mediaStreamType?screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1]):videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1])),{userId:userId,displayName:displayName,isMuted:isMuted,isSpeaking:isSpeaking,videoStream:videoStream,screenShareStream:screenShareStream,isScreenSharingOn:void 0!==screenShareStream&&screenShareStream.isAvailable}},memoizedAllConvertRemoteParticipant=memoizeFnAll((userId,isMuted,isSpeaking,videoStreams,displayName)=>convertRemoteParticipantToVideoGalleryRemoteParticipant(userId,isMuted,isSpeaking,videoStreams,displayName)),videoGalleryRemoteParticipantsFromCall=call=>call&&call.remoteParticipants?memoizedAllConvertRemoteParticipant(memoizedFn=>Array.from(call.remoteParticipants.values()).map(participant=>memoizedFn(toFlatCommunicationIdentifier(participant.identifier),participant.isMuted,participant.isSpeaking,participant.videoStreams,participant.displayName))):[];Object(es.a)([getCall,getDisplayName,getIdentifier],(call,displayName,identifier)=>{var _a,_b;const screenShareRemoteParticipant=(null==call?void 0:call.screenShareRemoteParticipant)?call.remoteParticipants.get(call.screenShareRemoteParticipant):void 0,localVideoStream=null==call?void 0:call.localVideoStreams.find(i=>"Video"===i.mediaStreamType);return{screenShareParticipant:screenShareRemoteParticipant?convertRemoteParticipantToVideoGalleryRemoteParticipant(toFlatCommunicationIdentifier(screenShareRemoteParticipant.identifier),screenShareRemoteParticipant.isMuted,screenShareRemoteParticipant.isSpeaking,screenShareRemoteParticipant.videoStreams,screenShareRemoteParticipant.displayName):void 0,localParticipant:{userId:identifier,displayName:null!=displayName?displayName:"",isMuted:null==call?void 0:call.isMuted,isScreenSharingOn:null==call?void 0:call.isScreenSharingOn,videoStream:{isAvailable:!!localVideoStream,isMirrored:null===(_a=null==localVideoStream?void 0:localVideoStream.view)||void 0===_a?void 0:_a.isMirrored,renderElement:null===(_b=null==localVideoStream?void 0:localVideoStream.view)||void 0===_b?void 0:_b.target}},remoteParticipants:videoGalleryRemoteParticipantsFromCall(call)}}),Object(react.createContext)(void 0),Object(react.createContext)(void 0),Object(react.createContext)(void 0);var styling_lib=__webpack_require__(26);Object(styling_lib.D)({height:"2.125rem",display:"flex",alignItems:"center"}),Object(styling_lib.D)({fontWeight:400,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0.1875rem"}),Object(styling_lib.D)({fontWeight:400,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0.1875rem"}),Object(styling_lib.D)({width:"2.125rem",height:"2.125rem",paddingRight:"0.1875rem"}),Object(styling_lib.D)({height:"100%",display:"grid",flexGrow:"1",gap:".5rem",padding:".5rem"});__webpack_require__(1656);Object(styling_lib.D)({padding:"0.0625rem"}),Object(styling_lib.D)({minHeight:"0",maxHeight:"8.25rem",outline:"red 5px",fontWeight:400,fontSize:"0.875rem",width:"100%",height:"2.25rem",lineHeight:"1.5rem","::-webkit-input-placeholder":{fontSize:"0.875rem"},"::-moz-placeholder":{fontSize:"0.875rem"},":-moz-placeholder":{fontSize:"0.875rem"}}),Object(styling_lib.D)({width:"2.25rem",color:"grey",right:"0.125rem",cursor:"pointer",display:"flex",justifyContent:"center",position:"absolute",top:"0.875rem"}),Object(styling_lib.D)({width:"1.0625rem",height:"1.0625rem"});var useTheme=__webpack_require__(376);var TooltipHost=__webpack_require__(1696);const MessageStatusIndicator_styles_palette=Object(styling_lib.z)().palette,MessageStatusIndicatorErrorIconStyle=Object(styling_lib.D)({marginRight:"-0.06rem",fontSize:"1.06rem",color:MessageStatusIndicator_styles_palette.redDark}),MessageStatusIndicatorIconStyle=Object(styling_lib.D)({fontSize:"1rem",color:MessageStatusIndicator_styles_palette.blue});var ErrorIcon=__webpack_require__(1658),CircleRingIcon=__webpack_require__(1659),CompletedIcon=__webpack_require__(1661),MessageSeenIcon=__webpack_require__(1660);const MessageStatusIndicator=props=>{const{status:status,deliveredTooltipText:deliveredTooltipText="Sent",seenTooltipText:seenTooltipText="Seen",sendingTooltipText:sendingTooltipText="Sending",failedToSendTooltipText:failedToSendTooltipText="Failed to send",size:size="medium",styles:styles}=props;switch(status){case"failed":return react_default.a.createElement(TooltipHost.a,{content:failedToSendTooltipText},react_default.a.createElement(ErrorIcon.a,{className:Object(styling_lib.D)(MessageStatusIndicatorErrorIconStyle,null==styles?void 0:styles.root)}));case"sending":return react_default.a.createElement(TooltipHost.a,{content:sendingTooltipText},react_default.a.createElement(CircleRingIcon.a,{className:Object(styling_lib.D)(MessageStatusIndicatorIconStyle,null==styles?void 0:styles.root)}));case"seen":return react_default.a.createElement(TooltipHost.a,{content:seenTooltipText},react_default.a.createElement(MessageSeenIcon.a,{size:size,className:Object(styling_lib.D)(null==styles?void 0:styles.root)}));case"delivered":return react_default.a.createElement(TooltipHost.a,{content:deliveredTooltipText},react_default.a.createElement(CompletedIcon.a,{className:Object(styling_lib.D)(MessageStatusIndicatorIconStyle,null==styles?void 0:styles.root)}));default:return react_default.a.createElement(react_default.a.Fragment,null)}};var react_linkify_dist=__webpack_require__(766),react_linkify_dist_default=__webpack_require__.n(react_linkify_dist),Chat=__webpack_require__(1709),Text=__webpack_require__(225),Flex=__webpack_require__(1716);__webpack_require__(1710);Object(styling_lib.D)({height:"100%",width:"100%",maxHeight:"100%",overflow:"auto",position:"relative"});const noMessageStatusStyle=Object(styling_lib.D)({width:"1rem"}),chatMessageStyle=(Object(styling_lib.D)({position:"absolute",zIndex:1,bottom:0,right:"1.5rem"}),{overflowY:"hidden"}),chatMessageDateStyle={fontWeight:600};Object(styling_lib.D)({float:"right",width:"fit-content"}),Object(styling_lib.D)({border:"none",minHeight:"1.5rem",selectors:{"&:hover":{background:"none"},"&:active":{background:"none"}}}),Object(styling_lib.D)({marginRight:"0.5em"});__webpack_require__(1662),__webpack_require__(1702);var Link=__webpack_require__(1703),Persona=__webpack_require__(1693),Persona_types=__webpack_require__(9),react_aria_live_es=__webpack_require__(399);const weekDayToDayName=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],formatTimeForChatMessage=messageDate=>{let hours=messageDate.getHours(),minutes=messageDate.getMinutes().toString();const isAm=hours<12;return hours>12&&(hours-=12),0===hours&&(hours=12),minutes.length<2&&(minutes="0"+minutes),hours.toString()+":"+minutes+" "+(isAm?"a.m.":"p.m.")},formatDateForChatMessage=messageDate=>{const year=messageDate.getFullYear().toString();let month=(messageDate.getMonth()+1).toString(),day=messageDate.getDate().toString();return 1===month.length&&(month="0"+month),1===day.length&&(day="0"+day),year+"-"+month+"-"+day},formatTimestampForChatMessage=(messageDate,todayDate)=>{if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()))return formatTimeForChatMessage(messageDate);if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-1))return"Yesterday "+formatTimeForChatMessage(messageDate);const weekDay=todayDate.getDay();if(0===weekDay)return formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate);return messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-weekDay)?weekDayToDayName[messageDate.getDay()]+" "+formatTimeForChatMessage(messageDate):formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate)};var FontIcon=__webpack_require__(763);const systemMessageIconStyle=Object(styling_lib.D)({margin:"0 0.688rem 0 0"}),systemMessageContentStyle=Object(styling_lib.D)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),SystemMessage=props=>{const{iconName:iconName,content:content}=props,Icon=react_default.a.createElement(FontIcon.a,{iconName:iconName,className:Object(styling_lib.D)(systemMessageIconStyle)});return react_default.a.createElement(Stack.a,{horizontal:!0,className:Object(styling_lib.D)(null==props?void 0:props.containerStyle)},Icon,react_default.a.createElement("span",{className:Object(styling_lib.D)(systemMessageContentStyle)},content))};var html_to_react=__webpack_require__(767);const DefaultSystemMessageRenderer=props=>{var _a,_b;if("system"===props.message.type){const payload=props.message.payload;return react_default.a.createElement(SystemMessage,{iconName:null!==(_a=payload.iconName)&&void 0!==_a?_a:"",content:null!==(_b=payload.content)&&void 0!==_b?_b:"",containerStyle:null==props?void 0:props.messageContainerStyle})}return react_default.a.createElement(react_default.a.Fragment,null)};function extractContent(s){const span=document.createElement("span");return span.innerHTML=s,span.textContent||span.innerText}const generateRichTextHTMLMessageContent=payload=>{const htmlToReactParser=new html_to_react.Parser,liveAuthor=payload.senderDisplayName+" says ";return react_default.a.createElement("div",null,react_default.a.createElement(react_aria_live_es.b,{message:`${payload.mine?"":liveAuthor} ${extractContent(payload.content)}`,"aria-live":"polite"}),htmlToReactParser.parse(payload.content))},generateMessageContent=payload=>{switch(payload.type){case"text":return(payload=>{const liveAuthor=payload.senderDisplayName+" says ";return react_default.a.createElement("div",null,react_default.a.createElement(react_aria_live_es.b,{message:`${payload.mine?"":liveAuthor} ${payload.content}`,"aria-live":"polite"}),react_default.a.createElement(react_linkify_dist_default.a,{componentDecorator:(decoratedHref,decoratedText,key)=>react_default.a.createElement(Link.a,{href:decoratedHref,key:key},decoratedText)},payload.content))})(payload);case"html":case"richtext/html":return generateRichTextHTMLMessageContent(payload);default:return console.warn("unknown message content type"),react_default.a.createElement(react_default.a.Fragment,null)}},DefaultChatMessageRenderer=props=>{if("chat"===props.message.type){const payload=props.message.payload,messageContentItem=generateMessageContent(payload);return react_default.a.createElement(Chat.a.Message,{className:Object(styling_lib.D)(chatMessageStyle,props.messageContainerStyle),content:messageContentItem,author:react_default.a.createElement(Text.a,{className:Object(styling_lib.D)(chatMessageDateStyle)},payload.senderDisplayName),mine:payload.mine,timestamp:payload.createdOn?props.showDate?formatTimestampForChatMessage(payload.createdOn,new Date):formatTimeForChatMessage(payload.createdOn):void 0})}return react_default.a.createElement(react_default.a.Fragment,null)},mediaContainer=(memoizeFnAll((_messageKey,message,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultChatMessageRenderer,_attached,statusToRender,onRenderMessage)=>{var _a,_b,_c;const messageProps={message:message,showDate:showMessageDate};if("chat"===message.type){const payload=message.payload;messageProps.messageContainerStyle=null==styles?void 0:styles.chatMessageContainer;const chatMessageComponent=void 0===onRenderMessage?defaultChatMessageRenderer(messageProps):onRenderMessage(messageProps,DefaultChatMessageRenderer);return{gutter:payload.mine?"":onRenderAvatar?onRenderAvatar(null!==(_a=payload.senderId)&&void 0!==_a?_a:""):react_default.a.createElement(Persona.a,{text:payload.senderDisplayName,hidePersonaDetails:!0,size:Persona_types.c.size32}),contentPosition:payload.mine?"end":"start",message:react_default.a.createElement(Flex.a,{vAlign:"end"},chatMessageComponent,react_default.a.createElement("div",{className:Object(styling_lib.D)((mine=null!==(_b=payload.mine)&&void 0!==_b&&_b,Object(styling_lib.D)({marginLeft:mine?"1rem":"0rem"})),(null==styles?void 0:styles.messageStatusContainer)?styles.messageStatusContainer(null!==(_c=payload.mine)&&void 0!==_c&&_c):"")},showMessageStatus&&statusToRender?onRenderMessageStatus?onRenderMessageStatus({status:statusToRender}):MessageStatusIndicator({status:statusToRender}):react_default.a.createElement("div",{className:Object(styling_lib.D)(noMessageStatusStyle)}))),attached:payload.attached,key:_messageKey}}if("system"===message.type){messageProps.messageContainerStyle=null==styles?void 0:styles.systemMessageContainer;return{children:void 0===onRenderMessage?DefaultSystemMessageRenderer(messageProps):onRenderMessage(messageProps,DefaultSystemMessageRenderer),key:_messageKey}}return{children:void 0===onRenderMessage?react_default.a.createElement(react_default.a.Fragment,null):onRenderMessage(messageProps),key:_messageKey};var mine}),Object(styling_lib.D)({position:"relative",height:"100%",width:"100%",background:"transparent",display:"flex","& video":{borderRadius:".25rem"}})),invertedVideoStyle=Object(styling_lib.D)(mediaContainer,{transform:"rotateY(180deg)"}),StreamMedia=props=>{const containerEl=Object(react.useRef)(null),{isMirrored:isMirrored,videoStreamElement:videoStreamElement,styles:styles}=props;return Object(react.useEffect)(()=>{const container=containerEl.current;if(container)return container.innerHTML="",videoStreamElement&&container.appendChild(videoStreamElement),()=>{container.innerHTML=""}},[videoStreamElement]),react_default.a.createElement("div",{className:Object(styling_lib.D)(isMirrored?invertedVideoStyle:mediaContainer,null==styles?void 0:styles.root),ref:containerEl})};Object(styling_lib.D)({fontSize:"0.875rem",fontWeight:400,marginTop:"0.3125rem",marginRight:"0.25rem",paddingLeft:"0.25rem",overflowY:"hidden"}),Object(styling_lib.D)({fontSize:"0.875rem",fontWeight:400,color:"#A19F9D",marginTop:"0.3125rem"}),Object(styling_lib.D)({position:"absolute",display:"flex",right:"1rem",top:"50%",msTransform:"translateY(-50%)",transform:"translateY(-50%)"});__webpack_require__(1690),__webpack_require__(64);__webpack_require__(1713),__webpack_require__(1704),__webpack_require__(1674),__webpack_require__(1675);Object(styling_lib.D)({height:"100%",overflow:"auto",paddingLeft:"1.125rem",paddingRight:"1.125rem"});const videoBaseStyle=Object(styling_lib.D)({border:0}),gridStyle=Object(styling_lib.D)(videoBaseStyle,{width:"100%",height:"100%"}),videoTileStyle={root:{borderRadius:".25rem"}};var Text_Text=__webpack_require__(1705);const rootStyles={position:"relative",height:"100%",width:"100%"},videoContainerStyles={position:"absolute",top:"0",left:"0",width:"100%",height:"100%",minWidth:"100%",minHeight:"100%",objectPosition:"center",objectFit:"cover",zIndex:0},overlayContainerStyles={width:"100%",height:"100%",zIndex:5},disabledVideoHint=Object(styling_lib.D)({bottom:"0.5rem",boxShadow:"none",textAlign:"left",left:"0.5rem",overflow:"hidden",position:"absolute",padding:"0.25rem",lineHeight:"1.4286rem",whiteSpace:"nowrap",maxWidth:"95%",borderRadius:4}),videoHint=Object(styling_lib.D)(disabledVideoHint,{backgroundColor:"rgba(0, 0, 0, 0.5)",boxShadow:"0 0 1px 0 rgba(0,0,0,.5)"}),DefaultPlaceholder=props=>{const{displayName:displayName,noVideoAvailableAriaLabel:noVideoAvailableAriaLabel}=props;return react_default.a.createElement(Stack.a,{className:Object(styling_lib.D)({position:"absolute",height:"100%",width:"100%"})},react_default.a.createElement(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size100,hidePersonaDetails:!0,text:displayName,initialsTextColor:"white","aria-label":noVideoAvailableAriaLabel}))},VideoTile=props=>{const{children:children,displayName:displayName,isMirrored:isMirrored,isVideoReady:isVideoReady,onRenderPlaceholder:onRenderPlaceholder,renderElement:renderElement,showDisplayName:showDisplayName=!0,styles:styles,userId:userId,noVideoAvailableAriaLabel:noVideoAvailableAriaLabel}=props,placeHolderProps={userId:userId,displayName:displayName,noVideoAvailableAriaLabel:noVideoAvailableAriaLabel},theme=Object(useTheme.a)();return react_default.a.createElement(Stack.a,{className:Object(styling_lib.D)(rootStyles,{background:theme.palette.neutralLighter},null==styles?void 0:styles.root)},isVideoReady&&renderElement?react_default.a.createElement(Stack.a,{className:Object(styling_lib.D)(videoContainerStyles,isMirrored&&{transform:"scaleX(-1)"},null==styles?void 0:styles.videoContainer)},renderElement):react_default.a.createElement(Stack.a,{className:Object(styling_lib.D)(videoContainerStyles)},onRenderPlaceholder?onRenderPlaceholder(placeHolderProps,DefaultPlaceholder):react_default.a.createElement(DefaultPlaceholder,Object.assign({},placeHolderProps))),displayName&&showDisplayName&&react_default.a.createElement(Text_Text.a,{className:Object(styling_lib.D)(isVideoReady?videoHint:disabledVideoHint,{color:isVideoReady?"white":theme.palette.neutralPrimaryAlt},null==styles?void 0:styles.displayNameContainer)},displayName),children&&react_default.a.createElement(Stack.a,{className:Object(styling_lib.D)(overlayContainerStyles,null==styles?void 0:styles.overlayContainer)},children))};memoizeFnAll((userId,onCreateRemoteStreamView,isAvailable,renderElement,displayName,remoteVideoViewOption,onRenderAvatar)=>(isAvailable&&!renderElement&&onCreateRemoteStreamView&&onCreateRemoteStreamView(userId,remoteVideoViewOption),react_default.a.createElement(Stack.a,{className:gridStyle,key:userId,grow:!0},react_default.a.createElement(VideoTile,{userId:userId,isVideoReady:isAvailable,renderElement:react_default.a.createElement(StreamMedia,{videoStreamElement:null!=renderElement?renderElement:null}),displayName:displayName,styles:videoTileStyle,onRenderPlaceholder:onRenderAvatar}))));__webpack_require__(1701),__webpack_require__(1676),__webpack_require__(1677);const ControlBar_styles_theme=Object(styling_lib.z)(),ControlBar_styles_palette=ControlBar_styles_theme.palette,controlButtonStyles=(ControlBar_styles_theme.effects.elevation16,ControlBar_styles_theme.effects.roundedCorner6,ControlBar_styles_theme.effects.elevation16,ControlBar_styles_theme.effects.roundedCorner6,ControlBar_styles_theme.effects.elevation16,ControlBar_styles_theme.effects.roundedCorner6,ControlBar_styles_theme.effects.elevation16,ControlBar_styles_theme.effects.roundedCorner6,{root:{background:"none",border:"none",borderRadius:0,minHeight:"3.5rem",minWidth:"3.5rem"},flexContainer:{flexFlow:"column",display:"contents"}});Object(styling_lib.o)(controlButtonStyles,{root:{color:ControlBar_styles_palette.white},rootHovered:{color:ControlBar_styles_palette.white},rootPressed:{color:ControlBar_styles_palette.white},label:{color:ControlBar_styles_palette.whiteTranslucent40}});__webpack_require__(1678);const lightTheme={palette:{themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#59b0f7",themeDarker:"#004578",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},callingPalette:{callRed:"#c4314b",callRedDark:"#a42e43",callRedDarker:"#8b2c3d"}},darkTheme={palette:{themePrimary:"#2899f5",themeLighterAlt:"#02060a",themeLighter:"#061827",themeLight:"#0c2e49",themeTertiary:"#185b93",themeSecondary:"#2286d7",themeDarkAlt:"#3ca2f6",themeDark:"#59b0f7",themeDarker:"#84c5f9",neutralLighterAlt:"#302e2d",neutralLighter:"#383735",neutralLight:"#464443",neutralQuaternaryAlt:"#4e4d4b",neutralQuaternary:"#4d4b49",neutralTertiaryAlt:"#72706e",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#252423"},callingPalette:{callRed:"#a42e43",callRedDark:"#8b2c3d",callRedDarker:"#772a38"}};__webpack_require__(1679);__webpack_require__(1680);__webpack_require__(1681);__webpack_require__(1691);var mergeThemes=__webpack_require__(797),teams=__webpack_require__(1684);__webpack_require__(1686);Object(styling_lib.D)({height:"100%",width:"100%"}),Object(mergeThemes.f)(teams.a,{componentVariables:{ChatMessage:{linkColor:void 0,linkColorMine:void 0}}});var createHandlers_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};Object(memoize_one_esm.a)((chatClient,chatThreadClient)=>{const messageIterator=chatThreadClient.listMessages();return{onSendMessage:content=>createHandlers_awaiter(void 0,void 0,void 0,(function*(){const sendMessageRequest={content:content,senderDisplayName:chatClient.getState().displayName};yield chatThreadClient.sendMessage(sendMessageRequest)})),onMessageSeen:chatMessageId=>createHandlers_awaiter(void 0,void 0,void 0,(function*(){yield chatThreadClient.sendReadReceipt({chatMessageId:chatMessageId})})),onTyping:()=>createHandlers_awaiter(void 0,void 0,void 0,(function*(){yield chatThreadClient.sendTypingNotification()})),onParticipantRemove:userId=>createHandlers_awaiter(void 0,void 0,void 0,(function*(){yield chatThreadClient.removeParticipant(fromFlatCommunicationIdentifier(userId))})),updateThreadTopicName:topicName=>createHandlers_awaiter(void 0,void 0,void 0,(function*(){yield chatThreadClient.updateTopic(topicName)})),onLoadPreviousChatMessages:messagesToLoad=>createHandlers_awaiter(void 0,void 0,void 0,(function*(){var _a;let remainingMessagesToGet=messagesToLoad,isAllChatMessagesLoaded=!1;for(;remainingMessagesToGet>=1;){const message=yield messageIterator.next();if((null===(_a=message.value)||void 0===_a?void 0:_a.type)&&"text"===message.value.type&&remainingMessagesToGet--,message.done){isAllChatMessagesLoaded=!0;break}}return isAllChatMessagesLoaded}))}}),Object(react.createContext)(void 0),Object(react.createContext)(void 0);const getUserId=state=>toFlatCommunicationIdentifier(state.userId),baseSelectors_getDisplayName=state=>state.displayName,getParticipants=(state,props)=>{var _a;return props.threadId&&(null===(_a=state.threads.get(props.threadId))||void 0===_a?void 0:_a.participants)||new Map},sanitizedMessageContentType=type=>{const lowerCaseType=type.toLowerCase();return"text"===lowerCaseType||"html"===lowerCaseType||"richtext/html"===lowerCaseType?lowerCaseType:"unknown"},compareMessages=(Object(es.a)([getUserId,baseSelectors_getDisplayName],(userId,displayName)=>({displayName:displayName,userId:userId})),(firstMessage,secondMessage)=>{if(void 0===firstMessage.payload.createdOn)return 1;if(void 0===secondMessage.payload.createdOn)return-1;return new Date(firstMessage.payload.createdOn).getTime()-new Date(secondMessage.payload.createdOn).getTime()}),memoizedAllConvertChatMessage=memoizeFnAll((_key,chatMessage,userId,isSeen,isLargeGroup)=>{var _a;return{type:"chat",payload:{createdOn:chatMessage.createdOn,content:null===(_a=chatMessage.content)||void 0===_a?void 0:_a.message,type:sanitizedMessageContentType(chatMessage.type),status:!isLargeGroup&&"delivered"===chatMessage.status&&isSeen?"seen":chatMessage.status,senderDisplayName:chatMessage.senderDisplayName,senderId:void 0!==chatMessage.sender?toFlatCommunicationIdentifier(chatMessage.sender):userId,messageId:chatMessage.id,clientMessageId:chatMessage.clientMessageId}}}),updateMessagesWithAttached=(Object(es.a)([getUserId,(state,props)=>{var _a;return props.threadId&&(null===(_a=state.threads.get(props.threadId))||void 0===_a?void 0:_a.chatMessages)||new Map},(state,props)=>{var _a;return props.threadId&&(null===(_a=state.threads.get(props.threadId))||void 0===_a?void 0:_a.latestReadTime)||new Date(0)},(state,props)=>{var _a;const participants=null===(_a=state.threads.get(props.threadId))||void 0===_a?void 0:_a.participants;return!!participants&&participants.size>20}],(userId,chatMessages,latestReadTime,isLargeGroup)=>{const convertedMessages=memoizedAllConvertChatMessage(memoizedFn=>Array.from(chatMessages.values()).filter(message=>"text"===message.type.toLowerCase()||"richtext/html"===message.type.toLowerCase()||void 0!==message.clientMessageId).map(message=>{var _a;return memoizedFn(null!==(_a=message.id)&&void 0!==_a?_a:message.clientMessageId,message,userId,message.createdOn<=latestReadTime,isLargeGroup)}));return updateMessagesWithAttached(convertedMessages,userId),{userId:userId,showMessageStatus:!isLargeGroup,messages:convertedMessages}}),(chatMessagesWithStatus,userId)=>{chatMessagesWithStatus.sort(compareMessages),chatMessagesWithStatus.forEach((message,index,messages)=>{const mine=message.payload.senderId===userId;let attached=!1;0===index?index!==messages.length-1&&messages[index].payload.senderId===messages[index+1].payload.senderId&&(attached="top"):messages[index].payload.senderId===messages[index-1].payload.senderId?attached=index!==messages.length-1&&messages[index].payload.senderId===messages[index+1].payload.senderId||"bottom":index!==messages.length-1&&messages[index].payload.senderId===messages[index+1].payload.senderId&&(attached="top"),message.payload.attached=attached,message.payload.mine=mine})});es.a([(state,props)=>{var _a;return props.threadId&&(null===(_a=state.threads.get(props.threadId))||void 0===_a?void 0:_a.typingIndicators)||[]},getParticipants,getUserId],(typingIndicators,participants,userId)=>{if(participants.size>=20)return{typingUsers:[]};return{typingUsers:((typingIndicators,participants)=>typingIndicators.map(typingIndicator=>{var _a;return{userId:toFlatCommunicationIdentifier(typingIndicator.sender),displayName:null===(_a=participants.get(toFlatCommunicationIdentifier(typingIndicator.sender)))||void 0===_a?void 0:_a.displayName}}))(((typingIndicators,userId)=>{const filteredTypingIndicators=[],seen=new Set,date8SecondsAgo=new Date(Date.now()-8e3);for(let i=typingIndicators.length-1;i>=0;i--){const typingIndicator=typingIndicators[i];toFlatCommunicationIdentifier(typingIndicator.sender)!==userId&&(typingIndicator.receivedOn<date8SecondsAgo||seen.has(toFlatCommunicationIdentifier(typingIndicator.sender))||(seen.add(toFlatCommunicationIdentifier(typingIndicator.sender)),filteredTypingIndicators.push(typingIndicator)))}return filteredTypingIndicators})(typingIndicators,userId),participants)}}),es.a([getUserId,getParticipants,baseSelectors_getDisplayName],(userId,chatParticipants,displayName)=>{let participants=(chatParticipants=>chatParticipants.map(participant=>({userId:toFlatCommunicationIdentifier(participant.id),displayName:participant.displayName})))(Array.from(chatParticipants.values()));if(0!==participants.length){const moderatorIdx=(participants=>participants.map(p=>p.displayName).indexOf(void 0))(participants);if(-1!==moderatorIdx){moderatorIdx===participants.map(p=>p.userId).indexOf(userId)?participants[moderatorIdx].displayName=displayName:participants=participants.filter(p=>p.displayName)}}return{myUserId:userId,participants:participants}});__webpack_require__(148);var immer_esm=__webpack_require__(34);Object(immer_esm.b)();__webpack_require__(1687);new Date(0);Object(immer_esm.b)();__webpack_require__(786);var CommunicationUiErrorCode;__webpack_require__(747);!function(CommunicationUiErrorCode){CommunicationUiErrorCode[CommunicationUiErrorCode.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CONFIGURATION_ERROR=1]="CONFIGURATION_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UNAUTHORIZED_ERROR=2]="UNAUTHORIZED_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.FORBIDDEN_ERROR=3]="FORBIDDEN_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.TOO_MANY_REQUESTS_ERROR=4]="TOO_MANY_REQUESTS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SERVICE_UNAVAILABLE_ERROR=5]="SERVICE_UNAVAILABLE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.INTERNAL_SERVER_ERROR=6]="INTERNAL_SERVER_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UNKNOWN_STATUS_CODE_ERROR=7]="UNKNOWN_STATUS_CODE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.MESSAGE_EXCEEDED_RETRY_ERROR=8]="MESSAGE_EXCEEDED_RETRY_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.START_REALTIME_NOTIFICATIONS_ERROR=9]="START_REALTIME_NOTIFICATIONS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CREATE_CHAT_THREAD_CLIENT_ERROR=10]="CREATE_CHAT_THREAD_CLIENT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SEND_READ_RECEIPT_ERROR=11]="SEND_READ_RECEIPT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_READ_RECEIPT_ERROR=12]="GET_READ_RECEIPT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SEND_MESSAGE_ERROR=13]="SEND_MESSAGE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_MESSAGE_ERROR=14]="GET_MESSAGE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SEND_TYPING_NOTIFICATION_ERROR=15]="SEND_TYPING_NOTIFICATION_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_MESSAGES_ERROR=16]="GET_MESSAGES_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.REMOVE_THREAD_PARTICIPANT_ERROR=17]="REMOVE_THREAD_PARTICIPANT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UPDATE_THREAD_ERROR=18]="UPDATE_THREAD_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_THREAD_ERROR=19]="GET_THREAD_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.QUERY_PERMISSIONS_ERROR=20]="QUERY_PERMISSIONS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.ASK_PERMISSIONS_ERROR=21]="ASK_PERMISSIONS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SWITCH_VIDEO_SOURCE_ERROR=22]="SWITCH_VIDEO_SOURCE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UNMUTE_ERROR=23]="UNMUTE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.MUTE_ERROR=24]="MUTE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.START_VIDEO_ERROR=25]="START_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.STOP_VIDEO_ERROR=26]="STOP_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.START_SCREEN_SHARE_ERROR=27]="START_SCREEN_SHARE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.STOP_SCREEN_SHARE_ERROR=28]="STOP_SCREEN_SHARE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.RENDER_REMOTE_VIDEO_ERROR=29]="RENDER_REMOTE_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.RENDER_LOCAL_VIDEO_ERROR=30]="RENDER_LOCAL_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CREATE_CALL_AGENT_ERROR=31]="CREATE_CALL_AGENT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CREATE_DEVICE_MANAGER_ERROR=32]="CREATE_DEVICE_MANAGER_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.DISPOSE_CALL_AGENT_ERROR=33]="DISPOSE_CALL_AGENT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.JOIN_CALL_ERROR=34]="JOIN_CALL_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.LEAVE_CALL_ERROR=35]="LEAVE_CALL_ERROR"}(CommunicationUiErrorCode||(CommunicationUiErrorCode={}));Error;Object(react.createContext)(void 0),Object(memoize_one_esm.a)((userId,displayName,threads)=>({userId:userId,displayName:displayName,threads:threads})),Object(memoize_one_esm.a)(thread=>new Map([[thread.threadId,thread]])),Object(memoize_one_esm.a)(adapter=>({onSendMessage:adapter.sendMessage,onLoadPreviousChatMessages:adapter.loadPreviousChatMessages,onMessageSeen:adapter.sendReadReceipt,onTyping:adapter.sendTypingIndicator,onParticipantRemove:adapter.removeParticipant,updateThreadTopicName:adapter.setTopic})),Object(styling_lib.D)({height:"100%",width:"100%",overflow:"hidden",minHeight:"25rem",minWidth:"25rem","*::-webkit-scrollbar":{width:"0.3rem",height:"0.3rem"},".scroll::-webkit-scrollbar-track":{background:"rgba(150, 150, 150)",borderRadius:"0.3rem"},"*::-webkit-scrollbar-thumb":{borderRadius:"10px",background:"rgba(150, 150, 150)"}}),Object(styling_lib.D)({height:"100%",width:"100%",paddingLeft:"1rem",paddingRight:"1rem",paddingBottom:"1rem",overflow:"hidden"}),Object(styling_lib.D)({height:"100%",width:"100%",paddingBottom:"1rem",overflow:"auto",margin:"0 0.2rem"}),Object(styling_lib.D)({width:"100%",height:"3rem",paddingLeft:"1.5rem",paddingRight:"3.25rem",selectors:{"@media screen and (max-width: 25rem)":{paddingLeft:"5%",paddingRight:"5%"}},borderBottom:"0.063rem solid #DDDDDD"}),Object(styling_lib.D)({fontSize:"1.1rem",lineHeight:"2.5rem",fontWeight:600,marginRight:"0.125rem",textOverflow:"ellipsis",overflowY:"hidden"}),Object(styling_lib.D)({boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",width:"15rem",height:"100%"}),Object(styling_lib.D)({fontSize:"1rem",margin:"1rem"}),Object(styling_lib.D)({width:"15rem",height:"100%"}),Object(styling_lib.D)({overflowY:"hidden"}),es.a([(state,props)=>{var _a,_b;return(null===(_b=null===(_a=state.threads.get(props.threadId))||void 0===_a?void 0:_a.properties)||void 0===_b?void 0:_b.topic)||""}],topic=>({topic:topic}));__webpack_require__(1706),__webpack_require__(50);es.a([state=>toFlatCommunicationIdentifier(state.userId),(state,props)=>{var _a;return props.threadId&&(null===(_a=state.threads.get(props.threadId))||void 0===_a?void 0:_a.participants)||new Map}],(userId,chatParticipants)=>({amIRemovedFromThread:chatParticipants.size>0&&!chatParticipants.has(userId)}));__webpack_require__(1707);const headerContainer=Object(styling_lib.D)({width:"100%",height:"3.875rem",padding:"0.0625rem 0",boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2});Object(styling_lib.D)(headerContainer,{justifyContent:"center"}),Object(styling_lib.D)({height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),Object(react.createContext)(void 0),Object(memoize_one_esm.a)((userId,deviceManager,calls,displayName)=>({userId:userId,incomingCalls:new Map([]),incomingCallsEnded:[],callsEnded:[],deviceManager:deviceManager,callAgent:{displayName:displayName},calls:calls})),Object(memoize_one_esm.a)(call=>call?new Map([[call.id,call]]):new Map([]));var useHandlers_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};Object(memoize_one_esm.a)(adapter=>({onCreateLocalStreamView:options=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.createStreamView(void 0,options)})),onCreateRemoteStreamView:(userId,options)=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.createStreamView(userId,options)})),onHangUp:()=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.leaveCall()})),onParticipantRemove:userId=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.removeParticipant(userId)})),onSelectCamera:deviceInfo=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.setCamera(deviceInfo)})),onSelectMicrophone:deviceInfo=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.setMicrophone(deviceInfo)})),onSelectSpeaker:deviceInfo=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.setSpeaker(deviceInfo)})),onStartCall:participants=>{const rawIds=participants.map(participant=>toFlatCommunicationIdentifier(participant));return adapter.startCall(rawIds)},onStartScreenShare:()=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.startScreenShare()})),onStopScreenShare:()=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.stopScreenShare()})),onToggleCamera:()=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){yield adapter.onToggleCamera()})),onToggleMicrophone:()=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){var _a;return(null===(_a=adapter.getState().call)||void 0===_a?void 0:_a.isMuted)?yield adapter.unmute():yield adapter.mute()})),onToggleScreenShare:()=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){var _b;return(null===(_b=adapter.getState().call)||void 0===_b?void 0:_b.isScreenSharingOn)?yield adapter.stopScreenShare():yield adapter.startScreenShare()})),onStartLocalVideo:()=>useHandlers_awaiter(void 0,void 0,void 0,(function*(){if(adapter.getState().call)return adapter.startCamera()}))}));__webpack_require__(168);const MediaGallery_styles_videoBaseStyle=Object(styling_lib.D)({border:0}),aspectRatioBoxStyle=(Object(styling_lib.D)(MediaGallery_styles_videoBaseStyle,{width:"100%",height:"100%"}),Object(styling_lib.D)(MediaGallery_styles_videoBaseStyle,{width:"100%",height:0,position:"relative",paddingTop:"56.25%"})),aspectRatioBoxContentStyle=Object(styling_lib.D)({position:"absolute",top:0,left:0,width:"100%",height:"100%"}),ScreenShare_styles_videoTileStyle=(Object(styling_lib.D)({height:"100%",width:"25%"}),Object(styling_lib.D)({height:"100%",width:"75%",position:"relative"}),Object(styling_lib.D)({position:"absolute",bottom:".25rem",right:".25rem",height:"20%",width:"25%"}),Object(styling_lib.D)({height:"100%",width:"100%",display:"flex",justifyContent:"center"}),{root:{borderRadius:".25rem"}}),baseSelectors_getCall=(memoizeFnAll((userId,isAvailable,renderElement,displayName)=>react_default.a.createElement(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:aspectRatioBoxStyle,key:userId},react_default.a.createElement(Stack.a,{className:aspectRatioBoxContentStyle},react_default.a.createElement(VideoTile,{userId:userId,isVideoReady:isAvailable,renderElement:react_default.a.createElement(StreamMedia,{videoStreamElement:null!=renderElement?renderElement:null}),displayName:displayName,styles:ScreenShare_styles_videoTileStyle})))),state=>state.call);es.a([baseSelectors_getCall],call=>({callTranscribeState:null==call?void 0:call.transcription.isTranscriptionActive,callRecordState:null==call?void 0:call.recording.isRecordingActive})),Object(es.a)([state=>{var _a,_b;return null!==(_b=null===(_a=state.call)||void 0===_a?void 0:_a.state)&&void 0!==_b?_b:"None"},state=>{var _a,_b;return null!==(_b=null===(_a=state.call)||void 0===_a?void 0:_a.isScreenSharingOn)&&void 0!==_b&&_b}],(callStatus,isScreenShareOn)=>({callStatus:callStatus,isScreenShareOn:isScreenShareOn})),es.a([baseSelectors_getCall],call=>{var _a,_b;return{isVideoStreamOn:!!(null===(_b=null===(_a=null==call?void 0:call.localVideoStreams.find(stream=>"Video"===stream.mediaStreamType))||void 0===_a?void 0:_a.view)||void 0===_b?void 0:_b.target)}});es.a([baseSelectors_getCall,state=>state.displayName,state=>state.userId],(call,displayName,identifier)=>{var _a,_b;const localVideoStream=null==call?void 0:call.localVideoStreams.find(i=>"Video"===i.mediaStreamType);return{localParticipant:{userId:null!=identifier?identifier:"",displayName:null!=displayName?displayName:"",isMuted:null==call?void 0:call.isMuted,isScreenSharingOn:null==call?void 0:call.isScreenSharingOn,videoStream:{isAvailable:!!localVideoStream,isMirrored:null===(_a=null==localVideoStream?void 0:localVideoStream.view)||void 0===_a?void 0:_a.isMirrored,renderElement:null===(_b=null==localVideoStream?void 0:localVideoStream.view)||void 0===_b?void 0:_b.target}}}});__webpack_require__(1714);Object(styling_lib.D)({width:"100%",height:"100%",selectors:{"@media (max-width: 750px)":{padding:"0.625rem",height:"100%"}}}),Object(styling_lib.D)({width:"100%",maxWidth:"18.75rem"}),Object(styling_lib.D)({height:"100%",width:"100%"}),Object(styling_lib.D)({height:"100%",width:"100%",justifyContent:"space-evenly"});const LocalPreview_styles_palette=Object(styling_lib.z)().palette;Object(styling_lib.D)({width:"100%",height:"100%"}),Object(styling_lib.D)({maxWidth:"25rem",minWidth:"12.5rem",width:"100%",height:"100%",maxHeight:"18.75rem",minHeight:"16.875rem",background:LocalPreview_styles_palette.neutralLighter,color:LocalPreview_styles_palette.neutralPrimaryAlt}),Object(styling_lib.D)({height:"2.8125rem",width:"100%",backgroundColor:LocalPreview_styles_palette.neutralQuaternaryAlt}),Object(styling_lib.D)({fontFamily:"Segoe UI Regular",fontSize:"0.625rem",color:LocalPreview_styles_palette.neutralTertiary}),es.a([state=>state.devices],deviceManager=>{var _a;const view=null===(_a=deviceManager.unparentedViews.values().next().value)||void 0===_a?void 0:_a.view;return{videoStreamElement:view?view.target:null}});__webpack_require__(1692);Object(styling_lib.D)({width:"100%",maxWidth:"18.75rem",minWidth:"12.5rem",maxHeight:"19.125rem",marginTop:"2.125rem"}),Object(styling_lib.D)({marginRight:"0.375rem",fontSize:"1.375rem"}),Object(styling_lib.D)({fontWeight:600,fontSize:"0.875rem",height:"2.75rem",width:"100%",marginTop:"2.125rem",maxWidth:"18.75rem",minWidth:"12.5rem"});__webpack_require__(1682);Object(styling_lib.D)({width:"20.625rem",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto"}),Object(styling_lib.D)({fontSize:"1.375rem",fontWeight:600}),Object(styling_lib.D)({fontWeight:600,height:"2.5rem",width:"9.875rem",fontSize:"0.875rem",padding:0}),Object(styling_lib.D)({marginRight:"0.375rem",fontSize:"1.375rem"}),Object(styling_lib.D)({fontSize:"0.875 rem"});Object(styling_lib.D)({height:"100%",width:"100%",overflow:"auto",minHeight:"30rem",minWidth:"50rem"});var THEMES={Light:{name:"Light",theme:lightTheme},Dark:{name:"Dark",theme:darkTheme}};function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ThemeToolTipWithPanel_ThemeToolTipWithPanel=function ThemeToolTipWithPanel(props){var _useGlobals2=_slicedToArray(Object(api_dist.useGlobals)(),2),globals=_useGlobals2[0],updateGlobals=_useGlobals2[1],_useState2=_slicedToArray(Object(react.useState)(""),2),textValue=_useState2[0],setTextValue=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!1),2),showPanel=_useState4[0],setShowPanel=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(""),2),error=_useState6[0],setError=_useState6[1];Object(lib.a)();var themeOptions=[];return Object.keys(THEMES).forEach((function(theme){return themeOptions.push({id:theme,title:theme,onClick:function onClick(){var _updateGlobals2;setShowPanel(!1),updateGlobals((_defineProperty(_updateGlobals2={},"theme",theme),_defineProperty(_updateGlobals2,"customTheme",""),_updateGlobals2)),public_api_default.a.getChannel().emit(core_events_dist.FORCE_RE_RENDER)},active:globals.theme===theme})})),themeOptions.push({id:"Custom",title:"Custom",onClick:function onClick(){return setShowPanel(!0)},active:"Custom"===globals.theme}),react_default.a.createElement(components_dist.WithTooltip,{placement:"top",trigger:"click",closeOnClick:!0,tooltip:react_default.a.createElement(components_dist.TooltipLinkList,{links:themeOptions})},react_default.a.createElement(components_dist.IconButton,{key:"background",title:"Change the background of the preview",active:props.active},react_default.a.createElement(components_dist.Icons,{icon:"paintbrush"})),react_default.a.createElement(Panel.a,{headerText:"Apply a custom theme",isOpen:showPanel,onDismiss:function onDismiss(){return setShowPanel(!1)},hasCloseButton:!0,closeButtonAriaLabel:"Close",isLightDismiss:!0,onDismissed:function onDismissed(){return setError("")}},react_default.a.createElement(Stack.a,null,react_default.a.createElement("p",null,"Enter your fluent theme in JSON format in the text field below and click 'Apply'"),react_default.a.createElement(TextField.a,{value:textValue,onChange:function setText(e){setError(""),setTextValue(e.target.value)},errorMessage:error,multiline:!0,styles:{fieldGroup:{height:"32rem"},root:{height:"35rem"}}}),react_default.a.createElement(Stack.a,{horizontal:!0,tokens:{childrenGap:"1rem"}},react_default.a.createElement(DefaultButton.a,{onClick:function onClick(){setTextValue(""),setError("")}},"Clear"),react_default.a.createElement(DefaultButton.a,{onClick:function onClick(){return function validateThenUpdate(){if(textValue.trim())try{var _updateGlobals,themeJson=textValue.replace(/(['"])?([a-z0-9A-Z_]+)(['"])?:/g,'"$2": '),customThemeValue=themeJson=(themeJson=themeJson.replace(/'/g,'"')).replace(/\,(?!\s*[\{\"\w])/g,""),themeObject=JSON.parse(themeJson);themeObject.palette||(customThemeValue=JSON.stringify({palette:themeObject})),updateGlobals((_defineProperty(_updateGlobals={},"theme","Custom"),_defineProperty(_updateGlobals,"customTheme",customThemeValue),_updateGlobals)),public_api_default.a.getChannel().emit(core_events_dist.FORCE_RE_RENDER),setTextValue(themeJson),setShowPanel(!1)}catch(e){setError(e.toString())}else setError("empty input")}()}},"Apply")))))},Initialization=__webpack_require__(1685),analyticsCookieConsentObtained=function analyticsCookieConsentObtained(){return!!window.siteConsent&&(!window.siteConsent.isConsentRequired||window.siteConsent.getConsent().Analytics)},createCookieChangedCallback=function createCookieChangedCallback(applicationInsightsInstance){window.cookieConsentChanged=function(){var analyticsCookieConsent=analyticsCookieConsentObtained();applicationInsightsInstance.getCookieMgr().setEnabled(analyticsCookieConsent)}},telemetry_startTelemetry=function startTelemetry(cookieConsent){var appInsights=new Initialization.a({config:{disableCookiesUsage:!cookieConsent,instrumentationKey:"1b58140a-796c-4831-97fb-370721e38a90",enableAutoRouteTracking:!0}});return appInsights.loadAppInsights(),appInsights};!function initTelemetry(){var appInsightsInstance=telemetry_startTelemetry(analyticsCookieConsentObtained());appInsightsInstance&&createCookieChangedCallback(appInsightsInstance)}(),public_api_default.a.setConfig({theme:Object(dist.create)({base:"light",brandTitle:"Azure Communication Services - UI Library",brandImage:"./images/logo.svg"}),enableShortcuts:!1}),public_api_default.a.register("toolbar",(function(){public_api_default.a.add("toolbar-addon/theme",{title:"Theme",type:public_api.types.TOOL,match:function match(_ref){var viewMode=_ref.viewMode,storyId=_ref.storyId;return!(!viewMode||!viewMode.match(/^(story)$/)||!storyId||storyId.match(/(teams-theme-component)$/))},render:function render(_ref2){var active=_ref2.active;return react_default.a.createElement(ThemeToolTipWithPanel_ThemeToolTipWithPanel,{active:active})}})}))},821:function(module,exports,__webpack_require__){__webpack_require__(822),__webpack_require__(1531),__webpack_require__(1403),__webpack_require__(1488),__webpack_require__(1490),__webpack_require__(1492),__webpack_require__(1497),__webpack_require__(1500),__webpack_require__(1504),module.exports=__webpack_require__(1530)},889:function(module,exports){}},[[821,1,2]]]);