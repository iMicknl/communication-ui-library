(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return microphoneButtonSelector})),__webpack_require__.d(__webpack_exports__,"a",(function(){return cameraButtonSelector})),__webpack_require__.d(__webpack_exports__,"f",(function(){return screenShareButtonSelector})),__webpack_require__.d(__webpack_exports__,"e",(function(){return optionsButtonSelector})),__webpack_require__.d(__webpack_exports__,"c",(function(){return devicePermissionSelector})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createDefaultCallingHandlers})),__webpack_require__.d(__webpack_exports__,"g",(function(){return videoGallerySelector}));var getDeviceManager=function getDeviceManager(state){return state.deviceManager},getCall=function getCall(state,props){return state.calls.get(props.callId)},getDisplayName=function getDisplayName(state){var _state$callAgent;return null===(_state$callAgent=state.callAgent)||void 0===_state$callAgent?void 0:_state$callAgent.displayName},getIdentifier=function getIdentifier(state){return state.userId},es=(__webpack_require__(9),__webpack_require__(15),__webpack_require__(16),__webpack_require__(118),__webpack_require__(62)),microphoneButtonSelector=es.a([getCall,getDeviceManager],(function(call,deviceManager){return{disabled:!call,checked:!!call&&!call.isMuted}})),cameraButtonSelector=es.a([getCall,getDeviceManager],(function(call,deviceManager){var _deviceManager$unpare,previewOn=void 0!==(null===(_deviceManager$unpare=deviceManager.unparentedViews.values().next().value)||void 0===_deviceManager$unpare?void 0:_deviceManager$unpare.view),localVideoFromCall=null==call?void 0:call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType}));return{disabled:!deviceManager.selectedCamera,checked:call?!!localVideoFromCall:previewOn}})),screenShareButtonSelector=es.a([getCall],(function(call){return{checked:null==call?void 0:call.isScreenSharingOn}})),optionsButtonSelector=es.a([getDeviceManager,getCall],(function(deviceManager){return{microphones:deviceManager.microphones,speakers:deviceManager.speakers,cameras:deviceManager.cameras,selectedMicrophone:deviceManager.selectedMicrophone,selectedSpeaker:deviceManager.selectedSpeaker,selectedCamera:deviceManager.selectedCamera}})),devicePermissionSelector=es.a([getDeviceManager],(function(deviceManager){return{video:!deviceManager.deviceAccess||deviceManager.deviceAccess.video,audio:!deviceManager.deviceAccess||deviceManager.deviceAccess.audio}})),sdk_bundle=(__webpack_require__(45),__webpack_require__(24),__webpack_require__(17),__webpack_require__(41),__webpack_require__(20),__webpack_require__(13),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(21),__webpack_require__(90)),src=__webpack_require__(35),memoize_one_esm=__webpack_require__(398);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var areStreamsEqual=function areStreamsEqual(prevStream,newStream){return!!prevStream&&!!newStream&&prevStream.source.id===newStream.source.id},createDefaultCallingHandlers=Object(memoize_one_esm.a)((function(callClient,callAgent,deviceManager,call){var onStartLocalVideo=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var callId,videoDeviceInfo,cameras,stream;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(callId=null==call?void 0:call.id,videoDeviceInfo=callClient.getState().deviceManager.selectedCamera){_context.next=8;break}return _context.next=5,null==deviceManager?void 0:deviceManager.getCameras();case 5:cameras=_context.sent,(videoDeviceInfo=cameras&&cameras.length>0?cameras[0]:void 0)&&(null==deviceManager||deviceManager.selectCamera(videoDeviceInfo));case 8:if(callId&&videoDeviceInfo){_context.next=10;break}return _context.abrupt("return");case 10:if(stream=new sdk_bundle.LocalVideoStream(videoDeviceInfo),!call||call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context.next=14;break}return _context.next=14,call.startVideo(stream);case 14:case"end":return _context.stop()}}),_callee)})));return function onStartLocalVideo(){return _ref.apply(this,arguments)}}(),onStopLocalVideo=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(stream){var callId;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(callId=null==call?void 0:call.id){_context2.next=3;break}return _context2.abrupt("return");case 3:if(!call||!call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context2.next=8;break}return _context2.next=6,call.stopVideo(stream);case 6:return _context2.next=8,callClient.disposeView(callId,void 0,{source:stream.source,mediaStreamType:stream.mediaStreamType});case 8:case"end":return _context2.stop()}}),_callee2)})));return function onStopLocalVideo(_x){return _ref2.apply(this,arguments)}}(),onToggleCamera=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var stream,selectedCamera,_iterator,_step,_stream;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!call){_context3.next=11;break}if(!(stream=call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})))){_context3.next=7;break}return _context3.next=5,onStopLocalVideo(stream);case 5:_context3.next=9;break;case 7:return _context3.next=9,onStartLocalVideo();case 9:_context3.next=36;break;case 11:if(!(selectedCamera=callClient.getState().deviceManager.selectedCamera)){_context3.next=36;break}if(!isPreviewOn(callClient.getState().deviceManager)){_context3.next=34;break}_iterator=_createForOfIteratorHelper(callClient.getState().deviceManager.unparentedViews.keys()),_context3.prev=16,_iterator.s();case 18:if((_step=_iterator.n()).done){_context3.next=24;break}return _stream=_step.value,_context3.next=22,callClient.disposeView(void 0,void 0,_stream);case 22:_context3.next=18;break;case 24:_context3.next=29;break;case 26:_context3.prev=26,_context3.t0=_context3.catch(16),_iterator.e(_context3.t0);case 29:return _context3.prev=29,_iterator.f(),_context3.finish(29);case 32:_context3.next=36;break;case 34:return _context3.next=36,callClient.createView(void 0,void 0,{source:selectedCamera,mediaStreamType:"Video"});case 36:case"end":return _context3.stop()}}),_callee3,null,[[16,26,29,32]])})));return function onToggleCamera(){return _ref3.apply(this,arguments)}}(),onSelectMicrophone=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(device){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(deviceManager){_context4.next=2;break}return _context4.abrupt("return");case 2:return _context4.abrupt("return",deviceManager.selectMicrophone(device));case 3:case"end":return _context4.stop()}}),_callee4)})));return function onSelectMicrophone(_x2){return _ref4.apply(this,arguments)}}(),onSelectSpeaker=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(device){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(deviceManager){_context5.next=2;break}return _context5.abrupt("return");case 2:return _context5.abrupt("return",deviceManager.selectSpeaker(device));case 3:case"end":return _context5.stop()}}),_callee5)})));return function onSelectSpeaker(_x3){return _ref5.apply(this,arguments)}}(),onSelectCamera=function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(device){var stream,_iterator2,_step2,_stream2;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(deviceManager){_context6.next=2;break}return _context6.abrupt("return");case 2:if(!call){_context6.next=8;break}return deviceManager.selectCamera(device),stream=call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})),_context6.abrupt("return",null==stream?void 0:stream.switchSource(device));case 8:if(isPreviewOn(callClient.getState().deviceManager)){_context6.next=12;break}return deviceManager.selectCamera(device),_context6.abrupt("return");case 12:if(!callClient.getState().deviceManager.selectedCamera){_context6.next=31;break}_iterator2=_createForOfIteratorHelper(callClient.getState().deviceManager.unparentedViews.keys()),_context6.prev=15,_iterator2.s();case 17:if((_step2=_iterator2.n()).done){_context6.next=23;break}return _stream2=_step2.value,_context6.next=21,callClient.disposeView(void 0,void 0,_stream2);case 21:_context6.next=17;break;case 23:_context6.next=28;break;case 25:_context6.prev=25,_context6.t0=_context6.catch(15),_iterator2.e(_context6.t0);case 28:return _context6.prev=28,_iterator2.f(),_context6.finish(28);case 31:return deviceManager.selectCamera(device),_context6.next=34,callClient.createView(void 0,void 0,{source:device,mediaStreamType:"Video"});case 34:case"end":return _context6.stop()}}),_callee6,null,[[15,25,28,31]])})));return function onSelectCamera(_x4){return _ref6.apply(this,arguments)}}(),onToggleMicrophone=function(){var _ref7=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(call){_context7.next=2;break}throw new Error("Please invoke onToggleMicrophone after call is started");case 2:if(!call.isMuted){_context7.next=8;break}return _context7.next=5,call.unmute();case 5:_context7.t0=_context7.sent,_context7.next=11;break;case 8:return _context7.next=10,call.mute();case 10:_context7.t0=_context7.sent;case 11:return _context7.abrupt("return",_context7.t0);case 12:case"end":return _context7.stop()}}),_callee7)})));return function onToggleMicrophone(){return _ref7.apply(this,arguments)}}(),onStartScreenShare=function(){var _ref8=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,null==call?void 0:call.startScreenSharing();case 2:return _context8.abrupt("return",_context8.sent);case 3:case"end":return _context8.stop()}}),_callee8)})));return function onStartScreenShare(){return _ref8.apply(this,arguments)}}(),onStopScreenShare=function(){var _ref9=_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,null==call?void 0:call.stopScreenSharing();case 2:return _context9.abrupt("return",_context9.sent);case 3:case"end":return _context9.stop()}}),_callee9)})));return function onStopScreenShare(){return _ref9.apply(this,arguments)}}(),onToggleScreenShare=function(){var _ref10=_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(null==call||!call.isScreenSharingOn){_context10.next=6;break}return _context10.next=3,onStopScreenShare();case 3:_context10.t0=_context10.sent,_context10.next=9;break;case 6:return _context10.next=8,onStartScreenShare();case 8:_context10.t0=_context10.sent;case 9:return _context10.abrupt("return",_context10.t0);case 10:case"end":return _context10.stop()}}),_callee10)})));return function onToggleScreenShare(){return _ref10.apply(this,arguments)}}();return{onHangUp:function(){var _ref11=_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,null==call?void 0:call.hangUp();case 2:return _context11.abrupt("return",_context11.sent);case 3:case"end":return _context11.stop()}}),_callee11)})));return function onHangUp(){return _ref11.apply(this,arguments)}}(),onSelectCamera:onSelectCamera,onSelectMicrophone:onSelectMicrophone,onSelectSpeaker:onSelectSpeaker,onStartCall:function onStartCall(participants,options){return callAgent?callAgent.startCall(participants,options):void 0},onStartScreenShare:onStartScreenShare,onStopScreenShare:onStopScreenShare,onToggleCamera:onToggleCamera,onToggleMicrophone:onToggleMicrophone,onToggleScreenShare:onToggleScreenShare,onCreateLocalStreamView:function(){var _ref12=_asyncToGenerator(regeneratorRuntime.mark((function _callee12(options){var callState,localStream;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:if(call&&0!==call.localVideoStreams.length){_context12.next=2;break}return _context12.abrupt("return");case 2:if(callState=callClient.getState().calls.get(call.id)){_context12.next=5;break}return _context12.abrupt("return");case 5:if(localStream=callState.localVideoStreams.find((function(item){return"Video"===item.mediaStreamType}))){_context12.next=8;break}return _context12.abrupt("return");case 8:return _context12.abrupt("return",callClient.createView(call.id,void 0,localStream,options));case 9:case"end":return _context12.stop()}}),_callee12)})));return function onCreateLocalStreamView(_x5){return _ref12.apply(this,arguments)}}(),onCreateRemoteStreamView:function(){var _ref13=_asyncToGenerator(regeneratorRuntime.mark((function _callee13(userId,options){var callState,participant,remoteVideoStream,screenShareStream;return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(call){_context13.next=2;break}return _context13.abrupt("return");case 2:if(callState=callClient.getState().calls.get(call.id)){_context13.next=5;break}throw new Error("Call Not Found: ".concat(call.id));case 5:if((participant=Array.from(callState.remoteParticipants.values()).find((function(participant){return Object(src.c)(participant.identifier)===userId})))&&participant.videoStreams){_context13.next=8;break}return _context13.abrupt("return");case 8:remoteVideoStream=Array.from(participant.videoStreams.values()).find((function(i){return"Video"===i.mediaStreamType})),screenShareStream=Array.from(participant.videoStreams.values()).find((function(i){return"ScreenSharing"===i.mediaStreamType})),remoteVideoStream&&remoteVideoStream.isAvailable&&!remoteVideoStream.view&&callClient.createView(call.id,participant.identifier,remoteVideoStream,options),screenShareStream&&screenShareStream.isAvailable&&!screenShareStream.view&&callClient.createView(call.id,participant.identifier,screenShareStream,options);case 12:case"end":return _context13.stop()}}),_callee13)})));return function onCreateRemoteStreamView(_x6,_x7){return _ref13.apply(this,arguments)}}(),onParticipantRemove:function onParticipantRemove(userId){null==call||call.removeParticipant(Object(src.a)(userId))},onStartLocalVideo:onStartLocalVideo}})),isPreviewOn=function isPreviewOn(deviceManager){var _deviceManager$unpare;return void 0!==(null===(_deviceManager$unpare=deviceManager.unparentedViews.values().next().value)||void 0===_deviceManager$unpare?void 0:_deviceManager$unpare.view)},convertRemoteVideoStreamToVideoGalleryStream=(__webpack_require__(39),__webpack_require__(523),es.a([getIdentifier,getDisplayName,getCall],(function(userId,displayName,call){var remoteParticipants=call&&null!=call&&call.remoteParticipants?function convertRemoteParticipantsToCommunicationParticipants(remoteParticipants){return remoteParticipants.map((function(participant){var isScreenSharing=Array.from(participant.videoStreams.values()).some((function(videoStream){return"ScreenSharing"===videoStream.mediaStreamType&&videoStream.isAvailable}));return{userId:Object(src.c)(participant.identifier),displayName:participant.displayName,state:participant.state,isMuted:participant.isMuted,isScreenSharing:isScreenSharing,isSpeaking:participant.isSpeaking}}))}(Array.from(null==call?void 0:call.remoteParticipants.values())):[];return remoteParticipants.push({userId:userId,displayName:displayName,isScreenSharing:null==call?void 0:call.isScreenSharingOn,isMuted:null==call?void 0:call.isMuted,state:"Connected"}),{participants:remoteParticipants,myUserId:userId}})),function convertRemoteVideoStreamToVideoGalleryStream(stream){var _stream$view,_stream$view2;return{id:stream.id,isAvailable:stream.isAvailable,isMirrored:null===(_stream$view=stream.view)||void 0===_stream$view?void 0:_stream$view.isMirrored,renderElement:null===(_stream$view2=stream.view)||void 0===_stream$view2?void 0:_stream$view2.target}}),convertRemoteParticipantToVideoGalleryRemoteParticipant=function convertRemoteParticipantToVideoGalleryRemoteParticipant(userId,isMuted,isSpeaking,videoStreams,displayName){var rawVideoStreamsArray=Array.from(videoStreams.values()),videoStream=void 0,screenShareStream=void 0;return rawVideoStreamsArray[0]&&("Video"===rawVideoStreamsArray[0].mediaStreamType?videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0]):screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0])),rawVideoStreamsArray[1]&&("ScreenSharing"===rawVideoStreamsArray[1].mediaStreamType?screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1]):videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1])),{userId:userId,displayName:displayName,isMuted:isMuted,isSpeaking:isSpeaking,videoStream:videoStream,screenShareStream:screenShareStream,isScreenSharingOn:void 0!==screenShareStream&&screenShareStream.isAvailable}},memoizedAllConvertRemoteParticipant=Object(src.b)((function(userId,isMuted,isSpeaking,videoStreams,displayName){return convertRemoteParticipantToVideoGalleryRemoteParticipant(userId,isMuted,isSpeaking,videoStreams,displayName)})),videoGallerySelector_videoGalleryRemoteParticipantsFromCall=function videoGalleryRemoteParticipantsFromCall(call){return call&&call.remoteParticipants?memoizedAllConvertRemoteParticipant((function(memoizedFn){return Array.from(call.remoteParticipants.values()).map((function(participant){return memoizedFn(Object(src.c)(participant.identifier),participant.isMuted,participant.isSpeaking,participant.videoStreams,participant.displayName)}))})):[]},videoGallerySelector=Object(es.a)([getCall,getDisplayName,getIdentifier],(function(call,displayName,identifier){var _localVideoStream$vie,_localVideoStream$vie2,screenShareRemoteParticipant=null!=call&&call.screenShareRemoteParticipant?call.remoteParticipants.get(call.screenShareRemoteParticipant):void 0,localVideoStream=null==call?void 0:call.localVideoStreams.find((function(i){return"Video"===i.mediaStreamType}));return{screenShareParticipant:screenShareRemoteParticipant?convertRemoteParticipantToVideoGalleryRemoteParticipant(Object(src.c)(screenShareRemoteParticipant.identifier),screenShareRemoteParticipant.isMuted,screenShareRemoteParticipant.isSpeaking,screenShareRemoteParticipant.videoStreams,screenShareRemoteParticipant.displayName):void 0,localParticipant:{userId:identifier,displayName:null!=displayName?displayName:"",isMuted:null==call?void 0:call.isMuted,isScreenSharingOn:null==call?void 0:call.isScreenSharingOn,videoStream:{isAvailable:!!localVideoStream,isMirrored:null==localVideoStream||null===(_localVideoStream$vie=localVideoStream.view)||void 0===_localVideoStream$vie?void 0:_localVideoStream$vie.isMirrored,renderElement:null==localVideoStream||null===(_localVideoStream$vie2=localVideoStream.view)||void 0===_localVideoStream$vie2?void 0:_localVideoStream$vie2.target}},remoteParticipants:videoGallerySelector_videoGalleryRemoteParticipantsFromCall(call)}})),react=(__webpack_require__(10),__webpack_require__(0)),jsx_runtime=__webpack_require__(1),CallAgentContext=Object(react.createContext)(void 0),CallAgentProvider_CallAgentProviderBase=function CallAgentProviderBase(props){var initialState={callAgent:props.callAgent};return Object(jsx_runtime.jsx)(CallAgentContext.Provider,{value:initialState,children:props.children})};CallAgentProvider_CallAgentProviderBase.displayName="CallAgentProviderBase";var CallAgentProvider_CallAgentProvider=function CallAgentProvider(props){return Object(jsx_runtime.jsx)(CallAgentProvider_CallAgentProviderBase,Object.assign({},props))};CallAgentProvider_CallAgentProvider.displayName="CallAgentProvider";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallClientProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallClientProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallClientProvider_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallClientProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CallAgentProvider_CallAgentProvider.__docgenInfo={description:"",methods:[],displayName:"CallAgentProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},callAgent:{required:!1,tsType:{name:"CallAgent"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallAgentProvider.tsx"]={name:"CallAgentProvider",docgenInfo:CallAgentProvider_CallAgentProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallAgentProvider.tsx"});var CallClientContext=Object(react.createContext)(void 0),CallClientProvider_CallClientProviderBase=function CallClientProviderBase(props){var callClient=props.callClient,_useState2=_slicedToArray(Object(react.useState)(void 0),2),deviceManager=_useState2[0],setDeviceManager=_useState2[1];Object(react.useEffect)((function(){callClient.getDeviceManager().then((function(manager){manager.getCameras(),manager.getMicrophones(),manager.getSpeakers(),setDeviceManager(manager)})).catch((function(error){throw new Error(error)}))}),[callClient]);var initialState={callClient:callClient,deviceManager:deviceManager};return Object(jsx_runtime.jsx)(CallClientContext.Provider,{value:initialState,children:props.children})};CallClientProvider_CallClientProviderBase.displayName="CallClientProviderBase";var CallClientProvider_CallClientProvider=function CallClientProvider(props){return Object(jsx_runtime.jsx)(CallClientProvider_CallClientProviderBase,Object.assign({},props))};CallClientProvider_CallClientProvider.displayName="CallClientProvider";CallClientProvider_CallClientProvider.__docgenInfo={description:"",methods:[],displayName:"CallClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},callClient:{required:!0,tsType:{name:"StatefulCallClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallClientProvider.tsx"]={name:"CallClientProvider",docgenInfo:CallClientProvider_CallClientProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallClientProvider.tsx"});var CallContext=Object(react.createContext)(void 0),CallProvider_CallProviderBase=function CallProviderBase(props){var children=props.children,initialState={call:props.call};return Object(jsx_runtime.jsx)(CallContext.Provider,{value:initialState,children:children})};CallProvider_CallProviderBase.displayName="CallProviderBase";var CallProvider_CallProvider=function CallProvider(props){return Object(jsx_runtime.jsx)(CallProvider_CallProviderBase,Object.assign({},props))};CallProvider_CallProvider.displayName="CallProvider";CallProvider_CallProvider.__docgenInfo={description:"",methods:[],displayName:"CallProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},call:{required:!1,tsType:{name:"Call"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallProvider.tsx"]={name:"CallProvider",docgenInfo:CallProvider_CallProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallProvider.tsx"});__webpack_require__(27)},1041:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(624)},106:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPOSITE_STRING_CONNECTIONSTRING})),__webpack_require__.d(__webpack_exports__,"b",(function(){return CompositeConnectionParamsErrMessage}));__webpack_require__(39);var _fluentui_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(435),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(0),__webpack_require__(1)),COMPOSITE_STRING_CONNECTIONSTRING="Connection String",CompositeConnectionParamsErrMessage=function CompositeConnectionParamsErrMessage(errors){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_1__.a,{horizontalAlign:"center",verticalAlign:"center",style:{height:"100%",width:"100%"},children:errors.map((function(error){return error?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("span",{children:error},error):null}))})};CompositeConnectionParamsErrMessage.displayName="CompositeConnectionParamsErrMessage",CompositeConnectionParamsErrMessage.__docgenInfo={description:"",methods:[],displayName:"CompositeConnectionParamsErrMessage"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CompositeStringUtils.tsx"]={name:"CompositeConnectionParamsErrMessage",docgenInfo:CompositeConnectionParamsErrMessage.__docgenInfo,path:"stories/CompositeStringUtils.tsx"})},128:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return renderVideoStream}));var renderVideoStream=function renderVideoStream(scalingMode){var _navigator$mediaDevic;if(null!==(_navigator$mediaDevic=navigator.mediaDevices)&&void 0!==_navigator$mediaDevic&&_navigator$mediaDevic.getUserMedia){var video=document.createElement("video");return video.autoplay=!0,video.style.height="100%",video.style.width="100%",video.style.objectFit=null!=scalingMode?scalingMode:"cover",navigator.mediaDevices.getUserMedia({video:!0}).then((function(stream){video.srcObject=stream})).catch((function(error){console.log("Something went wrong!",error)})),video}return null}},137:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return isInCall})),__webpack_require__.d(__webpack_exports__,"a",(function(){return createAzureCommunicationUserCredential})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getIdFromToken})),__webpack_require__.d(__webpack_exports__,"d",(function(){return propagateError}));__webpack_require__(99),__webpack_require__(55);var _azure_communication_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(422),_types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(33),isInCall=function isInCall(callStatus){return!("None"===callStatus||"Disconnected"===callStatus)},createAzureCommunicationUserCredential=function createAzureCommunicationUserCredential(token,refreshTokenCallback){if(void 0!==refreshTokenCallback){var options={token:token,tokenRefresher:function tokenRefresher(){return refreshTokenCallback()},refreshProactively:!0};return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_2__.a(options)}return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_2__.a(token)},getIdFromToken=function getIdFromToken(jwtToken){var base64DecodedClaims,base64DecodedClaimsAsJson,jwtTokenParts=jwtToken.split(".");if(3!==jwtTokenParts.length)throw new _types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__.a({message:"Invalid jwt token",code:_types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__.b.CONFIGURATION_ERROR});try{base64DecodedClaims=atob(jwtTokenParts[1]),base64DecodedClaimsAsJson=JSON.parse(base64DecodedClaims)}catch(error){throw new _types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__.a({message:"Invalid access token",code:_types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__.b.CONFIGURATION_ERROR,error:error})}if(Object.prototype.hasOwnProperty.call(base64DecodedClaimsAsJson,"skypeid"))return"8:".concat(base64DecodedClaimsAsJson.skypeid);throw new _types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__.a({message:"Invalid access token",code:_types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__.b.CONFIGURATION_ERROR})},propagateError=function propagateError(error,onErrorCallback){if(!onErrorCallback)throw error;onErrorCallback(Object(_types_CommunicationUiError__WEBPACK_IMPORTED_MODULE_3__.c)(error))}},1433:function(module,exports,__webpack_require__){"use strict";__webpack_require__(38),__webpack_require__(8),__webpack_require__(83),__webpack_require__(1434),__webpack_require__(61),__webpack_require__(70),__webpack_require__(1435),__webpack_require__(95),__webpack_require__(56);var _clientApi=__webpack_require__(125),_clientLogger=__webpack_require__(96),_configFilename=__webpack_require__(1672);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(_configFilename.args||_configFilename.argTypes)&&_clientLogger.logger.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify({args:_configFilename.args,argTypes:_configFilename.argTypes})),_configFilename.decorators&&_configFilename.decorators.forEach((function(decorator){return(0,_clientApi.addDecorator)(decorator,!1)})),_configFilename.loaders&&_configFilename.loaders.forEach((function(loader){return(0,_clientApi.addLoader)(loader,!1)})),(_configFilename.parameters||_configFilename.globals||_configFilename.globalTypes)&&(0,_clientApi.addParameters)(_objectSpread(_objectSpread({},_configFilename.parameters),{},{globals:_configFilename.globals,globalTypes:_configFilename.globalTypes}),!1),_configFilename.argTypesEnhancers&&_configFilename.argTypesEnhancers.forEach((function(enhancer){return(0,_clientApi.addArgTypesEnhancer)(enhancer)}))},1570:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(624).configure)([__webpack_require__(1571),__webpack_require__(1583)],module,!1)}).call(this,__webpack_require__(224)(module))},1571:function(module,exports,__webpack_require__){var map={"./Accessibility.stories.mdx":1572,"./CustomUserDataModel.stories.mdx":1573,"./Feedback.stories.mdx":1574,"./Localization.stories.mdx":1575,"./Overview.stories.mdx":1576,"./QuickStarts/QuickstartComposite.stories.mdx":1673,"./QuickStarts/QuickstartStateful.stories.mdx":1659,"./QuickStarts/QuickstartUIComponents.stories.mdx":1655,"./Stateful Client/BestPractices.stories.mdx":1577,"./Stateful Client/OverviewStateful.stories.mdx":1578,"./Stateful Client/SettingUpReactHooks.stories.mdx":1579,"./Stateful Client/UsePropsForHook.stories.mdx":1580,"./Stateful Client/UseSelector.stories.mdx":1581,"./Styling/Styling.stories.mdx":1674,"./Theming.stories.mdx":1656,"./UseCases.stories.mdx":1582};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1571},1572:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"accessibility",title:"Accessibility",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"accessibility"},"Accessibility"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Accessibility by design is a principle across Microsoft products.\nUI Library follows this principle in making sure that all UI Components are fully accessible.\nDuring public preview, the UI Library will continue to improve and add accessibility feature to the UI Components.\nWe expect to add more details on accessibility ahead of the UI Library being in General Availability."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Accessibility",id:"accessibility",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1573:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"customuserdatamodel",title:"Custom User Data Model",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"custom-user-data-model"},"Custom User Data Model"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Azure Communication Services uses an identity agnostic model where developers can ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/identity-model",target:"_blank",rel:"nofollow noopener noreferrer"},"bring their own identities"),".\nDevelopers can bring their own data model and link it to Azure Communication Services identities.\nA developers data model for a user most likely includes information such as their display name, profile picture or avatar and other details. Information used by developers to power their own applications and platforms.\nThe UI Library makes it simple for developers to inject that user data model into the UI Components, so that when rendered they show a users provided information rather than generic information that Azure Communication Services has.\nUI Library enables these capabilities for both UI Components and Composites. Below, we will introduce the patterns to customize user data model for both types of components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"ui-components"},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For UI Components, user data model can be customized for each individual component.\nThis provides developers the most flexibility when building truly custom experiences that might expose and reflect different parts of a users persona.\nUser data model injection is available for those components that expose user information, particularly their display name and their avatar.\nBelow you will find a table with the components that support injection and the pattern/method used to inject information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Display Name"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Avatar"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-videotile--video-tile"},"Video Tile")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"placeholder")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-videogallery--video-gallery"},"Video Gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderRemoteVideoTile and onRenderLocalVideoTile"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-messagethread--message-thread"},"Message Thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderMessage"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-typingindicator--typing-indicator"},"Typing Indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderUsers"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderUsers")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-participantitem--participant-item"},"Participant Item")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-participantlist--participant-list"},"Participant List")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderParticipant"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderAvatar")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For additional examples on how this user data model injection pattern works, visit the individual component pages for each component."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"composites"},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For Composites, user data model can be customized at a composite level.\nAs turn-key experience, developers can provide a single data model mapping to the composite and the composite takes care of rendering the correct information for a user.\nComposites support user data model injection for display name and avatar across both chat and calling composites."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Display Name"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Avatar"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/composites-call--basic-example"},"CallComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/composites-chat--basic-example"},"ChatComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/docs/composites-chat--basic-example#custom-data-model"},"displayName")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/docs/composites-chat--basic-example#custom-data-model"},"onRenderAvatar"))))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For additional examples on how this user data model injection pattern works, visit the individual composite pages."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Custom User Data Model",id:"customuserdatamodel",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1574:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"feedback",title:"Feedback",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"feedback"},"Feedback"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"In order to improve the UI Library for Azure Communication Services we need your feedback!\nThere are various ways for you to provide feedback of your experience and help us make the UI Library better."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"contributing-to-ui-library"},"Contributing to UI Library"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"If there is a feature or bug you find and you are intersted in contributing directly to our code base please refer to our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/blob/main/docs/contributing-guide/1.%20getting-set-up.md",target:"_blank",rel:"nofollow noopener noreferrer"},"contribution guide"),".\nWe encourage developers to feel welcomed into the code base and directly contribute."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"github-issues"},"GitHub Issues"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"File feature requests, bugs or other issues against the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/issues",target:"_blank",rel:"nofollow noopener noreferrer"},"UI Library GitHub Repo"),".\nTo help us get to your issue faster use the GitHub labels provided.\nA team member will look to help out with outstanding issues and navigate them to the right owner.\nIssues on this repo should only be related to the UI Library. Issues for Azure Communication Services generally should be added to the main ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://github.com/Azure/communication",target:"_blank",rel:"nofollow noopener noreferrer"},"repo"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"microsoft-qa"},"Microsoft QA"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For any questions on UI Library or Azure Communication Services, use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/answers/topics/azure-communication-services.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft QA"),".\nThere use the tag ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"azure-communication-services")," for the question to be funneled to our team."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"uservoice"},"UserVoice"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For feedback on the UI Library or Azure Communication Services, use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://feedback.azure.com/forums/934536-azure-communication-services",target:"_blank",rel:"nofollow noopener noreferrer"},"UserVoice"),".\nMake sure to use the Azure Communication Services UserVoice and use the category ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"UI Library")," so that its indexed correctly."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Feedback",id:"feedback",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1575:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"localization",title:"Localization",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"localization"},"Localization"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Localization is a key to making products that can be used across the world and by people who who speak different languages.\nUI Library will provide out of the box support for some languages and capabilities such as RTL.\nDevelopers can provide their own localization files to be used for the UI Library.\nThese localization capabilities will be added ahead of General Availability."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Localization",id:"localization",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1576:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_fluentui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(435);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"overview",title:"Overview",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{horizontal:!0,horizontalAlign:"space-between",style:{backgroundColor:"#EFF6FC",padding:"2.25rem"},mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{style:{fontFamily:'"Segoe UI", sans-serif',color:"rgba(0,0,0,.5)",fontSize:"1.125rem",fontWeight:"500",border:"none",margin:"0rem 0rem 0.25rem 0rem",lineHeight:"1.5rem"}},"Azure Communication Services"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{style:{fontFamily:'"Segoe UI", sans-serif',color:"#0078D4",fontWeight:"600",fontSize:"2rem",margin:"0rem",lineHeight:"2.5rem"}},"UI Library")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("img",{src:"images/hero.svg",alt:"UI Library Hero Image",style:{maxHeight:"18.75rem"}}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Azure Communication Services - UI Library makes it easy for you to build modern communications user experiences using Azure Communication Services.\nIt gives you a library of production-ready UI components that you can drop into your applications:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("strong",{parentName:"p"},"Composites")," - These components are turn-key solutions that implement common communication scenarios.\nYou can quickly add video calling or chat experiences to your applications.\nComposites are open-source higher order components built using UI components.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("strong",{parentName:"p"},"UI Components")," - These components are open-source building blocks that let you build custom communications experience.\nComponents are offered for both calling and chat capabilities that can be combined to build experiences."))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"These UI client libraries all use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://developer.microsoft.com/fluentui/",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft's Fluent design language")," and assets. Fluent UI provides a foundational layer for the UI Library and is actively used across Microsoft products."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"In conjunction to the UI components, the UI Library exposes a ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("em",{parentName:"p"},"stateful client library")," for calling and chat.\nThis client is agnostic to any specific state management framework and can be integrated with common state managers like Redux or React Context.\nThis stateful client library can be used with the UI Components to pass props and methods for the UI Components to render data.\nFor more information, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/story/statefulclient-overview--page"},"Stateful Client Overview"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"installing-ui-library"},"Installing UI Library"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-bash"},"npm i --save @azure/communication-react\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"composites-overview"},"Composites Overview"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Composites are higher-level components composed of UI components that deliver turn-key solutions for common communication scenarios using Azure Communication Services.\nDevelopers can easily instantiate the Composite using an Azure Communication Services access token and the required configuration attributed for call or chat."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/composites-call--basic-example"},"CallComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Calling experience that allows users to start or join a call. Inside the experience users can configure their devices, participate in the call with video and see other participants, including those with video turn on. For Teams Interop is includes lobby functionality for user to wait to be admitted.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/composites-chat--basic-example"},"ChatComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chat experience where user can send and receive messages. Thread events like typing, reads, participants entering and leaving are displayed to the user as part of the chat thread.")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"ui-component-overview"},"UI Component Overview"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Pure UI Components that can be used by developers to compose communication experiences, from stitching video tiles into a grid to showcase remote participants, to organizing components to fit your applications specifications.\nUI Components support customization to give the components the right feel and look to match an applications branding and style."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Component"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Description"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-gridlayout--grid-layout"},"Grid Layout")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Grid component to organize Video Tiles into an NxN grid")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-videotile--video-tile"},"Video Tile")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Component that displays video stream when available and a default static component when not")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-controlbar--control-bar"},"Control Bar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Container to organize DefaultButtons to hook up to specific call actions like mute or share screen")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-videogallery--video-gallery"},"Video Gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Turn-key video gallery component which dynamically changes as participants are added")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-messagethread--message-thread"},"Message Thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Container that renders chat messages, system messages, and custom messages")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-sendbox--send-box"},"Send Box")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Text input component with a discrete send button")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-messagestatusindicator--message-status-indicator"},"Message Status Indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Multi-state message status indicator component to show status of sent message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-typingindicator--typing-indicator"},"Typing indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Text component to render the participants who are actively typing on a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Common"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-participantitem--participant-item"},"Participant Item")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Common component to render a call or chat participant including avatar and display name")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-participantlist--participant-list"},"Participant List")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Common component to render a call or chat participant list including avatar and display name")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"what-ui-artifact-is-best-for-my-project"},"What UI Artifact is Best for my Project?"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Understanding these requirements will help you choose the right client library:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("strong",{parentName:"li"},"How much customization do you desire?")," Azure Communication core client libraries don't have a UX and are designed so you can build whatever UX you want. UI Library components provide UI assets at the cost of reduced customization."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("strong",{parentName:"li"},"What platforms are you targeting?")," Different platforms have different capabilities.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Details about feature availability in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/story/usecases--page"},"UI Library is available here"),", but key trade-offs are summarized below."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Client library / SDK"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Implementation Complexity"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Customization Ability"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"th",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Composite Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Low"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Low"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Base Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Medium"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Medium"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Core client libraries"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"High"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"High"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Overview",id:"overview",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1577:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"statefulclient-bestpractices",title:"Stateful Client/Best Practices",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"best-practices"},"Best Practices"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"We are sharing some of our recommended best practices when handling state with Azure Communication Services UI Library."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"use-the-stateful-clients"},"Use the Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Managing the complex state of a calling or chat sesion can be challenging. This was a complex problem we found we were in and we think many of our developer community\nwill run into this challenge themselves. We wanted to find a convenient way to store this information on the client in a way that plays nicely with our components we are offering.\nBy using the stateful client for calling or chat, you are on our recommended path for powering your own communications experience using Azure Communication Services."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"use-usepropsfor"},"Use usePropsFor"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"If you are using our provided UI Components, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"usePropsFor")," will help you get integrated with the underlying functionality quickly. This provides a series of properties our\nprovided components are expecting from the stateful client to render an experience your users will be expecting. This is the fastest way to get your experience up and running with Azure Communication Services."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"you-can-use-your-own-ui-components"},"You can use your own UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Today you can use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useSelector")," to connect your own components to create your own experiences! We use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useSelector")," under the hood when you leverage our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"usePropsFor")," hook.\nWe wanted to ensure that developers wanting to create custom components had the same development path that we were using as well. Using this development path allows\nyou to start on the path that we use as well to create amazing components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"populating-the-devicemanager-state"},"Populating the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"h2"},"DeviceManager")," State"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"When using Stateful Calling, the call related state will be automatically retrieved for you.\nHowever, this is not the case for ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"DeviceManager")," state.\nTo be able to retrieve ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"DeviceManager")," state from the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"StatefulCallClient"),"’s state, you must trigger the appropriate APIs to populate the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"DeviceManager")," state."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"li"},"DeviceManager.askPermission()")," – this must be called to ask for device permissions from the user. The result of their decisions will be stored in DeviceManagerState.deviceAccess."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"li"},"DeviceManager.getCameras()")," – When called, the result will be stored in DeviceManagerState.cameras."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"li"},"DeviceManager.getMicrophones()")," – When called, the result will be stored in DeviceManagerState.microphones."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"li"},"DeviceManager.getSpeakers()")," – When called, the result will be stored in DeviceManagerState.speakers")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"use-of-selectedcamera-inside-the-devicemanager"},"Use of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"h2"},"selectedCamera")," inside the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"h2"},"DeviceManager")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To make Stateful Calling easier to use we’ve added a property to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"DeviceManagerState")," called ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"selectedCamera"),".\nThis is not a proxy of the SDK state and is completely controlled by you.\nIt is populated when you set it and updated when you update it. It has no bearing on the function of the SDK and not automatically used by the SDK."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"use-of-createview-and-disposeview-on-the-statefulcallclient"},"Use of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"h2"},"createView")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"h2"},"disposeView")," on the StatefulCallClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To allow developers to generate a HTMLElement/view of a Stateful VideoStream, we provide a createView and disposeView API.\nThese APIs are located in StatefulCallClient and should only be used for scenarios where developers want to generate their own components to use in conjunction with the UI Library.\nThere are three scenarios to using these APIs:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("em",{parentName:"p"},"Rendering a RemoteVideoStreamState"),"\nYou are required to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," with a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"callId"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"participantIdentifier"),", and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"remoteVideoStreamState"),".\nThe ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," is async and if your architecture can support awaiting for it we recommend you do that.\nOnce the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," completes the view will be stored under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallState.RemoteParticipants.[your remote participant].videoStream.[your videostream].view"),".\nIf you cannot await the result of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView"),", it is fine to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," again, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," will no-op the second call. Once the view has been created, the call state will be automatically updated and you can check the state for the view.\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CreateView")," will not allow creating multiple view of the same stream.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("em",{parentName:"p"},"Rendering a LocalVideoStreamState in a Call"),"\nSame as #1 except this time ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," only requires a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"callId")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"LocalVideoStreamState"),".\nNote that this will only work if the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"LocalVideoStream")," is already part of the call (you’ll have to first call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"Call.startVideo")," to add the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"LocalVideoStream")," to the Call).\nEverything else is the same as #1 after this except the view can be found in ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallState.localVideoStreams.(your videostream).view"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("em",{parentName:"p"},"Rendering a LocalVideoStreamState when not in a call"),"\nThis scenario supports the case if you want to see a video render without adding that stream to the call, for instance ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"LocalPreview")," scenario.\nIn this case ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," requires only a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"LocalVideoStreamState"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CreateView")," will put the created view under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"DeviceManagerState.unparentedViews.(your videostream).view"),".\nYou can access this Map using your original ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"LocalVideoStreamState")," as the key."))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To debug ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createView")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"disposeView"),", they emit ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"console.warns")," when used incorrectly that can be tracked."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"track-changes-to-callid"},"Track Changes to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"h2"},"callId")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"One major gotcha with using Stateful Calling is that ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"callId")," may change and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"callId")," is used to look up data in Stateful state.\nIf you have an old callId and the callId changed, you will not be able to access or find ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallState")," in ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallClientState"),".\nTo work around, we recommend you do not cache the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"callId")," and instead cache the entire call object.\nThe id in the call object will be kept up to date and when ever you access ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallClientState")," use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"call.id"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"detecting-screenshare-participant"},"Detecting Screenshare Participant"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To make Stateful Calling easier to use we added a ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"screenshareRemoteParticipant")," property to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallState"),".\nIf there is a remote participant screensharing, this will allow you to quickly look up that participant’s state by doing something like this:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"CallState.remoteParticipants.get(CallState.screenshareRemoteParticipant);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"This property will be undefined if there are no remote participants screensharing.\nNote that this only applies to remote screenshares and not local screenshares."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"detecting-transcription-and-recording"},"Detecting Transcription and Recording"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Stateful Calling will manage transcription/recording for you.\nYou only need to simply check the states under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallState.transcription")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallState.recording"),"."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Best Practices",id:"statefulclient-bestpractices",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1578:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"statefulclient-overview",title:"Stateful Client/Overview",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"overview-of-stateful-client"},"Overview of Stateful Client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Azure Communication Service UI Library exposes stateful clients for calling and chat.\nStateful clients are a 1:1 representation of the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"ChatClient")," exposed by the underlying low-level calling and chat SDKs.\nThey simply add a state layer on top of it to help track state that can be rendered as part of the UI.\nThey can be used in the same way as low-level clients would be used, so developers can use it to query the service and handle events (i.e. participant added or message recieved).\nStateful clients are agnostic to any specific state management framework."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"component-binding-with-stateful-clients"},"Component Binding with Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To make it simpler to connect the stateful client with UI Components, the UI Library exposes helpers, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-usepropsfor--page"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"a"},"usePropsFor")),", to generate props\nThese helpers aid in extracting the correct set of props required for different UI Components.\nThey expose both data for the UI Components to render such as a message list or a participants remote video, and default handlers for UI Components action such as sending a message."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"installing-stateful-clients"},"Installing Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Stateful clients are found as part of the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"@azure/communication-react")," package."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm i --save @azure/communication-react\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"calling-statefulclient"},"Calling StatefulClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Using ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createStatefulCallClient"),", developer can generate a stateful version of the call client."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"import { createStatefulCallClient } from '@azure/communication-react;\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\n\nconst endpointUrl = '<ENDPOINT>';\nconst userAccessToken = '<USER_ACCESS_TOKEN>';\nconst tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n\nconst statefulCallClient = createStatefulCallClient({\n  userId: userId,\n});\n\n// You can then use the `statefulCallClient` in the same way as a `CallClient` with a slight variation.\n\nconst callAgent = await statefulCallClient.createCallAgent(tokenCredential, {displayName: 'Optional User Name'})\n\nconst call = callAgent.join({groupId: <GUID>})\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To interact with the call, developers have access to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"statefulCallClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallAgent"),". The stateful clients are a 1:1 representation.\nFor state to be tracked, developers should use the stateful clients to query the service and listen to events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"accessing-the-device-manager"},"Accessing the Device Manager"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Through the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"statefulCallClient"),", developers can access the device manager to query the device available for the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"const deviceManager = await statefulCallClient.getDeviceManager();\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"The device manager allows developers to access the local video stream to render for the user ahead of joining a call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"const cameras = await deviceManager.getCameras();\nconst camera = cameras[0];\nconst localCameraStream = { source: camera, mediaStreamType: 'Video' } as LocalVideoStreamState;\nconst view = statefulClient.createView(localCameraStream);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For more information on the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"DeviceManager"),", see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/javascript/api/azure-communication-services/@azure/communication-calling/devicemanager?view=azure-communication-services-js",target:"_blank",rel:"nofollow noopener noreferrer"},"Device Management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"chat-statefulclient"},"Chat StatefulClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Using the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"createStatefulChatClient"),", developer can generate a stateful version of the chat client."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"import { createStatefulChatClient } from '@azure/communication-react;\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\n\nconst endpointUrl = '<ENDPOINT>';\nconst userAccessToken = '<USER_ACCESS_TOKEN>';\nconst tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n\nconst statefulChatClient = createStatefulChatClient({\n  userId: userId,\n  displayName: displayName,\n  endpoint: endpointUrl,\n  credential: tokenCredential\n});\n\n// You can then use the `statefulChatClient` in the same way as a `ChatClient` with a slight variation.\n\nconst chatThreadClient = await statefulChatClient.createChatThread({});\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To interact with the chat thread, developers have access ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"statefulChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"chatThreadClient"),". The stateful clients are a 1:1 representation.\nFor state to be tracked, developers should use the stateful clients to query the service and listen to events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"access-the-chat-thread-client"},"Access the Chat Thread Client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"The Chat Thread Client allows developers to access a variety of methods to query participants and send messages to a thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"const sendMessageRequest = {\n  content: 'Hello! Can you share the deck for the conference?'\n};\n\nlet sendMessageOptions = {\n  senderDisplayName: 'Jack',\n  type: 'text'\n};\nconst sendChatMessageResult = await chatThreadClient.sendMessage(sendMessageRequest, sendMessageOptions);\nconst messageId = sendChatMessageResult.id;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For more information on the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"ChatThreadClient"),", see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://azuresdkdocs.blob.core.windows.net/$web/javascript/azure-communication-chat/1.0.0/classes/chatthreadclient.html",target:"_blank",rel:"nofollow noopener noreferrer"},"ChatThreadClient")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"capabilities"},"Capabilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Stateful clients enable developers to access all the APIs that low-level calling and chat SDKs expose.\nFor a complete list of capabilities see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/voice-video-calling/calling-sdk-features",target:"_blank",rel:"nofollow noopener noreferrer"},"Calling Overview")," and\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/chat/sdk-features",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat Overview"),".\nAt a high level, stateful clients allow developers the following capabilities."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Capabilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Example"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Read state"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Query the state ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"td"},"statefulClient.state")," to access properties such as ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"td"},"statefulClient.state.messsages"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Handle state event changes"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Subscribe to events ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"td"},"statefulClient.onStateChange()")," and unsubscribe from events ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"td"},"statefulClient.offStateChange()"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Send commands"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Mute the microphone ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"td"},"statefulClient.mute()"))))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Overview",id:"statefulclient-overview",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1579:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"statefulclient-reacthooks-setup",title:"Stateful Client/React Hooks/Setting up",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"hooks"},"Hooks"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-intro.html",target:"_blank",rel:"nofollow noopener noreferrer"},"React Hooks")," allows developers to use state and other react features without writing a class component."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"While you can choose any state management library such as Redux, we also provide a simple way to power react components with our Stateful SDK.\nWe provide two ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-custom.html",target:"_blank",rel:"nofollow noopener noreferrer"},"custom hooks")," in our library, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor()")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-useselector--page"},"useSelector()"),", that allow you to subscribe to changes in the SDK state and bind to our UI components.\nAfter binding with the custom hooks a SDK state change will trigger a re-render of the UI component, and events on the component will call into the SDK clients."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"before-you-start"},"Before you Start"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Before you start, you need to wrap your whole App with Providers.\nThey give you access to global variables (like Stateful ChatClient/CallClient) for our hooks to consume.\nThere are different Providers for building apps with varying functionality:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"chat"},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For your Chat app, use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"ChatClientProvider")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"ChatThreadClientProvider")," to give hooks access to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"ChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"ChatThreadClient"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"statefulChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"chatThreadClient")," instances need to be passed to the Provider when you wrap your app.\nFor more information on creating them, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/statefulclient-overview--page"},"Overview")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"ReactDOM.render(\n  <ChatClientProvider chatClient={statefulChatClient}>\n    <ChatThreadClientProvider chatThreadClient={ChatThreadClient}>\n      <App />\n    </ChatThreadClientProvider>\n  </ChatClientProvider>,\n  document.getElementById('root')\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"calling"},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For your Chat app, use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallClientProvider"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallAgentProvider")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallProvider")," to give hooks access to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallClient"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"CallAgentClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"Call"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"statefulCallClient"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"callAgent")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"call")," instances need to be passed to the Provider when you wrap your app.\nFor more information on creating them, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/statefulclient-overview--page"},"Overview")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"ReactDOM.render(\n  <CallClientProvider callClient={statefulCallClient}>\n    <CallAgentProvider callAgent={callAgent}>\n      <CallProvider call={call}>\n        <App />\n      </CallProvider>\n    </CallAgentProvider>\n  </CallClientProvider>,\n  document.getElementById('root')\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"next"},"Next"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Once you have wrapped your entire app with providers, you are now can use the usePropsFor() method inside of your app to connect your components to the state."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To see a full end-to-end example using providers, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/quickstarts-statefulclient--page"},"Getting Started with StatefulClient")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/Setting up",id:"statefulclient-reacthooks-setup",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1580:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"statefulclient-reacthooks-usepropsfor",title:"Stateful Client/React Hooks/UsePropsFor",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"usepropsfor-a-nameusepropsfora"},"usePropsFor ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{name:"usePropsFor"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"If you are using React Component from our communication-react components, usePropsFor is the go-to hook.\nIt provides all the required props to power a feature component.\nIt subscribes to state changes of stateful clients, gets props designed for your component, and triggers a re-render whenever the props change.\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"UsePropsFor")," comes in two flavors: ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"UseCallPropsFor")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"UseChatPropsFor"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"To see a full end-to-end example using usePropsFor, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/quickstarts-statefulclient--page"},"Getting Started with StatefulClient")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"usecallpropsfor-example"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("em",{parentName:"h2"},"useCallPropsFor")," Example"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { VideoGallery } from '@azure/communication-react';\nimport { useCallPropsFor } from '@azure/communication-react';\n\nexport const ChatScreen = () => {\n  const props = useCallPropsFor(VideoGallery);\n  return <VideoGallery {...props} />;\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useCallPropsFor")," supports the following call components:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/docs/ui-components-controlbar--control-bar"},"ControlBar Buttons")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/docs/ui-components-videogallery--video-gallery"},"VideoGallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/docs/ui-components-participantlist--participant-list"},"ParticipantList"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"usechatpropsfor-example"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("em",{parentName:"h2"},"useChatPropsFor")," Example"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { MessageThread } from '@azure/acs-chat-component';\nimport { useChatPropsFor } from 'chat-component-bindings';\n\nexport const ChatScreen = () => {\n  const props = useChatPropsFor(MessageThread);\n  return <MessageThread {...props} />;\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useChatPropsFor")," supports the following chat components:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/docs/ui-components-messagethread--message-thread"},"MessageThread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/docs/ui-components-sendbox--send-box"},"SendBox")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/docs/ui-components-typingindicator--typing-indicator"},"TypingIndicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/docs/ui-components-participantlist--participant-list"},"ParticipantList"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"under-the-hood-of-usepropsfor"},"Under the Hood of usePropsFor"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"usePropsFor() is a function that provides all you need to run a component in our library.\nIt combines 2 tasks for generating the component's props for you:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ol"},"Finds the right selector designed for the component, then call useSelector()"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ol"},"Constructs a set of handlers tailored for the component")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"using-usepropsfor-with-custom-components"},"Using usePropsFor with Custom Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"You can use the usePropsFor function for your own custom components by matching the props structure of the supported UI Components.\nBy passing the component that matches your custom components prop structure, you can then use the outputted props on your own custom component.\nThis means you could build your own ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"Video Gallery")," with a custom layout using our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"Grid Layout")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"Video Tile")," components, and still leverage our usePropsFor helper.\nIn cases, where matching the prop structure is not possible, the stateful clients can still be leveraged to extract and maintain your own props.\nFor more information, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-useselector--page"},"useSelector"),"."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/UsePropsFor",id:"statefulclient-reacthooks-usepropsfor",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1581:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"statefulclient-reacthooks-useselector",title:"Stateful Client/React Hooks/UseSelector",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"useselector-a-nameuseselectora"},"useSelector() ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{name:"useSelector"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useSelector")," allows you to provide your own selector function that maps the stateful SDK state to your own props for your own component. It subscribes to state changes and runs the selector every time when anything changes in the state, but note that it will only trigger a component re-render when the return value of the selector changes.\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useSelector")," comes in two flavors: ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useCallSelector")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useChatSelector")," for each of the modalities."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"when-to-call-useselector"},"When to Call useSelector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"By default, if you are satisfied with props we prepared for component library, all you need is to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"usePropsFor")," to power our component. If just one or two props need to be filtered or modified, directly overriding properties from return value of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"usePropsFor")," is recommended. But sometimes you might want to call use selector instead when:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ol"},"Override the way how it generates props from state"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ol"},"Write your own components (which we don't provide dedicated selectors for it)")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"basic-example"},"Basic Example:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"const userInfoSelector = (state) => ({\n  id: state.userId\n  userName: state.displayName\n});\n\nconst chatInfoProps = useChatSelector(userInfoSelector);\n\nconst ChatInfo = ({id: string, userName: string}) => {\n  return <div> userName: {userName}, id: {id} </div>;\n}\n\n<ChatInfo {...chatInfoProps} />\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"memoizing-your-selector"},"Memoizing your Selector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"(Recommended for optimized perf)"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"While this basic example will work without problems, but it is not a good way to optimize your app perf, we recommend to use the reselect library to enable memoization for selectors to get better performance, check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://redux-toolkit.js.org/api/createSelector#createselector",target:"_blank",rel:"nofollow noopener noreferrer"},"reselect's official docs")," for more information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"import { createSelector } from 'reselect';\n\nconst userInfoSelector = createSelector([(state) => state.userId, (state) => state.displayName], (id, userName) => ({\n  id,\n  userName\n}));\n\nconst chatInfoProps = useChatSelector(userInfoSelector);\n\nconst ChatInfo = ({ id: string, userName: string }) => {\n  return (\n    <div>\n      {' '}\n      userName: {userName}, id: {id}{' '}\n    </div>\n  );\n};\n\n<ChatInfo {...chatInfoProps} />;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"override-default-behaviors"},"Override Default Behaviors"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"While we provide a set of default props(which includes data and handler functions) for our UI library component, you might find it doesn't fit all you needs, there are several different ways you can choose to override the default behavior."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"write-your-own-handler-function"},"Write your own Handler Function"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"In some situations, you may want to override default behavior and place your own API call (like call another service, or call another API in our stateful SDK). Here is an example of how to change the message before using the stateful client to send it."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"const sendBoxProps = useChatPropsFor(SendBox);\n// This hook will get stateful client you created\nconst chatThreadClient = useChatThreadClient();\n\nconst onSendMessage = useCallback(\n  (message: string) => {\n    const sendMessageRequest = {\n      `✉: ${content}`,\n      senderDisplayName: chatClient.getState().displayName\n    };\n    // directly call into stateful client\n    await chatThreadClient.sendMessage(sendMessageRequest);\n  },\n  [chatThreadClient]\n);\n\n<SendBox {...sendBoxProps} onSendMessage={onSendMessage} />;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"override-selector"},"Override Selector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"With the hooks that we provide it is also possible to override a selector without re-writing the default handlers."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"const customSelector = createSelector(....); // create your own selector\nconst messageThreadProps = useChatSelector(customSelector);\nconst messageThreadHandlers = useChatHandlers(MessageThread);\n\n\n<MessageThread {...messageThreadProps} {...messageThreadHandlers} />\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h3",{id:"choose-your-own-overridden-combination"},"Choose your own Overridden Combination"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"By calling ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"useSelector"),"/",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("inlineCode",{parentName:"p"},"usePropsFor"),", you can get the right combination of default selector + overrided handler/default handler + overrided selector for your own needs. You can even entirely override the whole behavior by writing your own handler and selectors:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("code",{parentName:"pre",className:"language-tsx"},"const customSelector = createSelector(....); // create your own selector\nconst messageThreadProps = useChatSelector(customSelector);\n// This hook will get stateful client you created\nconst chatThreadClient = useChatThreadClient();\n\n// Create your own handlers\nconst onMessageSeen = useCallback((message: string) => {\n  await chatThreadClient.sendReadReceipt({ chatMessageId });\n}, [chatThreadClient]);\n\n<MessageThread {...messageThreadProps} onMessageSeen={onMessageSeen} />\n")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/UseSelector",id:"statefulclient-reacthooks-useselector",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1582:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.Meta,{id:"usecases",title:"Use Cases",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h1",{id:"ui-library-use-cases"},"UI Library Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"UI Library supports many use cases across calling and chat experiences.\nThese capabilities are available through UI Components and Composites.\nFor Composites, these capabilities are built directly in and exposed when the composite is integrated into an application.\nFor UI Components, these capabilities are exposed through a combination of UI functionality and underlying stateful libraries.\nTo take full advantage of these capabilities, we recommend using the UI Components with the stateful call and chat client libraries."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"calling-use-cases"},"Calling Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Call Types"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Join Teams Meeting")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Join Azure Communication Services call with Group Id")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"td",href:"https://docs.microsoft.com/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Call Lobby")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Transcription and recording alert banner")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Call Controls"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Mute/unmute call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Video on/off on call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Screen Sharing")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"End call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Participant Gallery"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Remote participants are displayed on grid")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Video preview available throughout call for local user")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Default avatars available when video is off")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Shared screen content displayed on participant gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Call configuration"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Microphone device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Camera device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Speaker device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Local preview available for user to check video")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Participants"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Participant roster")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"chat-use-cases"},"Chat Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chat Types"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Join a Teams Meeting Chat")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Join an Azure Communication Services chat thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chat Actions"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Send chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Receive chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chat Events"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Typing Indicators")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Read Receipt")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Participant added/removed")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chat title changed")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Participants"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Participant roster")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"supported-identities"},"Supported Identities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"An Azure Communication Services identity is required to initialize the stateful client libraries and authenticate to the service.\nFor more information on authentication, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/authentication",target:"_blank",rel:"nofollow noopener noreferrer"},"Authentication")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/access-tokens?pivots=programming-language-javascript",target:"_blank",rel:"nofollow noopener noreferrer"},"Access Tokens")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"teams-interop-use-case"},"Teams Interop Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"For ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")," scenarios, developers can use UI Library Components to join Teams meetings through Azure Communication Services.\nTo enable Teams Interop, developers can either use calling and chat composites directly or use UI Components to build a custom experience.\nWhen enabling applications with both calling and chat, its important to remember that the chat client can't be initialized until the participant has been admitted to the call.\nOnce admitted, the chat client can be initialized to join the meeting chat thread.\nSee the diagram below for guidance:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("img",{parentName:"p",src:"images/teams-interop-pattern.png",alt:"Teams Interop pattern for calling and chat"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"When using UI Components to deliver Teams Interop experiences, UI Library provides examples for key pieces of the experience.\nFor example:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/story/examples-teamsinterop-lobby--lobby"},"Lobby Example"),": Sample lobby for participant to wait to be admitted to the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/story/examples-teamsinterop-compliancebanner--compliance-banner"},"Compliance banner"),": Sample banner to show the user whether the call is being recorded or not."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"li",href:"/?path=/story/examples-themes-teams--teams"},"Teams Theme"),": Sample theme that makes the UI Library looks like Microsoft Teams.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"customization"},"Customization"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"UI Library exposes patterns for developers to modify components to fit the look and feel of their application.\nThese capabilities are a key area of differentiation between Composites and UI Components, where Composites provide less customization options in favor of a simpler integration experience."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"UI Components"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Fluent based Theming"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Experience layout is composable"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"CSS Styling can be used to modify style properties"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Icons can be replaced"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Participant gallery layout can be modified"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Call control layout can be modified"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Data models can be injected to modify user metadata"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"observability"},"Observability"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"As part of the decoupled state management architecture of the UI Library, developers are able to access the stateful calling and chat clients directly.\nDevelopers can hook into the stateful client to read the state, handle events and override behavior to pass onto the UI Components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Example"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Call/Chat client state can be accessed"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Check whether a all is connected or see the participants in a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Commands can be sent to the call and chat client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Mute or Unmute the call client or send messages on behalf of the user")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Client events can be accessed and handled"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Handle a participant join a call or intercept a message coming into a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"UI events can be accessed and handled"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"✔"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Handle mute button click or chat send button to add your own logic")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"recommended-architecture"},"Recommended Architecture"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("img",{parentName:"p",src:"images/ui-library-architecture.png",alt:"UI Library recommended architecture with client-server architecture"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Composite and Base Components are initialized using an Azure Communication Services access token. Access tokens should be procured from Azure Communication Services through a\ntrusted service that you manage. See ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/access-tokens?pivots=programming-language-javascript",target:"_blank",rel:"nofollow noopener noreferrer"},"Quickstart: Create Access Tokens")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/tutorials/trusted-service-tutorial",target:"_blank",rel:"nofollow noopener noreferrer"},"Trusted Service Tutorial")," for more information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"These client libraries also require the context for the call or chat they will join. Similar to user access tokens, this context should be disseminated to clients via your own trusted service. The list below summarizes the initialization and resource management functions that you need to operationalize."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Contoso Responsibilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"UI Library Responsibilities"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Provide access token from Azure"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Pass through given access token to initialize components")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Provide refresh function"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Refresh access token using developer provided function")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Retrieve/Pass join information for call or chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Pass through call and chat information to initialize components")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Retrieve/Pass user information for any custom data model"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Pass through custom data model to components to render")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"platform-support"},"Platform support"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"SDK"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Windows"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"macOS"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Ubuntu"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Linux"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"Android"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("th",{parentName:"tr",align:null},"iOS"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"UI SDK"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chrome","*",", new Edge"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chrome","*",", Safari","*","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("td",{parentName:"tr",align:null},"Safari","*","*")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"*","Note that the latest version of Chrome is supported in addition to the\nprevious two releases."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"*","*","Note that Safari versions 13.1+ are supported. Outgoing video for Safari\nmacOS is not yet supported, but it is supported on iOS. Outgoing screen sharing\nis only supported on desktop iOS."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"accessibility"},"Accessibility"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Accessibility by design is a principle across Microsoft products.\nUI Library follows this principle in making sure that all UI Components are fully accessible.\nDuring public preview, the UI Library will continue to improve and add accessibility feature to the UI Components.\nWe expect to add more details on accessibility ahead of the UI Library being in General Availability."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("h2",{id:"localization"},"Localization"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)("p",null,"Localization is a key to making products that can be used across the world and by people who who speak different languages.\nUI Library will provide out of the box support for some languages and capabilities such as RTL.\nDevelopers can provide their own localization files to be used for the UI Library.\nThese localization capabilities will be added ahead of General Availability."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Use Cases",id:"usecases",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_6__.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.mdx)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1583:function(module,exports,__webpack_require__){var map={"./CallComposite/CallComposite.stories.tsx":1654,"./ChatComposite/ChatComposite.stories.tsx":1653,"./ControlBar/Buttons/Camera/Camera.stories.tsx":1662,"./ControlBar/Buttons/EndCall/EndCall.stories.tsx":1663,"./ControlBar/Buttons/Microphone/Microphone.stories.tsx":1664,"./ControlBar/Buttons/Options/Options.stories.tsx":1665,"./ControlBar/Buttons/ScreenShare/ScreenShare.stories.tsx":1666,"./ControlBar/ControlBar.stories.tsx":1657,"./Examples/DevicesDropdown/DeviceSettingsDropDown.stories.tsx":1676,"./Examples/IncomingCallAlerts/IncomingCallAlerts.stories.tsx":1651,"./Examples/Layouts/Layouts.stories.tsx":1660,"./Examples/LocalPreview/LocalPreview.stories.tsx":1677,"./Examples/TeamsInterop/ComplianceBanner.stories.tsx":1678,"./Examples/TeamsInterop/Lobby.stories.tsx":1679,"./Examples/Themes/TeamsTheme.stories.tsx":1680,"./GridLayout/GridLayout.stories.tsx":1681,"./MessageStatusIndicator/MessageStatusIndicator.stories.tsx":1620,"./MessageThread/MessageThread.stories.tsx":1652,"./ParticipantItem/ParticipantItem.stories.tsx":1667,"./ParticipantList/ParticipantList.stories.tsx":1668,"./SendBox/SendBox.stories.tsx":1661,"./TypingIndicator/TypingIndicator.stories.tsx":1669,"./VideoGallery/VideoGallery.stories.tsx":1670,"./VideoTile/VideoTile.stories.tsx":1675};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1583},1584:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallComposite, CallAdapter, createAzureCommunicationCallAdapter } from '@azure/communication-react';\nimport { Theme, PartialTheme } from '@fluentui/react-theme-provider';\nimport React, { useState, useEffect } from 'react';\n\nexport type ContainerProps = {\n  token: string;\n  locator: string;\n  displayName: string;\n  fluentTheme?: PartialTheme | Theme;\n};\n\nconst isTeamsMeetingLink = (link: string): boolean => link.startsWith('https://teams.microsoft.com/l/meetup-join');\n\nexport const ContosoCallContainer = (props: ContainerProps): JSX.Element => {\n  const [adapter, setAdapter] = useState<CallAdapter>();\n\n  useEffect(() => {\n    (async () => {\n      if (props.token && props.locator && props.displayName) {\n        const callLocator = isTeamsMeetingLink(props.locator)\n          ? { meetingLink: props.locator }\n          : { groupId: props.locator };\n        const createAdapter = async (): Promise<void> => {\n          setAdapter(await createAzureCommunicationCallAdapter(props.token, callLocator, props.displayName));\n        };\n        createAdapter();\n      }\n    })();\n  }, [props]);\n\n  useEffect(() => {\n    return () => {\n      (async () => {\n        if (!adapter) {\n          return;\n        }\n        await adapter.leaveCall().catch((e) => {\n          console.error('Failed to leave call', e);\n        });\n        adapter.dispose();\n      })();\n    };\n  }, [adapter]);\n\n  return <>{adapter && <CallComposite adapter={adapter} fluentTheme={props.fluentTheme} />}</>;\n};\n"},1585:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Contoso server to create a new user and group.\n\nimport { CommunicationIdentityClient } from '@azure/communication-identity';\nimport { v1 as createGUID } from 'uuid';\n\nexport const createUserAndGroup = async (resourceConnectionString: string): Promise<any> => {\n  const tokenClient = new CommunicationIdentityClient(resourceConnectionString);\n  const user = await tokenClient.createUserAndToken(['voip']);\n  return {\n    token: user.token,\n    endpointUrl: new URL(resourceConnectionString.replace('endpoint=', '').split(';')[0]).toString(),\n\n    // Contoso creates a group call and provides the group ID to the client application.\n    // Alternatively, the client application could join an existing teams meeting.\n    locator: createGUID()\n  };\n};\n"},1586:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport { Theme, PartialTheme } from '@fluentui/react-theme-provider';\nimport React, { useState, useEffect } from 'react';\n\nexport type ContainerProps = {\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n  fluentTheme?: PartialTheme | Theme;\n};\n\nexport const ContosoChatContainer = (props: ContainerProps): JSX.Element => {\n  // Creating an adapter is asynchronous.\n  // An update to `config` triggers a new adapter creation, via the useEffect block.\n  // When the adapter becomes ready, the state update triggers a re-render of the ChatComposite.\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setAdapter(\n          await createAzureCommunicationChatAdapter(props.token, props.endpointUrl, props.threadId, props.displayName)\n        );\n      };\n      createAdapter();\n    }\n  }, [props]);\n\n  return <>{adapter ? <ChatComposite adapter={adapter} fluentTheme={props.fluentTheme} /> : <h3>Loading...</h3>}</>;\n};\n"},1587:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport React, { useState, useEffect, useCallback } from 'react';\n\nexport interface CustomDataModelExampleContainerProps {\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n  botUserId: string;\n  botAvatar: string;\n}\n\nexport const CustomDataModelExampleContainer = (props: CustomDataModelExampleContainerProps): JSX.Element => {\n  // Creating an adapter is asynchronous.\n  // An update to `config` triggers a new adapter creation, via the useEffect block.\n  // When the adapter becomes ready, the state update triggers a re-render of the ChatComposite.\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setAdapter(\n          await createAzureCommunicationChatAdapter(\n            props.token,\n            props.endpointUrl,\n            props.threadId,\n\n            // Data model injection: The display name for the local user comes from Contoso's data model.\n            props.displayName\n          )\n        );\n      };\n      createAdapter();\n    }\n  }, [props]);\n\n  // Data model injection: Contoso provides avatars for the chat participants.\n  // Unlike the displayName example above, this sets the avatar for the remote bot participant.\n  //\n  // Although ChatComposite is not a pure react component, this callback may be passed on to\n  // pure components lower in the Component tree.\n  // Thus, it is best practice to memoize this with useCallback() to avoid spurious rendering.\n  const onRenderAvatar = useCallback(\n    (userId: string): JSX.Element => {\n      if (userId === props.botUserId) {\n        return <label>{props.botAvatar}</label>;\n      }\n      return <label>?</label>;\n    },\n    [props.botUserId, props.botAvatar]\n  );\n  return <>{adapter ? <ChatComposite adapter={adapter} onRenderAvatar={onRenderAvatar} /> : <h3>Loading...</h3>}</>;\n};\n"},1588:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\nexport type ContainerProps = {\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n};\n\nexport const ContosoChatContainer = (props: ContainerProps): JSX.Element => {\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n\n  useEffect(() => {\n    if (!props) return;\n\n    const createAdapter = async (): Promise<void> => {\n      const chatAdapter = await createAzureCommunicationChatAdapter(\n        props.token,\n        props.endpointUrl,\n        props.threadId,\n        props.displayName\n      );\n\n      // Custom behavior: Intercept messages from the local user and convert\n      // to uppercase before sending to backend.\n      const sendMessage = chatAdapter.sendMessage.bind(chatAdapter);\n      chatAdapter.sendMessage = async (content: string): Promise<void> => {\n        await sendMessage(content.toUpperCase());\n      };\n\n      setAdapter(chatAdapter);\n    };\n\n    createAdapter();\n  }, [props]);\n\n  return <>{adapter ? <ChatComposite adapter={adapter} /> : <h3>Loading...</h3>}</>;\n};\n"},1589:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Contoso server to create a new user and thread.\n\nimport { ChatClient } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { CommunicationIdentityClient } from '@azure/communication-identity';\n\nexport const createUserAndThread = async (resourceConnectionString: string, displayName: string): Promise<any> => {\n  const tokenClient = new CommunicationIdentityClient(resourceConnectionString);\n  const user = await tokenClient.createUserAndToken(['chat']);\n\n  const endpointUrl = new URL(resourceConnectionString.replace('endpoint=', '').split(';')[0]).toString();\n  const chatClient = new ChatClient(endpointUrl, new AzureCommunicationTokenCredential(user.token));\n  const threadId = (await chatClient.createChatThread({ topic: 'DemoThread' })).chatThread?.id ?? '';\n  await chatClient.getChatThreadClient(threadId).addParticipants({\n    participants: [{ id: user.user, displayName: displayName }]\n  });\n  await chatClient.getChatThreadClient(threadId).updateTopic('Chat with a friendly bot');\n\n  return {\n    token: user.token,\n    endpointUrl,\n    displayName,\n    threadId\n  };\n};\n"},1590:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomCameraButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'CameraIconKey'} iconName={'Camera'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'CameraIconKey'}\n        iconName={'Camera'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Label key={'CameraLabelKey'} style={{ fontStyle: 'italic' }}>\n          Turn off\n        </Label>\n      );\n    }\n\n    return <Label key={'CameraLabelKey'}>Turn on</Label>;\n  };\n\n  return (\n    <>\n      <CameraButton\n        key={'camera 1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <CameraButton\n        key={'camera 2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1591:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CameraButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <CameraButton key={'camBtn1'} checked={true} />\n      <CameraButton key={'camBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1592:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CameraButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <CameraButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1593:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton } from '@azure/communication-react';\nimport { Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const EndCallButtonCustomExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return <Icon key={'endCallCustomIconKey'} iconName={'DeclineCall'} style={{ color: 'black', fontSize: '25px' }} />;\n  };\n\n  const customOnRenderText = (/*props?: IButtonProps*/): JSX.Element => {\n    return (\n      <Label key={'endCallCustomLabelKey'} style={{ color: 'blue', fontStyle: 'italic' }}>\n        end call\n      </Label>\n    );\n  };\n\n  return (\n    <EndCallButton\n      style={{ background: 'cyan' }}\n      key={'endCallCustomBtnKey'}\n      showLabel={true}\n      onRenderIcon={customOnRenderIcon}\n      onRenderText={customOnRenderText}\n    />\n  );\n};\n"},1594:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const EndCallButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <EndCallButton />\n    </FluentThemeProvider>\n  );\n};\n"},1595:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const EndCallButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <EndCallButton showLabel={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1596:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MicrophoneButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label, Text } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomMicrophoneButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'micCustomIcon1'} iconName={'Microphone'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'micCustomIcon2'}\n        iconName={'Microphone'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Text key={'micCustomText'} style={{ fontStyle: 'italic' }}>\n          unmuted\n        </Text>\n      );\n    }\n\n    return <Label key={'micCustomLabel'}>muted</Label>;\n  };\n\n  return (\n    <>\n      <MicrophoneButton\n        key={'micCustomBtn1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <MicrophoneButton\n        key={'micCustomBtn2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1597:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MicrophoneButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const MicrophoneButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MicrophoneButton key={'micBtn1'} checked={true} />\n      <MicrophoneButton key={'micBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1598:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MicrophoneButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const MicrophoneButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MicrophoneButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1599:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { OptionsButton } from '@azure/communication-react';\nimport { Icon, IContextualMenuProps, Label } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'Camera' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const OptionsButtonCustomExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return (\n      <Icon key={'optionsCustomIconKey'} iconName={'CircleAddition'} style={{ color: 'orange', fontSize: '20px' }} />\n    );\n  };\n\n  const customOnRenderText = (): JSX.Element => {\n    return (\n      <Label key={'optionsCustomLabelKey'} style={{ color: 'darkviolet', fontStyle: 'italic' }}>\n        More\n      </Label>\n    );\n  };\n\n  return (\n    <OptionsButton\n      key={'optionsCustomBtnKey'}\n      showLabel={true}\n      menuProps={exampleOptionsMenuProps}\n      onRenderIcon={customOnRenderIcon}\n      onRenderText={customOnRenderText}\n    />\n  );\n};\n"},1600:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, OptionsButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'LocationCircle' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const OptionsButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <OptionsButton menuProps={exampleOptionsMenuProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1601:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, OptionsButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'LocationCircle' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const OptionsButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <OptionsButton showLabel={true} menuProps={exampleOptionsMenuProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1602:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ScreenShareButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomScreenShareButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'screenShareIconKey'} iconName={'Presentation'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'screenShareIconKey'}\n        iconName={'Presentation'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Label key={'screenShareLabelKey'} style={{ fontStyle: 'italic' }}>\n          sharing screen\n        </Label>\n      );\n    }\n\n    return <Label key={'screenShareLabelKey'}>not sharing screen</Label>;\n  };\n\n  return (\n    <>\n      <ScreenShareButton\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <ScreenShareButton showLabel={true} onRenderIcon={customOnRenderIcon} onRenderText={customOnRenderText} />\n    </>\n  );\n};\n"},1603:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ScreenShareButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ScreenShareButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ScreenShareButton key={'micBtn1'} checked={true} />\n      <ScreenShareButton key={'micBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1604:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ScreenShareButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ScreenShareButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ScreenShareButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1605:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  OptionsButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nexport const AllButtonsControlBarExample: () => JSX.Element = () => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        onClick: () => alert('Choose Camera Menu Item Clicked!')\n      }\n    ]\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <MicrophoneButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <ScreenShareButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <OptionsButton menuProps={exampleOptionsMenuProps} />\n        <EndCallButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1606:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  OptionsButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst componentMainDivStyle = {\n  display: 'flex',\n  border: 'solid 0.5px lightgray',\n  height: '24rem',\n  alignItems: 'center',\n  justifyContent: 'center'\n};\n\nexport const ControlBarLayoutExample: () => JSX.Element = () => {\n  return (\n    <div style={componentMainDivStyle}>\n      <FluentThemeProvider>\n        <ControlBar layout=\"floatingLeft\">\n          <CameraButton />\n          <MicrophoneButton />\n          <ScreenShareButton />\n          <OptionsButton />\n          <EndCallButton />\n        </ControlBar>\n      </FluentThemeProvider>\n    </div>\n  );\n};\n"},1607:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport { CallEndIcon } from '@fluentui/react-northstar';\nimport React from 'react';\n\nexport const CustomButtonsExample: () => JSX.Element = () => {\n  const CustomEndCallButton: () => JSX.Element = () => {\n    const customStyles = {\n      root: {\n        height: 'inherit',\n        background: 'darkorange',\n        color: 'white',\n        width: '10rem'\n      },\n      rootHovered: {\n        background: 'darkred',\n        color: 'white'\n      },\n      flexContainer: { flexFlow: 'row' }\n    };\n\n    return (\n      <EndCallButton\n        styles={customStyles}\n        showLabel={true}\n        onRenderIcon={() => <CallEndIcon key={'hangupBtnIconKey'} />}\n        onRenderText={() => (\n          <span key={'hangupBtnTextKey'} style={{ marginLeft: '0.5rem' }}>\n            End Call\n          </span>\n        )}\n        onClick={() => {\n          /* handle hangup */\n        }}\n      />\n    );\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton />\n        <MicrophoneButton />\n        <CustomEndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1608:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const CustomControlBarStylesExample: () => JSX.Element = () => {\n  const customStyles = {\n    root: {\n      backgroundColor: 'lightgray',\n      border: 'solid black',\n      borderRadius: '0.3rem',\n      maxWidth: 'fit-content'\n    }\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'} styles={customStyles}>\n        <CameraButton />\n        <MicrophoneButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1609:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, ControlBar, FluentThemeProvider, OptionsButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nexport const OptionsButtonExample: () => JSX.Element = () => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        subMenuProps: {\n          items: [\n            { key: 'camera1', text: 'Full HD Webcam', title: 'Full HD Webcam', canCheck: true, isChecked: true },\n            { key: 'camera2', text: 'Macbook Pro Webcam', title: 'Macbook Pro Webcam' }\n          ]\n        }\n      },\n      {\n        key: '2',\n        name: 'Choose Microphone',\n        iconProps: { iconName: 'LocationCircle' },\n        subMenuProps: {\n          items: [\n            { key: 'mic1', text: 'Realtek HD Audio', title: 'Realtek HD Audio' },\n            { key: 'mic2', text: 'Macbook Pro Mic', title: 'Macbook Pro Mic', canCheck: true, isChecked: true }\n          ]\n        }\n      }\n    ]\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <OptionsButton menuProps={exampleOptionsMenuProps} />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1610:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider } from '@azure/communication-react';\nimport { Dropdown, IDropdownOption } from '@fluentui/react';\nimport { useTheme } from '@fluentui/react-theme-provider';\nimport React from 'react';\n\nexport interface DeviceSettingsProps {\n  devices: string[];\n  onChange: (event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption, index?: number) => void;\n}\n\nexport const DeviceSettingDropdownExample = ({ devices, onChange }: DeviceSettingsProps): JSX.Element => {\n  const theme = useTheme();\n\n  return (\n    <FluentThemeProvider fluentTheme={theme}>\n      <Dropdown\n        style={{ width: '15rem' }}\n        placeholder=\"Select an option\"\n        onChange={onChange}\n        options={devices.map((device) => {\n          return {\n            selected: false,\n            key: device,\n            text: device\n          };\n        })}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1612:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile } from '@azure/communication-react';\nimport { mergeStyles, Persona, PersonaSize, Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst renderPersona = (): JSX.Element => (\n  <Persona\n    styles={{ root: { margin: 'auto' } }}\n    size={PersonaSize.size56}\n    hidePersonaDetails={true}\n    text={'Toby'}\n    initialsTextColor=\"white\"\n  />\n);\n\nexport const OneToOneCallLayoutExample: () => JSX.Element = () => {\n  const videoStreamStyle = mergeStyles({\n    border: '1',\n    borderStyle: 'solid',\n    position: 'absolute',\n    bottom: '.25rem',\n    right: '.25rem',\n    height: '25\\u0025',\n    width: '30\\u0025'\n  });\n\n  return (\n    <Stack style={{ height: '500px', width: '600px', border: '1px' }} horizontal>\n      {/* Video component for the other person's video stream */}\n      <VideoTile\n        isVideoReady={false}\n        styles={{\n          overlayContainer: videoStreamStyle\n        }}\n        displayName={'Holly'}\n        showDisplayName={false}\n      >\n        {/* Video component for my video stream stream */}\n        <VideoTile\n          isVideoReady={false}\n          // A render placeholder function for my video stream\n          onRenderPlaceholder={renderPersona}\n        />\n      </VideoTile>\n    </Stack>\n  );\n};\n"},1613:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { PlaceholderProps, VideoTile } from '@azure/communication-react';\nimport { mergeStyles, Persona, PersonaSize, Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst renderPersona = (props: PlaceholderProps): JSX.Element => (\n  <Persona\n    styles={{ root: { margin: 'auto' } }}\n    size={PersonaSize.size56}\n    hidePersonaDetails={true}\n    text={props.displayName}\n    initialsTextColor=\"white\"\n  />\n);\n\nconst renderScreenSharePlaceholder = (): JSX.Element => (\n  <Stack className={mergeStyles({ height: '100%' })}>\n    <Stack verticalAlign=\"center\" horizontalAlign=\"center\" className={mergeStyles({ height: '100%' })}>\n      Your Screen Share Stream\n    </Stack>\n  </Stack>\n);\n\nconst renderSharePersonaPlaceholder = (): JSX.Element => (\n  <Persona\n    styles={{ root: { margin: 'auto' } }}\n    size={PersonaSize.size56}\n    hidePersonaDetails={true}\n    text={'Toby'}\n    initialsTextColor=\"white\"\n  />\n);\n\nexport const ScreenShareLayoutExample: () => JSX.Element = () => {\n  const MockParticipantDisplayNames = ['Michael', 'Jim', 'Pam', 'Dwight', 'Kelly', 'Ryan', 'Andy'];\n\n  const aspectRatioBoxStyle = mergeStyles({\n    borderWidth: '.063rem .063rem .025rem .063rem',\n    borderStyle: 'solid',\n    width: '100\\u0025',\n    height: 0,\n    position: 'relative',\n    paddingTop: '56.25\\u0025'\n  });\n\n  const aspectRatioBoxContentStyle = mergeStyles({\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100\\u0025',\n    height: '100\\u0025'\n  });\n\n  const videoStreamStyle = mergeStyles({\n    border: '1',\n    borderStyle: 'solid',\n    position: 'absolute',\n    bottom: '.25rem',\n    right: '.25rem',\n    height: '20\\u0025',\n    width: '30\\u0025'\n  });\n\n  const screenShareLayoutStyle = {\n    height: `31.25rem`,\n    width: `53.125rem`,\n    border: '.063rem'\n  };\n\n  const participantsComponents = MockParticipantDisplayNames.map((participantDisplayName, index) => {\n    return (\n      <Stack className={aspectRatioBoxStyle} key={index}>\n        <Stack className={aspectRatioBoxContentStyle}>\n          <VideoTile isVideoReady={false} displayName={participantDisplayName} onRenderPlaceholder={renderPersona} />\n        </Stack>\n      </Stack>\n    );\n  });\n\n  return (\n    <Stack style={screenShareLayoutStyle} horizontal>\n      {/* Side panel component in this layout */}\n      <Stack.Item className={mergeStyles({ height: '100\\u0025', width: '30\\u0025' })}>\n        <Stack grow className={mergeStyles({ height: '100\\u0025', overflow: 'auto' })}>\n          {participantsComponents}\n        </Stack>\n      </Stack.Item>\n      {/* Screen share stream component in this layout */}\n      <Stack.Item grow className={mergeStyles({ height: '100\\u0025' })}>\n        {/* The screen share component that will display the screen share stream and sharer's video */}\n        <VideoTile\n          isVideoReady={false}\n          styles={{\n            overlayContainer: videoStreamStyle\n          }}\n          // A placeholder element for the screen share stream\n          onRenderPlaceholder={renderScreenSharePlaceholder}\n        >\n          {/* We want to render another overlay videoTile inside the parent videoTile for screen sharer's video */}\n          <VideoTile\n            isVideoReady={false}\n            // A placeholder element for screen sharer's video stream\n            onRenderPlaceholder={renderSharePersonaPlaceholder}\n          >\n            {/* We do not want to add any overlay component for this videoTile, so we do not add children for this videoTile. */}\n          </VideoTile>\n        </VideoTile>\n      </Stack.Item>\n    </Stack>\n  );\n};\n"},1614:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  StreamMedia,\n  VideoTile,\n  ControlBar,\n  CameraButton,\n  MicrophoneButton,\n  FluentThemeProvider\n} from '@azure/communication-react';\nimport { Stack, mergeStyles, Text } from '@fluentui/react';\nimport { CallVideoOffIcon } from '@fluentui/react-northstar';\nimport { useTheme } from '@fluentui/react-theme-provider';\nimport React, { useCallback, useState } from 'react';\nimport { renderVideoStream } from '../../../utils';\n\nexport interface LocalPreviewProps {\n  isVideoAvailable: boolean;\n  isCameraEnabled: boolean;\n  isMicrophoneEnabled: boolean;\n}\n\nexport const LocalPreviewExample = ({\n  isVideoAvailable,\n  isCameraEnabled,\n  isMicrophoneEnabled\n}: LocalPreviewProps): JSX.Element => {\n  const [microphone, setMicrophone] = useState(false);\n  const [camera, setCamera] = useState(false);\n  const theme = useTheme();\n  const palette = theme.palette;\n\n  const localPreviewContainerStyle = mergeStyles({\n    minWidth: '25rem',\n    width: '100\\u0025',\n    height: '100\\u0025',\n    maxHeight: '18.75rem',\n    minHeight: '16.875rem',\n    margin: '0 auto',\n    background: palette.neutralLighter,\n    color: palette.neutralTertiary\n  });\n\n  const videoTileStyle = {\n    root: {\n      minHeight: '14rem'\n    }\n  };\n\n  const cameraOffLabelStyle = mergeStyles({\n    fontFamily: 'Segoe UI Regular',\n    fontSize: '0.625rem', // 10px\n    color: palette.neutralTertiary\n  });\n\n  const renderCameraOffPlaceholder = useCallback(\n    () => (\n      <Stack style={{ width: '100\\u0025', height: '100\\u0025' }} verticalAlign=\"center\">\n        <Stack.Item align=\"center\">\n          <CallVideoOffIcon />\n        </Stack.Item>\n        <Stack.Item align=\"center\">\n          <Text className={cameraOffLabelStyle}>Your camera is turned off</Text>\n        </Stack.Item>\n      </Stack>\n    ),\n    [cameraOffLabelStyle]\n  );\n\n  return (\n    <FluentThemeProvider fluentTheme={theme}>\n      <Stack style={{ width: '100\\u0025', height: '100\\u0025' }} verticalAlign=\"center\">\n        <Stack.Item align=\"center\">\n          <Stack className={localPreviewContainerStyle}>\n            <VideoTile\n              styles={videoTileStyle}\n              isVideoReady={isVideoAvailable}\n              // Here this storybook example isn't connected with Azure Communication Services\n              // We would suggest you replace this videoStreamElement below with a rendered video stream from the calling SDK\n              renderElement={<StreamMedia videoStreamElement={renderVideoStream()} />}\n              onRenderPlaceholder={renderCameraOffPlaceholder}\n            >\n              <ControlBar layout=\"floatingBottom\">\n                <CameraButton disabled={!isCameraEnabled} checked={camera} onClick={() => setCamera(!camera)} />\n                <MicrophoneButton\n                  disabled={!isMicrophoneEnabled}\n                  checked={microphone}\n                  onClick={() => setMicrophone(!microphone)}\n                />\n              </ControlBar>\n            </VideoTile>\n          </Stack>\n        </Stack.Item>\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1615:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile } from '@azure/communication-react';\nimport React from 'react';\nimport { ComplianceBanner } from './ComplianceBanner.snippet';\n\nexport const CallComponent = (): JSX.Element => {\n  const videoTileStyles = {\n    root: { height: '100%', width: '100%' },\n    overlayContainer: {}\n  };\n\n  return (\n    <VideoTile styles={videoTileStyles}>\n      <ComplianceBanner callRecordState={true} callTranscribeState={true} />\n    </VideoTile>\n  );\n};\n"},1616:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='// ComplianceBanner.snippet.tsx\n\nimport { Link, MessageBar } from \'@fluentui/react\';\nimport React, { useEffect, useState } from \'react\';\n\nexport type ComplianceBannerProps = {\n  callTranscribeState?: boolean;\n  callRecordState?: boolean;\n};\n\nexport const ComplianceBanner = (props: ComplianceBannerProps): JSX.Element => {\n  const [previousCallTranscribeState, setPreviousCallTranscribeState] = useState<boolean | undefined>(false);\n  const [previousCallRecordState, setPreviousCallRecordState] = useState<boolean | undefined>(false);\n  const [variant, setVariant] = useState(0);\n\n  const TRANSCRIPTION_STOPPED_STILL_RECORDING = 1;\n  const RECORDING_STOPPED_STILL_TRANSCRIBING = 2;\n  const RECORDING_AND_TRANSCRIPTION_STOPPED = 3;\n  const RECORDING_AND_TRANSCRIPTION_STARTED = 4;\n  const TRANSCRIPTION_STARTED = 5;\n  const RECORDING_STOPPED = 6;\n  const RECORDING_STARTED = 7;\n  const RECORDING_STOPPED_AND_SAVED = 8;\n  const NO_STATE = 0;\n\n  const { callTranscribeState, callRecordState } = props;\n\n  useEffect(() => {\n    if (previousCallRecordState && previousCallTranscribeState) {\n      if (callRecordState && !callTranscribeState) {\n        setVariant(TRANSCRIPTION_STOPPED_STILL_RECORDING);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(RECORDING_STOPPED_STILL_TRANSCRIBING);\n      } else if (!callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STOPPED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    } else if (previousCallRecordState && !previousCallTranscribeState) {\n      if (callRecordState && callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STARTED);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(TRANSCRIPTION_STARTED);\n      } else if (!callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_STOPPED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    } else if (!previousCallRecordState && previousCallTranscribeState) {\n      if (callRecordState && callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STARTED);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(RECORDING_STARTED);\n      } else if (!callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_STOPPED_AND_SAVED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    } else if (!previousCallRecordState && !previousCallTranscribeState) {\n      if (callRecordState && callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STARTED);\n      } else if (callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_STARTED);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(TRANSCRIPTION_STARTED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    }\n\n    setPreviousCallTranscribeState(callTranscribeState);\n    setPreviousCallRecordState(callRecordState);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [callTranscribeState, callRecordState]);\n\n  function PrivacyPolicy(): JSX.Element {\n    return (\n      <Link\n        href="https://privacy.microsoft.com/en-US/privacystatement#mainnoticetoendusersmodule"\n        target="_blank"\n        underline\n      >\n        Privacy policy\n      </Link>\n    );\n  }\n\n  function LearnMore(): JSX.Element {\n    return (\n      <Link\n        href="https://support.microsoft.com/en-us/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24"\n        target="_blank"\n        underline\n      >\n        Learn more\n      </Link>\n    );\n  }\n\n  function getBannerMessage(variant: number): JSX.Element {\n    switch (variant) {\n      case TRANSCRIPTION_STOPPED_STILL_RECORDING:\n        return (\n          <>\n            <b>Transcription has stopped.</b> You are now only recording this meeting.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_STOPPED_STILL_TRANSCRIBING:\n        return (\n          <>\n            <b>Recording has stopped.</b> You are now only transcribing this meeting.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_AND_TRANSCRIPTION_STOPPED:\n        return (\n          <>\n            <b>Recording and transcription are being saved. </b> Recording and transcription have stopped.\n            <LearnMore />\n          </>\n        );\n      case RECORDING_AND_TRANSCRIPTION_STARTED:\n        return (\n          <>\n            <b>Recording and transcription have started.</b> By joining, you are giving consent for this meeting to be\n            transcribed.\n            <PrivacyPolicy />\n          </>\n        );\n      case TRANSCRIPTION_STARTED:\n        return (\n          <>\n            <b>Transcription has started.</b> By joining, you are giving consent for this meeting to be transcribed.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_STOPPED:\n        return (\n          <>\n            <b>Recording is being saved.</b> Recording has stopped.\n            <LearnMore />\n          </>\n        );\n      case RECORDING_STARTED:\n        return (\n          <>\n            <b>Recording has started.</b> By joining, you are giving consent for this meeting to be transcribed.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_STOPPED_AND_SAVED:\n        return (\n          <>\n            <b>Transcription is being saved.</b> Transcription has stopped.\n            <LearnMore />\n          </>\n        );\n    }\n    return <></>;\n  }\n\n  return variant === NO_STATE ? (\n    <></>\n  ) : (\n    <MessageBar\n      onDismiss={() => {\n        setVariant(NO_STATE);\n      }}\n      dismissButtonAriaLabel="Close"\n    >\n      {getBannerMessage(variant)}\n    </MessageBar>\n  );\n};\n'},1617:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  StreamMedia,\n  VideoTile,\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  MicrophoneButton,\n  OptionsButton\n} from '@azure/communication-react';\nimport { useTheme } from '@fluentui/react-theme-provider';\nimport React from 'react';\n\nexport interface LobbyProps {\n  isVideoReady: boolean;\n  callStateText: string;\n}\n\nexport const Lobby = (props: LobbyProps): JSX.Element => {\n  const theme = useTheme();\n  const palette = theme.palette;\n\n  const videoTileStyles = {\n    root: { height: '100%', width: '100%' },\n    overlayContainer: {}\n  };\n\n  const ControlBarStyles = {\n    root: { background: theme.palette.white, minHeight: '4.25rem', alignItems: 'center' }\n  };\n\n  return (\n    <VideoTile\n      styles={videoTileStyles}\n      isMirrored={true}\n      isVideoReady={props.isVideoReady}\n      onRenderPlaceholder={() => <></>}\n      renderElement={\n        // Replace with your own html local video render element.\n        <StreamMedia videoStreamElement={{} as any} />\n      }\n    >\n      <div\n        style={{\n          width: '100%',\n          height: '100%',\n          position: 'absolute',\n          background: props.isVideoReady ? '#201f1e' : palette.neutralLight,\n          opacity: 0.75\n        }}\n      />\n\n      <div\n        style={{\n          zIndex: 0,\n          textAlign: 'center',\n          width: '50%',\n          height: '25%',\n          overflow: 'none',\n          margin: 'auto',\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          bottom: 0,\n          right: 0\n        }}\n      >\n        <p style={{ fontSize: '1.75rem', color: props.isVideoReady ? 'white' : palette.neutralPrimary }}>\n          ☕ <br /> {props.callStateText}\n        </p>\n      </div>\n\n      <ControlBar layout=\"dockedBottom\" styles={ControlBarStyles}>\n        <CameraButton showLabel={true} checked={true} />\n        <MicrophoneButton showLabel={true} checked={true} />\n        <OptionsButton showLabel={true} />\n        <EndCallButton showLabel={true} style={{ borderRadius: '0.25rem', marginLeft: '0.25rem' }} />\n      </ControlBar>\n    </VideoTile>\n  );\n};\n"},1618:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  GridLayout,\n  MicrophoneButton,\n  ScreenShareButton,\n  VideoTile\n} from '@azure/communication-react';\nimport { Stack, mergeStyles } from '@fluentui/react';\nimport { useTheme } from '@fluentui/react-theme-provider';\nimport React from 'react';\n\nconst teamsTheme = {\n  palette: {\n    themePrimary: '#4b53bc',\n    themeLighterAlt: '#030308',\n    themeLighter: '#0c0d1e',\n    themeLight: '#171939',\n    themeTertiary: '#2d3271',\n    themeSecondary: '#4249a6',\n    themeDarkAlt: '#5a61c3',\n    themeDark: '#6f76cd',\n    themeDarker: '#9196da',\n    neutralLighterAlt: '#1e1e1e',\n    neutralLighter: '#1d1d1d',\n    neutralLight: '#1c1c1c',\n    neutralQuaternaryAlt: '#1a1a1a',\n    neutralQuaternary: '#191919',\n    neutralTertiaryAlt: '#181818',\n    neutralTertiary: '#c8c8c8',\n    neutralSecondary: '#d0d0d0',\n    neutralPrimaryAlt: '#dadada',\n    neutralPrimary: '#ffffff',\n    neutralDark: '#f4f4f4',\n    black: '#f8f8f8',\n    white: '#1f1f1f'\n  }\n};\n\nexport const TeamsTheme: () => JSX.Element = () => {\n  const wrapperStyle = {\n    width: '100%',\n    height: '100%',\n    maxWidth: '50rem',\n    maxHeight: '30rem'\n  };\n\n  return (\n    <div style={wrapperStyle}>\n      <FluentThemeProvider fluentTheme={teamsTheme}>\n        <App />\n      </FluentThemeProvider>\n    </div>\n  );\n};\n\nconst App: () => JSX.Element = () => {\n  const theme = useTheme();\n\n  const headerContainer = mergeStyles({\n    width: '100%',\n    height: '3.875rem',\n    overflow: 'hidden',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    alignItems: 'center',\n    marginBottom: 2,\n    background: theme.palette.white\n  });\n\n  const controlBarStyle = {\n    root: {\n      marginRight: '.5rem',\n      alignItems: 'center'\n    }\n  };\n\n  const teamsButtonStyle = {\n    root: { minWidth: '2.75rem' },\n    rootHovered: { color: theme.palette.themePrimary, background: 'none' }\n  };\n\n  const endCallButtonStyles = {\n    root: {\n      height: '2rem',\n      minHeight: '2rem',\n      width: '6.5rem',\n      borderRadius: '0.125rem'\n    }\n  };\n\n  const videoTileStyle = {\n    root: { background: theme.palette.white }\n  };\n\n  return (\n    <Stack\n      style={{\n        height: '100%',\n        width: '100%',\n        background: theme.palette.neutralQuaternaryAlt\n      }}\n    >\n      <Stack className={headerContainer}>\n        <Stack.Item>\n          <ControlBar styles={controlBarStyle}>\n            <CameraButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <MicrophoneButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <ScreenShareButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <EndCallButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              showLabel={true}\n              onRenderText={() => (\n                <span key={'endCallBtnTextKey'} style={{ marginLeft: '0.5rem' }}>\n                  Leave\n                </span>\n              )}\n              styles={endCallButtonStyles}\n            />\n          </ControlBar>\n        </Stack.Item>\n      </Stack>\n      <GridLayout>\n        <VideoTile isVideoReady={false} renderElement={null} displayName={'Michael'} styles={videoTileStyle} />\n      </GridLayout>\n    </Stack>\n  );\n};\n"},1619:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { GridLayout, VideoTile } from '@azure/communication-react';\nimport React from 'react';\n\nexport const GridLayoutExample = (): JSX.Element => {\n  const videoTileStyles = { root: { padding: '10px', border: '1px solid #999' } };\n  return (\n    <div style={{ height: '530px', width: '830px' }}>\n      <GridLayout>\n        <VideoTile styles={videoTileStyles} displayName={'Michael'} />\n        <VideoTile styles={videoTileStyles} displayName={'Jim'} />\n        <VideoTile styles={videoTileStyles} displayName={'Pam'} />\n        <VideoTile styles={videoTileStyles} displayName={'Dwight'} />\n      </GridLayout>\n    </div>\n  );\n};\n"},1620:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"MessageStatusIndicator",(function(){return MessageStatusIndicator}));__webpack_require__(80),__webpack_require__(10);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6),_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1695),_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1694),_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(5),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(18),_constants__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(0),__webpack_require__(23)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(1),DefaultMessageStatusIndicatorsExampleText=__webpack_require__(1621).default,MessageStatusIndicatorsExample=function MessageStatusIndicatorsExample(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{style:{margin:"0 5px"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.h,{status:"delivered"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{style:{margin:"0 5px"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.h,{status:"seen"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{style:{margin:"0 5px"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.h,{status:"sending"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{style:{margin:"0 5px"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.h,{status:"failed"})})]})},MessageStatusIndicatorStory=function MessageStatusIndicatorStory(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.h,{status:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__.select)("Message Status",["delivered","sending","seen","failed"],"delivered"),deliveredTooltipText:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__.text)("Delivered icon tooltip text","Sent"),sendingTooltipText:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__.text)("Sending icon tooltip text","Sending"),seenTooltipText:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__.text)("Seen icon tooltip text","Seen"),failedToSendTooltipText:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_6__.text)("Failed to send icon tooltip text","Failed to send")})};MessageStatusIndicatorStory.displayName="MessageStatusIndicatorStory";var MessageStatusIndicator=MessageStatusIndicatorStory.bind({});__webpack_exports__.default={id:"".concat(_constants__WEBPACK_IMPORTED_MODULE_8__.a,"-messagestatusindicator"),title:"".concat(_constants__WEBPACK_IMPORTED_MODULE_8__.a,"/Message Status Indicator"),component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.h,parameters:{docs:{page:function page(){return function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Title,{children:"MessageStatusIndicator"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Description,{children:"MessageStatusIndicator is used to indicate whether a message has been read, delivered, currently sending, or failed to send."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Heading,{children:"Importing"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Source,{code:"import { MessageStatus, MessageStatusIndicator } from '@azure/communication-react';"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Heading,{children:"Example"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Canvas,{mdxSource:DefaultMessageStatusIndicatorsExampleText,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_3__.a,{theme:_fluentui_react_northstar__WEBPACK_IMPORTED_MODULE_4__.a,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(MessageStatusIndicatorsExample,{})})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Heading,{children:"Props"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_5__.Props,{of:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.h})]})}()}}}},MessageStatusIndicator.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  return (\n    <MessageStatusIndicatorComponent\n      status={select<MessageStatus>('Message Status', ['delivered', 'sending', 'seen', 'failed'], 'delivered')}\n      deliveredTooltipText={text('Delivered icon tooltip text', 'Sent')}\n      sendingTooltipText={text('Sending icon tooltip text', 'Sending')}\n      seenTooltipText={text('Seen icon tooltip text', 'Seen')}\n      failedToSendTooltipText={text('Failed to send icon tooltip text', 'Failed to send')}\n    />\n  );\n}"}},MessageStatusIndicator.parameters)},1621:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MessageStatus, MessageStatusIndicator } from '@azure/communication-react';\nimport React from 'react';\n\nexport const DefaultMessageStatusIndicatorsExample: () => JSX.Element = () => {\n  return (\n    <>\n      <MessageStatusIndicator status={'delivered' as MessageStatus} />\n      <MessageStatusIndicator status={'seen' as MessageStatus} />\n      <MessageStatusIndicator status={'sending' as MessageStatus} />\n      <MessageStatusIndicator status={'failed' as MessageStatus} />\n    </>\n  );\n};\n"},1622:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport { Persona, PersonaPresence, PersonaSize } from '@fluentui/react';\nimport React from 'react';\nimport { GetAvatarUrlByUserId, GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomAvatarExample: () => JSX.Element = () => {\n  // Customize the Avatar of other participants to be a Persona component from Fluent and show the presence status on the avatar.\n  return (\n    <FluentThemeProvider>\n      <MessageThread\n        userId={'1'}\n        messages={GetHistoryChatMessages()}\n        onRenderAvatar={(userId: string) => {\n          return (\n            <Persona\n              size={PersonaSize.size32}\n              hidePersonaDetails\n              presence={PersonaPresence.online}\n              text={userId}\n              imageUrl={GetAvatarUrlByUserId(userId)}\n            />\n          );\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1623:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomChatContainerExample: () => JSX.Element = () => {\n  const messageThreadStyles = {\n    chatContainer: {\n      backgroundColor: 'lightgray',\n      padding: '15px'\n    }\n  };\n\n  // Show a customized Chat container.\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} styles={messageThreadStyles} />\n    </FluentThemeProvider>\n  );\n};\n"},1624:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread, MessageThreadStylesProps } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryWithSystemMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessageContainerExample: () => JSX.Element = () => {\n  const messageThreadStyle: MessageThreadStylesProps = {\n    chatMessageContainer: {\n      fontStyle: 'italic',\n      boxShadow: '0px 3.2px 7.2px rgb(0 0 0 / 13\\u0025), 0px 0.6px 1.8px rgb(0 0 0 / 11\\u0025)'\n    },\n    systemMessageContainer: { fontWeight: 'bold', border: 'double red' }\n  };\n\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} styles={messageThreadStyle} messages={GetHistoryWithSystemMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1625:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  DefaultMessageRendererType,\n  FluentThemeProvider,\n  MessageProps,\n  MessageThread\n} from '@azure/communication-react';\nimport { Divider } from '@fluentui/react-northstar';\nimport React from 'react';\nimport { GetHistoryWithCustomMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessagesExample: () => JSX.Element = () => {\n  // As an example, we want to use render custom message as a Divider.\n  const onRenderMessage = (messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType): JSX.Element => {\n    if (messageProps.message.type === 'custom') {\n      return <Divider content={messageProps.message.payload.content} color=\"brand\" important />;\n    }\n\n    return defaultOnRender ? defaultOnRender(messageProps) : <></>;\n  };\n\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryWithCustomMessages()} onRenderMessage={onRenderMessage} />\n    </FluentThemeProvider>\n  );\n};\n"},1626:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport { Text } from '@fluentui/react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessageStatusIndicatorExample: () => JSX.Element = () => {\n  // Show the status of messages that I sent by setting 'showMessageStatus' prop to be true and customized it\n  return (\n    <FluentThemeProvider>\n      <MessageThread\n        userId={'1'}\n        messages={GetHistoryChatMessages()}\n        showMessageStatus={true}\n        onRenderMessageStatus={(messageStatusIndicatorProps) => {\n          return messageStatusIndicatorProps.status === 'seen' ? (\n            <Text style={{ fontStyle: 'italic', fontWeight: 'bold', color: 'green' }}>seen</Text>\n          ) : null;\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1627:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const DefaultMessageThreadExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1628:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithMessageStatusIndicatorExample: () => JSX.Element = () => {\n  // Show the status of messages that I sent by setting 'showMessageStatus' prop to be true.\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} showMessageStatus={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1629:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { ChatMessage, CustomMessage, MessageStatus, SystemMessage } from '@azure/communication-react';\n\n// This is some mock messages for example purposes.\n// For actual projects, you can get chat messages from declarative/selectors for ACS.\nexport const GetHistoryChatMessages = (): ChatMessage[] => {\n  return [\n    {\n      type: 'chat',\n      payload: {\n        senderId: 'user1',\n        senderDisplayName: 'Kat Larsson',\n        messageId: Math.random().toString(),\n        content: 'Hi everyone, I created this awesome group chat for us!',\n        createdOn: new Date('2019-04-13T00:00:00.000+08:10'),\n        mine: true,\n        attached: false,\n        status: 'seen' as MessageStatus,\n        type: 'text'\n      }\n    },\n    {\n      type: 'chat',\n      payload: {\n        senderId: 'user2',\n        senderDisplayName: 'Robert Tolbert',\n        messageId: Math.random().toString(),\n        content: 'Nice! This looks great!',\n        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n        mine: false,\n        attached: false,\n        type: 'text'\n      }\n    },\n    {\n      type: 'chat',\n      payload: {\n        senderId: 'user3',\n        senderDisplayName: 'Carole Poland',\n        messageId: Math.random().toString(),\n        content: \"Yeah agree, let's chat here from now on!\",\n        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n        mine: false,\n        attached: false,\n        type: 'text'\n      }\n    }\n  ];\n};\n\nexport const GetHistoryWithSystemMessages = (): (SystemMessage | ChatMessage)[] => {\n  return [\n    ...GetHistoryChatMessages(),\n    {\n      type: 'system',\n      payload: {\n        messageId: Math.random().toString(),\n        iconName: 'PeopleAdd',\n        content: 'Miguel Garcia is added to the chat'\n      }\n    }\n  ];\n};\n\nexport const GetHistoryWithCustomMessages = (): (CustomMessage | ChatMessage)[] => {\n  return [\n    {\n      type: 'custom',\n      // Custom message's payload can be any shape, this is just an example.\n      // Whatever is defined in the custom message's payload needs to be handled in onRenderMessage in MessageThread.\n      payload: {\n        messageId: Math.random().toString(),\n        content: 'Today'\n      }\n    },\n    ...GetHistoryChatMessages()\n  ];\n};\n\n// This is some mock avatars for example purposes.\nexport const GetAvatarUrlByUserId = (userId: string): string => {\n  switch (userId) {\n    case 'user1':\n      return 'images/avatars/avatar-1.jpg';\n    case 'user2':\n      return 'images/avatars/avatar-2.jpg';\n    case 'user3':\n      return 'images/avatars/avatar-8.jpg';\n    default:\n      return '';\n  }\n};\n"},1630:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryWithSystemMessages } from './placeholdermessages';\n\nexport const MessageThreadWithSystemMessagesExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryWithSystemMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1631:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithMessageDateExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} showMessageDate={true} messages={GetHistoryChatMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1632:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantItem } from '@azure/communication-react';\nimport { PersonaPresence } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomAvatarExample: () => JSX.Element = () => {\n  const avatarStyle = {\n    borderRadius: 20,\n    display: 'block'\n  };\n  const onRenderAvatar = (): JSX.Element => {\n    return (\n      <img\n        src=\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png\"\n        width=\"32px\"\n        height=\"32px\"\n        style={avatarStyle}\n      />\n    );\n  };\n\n  return (\n    <ParticipantItem displayName=\"Annie Lindqvist\" presence={PersonaPresence.online} onRenderAvatar={onRenderAvatar} />\n  );\n};\n"},1633:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='import { ParticipantItem, ParticipantItemProps } from \'@azure/communication-react\';\nimport { PersonaPresence, Icon, Stack } from \'@fluentui/react\';\nimport React from \'react\';\n\nexport const CustomIconExample: () => JSX.Element = () => {\n  const onRenderIcon = (props?: ParticipantItemProps): JSX.Element | null => {\n    if (props?.displayName === \'Patrick\') {\n      return <Icon iconName="FavoriteStar" />;\n    } else if (props?.me) {\n      return null;\n    }\n    return <Icon iconName="AddFriend" />;\n  };\n\n  return (\n    <Stack>\n      <ParticipantItem\n        displayName="Spongebob"\n        presence={PersonaPresence.online}\n        me={true}\n        onRenderIcon={onRenderIcon}\n      />\n      <ParticipantItem displayName="Patrick" presence={PersonaPresence.online} onRenderIcon={onRenderIcon} />\n      <ParticipantItem displayName="Sandy" presence={PersonaPresence.online} onRenderIcon={onRenderIcon} />\n    </Stack>\n  );\n};\n'},1634:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantItem } from '@azure/communication-react';\nimport { IContextualMenuItem, PersonaPresence } from '@fluentui/react';\nimport React from 'react';\n\nexport const ParticipantItemExample: () => JSX.Element = () => {\n  const menuItems: IContextualMenuItem[] = [\n    {\n      key: 'Mute',\n      text: 'Mute',\n      onClick: () => alert('Mute')\n    },\n    {\n      key: 'Remove',\n      text: 'Remove',\n      onClick: () => alert('Remove')\n    }\n  ];\n\n  return <ParticipantItem displayName=\"Johnny Bravo\" menuItems={menuItems} presence={PersonaPresence.online} />;\n};\n"},1635:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipant, FluentThemeProvider, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultCallParticipantListExample: () => JSX.Element = () => {\n  const mockParticipants: CallParticipant[] = [\n    {\n      userId: 'user1',\n      displayName: 'You',\n      state: 'Connected',\n      isMuted: true,\n      isScreenSharing: false\n    },\n    {\n      userId: 'user2',\n      displayName: 'Hal Jordan',\n      state: 'Connected',\n      isMuted: true,\n      isScreenSharing: true\n    },\n    {\n      userId: 'user3',\n      displayName: 'Barry Allen',\n      state: 'Idle',\n      isMuted: false,\n      isScreenSharing: false\n    },\n    {\n      userId: 'user4',\n      displayName: 'Bruce Wayne',\n      state: 'Connecting',\n      isMuted: false,\n      isScreenSharing: false\n    }\n  ];\n\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList participants={mockParticipants} myUserId={'user1'} />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1636:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CommunicationParticipant, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultChatParticipantListExample: () => JSX.Element = () => {\n  const mockParticipants: CommunicationParticipant[] = [\n    {\n      userId: 'user 1',\n      displayName: 'You'\n    },\n    {\n      userId: 'user 2',\n      displayName: 'Hal Jordan'\n    },\n    {\n      userId: 'user 3',\n      displayName: 'Barry Allen'\n    },\n    {\n      userId: 'user 4',\n      displayName: 'Bruce Wayne'\n    }\n  ];\n\n  return (\n    <Stack>\n      <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n      <ParticipantList participants={mockParticipants} />\n    </Stack>\n  );\n};\n"},1637:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  CommunicationParticipant,\n  FluentThemeProvider,\n  ParticipantList,\n  ParticipantItem\n} from '@azure/communication-react';\nimport { Icon, IContextualMenuItem, PersonaPresence, Stack } from '@fluentui/react';\nimport React, { useState } from 'react';\n\nconst mockParticipants = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker',\n    state: 'Connected',\n    isMuted: false\n  },\n  {\n    userId: 'user3',\n    displayName: 'Matthew Murdock',\n    state: 'Idle',\n    isMuted: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Frank Castiglione',\n    state: 'Connecting',\n    isMuted: false\n  }\n];\n\nexport const InteractiveCallParticipantListExample: () => JSX.Element = () => {\n  const [participants, setParticpants] = useState<any[]>(mockParticipants);\n\n  const mockMyUserId = 'user1';\n\n  const onRenderParticipant = (participant: CommunicationParticipant): JSX.Element => {\n    const participantIndex = participants.map((p) => p.userId).indexOf(participant.userId);\n\n    // Try to consider CommunicationParticipant as CallParticipant\n    const callingParticipant = participants[participantIndex] as CallParticipant;\n\n    let presence: PersonaPresence | undefined = undefined;\n    if (callingParticipant) {\n      if (callingParticipant.state === 'Connected') {\n        presence = PersonaPresence.online;\n      } else if (callingParticipant.state === 'Idle') {\n        presence = PersonaPresence.away;\n      } else if (callingParticipant.state === 'Connecting') {\n        presence = PersonaPresence.offline;\n      }\n    }\n\n    const menuItems: IContextualMenuItem[] = [\n      {\n        key: 'mute',\n        text: callingParticipant.isMuted ? 'Unmute' : 'Mute',\n        onClick: () => {\n          const newParticipants = [...participants];\n          newParticipants[participantIndex].isMuted = !participants[participantIndex].isMuted;\n          setParticpants(newParticipants);\n        }\n      }\n    ];\n\n    const onRenderIcon = callingParticipant?.isMuted ? () => <Icon iconName=\"MicOff2\" /> : () => <></>;\n\n    if (participant.displayName) {\n      return (\n        <ParticipantItem\n          displayName={participant.displayName}\n          me={participant.userId === mockMyUserId}\n          menuItems={menuItems}\n          presence={presence}\n          onRenderIcon={onRenderIcon}\n        />\n      );\n    }\n    return <></>;\n  };\n\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList\n          participants={participants}\n          myUserId={mockMyUserId}\n          onRenderParticipant={onRenderParticipant}\n        />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1638:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport { Icon } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomIconExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n        onRenderIcon={() => <Icon iconName=\"AirplaneSolid\" />}\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1639:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CustomStylingExample: () => JSX.Element = () => {\n  const sendBoxStyles = {\n    root: { border: '2px solid gray', borderRadius: '10px', padding: '10px' },\n    systemMessage: { border: '1px solid darkred', background: 'lightpink' },\n    textField: { background: 'ghostwhite' }\n    // The sub-components below are also available\n    // sendMessageIconContainer: { },\n    // sendMessageIcon: { }\n  };\n  return (\n    <FluentThemeProvider>\n      <div style={{ width: '31.25rem' }}>\n        <SendBox\n          onSendMessage={async () => {\n            return;\n          }}\n          onTyping={async () => {\n            return;\n          }}\n          styles={sendBoxStyles}\n          systemMessage=\"This is a system message\"\n        />\n      </div>\n    </FluentThemeProvider>\n  );\n};\n"},1640:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const SendBoxExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1641:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const SendBoxWithSystemMessageExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n        systemMessage=\"Please wait 30 seconds to send new messages\"\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1642:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator } from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const CustomStylingSnippet: () => JSX.Element = () => {\r\n  const twoTypingUsers = [\r\n    { userId: '1', displayName: 'User1' },\r\n    { userId: '2', displayName: 'User2' }\r\n  ];\r\n\r\n  const styles = {\r\n    root: { border: '1px solid darkblue', width: '400px', padding: '5px' },\r\n    typingUserDisplayName: { font: '15px Tahoma , sans-serif;' },\r\n    typingString: { color: 'slategrey' }\r\n  };\r\n\r\n  return <TypingIndicator typingUsers={twoTypingUsers} styles={styles} />;\r\n};\r\n"},1643:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator, CommunicationParticipant } from '@azure/communication-react';\r\nimport { mergeStyles } from '@fluentui/react';\r\nimport React from 'react';\r\n\r\nexport const CustomUserRenderSnippet: () => JSX.Element = () => {\r\n  const avatarStyle = {\r\n    borderRadius: 20,\r\n    display: 'block'\r\n  };\r\n  const imageMap = {\r\n    ['1']: 'https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png',\r\n    ['2']: 'https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-male.png'\r\n  };\r\n\r\n  const verticallyCenterStyle = mergeStyles({ display: 'flex', alignItems: 'center' });\r\n  const spanStyle = mergeStyles({ whiteSpace: 'nowrap', paddingRight: '3px' });\r\n\r\n  const onRenderUsers = (users: CommunicationParticipant[]): JSX.Element => {\r\n    return (\r\n      <>\r\n        {users.map((user, index) => (\r\n          <div key={`${user.displayName}UserKey`} className={verticallyCenterStyle}>\r\n            <img src={imageMap[user.userId]} width=\"32px\" height=\"32px\" style={avatarStyle} />\r\n            <span className={spanStyle}>\r\n              {user.displayName}\r\n              {index < users.length - 1 && ', '}\r\n            </span>\r\n          </div>\r\n        ))}\r\n      </>\r\n    );\r\n  };\r\n\r\n  const twoTypingUsers = [\r\n    { userId: '1', displayName: 'Annie Lindqvist' },\r\n    { userId: '2', displayName: 'Ted Randall' }\r\n  ];\r\n\r\n  return <TypingIndicator typingUsers={twoTypingUsers} onRenderUsers={onRenderUsers} />;\r\n};\r\n"},1644:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator, CommunicationParticipant } from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const TypingIndicatorSnippet: () => JSX.Element = () => {\r\n  const oneTypingUsers = [{ userId: '1', displayName: 'User1' }];\r\n  const twoTypingUsers = [\r\n    { userId: '1', displayName: 'User1' },\r\n    { userId: '2', displayName: 'User2' }\r\n  ];\r\n\r\n  const twentyUsers: CommunicationParticipant[] = [];\r\n  for (let idx = 0; idx < 20; idx++) {\r\n    twentyUsers.push({ userId: `${idx}`, displayName: `User${idx}` });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <TypingIndicator typingUsers={oneTypingUsers} />\r\n      <TypingIndicator typingUsers={twoTypingUsers} />\r\n      <TypingIndicator typingUsers={twentyUsers} />\r\n      <TypingIndicator typingUsers={oneTypingUsers} typingString={' is composing a message...'} />\r\n    </>\r\n  );\r\n};\r\n"},1645:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { PlaceholderProps, VideoGallery as VideoGalleryComponent } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker',\n    state: 'Connected',\n    isMuted: false\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor',\n    state: 'Connecting',\n    isMuted: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock',\n    state: 'Idle',\n    isMuted: false\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nexport const CustomAvatarVideoGalleryExample: () => JSX.Element = () => {\n  const onRenderAvatar = (\n    placeholderProps: PlaceholderProps,\n    defaultOnRender: (props: PlaceholderProps) => JSX.Element\n  ): JSX.Element => {\n    switch (placeholderProps.displayName) {\n      case 'You':\n        return (\n          <Stack>\n            <img\n              src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n              style={{\n                borderRadius: '100px',\n                width: '100px',\n                position: 'absolute',\n                margin: 'auto',\n                left: 0,\n                right: 0,\n                top: 0,\n                bottom: 0\n              }}\n            />\n          </Stack>\n        );\n      case 'Thor':\n        return (\n          <Stack>\n            <img\n              src=\"https://media.giphy.com/media/7FgZWm6sGY0CNphZDJ/giphy.gif\"\n              style={{\n                width: '100px',\n                position: 'absolute',\n                margin: 'auto',\n                left: 0,\n                right: 0,\n                top: 0,\n                bottom: 0\n              }}\n            />\n          </Stack>\n        );\n      default:\n        return defaultOnRender(placeholderProps);\n    }\n  };\n\n  return (\n    <Stack style={{ height: '30rem' }}>\n      <VideoGalleryComponent\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n        onRenderAvatar={onRenderAvatar}\n      />\n    </Stack>\n  );\n};\n"},1646:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { BaseCustomStylesProps, VideoGallery as VideoGalleryComponent } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const CustomStyleVideoGalleryExample: () => JSX.Element = () => {\n  const customStyles: BaseCustomStylesProps = {\n    root: {\n      border: 'solid 5px red'\n    }\n  };\n  return (\n    <Stack style={{ height: '30rem' }}>\n      <VideoGalleryComponent\n        styles={customStyles}\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n      />\n    </Stack>\n  );\n};\n"},1647:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery as VideoGalleryComponent } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const DefaultVideoGalleryExample: () => JSX.Element = () => {\n  return (\n    <Stack style={{ height: '30rem' }}>\n      <VideoGalleryComponent localParticipant={MockLocalParticipant} remoteParticipants={MockRemoteParticipants} />\n    </Stack>\n  );\n};\n"},1648:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile, FluentThemeProvider, StreamMedia } from '@azure/communication-react';\nimport React from 'react';\nimport { renderVideoStream } from '../../utils';\n\nexport const VideoTileExample: () => JSX.Element = () => {\n  const videoTileStyles = { root: { height: '300px', width: '400px', border: '1px solid #999' } };\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        styles={videoTileStyles}\n        displayName={'Maximus Aurelius'}\n        renderElement={\n          // NOTE: Replace with your own video provider. (An html element with video stream)\n          <StreamMedia videoStreamElement={renderVideoStream()} />\n        }\n        isVideoReady={false}\n        isMirrored={true}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1649:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile, FluentThemeProvider, StreamMedia } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\nimport { renderVideoStream } from '../../utils';\n\nconst onRenderPlaceholder = (): JSX.Element => (\n  <Stack>\n    <img\n      src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n      style={{\n        borderRadius: '150px',\n        width: '150px',\n        position: 'absolute',\n        margin: 'auto',\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0\n      }}\n    />\n  </Stack>\n);\nexport const VideoTilePlaceholderExample: () => JSX.Element = () => {\n  const videoTileStyles = { root: { height: '300px', width: '400px', border: '1px solid #999' } };\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        userId=\"UserIdPlaceholder\"\n        styles={videoTileStyles}\n        displayName={'Maximus Aurelius'}\n        renderElement={\n          // NOTE: Replace with your own video provider. (An html element with video stream)\n          <StreamMedia videoStreamElement={renderVideoStream()} />\n        }\n        isVideoReady={false}\n        isMirrored={true}\n        onRenderPlaceholder={onRenderPlaceholder}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1651:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"IncomingCallModal",(function(){return IncomingCallModal_IncomingCallModal})),__webpack_require__.d(__webpack_exports__,"IncomingCallToast",(function(){return IncomingCallToast_IncomingCallToast}));var constants=__webpack_require__(23),blocks=__webpack_require__(5),react=__webpack_require__(0),react_default=__webpack_require__.n(react),jsx_runtime=__webpack_require__(1),IncomingCallAlertsDocs_getDocs=function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"Incoming Call Alerts"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The Incoming Call Alert Components alert about an incoming call. They can render a local video preview, custom avatar image, caller name and incoming call alert text."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Incoming Call Modal"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { StreamMedia, VideoTile } from '@azure/communication-react';\nimport { DefaultButton, Persona, PersonaSize, Stack, Dialog, DialogType, DialogFooter } from '@fluentui/react';\nimport { CallEndIcon, CallIcon, CallVideoIcon, CallVideoOffIcon } from '@fluentui/react-northstar';\nimport { getTheme, mergeStyles } from '@fluentui/react';\n\nconst theme = getTheme();\nconst palette = theme.palette;\n\nconst incomingCallModalContainerStyle = {\n  borderRadius: '0.75rem'\n};\n\nconst incomingCallModalLocalPreviewStyle = mergeStyles({\n  height: '10rem',\n  background: palette.neutralLighterAlt,\n  margin: '1.5rem 0',\n  borderRadius: '0.25rem',\n  '& video': {\n    borderRadius: '0.25rem'\n  }\n});\n\ninterface IncomingCallModalProps extends IncomingCallToastProps {\n  /** Text to the right of a Caller's Name */\n  callerNameAlt?: string;\n  /** A Caller's subtitle. Displayed right below the callers name */\n  callerTitle?: string;\n  /** Receiver's Name */\n  localParticipantDisplayName?: string;\n  /** If set to 'true', mirrors the local video preview of the receiver */\n  localVideoInverted?: boolean;\n  /** Toggle local video preview on or off */\n  showLocalVideo?: boolean;\n  /** Local Video Stream Element. An HTML Element containing a video stream. */\n  localVideoStreamElement: HTMLElement | null;\n  /** Provide a function that handles the call behavior when Video Toggle Button is clicked */\n  onClickVideoToggle: () => void;\n}\n\nconst IncomingCallModal = (props: WithTheme<IncomingCallModalProps>): JSX.Element => {\n  const {\n    alertText,\n    avatar,\n    callerName,\n    callerNameAlt,\n    callerTitle,\n    localParticipantDisplayName,\n    localVideoInverted,\n    onClickAccept,\n    onClickReject,\n    onClickVideoToggle,\n    showLocalVideo,\n    localVideoStreamElement,\n    theme\n  } = props;\n  const palette = theme.palette;\n  const [hideDialog, { toggle: toggleHideDialog }] = useBoolean(false);\n  const dialogContentProps = { type: DialogType.normal, title: alertText ?? 'Incoming Video Call' };\n\n  const mediaGalleryLocalParticipant: JSX.Element = (\n    <VideoTile\n      isVideoReady={showLocalVideo}\n      renderElement={<StreamMedia videoStreamElement={localVideoStreamElement} />}\n      displayName={localParticipantDisplayName}\n      isMirrored={localVideoInverted}\n    />\n  );\n\n  return (\n    <>\n      <Dialog\n        hidden={hideDialog}\n        onDismiss={toggleHideDialog}\n        dialogContentProps={dialogContentProps}\n        modalProps={{\n          isBlocking: true,\n          styles: { main: incomingCallModalContainerStyle }\n        }}\n      >\n        <Stack horizontal verticalAlign=\"center\">\n          <Stack horizontalAlign=\"start\" style={{ marginRight: '0.5rem' }}>\n            <Persona\n              imageUrl={avatar}\n              text={callerName}\n              size={PersonaSize.size40}\n              hidePersonaDetails={true}\n              aria-label={callerName}\n            />\n          </Stack>\n          <Stack grow={1} horizontalAlign=\"center\" style={{ alignItems: 'flex-start' }}>\n            <Stack style={{ fontSize: '0.875rem', color: palette.black, fontWeight: 'bold' }}>\n              <span>\n                {callerName ?? 'No display name'}\n                {callerNameAlt ? (\n                  <span style={{ opacity: 0.5, marginLeft: '0.2rem' }}> &bull; {callerNameAlt}</span>\n                ) : null}\n              </span>\n            </Stack>\n            <Stack style={{ fontSize: '0.75rem', color: palette.neutralDark }}>\n              <span>{callerTitle ?? ''}</span>\n            </Stack>\n          </Stack>\n        </Stack>\n\n        {showLocalVideo ? (\n          <Stack className={incomingCallModalLocalPreviewStyle}>{mediaGalleryLocalParticipant}</Stack>\n        ) : null}\n\n        <DialogFooter>\n          <DefaultButton\n            onClick={() => onClickVideoToggle()}\n            style={{ background: palette.neutralLighterAlt, border: 'none' }}\n          >\n            {showLocalVideo ? <CallVideoIcon size=\"small\" /> : <CallVideoOffIcon size=\"small\" />}\n          </DefaultButton>\n\n          <DefaultButton\n            onClick={() => onClickAccept()}\n            text=\"Accept\"\n            style={{ background: palette.green, border: 'none' }}\n          />\n\n          <DefaultButton\n            onClick={() => onClickReject()}\n            text=\"Decline\"\n            style={{ background: palette.redDark, border: 'none' }}\n          />\n        </DialogFooter>\n      </Dialog>\n    </>\n  );\n};\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Incoming Call Toast"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { DefaultButton, Persona, PersonaSize, Stack, Dialog, DialogType, DialogFooter } from '@fluentui/react';\nimport { CallEndIcon, CallIcon, CallVideoIcon, CallVideoOffIcon } from '@fluentui/react-northstar';\nimport { getTheme, mergeStyles } from '@fluentui/react';\n\nconst theme = getTheme();\nconst palette = theme.palette;\n\nconst incomingCallToastStyle = mergeStyles({\n  minWidth: '20rem',\n  width: '100%',\n  height: '100%',\n  backgroundColor: palette.whiteTranslucent40,\n  opacity: 0.95,\n  borderRadius: '0.5rem',\n  boxShadow: theme.effects.elevation8,\n  padding: '1rem'\n});\n\nconst incomingCallToastAvatarContainerStyle = mergeStyles({\n  marginRight: '0.5rem'\n});\n\nconst incomingCallAcceptButtonStyle = mergeStyles({\n  backgroundColor: palette.greenDark,\n  color: palette.white,\n  borderRadius: '2rem',\n  minWidth: '2rem',\n  width: '2rem',\n  border: 'none',\n  ':hover, :active': {\n    backgroundColor: palette.green,\n    color: palette.white\n  }\n});\n\nconst incomingCallRejectButtonStyle = mergeStyles({\n  backgroundColor: palette.redDark,\n  color: palette.white,\n  borderRadius: '2rem',\n  minWidth: '2rem',\n  width: '2rem',\n  border: 'none',\n  ':hover, :active': {\n    backgroundColor: palette.red,\n    color: palette.white\n  }\n});\n\ntype IncomingCallToastProps = {\n  /** Caller's Name */\n  callerName?: string;\n  /** Alert Text. For example \"incoming vido call...\" */\n  alertText?: string;\n  /** Caller's Avatar/Profile Image */\n  avatar?: string;\n  /** Provide a function that handles the call behavior when Accept Button is clicked */\n  onClickAccept: () => void;\n  /** Provide a function that handles the call behavior when Reject Button is clicked */\n  onClickReject: () => void;\n};\n\nconst IncomingCallToast = (props: IncomingCallToastProps): JSX.Element => {\n  const { callerName, alertText, avatar, onClickAccept, onClickReject } = props;\n\n  return (\n    <Stack horizontal verticalAlign=\"center\" className={incomingCallToastStyle}>\n      <Stack horizontalAlign=\"start\" className={incomingCallToastAvatarContainerStyle}>\n        <Persona\n          imageUrl={avatar}\n          text={callerName}\n          size={PersonaSize.size40}\n          hidePersonaDetails={true}\n          aria-label={callerName}\n        />\n      </Stack>\n\n      <Stack grow={1} horizontalAlign=\"center\" style={{ alignItems: 'flex-start', fontFamily: 'Segoe UI' }}>\n        <Stack style={{ fontSize: '0.875rem' }}>\n          <b>{callerName ?? 'No display name'}</b>\n        </Stack>\n        <Stack style={{ fontSize: '0.75rem' }}>\n          <span>{alertText ?? 'Incoming call'}</span>\n        </Stack>\n      </Stack>\n\n      <Stack horizontal tokens={{ childrenGap: 10 }}>\n        <DefaultButton onClick={() => onClickReject()} className={incomingCallRejectButtonStyle}>\n          <CallEndIcon size={'medium'} />\n        </DefaultButton>\n        <DefaultButton onClick={() => onClickAccept()} className={incomingCallAcceptButtonStyle}>\n          <CallIcon size={'medium'} />\n        </DefaultButton>\n      </Stack>\n    </Stack>\n  );\n};\n"})]})};IncomingCallAlertsDocs_getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/IncomingCallAlertsDocs.tsx"]={name:"getDocs",docgenInfo:IncomingCallAlertsDocs_getDocs.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/IncomingCallAlertsDocs.tsx"});var dist=__webpack_require__(18),Stack=(__webpack_require__(385),__webpack_require__(384),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(435)),TextField=__webpack_require__(1857),IconButton=__webpack_require__(1877),DefaultButton=__webpack_require__(425),CallIcon=__webpack_require__(1842),VideoCameraEmphasisIcon=__webpack_require__(1836),copy_to_clipboard=__webpack_require__(826),copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard),src=(__webpack_require__(45),__webpack_require__(61),__webpack_require__(70),__webpack_require__(41),__webpack_require__(269)),CommunicationUiError=__webpack_require__(33),utils=__webpack_require__(84);__webpack_require__(10),__webpack_require__(262),__webpack_require__(226),__webpack_require__(263),__webpack_require__(261),__webpack_require__(56);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ErrorContextLastError=Object(react.createContext)(void 0),ErrorContextSetLastError=Object(react.createContext)(void 0),ErrorContextOnErrorCallback=Object(react.createContext)(void 0),ErrorContextSetOnErrorCallback=Object(react.createContext)(void 0),ErrorProvider_ErrorProvider=function ErrorProvider(props){var _useState2=_slicedToArray(Object(react.useState)(),2),lastError=_useState2[0],setLastError=_useState2[1],_useState4=_slicedToArray(Object(react.useState)((function(){return props.onErrorCallback})),2),onErrorCallback=_useState4[0],setOnErrorCallback=_useState4[1],setLastErrorContext=Object(react.useMemo)((function(){return{setLastError:setLastError}}),[]),setOnErrorCallbackContext=Object(react.useMemo)((function(){return{setOnErrorCallback:setOnErrorCallback}}),[]),onErrorCallbackContext=Object(react.useMemo)((function(){return{onErrorCallback:onErrorCallback}}),[onErrorCallback]),lastErrorContext=Object(react.useMemo)((function(){return{lastError:lastError}}),[lastError]);return Object(jsx_runtime.jsx)(ErrorContextSetLastError.Provider,{value:setLastErrorContext,children:Object(jsx_runtime.jsx)(ErrorContextSetOnErrorCallback.Provider,{value:setOnErrorCallbackContext,children:Object(jsx_runtime.jsx)(ErrorContextOnErrorCallback.Provider,{value:onErrorCallbackContext,children:Object(jsx_runtime.jsx)(ErrorContextLastError.Provider,{value:lastErrorContext,children:props.children})})})})};ErrorProvider_ErrorProvider.displayName="ErrorProvider";var ErrorProvider_useTriggerOnErrorCallback=function useTriggerOnErrorCallback(){var onErrorCallbackContext=Object(react.useContext)(ErrorContextOnErrorCallback),setLastErrorContext=Object(react.useContext)(ErrorContextSetLastError);if(void 0===onErrorCallbackContext)throw new CommunicationUiError.a({message:"useTriggerOnErrorCallback invoked when ErrorContextOnErrorCallback not initialized yet",code:CommunicationUiError.b.CONFIGURATION_ERROR});if(void 0===setLastErrorContext)throw new CommunicationUiError.a({message:"useTriggerOnErrorCallback invoked when ErrorContextSetLastError not initialized yet",code:CommunicationUiError.b.CONFIGURATION_ERROR});return Object(react.useCallback)((function(error){var _onErrorCallbackConte,uiError=Object(CommunicationUiError.c)(error);setLastErrorContext.setLastError(uiError),null==onErrorCallbackContext||null===(_onErrorCallbackConte=onErrorCallbackContext.onErrorCallback)||void 0===_onErrorCallbackConte||_onErrorCallbackConte.call(onErrorCallbackContext,uiError)}),[onErrorCallbackContext,setLastErrorContext])};function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}ErrorProvider_ErrorProvider.__docgenInfo={description:"ErrorProvider provides access to 'lastError' which is used by the ErrorBar component and 'onErrorCallback' used by\nthe WithErrorHandling component. Takes in an optional 'onErrorCallback' which if provided will be called in the\nfunction returned by useTriggerOnErrorCallback().",methods:[],displayName:"ErrorProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},onErrorCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(error: CommunicationUiErrorInfo) => void",signature:{arguments:[{name:"error",type:{name:"CommunicationUiErrorInfo"}}],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/providers/ErrorProvider.tsx"]={name:"ErrorProvider",docgenInfo:ErrorProvider_ErrorProvider.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/providers/ErrorProvider.tsx"});var WithErrorHandling_ErrorBoundary=function(_React$Component){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ErrorBoundary,_React$Component);var _super=_createSuper(ErrorBoundary);function ErrorBoundary(props){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ErrorBoundary),_super.call(this,props)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ErrorBoundary,[{key:"componentDidCatch",value:function componentDidCatch(error,info){if(error instanceof CommunicationUiError.a){var _this$props$onErrorCa,_this$props,uiError=Object(CommunicationUiError.c)(error);uiError.errorInfo=info,null===(_this$props$onErrorCa=(_this$props=this.props).onErrorCallback)||void 0===_this$props$onErrorCa||_this$props$onErrorCa.call(_this$props,uiError)}else{var _this$props$onErrorCa2,_this$props2;null===(_this$props$onErrorCa2=(_this$props2=this.props).onErrorCallback)||void 0===_this$props$onErrorCa2||_this$props$onErrorCa2.call(_this$props2,new CommunicationUiError.a({error:error,errorInfo:info}))}}},{key:"render",value:function render(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:this.props.children})}}]),ErrorBoundary}(react_default.a.Component),WithErrorHandling_WithErrorHandling=function WithErrorHandling(Component,props){try{var triggerOnErrorCallback=ErrorProvider_useTriggerOnErrorCallback(),newProps=Object.assign({},props);return newProps.onErrorCallback=triggerOnErrorCallback,Object(jsx_runtime.jsx)(WithErrorHandling_ErrorBoundary,{onErrorCallback:triggerOnErrorCallback,children:Object(jsx_runtime.jsx)(Component,Object.assign({},newProps))})}catch(error){return Object(jsx_runtime.jsx)(WithErrorHandling_ErrorBoundary,{onErrorCallback:props.onErrorCallback,children:Object(jsx_runtime.jsx)(Component,Object.assign({},props))})}};WithErrorHandling_WithErrorHandling.__docgenInfo={description:"Wraps a given component with error handling. Wrapping a component does two things:\n\n1. Surrounds the given component with a component that implements React Error Boundary (componentDidCatch) to allow\n   us to handle errors detected by React.\n2. Adds ErrorProvider's triggerOnErrorCallback as a prop to the wrapped component if ErrorProvider is defined. If\n   ErrorProvider is not defined, then the original props.onErrorCallback is the passed into the component.\n\nThis support the two cases:\n\n1. Connected Component. The wrapper subscribes to ErrorProvider and will pass ErrorProvider's triggerOnErrorCallback\n   to the wrapped component.\n2. Pure Standalone Component. The wrapper takes in an optional props.onErrorCallback. Since ErrorProvider is not\n   defined, the passed in props.onErrorCallback will be used.",methods:[],displayName:"WithErrorHandling"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/utils/WithErrorHandling.tsx"]={name:"WithErrorHandling",docgenInfo:WithErrorHandling_WithErrorHandling.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/utils/WithErrorHandling.tsx"});var types=__webpack_require__(286),ValidContext_useValidContext=function useValidContext(ReactContext){var context=Object(react.useContext)(ReactContext);if(void 0===context)throw new types.CommunicationUiError({message:"Context is undefined",code:types.CommunicationUiErrorCode.CONFIGURATION_ERROR});return context};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallingProvider_slicedToArray(arr,i){return function CallingProvider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallingProvider_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallingProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallingProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallingProvider_arrayLikeToArray(o,minLen)}(arr,i)||function CallingProvider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallingProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallingContext=Object(react.createContext)(void 0),CallingProvider_CallingProviderBase=function CallingProviderBase(props){var token=props.token,initialDisplayName=props.displayName,callClientOptions=props.callClientOptions,refreshTokenCallback=props.refreshTokenCallback,onErrorCallback=props.onErrorCallback,userIdFromToken=token?Object(utils.b)(token):"",_useState2=CallingProvider_slicedToArray(Object(react.useState)(Object(src.a)({userId:userIdFromToken},{callClientOptions:callClientOptions})),2),callClient=_useState2[0],setCallClient=_useState2[1],_useState4=CallingProvider_slicedToArray(Object(react.useState)(void 0),2),callAgent=_useState4[0],setCallAgent=_useState4[1],_useState6=CallingProvider_slicedToArray(Object(react.useState)(void 0),2),deviceManager=_useState6[0],setDeviceManager=_useState6[1],_useState8=CallingProvider_slicedToArray(Object(react.useState)(userIdFromToken),2),userId=_useState8[0],setUserId=_useState8[1],_useState10=CallingProvider_slicedToArray(Object(react.useState)(initialDisplayName),2),displayName=_useState10[0],setDisplayName=_useState10[1],_useState12=CallingProvider_slicedToArray(Object(react.useState)("Unknown"),2),audioDevicePermission=_useState12[0],setAudioDevicePermission=_useState12[1],_useState14=CallingProvider_slicedToArray(Object(react.useState)("Unknown"),2),videoDevicePermission=_useState14[0],setVideoDevicePermission=_useState14[1],_useState16=CallingProvider_slicedToArray(Object(react.useState)(void 0),2),videoDeviceInfo=_useState16[0],setVideoDeviceInfo=_useState16[1],_useState18=CallingProvider_slicedToArray(Object(react.useState)([]),2),videoDeviceList=_useState18[0],setVideoDeviceList=_useState18[1],_useState20=CallingProvider_slicedToArray(Object(react.useState)(void 0),2),audioDeviceInfo=_useState20[0],setAudioDeviceInfo=_useState20[1],_useState22=CallingProvider_slicedToArray(Object(react.useState)([]),2),audioDeviceList=_useState22[0],setAudioDeviceList=_useState22[1],refreshTokenCallbackRefContainer=Object(react.useRef)(refreshTokenCallback);Object(react.useEffect)((function(){refreshTokenCallbackRefContainer.current=refreshTokenCallback}),[refreshTokenCallback]),Object(react.useEffect)((function(){setUserId(userIdFromToken)}),[userIdFromToken]),Object(react.useEffect)((function(){(function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}})(regeneratorRuntime.mark((function _callee(){var statefulDeviceManager;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!token){_context.next=7;break}return _context.t0=setCallAgent,_context.next=5,callClient.createCallAgent(Object(utils.a)(token,refreshTokenCallbackRefContainer.current),{displayName:displayName});case 5:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 7:return _context.next=9,callClient.getDeviceManager();case 9:(statefulDeviceManager=_context.sent).getCameras(),statefulDeviceManager.getMicrophones(),statefulDeviceManager.getSpeakers(),setDeviceManager(statefulDeviceManager),_context.next=19;break;case 16:throw _context.prev=16,_context.t2=_context.catch(0),new CommunicationUiError.a({message:"Error creating call agent",code:CommunicationUiError.b.CREATE_CALL_AGENT_ERROR,error:_context.t2});case 19:case"end":return _context.stop()}}),_callee,null,[[0,16]])})))().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}),[token,callClient,refreshTokenCallbackRefContainer,displayName,onErrorCallback]),Object(react.useEffect)((function(){return function(){null==callAgent||callAgent.dispose().catch((function(error){var communicationError=new CommunicationUiError.a({message:"Error disposing call agent",code:CommunicationUiError.b.DISPOSE_CALL_AGENT_ERROR,error:error});Object(utils.d)(communicationError,onErrorCallback)}))}}),[callAgent,token,onErrorCallback]);var initialState={callClient:callClient,setCallClient:setCallClient,callAgent:callAgent,setCallAgent:setCallAgent,deviceManager:deviceManager,setDeviceManager:setDeviceManager,userId:userId,setUserId:setUserId,displayName:displayName,setDisplayName:setDisplayName,audioDevicePermission:audioDevicePermission,setAudioDevicePermission:setAudioDevicePermission,videoDevicePermission:videoDevicePermission,setVideoDevicePermission:setVideoDevicePermission,videoDeviceInfo:videoDeviceInfo,setVideoDeviceInfo:setVideoDeviceInfo,videoDeviceList:videoDeviceList,setVideoDeviceList:setVideoDeviceList,audioDeviceInfo:audioDeviceInfo,setAudioDeviceInfo:setAudioDeviceInfo,audioDeviceList:audioDeviceList,setAudioDeviceList:setAudioDeviceList};return Object(jsx_runtime.jsx)(CallingContext.Provider,{value:initialState,children:props.children})};CallingProvider_CallingProviderBase.displayName="CallingProviderBase";var CallingProvider_CallingProvider=function CallingProvider(props){return WithErrorHandling_WithErrorHandling(CallingProvider_CallingProviderBase,props)},CallingProvider_useCallingContext=function useCallingContext(){return ValidContext_useValidContext(CallingContext)};function CallProvider_slicedToArray(arr,i){return function CallProvider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallProvider_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallProvider_arrayLikeToArray(o,minLen)}(arr,i)||function CallProvider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallContext=Object(react.createContext)(void 0),CallProvider_CallProviderBase=function CallProviderBase(props){var children=props.children,_useState2=CallProvider_slicedToArray(Object(react.useState)(void 0),2),call=_useState2[0],setCall=_useState2[1],_useState4=CallProvider_slicedToArray(Object(react.useState)("None"),2),callState=_useState4[0],setCallState=_useState4[1],_useState6=CallProvider_slicedToArray(Object(react.useState)([]),2),participants=_useState6[0],setParticipants=_useState6[1],_useState8=CallProvider_slicedToArray(Object(react.useState)(void 0),2),screenShareStream=_useState8[0],setScreenShareStream=_useState8[1],_useState10=CallProvider_slicedToArray(Object(react.useState)(!1),2),isMicrophoneEnabled=_useState10[0],setIsMicrophoneEnabled=_useState10[1],_useState12=CallProvider_slicedToArray(Object(react.useState)(!1),2),localScreenShareActive=_useState12[0],setLocalScreenShare=_useState12[1],_useState14=CallProvider_slicedToArray(Object(react.useState)(void 0),2),localVideoStream=_useState14[0],setLocalVideoStream=_useState14[1],_useState16=CallProvider_slicedToArray(Object(react.useState)(!1),2),isLocalVideoRendererBusy=_useState16[0],setLocalVideoRendererBusy=_useState16[1],_useState18=CallProvider_slicedToArray(Object(react.useState)(!1),2),initialState={call:call,setCall:setCall,callState:callState,setCallState:setCallState,participants:participants,setParticipants:setParticipants,screenShareStream:screenShareStream,setScreenShareStream:setScreenShareStream,isMicrophoneEnabled:isMicrophoneEnabled,setIsMicrophoneEnabled:setIsMicrophoneEnabled,localScreenShareActive:localScreenShareActive,setLocalScreenShare:setLocalScreenShare,localVideoStream:localVideoStream,setLocalVideoStream:setLocalVideoStream,isLocalVideoRendererBusy:isLocalVideoRendererBusy,setLocalVideoRendererBusy:setLocalVideoRendererBusy,isLocalVideoOn:_useState18[0],setLocalVideoOn:_useState18[1]};return Object(jsx_runtime.jsx)(CallContext.Provider,{value:initialState,children:children})};CallProvider_CallProviderBase.displayName="CallProviderBase";var CallProvider_CallProvider=function CallProvider(props){return WithErrorHandling_WithErrorHandling(CallProvider_CallProviderBase,props)},CallProvider_useCallContext=function useCallContext(){return ValidContext_useValidContext(CallContext)};function useOutgoingCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var useOutgoingCall_useOutgoingCall=function useOutgoingCall(){var callAgent=CallingProvider_useCallingContext().callAgent,_useCallContext=CallProvider_useCallContext(),call=_useCallContext.call,setCall=_useCallContext.setCall,setCallState=_useCallContext.setCallState,localVideoStream=_useCallContext.localVideoStream,setScreenShareStream=_useCallContext.setScreenShareStream,screenShareStream=_useCallContext.screenShareStream;Object(react.useEffect)((function(){var _call$state2,updateCallState=function updateCallState(){var _call$state;setCallState(null!==(_call$state=null==call?void 0:call.state)&&void 0!==_call$state?_call$state:"None")};return setCallState(null!==(_call$state2=null==call?void 0:call.state)&&void 0!==_call$state2?_call$state2:"None"),null==call||call.on("stateChanged",updateCallState),function(){null==call||call.off("stateChanged",updateCallState)}}),[call,setCallState]);return{makeCall:function makeCall(receiver,joinCallOptions){if(!callAgent)throw new Error("CallAgent is invalid");var audioOptions=(null==joinCallOptions?void 0:joinCallOptions.audioOptions)||{muted:!1},videoOptions=null==joinCallOptions?void 0:joinCallOptions.videoOptions;!videoOptions&&localVideoStream&&(videoOptions={localVideoStreams:[localVideoStream]});var newCall=callAgent.startCall([receiver],{videoOptions:videoOptions,audioOptions:audioOptions});console.log("newCall",newCall),setCall(newCall),newCall.remoteParticipants.forEach((function(participant){participant.on("videoStreamsUpdated",(function(e){e.added.forEach((function(addedStream){"Video"!==addedStream.mediaStreamType&&(addedStream.on("isAvailableChanged",(function(){var _screenShareStream$st;addedStream.isAvailable?setScreenShareStream({stream:addedStream,user:participant}):screenShareStream&&(null==screenShareStream||null===(_screenShareStream$st=screenShareStream.stream)||void 0===_screenShareStream$st?void 0:_screenShareStream$st.id)!==addedStream.id||setScreenShareStream(void 0)})),addedStream.isAvailable&&setScreenShareStream({stream:addedStream,user:participant}))}))}))}))},endCall:function(){var _ref=function useOutgoingCall_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useOutgoingCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useOutgoingCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(call){_context.next=2;break}throw new Error("Call is invalid");case 2:return _context.next=4,call.hangUp({forEveryone:!0});case 4:case"end":return _context.stop()}}),_callee)})));return function endCall(){return _ref.apply(this,arguments)}}()}},SDKUtils=__webpack_require__(137);function useSubscribeToDevicePermission_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useSubscribeToDevicePermission_slicedToArray(arr,i){return function useSubscribeToDevicePermission_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useSubscribeToDevicePermission_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function useSubscribeToDevicePermission_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useSubscribeToDevicePermission_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useSubscribeToDevicePermission_arrayLikeToArray(o,minLen)}(arr,i)||function useSubscribeToDevicePermission_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useSubscribeToDevicePermission_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var useSubscribeToDevicePermission=function(permissionType){var context=Object(react.useContext)(CallingContext),onErrorCallback=ErrorProvider_useTriggerOnErrorCallback();if(!context)throw new CommunicationUiError.a({message:"CallingContext is undefined",code:CommunicationUiError.b.CONFIGURATION_ERROR});var deviceManager=context.deviceManager,setAudioDevicePermission=context.setAudioDevicePermission,setVideoDevicePermission=context.setVideoDevicePermission,_useState2=useSubscribeToDevicePermission_slicedToArray(Object(react.useState)("Unknown"),2),devicePermissionState=_useState2[0],setDevicePermissionState=_useState2[1],mounted=Object(react.useRef)(!1);Object(react.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}})),Object(react.useEffect)((function(){deviceManager&&"Granted"!==devicePermissionState&&"Denied"!==devicePermissionState&&function(){var _ref=function useSubscribeToDevicePermission_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useSubscribeToDevicePermission_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useSubscribeToDevicePermission_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var access,permissionState,_access,_permissionState;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if("Unknown"!==devicePermissionState){_context.next=30;break}if(_context.prev=1,"Microphone"!==permissionType){_context.next=13;break}return _context.next=5,deviceManager.askDevicePermission({video:!1,audio:!0});case 5:if(access=_context.sent,mounted.current){_context.next=8;break}return _context.abrupt("return");case 8:permissionState=access.audio?"Granted":"Denied",setDevicePermissionState(permissionState),setAudioDevicePermission(permissionState),_context.next=25;break;case 13:if("Camera"!==permissionType){_context.next=24;break}return _context.next=16,deviceManager.askDevicePermission({video:!0,audio:!1});case 16:if(_access=_context.sent,mounted.current){_context.next=19;break}return _context.abrupt("return");case 19:_permissionState=_access.video?"Granted":"Denied",setDevicePermissionState(_permissionState),setVideoDevicePermission(_permissionState),_context.next=25;break;case 24:throw new Error("invalid device type specified");case 25:_context.next=30;break;case 27:throw _context.prev=27,_context.t0=_context.catch(1),new CommunicationUiError.a({message:"Error asking permissions",code:CommunicationUiError.b.ASK_PERMISSIONS_ERROR,error:_context.t0});case 30:case"end":return _context.stop()}}),_callee,null,[[1,27]])})));return function queryPermissionState(){return _ref.apply(this,arguments)}}()().catch((function(error){Object(SDKUtils.d)(error,onErrorCallback)}))}),[deviceManager,permissionType,setAudioDevicePermission,setVideoDevicePermission,onErrorCallback,devicePermissionState])},lib=__webpack_require__(34),mainContainerStyle=Object(lib.G)({width:"100%",height:"100%",selectors:{"@media (max-width: 750px)":{padding:"0.625rem",height:"100%"}},justifyContent:"center"}),inputBoxStyle=Object(lib.G)({boxSizing:"border-box",height:"2.5rem",width:"18.75rem",border:"1px solid #605e5c",borderRadius:"2px",backgroundColor:"#FFFFFF",marginLeft:"2.2rem"}),inputBoxTextStyle=Object(lib.G)({fontSize:"0.875rem",fontWeight:600,lineHeight:"1.5rem","::-webkit-input-placeholder":{fontSize:"0.875rem",fontWeight:600},"::-moz-placeholder":{fontSize:"0.875rem",fontWeight:600},":-moz-placeholder":{fontSize:"0.875rem",fontWeight:600}}),buttonStyle=Object(lib.G)({fontWeight:600,fontSize:"0.875rem",height:"2.75rem",width:"100%",marginTop:"1.125rem",maxWidth:"18.75rem",minWidth:"8rem"}),buttonIconStyle=Object(lib.G)({marginRight:"0.375rem",fontSize:"1.375rem"}),buttonStackTokens={childrenGap:"0.5rem"};function MakeCallScreen_slicedToArray(arr,i){return function MakeCallScreen_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MakeCallScreen_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MakeCallScreen_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MakeCallScreen_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MakeCallScreen_arrayLikeToArray(o,minLen)}(arr,i)||function MakeCallScreen_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MakeCallScreen_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MakeCallScreen_MakeCallScreen=function MakeCallScreen(props){var _props$calleeId,callerId=props.callerId,onStartCall=props.onStartCall,_useState2=MakeCallScreen_slicedToArray(Object(react.useState)(null!==(_props$calleeId=props.calleeId)&&void 0!==_props$calleeId?_props$calleeId:""),2),calleeId=_useState2[0],setCalleeId=_useState2[1];useSubscribeToDevicePermission("Microphone"),useSubscribeToDevicePermission("Camera");var makeCall=useOutgoingCall_useOutgoingCall().makeCall,_useCallContext=CallProvider_useCallContext(),setLocalVideoOn=_useCallContext.setLocalVideoOn,setIsMicrophoneEnabled=_useCallContext.setIsMicrophoneEnabled,startCall=function startCall(calleeId,videoEnabled){setLocalVideoOn(!!videoEnabled),setIsMicrophoneEnabled(!0),makeCall({communicationUserId:calleeId})};return Object(jsx_runtime.jsxs)(Stack.a,{className:mainContainerStyle,horizontalAlign:"center",verticalAlign:"center",children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"center",verticalAlign:"center",children:[Object(jsx_runtime.jsx)(TextField.a,{autoComplete:"off",ariaLabel:"Enter callee id",borderless:!0,onChange:function onChange(event){return setCalleeId(event.target.value)},id:"name",placeholder:"Enter callee id",inputClassName:inputBoxTextStyle,className:inputBoxStyle}),Object(jsx_runtime.jsx)(IconButton.a,{style:{marginLeft:"0.2rem"},onClick:function onClick(){copy_to_clipboard_default()(callerId)},iconProps:{iconName:"Copy"},title:"Copy my callerID"})]}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:buttonStackTokens,children:[Object(jsx_runtime.jsxs)(DefaultButton.a,{disabled:!calleeId,className:buttonStyle,onClick:function onClick(){onStartCall(),startCall(calleeId,!1)},children:[Object(jsx_runtime.jsx)(CallIcon.a,{className:buttonIconStyle,size:"medium"}),"Audio Call"]}),Object(jsx_runtime.jsxs)(DefaultButton.a,{disabled:!calleeId,className:buttonStyle,onClick:function onClick(){onStartCall(),startCall(calleeId,!0)},children:[Object(jsx_runtime.jsx)(VideoCameraEmphasisIcon.a,{className:buttonIconStyle,size:"medium"}),"Video Call"]})]})]})};MakeCallScreen_MakeCallScreen.displayName="MakeCallScreen",MakeCallScreen_MakeCallScreen.__docgenInfo={description:"",methods:[],displayName:"MakeCallScreen",props:{callerId:{required:!0,tsType:{name:"string"},description:""},calleeId:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/MakeCallScreen.tsx"]={name:"MakeCallScreen",docgenInfo:MakeCallScreen_MakeCallScreen.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/MakeCallScreen.tsx"});var Label=__webpack_require__(1865),CallScreen_styles_palette=Object(lib.B)().palette,containerStyles={root:{height:"100%",minHeight:"9.375rem",width:"100%",position:"relative"}},activeContainerClassName={root:{border:"solid 1px ".concat(CallScreen_styles_palette.neutralLighterAlt),height:"calc(100% - 0.1875rem)",display:"initial"}},loadingStyle=Object(lib.G)({height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),headerContainer=Object(lib.G)({width:"100%",height:"3.875rem",padding:"0.0625rem 0",boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2}),sdk_bundle=(Object(lib.G)(headerContainer,{justifyContent:"center"}),__webpack_require__(90)),Spinner=__webpack_require__(1870),Spinner_types=__webpack_require__(179),MediaFullScreen_styles_palette=Object(lib.B)().palette,fullScreenStyle=Object(lib.G)({padding:"0.5em",borderRight:"1px solid rgba(0,0,0,0.05)",height:"100%",width:"100%",background:MediaFullScreen_styles_palette.neutralLighterAlt}),hiddenFullScreenStyle=Object(lib.G)({display:"none",borderRight:"1px solid rgba(0,0,0,0.05)",height:"100%",width:"100%",background:MediaFullScreen_styles_palette.neutralLighterAlt}),MediaFullScreen_styles_loadingStyle=Object(lib.G)({height:"100%",display:"flex",justifyContent:"center"}),getACSId=(__webpack_require__(118),__webpack_require__(204),__webpack_require__(55),function getACSId(identifier){switch(identifier.kind){case"communicationUser":return identifier.communicationUserId;case"phoneNumber":return identifier.phoneNumber;case"microsoftTeamsUser":return identifier.microsoftTeamsUserId;default:return identifier.id}});function isSelectedDeviceInList(device,list){return!!list.find((function(item){return item.name===device.name}))}var areStreamsEqual=function areStreamsEqual(prevStream,newStream){return!!prevStream&&!!newStream&&prevStream.source.id===newStream.source.id},isLocalScreenShareSupportedInBrowser=function isLocalScreenShareSupportedInBrowser(){return!function isMobileSession(){return!!window.navigator.userAgent.match(/(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone)/g)}()&&(/chrome/i.test(navigator.userAgent.toLowerCase())||/safari/i.test(navigator.userAgent.toLowerCase()))};function MediaFullScreen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function MediaFullScreen_slicedToArray(arr,i){return function MediaFullScreen_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MediaFullScreen_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MediaFullScreen_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MediaFullScreen_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MediaFullScreen_arrayLikeToArray(o,minLen)}(arr,i)||function MediaFullScreen_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MediaFullScreen_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MediaFullScreen=function(props){var _props$activeScreenSh,_useState2=MediaFullScreen_slicedToArray(Object(react.useState)(!0),2),loading=_useState2[0],setLoading=_useState2[1],rendererViewRef=Object(react.useRef)(null),activeScreenShareStream=props.activeScreenShareStream;Object(react.useEffect)((function(){!function MediaFullScreen_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){MediaFullScreen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){MediaFullScreen_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var stream,renderer,container;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!activeScreenShareStream||!activeScreenShareStream.stream){_context.next=10;break}return stream=activeScreenShareStream.stream,renderer=new sdk_bundle.VideoStreamRenderer(stream),_context.next=5,renderer.createView({scalingMode:"Fit"});case 5:rendererViewRef.current=_context.sent,(container=document.getElementById("fullScreenStreamMediaId"))&&0===container.childElementCount&&(setLoading(!1),container.appendChild(rendererViewRef.current.target)),_context.next=11;break;case 10:rendererViewRef.current&&rendererViewRef.current.dispose();case 11:case"end":return _context.stop()}}),_callee)})))()}),[activeScreenShareStream]);var displayName=null!==(_props$activeScreenSh=props.activeScreenShareStream.user.displayName)&&void 0!==_props$activeScreenSh?_props$activeScreenSh:getACSId(props.activeScreenShareStream.user.identifier);return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[loading&&Object(jsx_runtime.jsx)("div",{className:MediaFullScreen_styles_loadingStyle,children:Object(jsx_runtime.jsx)(Spinner.a,{label:"Loading ".concat(displayName,"'s screen"),size:Spinner_types.a.xSmall})}),Object(jsx_runtime.jsx)("div",{id:"fullScreenStreamMediaId",className:loading?hiddenFullScreenStyle:fullScreenStyle})]})};function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function ConnectContext_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ConnectContext_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ConnectContext_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ConnectContext_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ConnectContext_connectFuncsToContext=function connectFuncsToContext(ElementToConnect){for(var _len=arguments.length,mapToComponentFuncs=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)mapToComponentFuncs[_key-1]=arguments[_key];return function(props){var _step,propsFromContext={},_iterator=_createForOfIteratorHelper(mapToComponentFuncs);try{for(_iterator.s();!(_step=_iterator.n()).done;){var mapToComponentProps=_step.value;propsFromContext=Object.assign({},mapToComponentProps(props),propsFromContext)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return Object(jsx_runtime.jsx)(ElementToConnect,Object.assign({},Object.assign({},propsFromContext,props)))}},dist_esm=(__webpack_require__(39),__webpack_require__(27));function useSubscribeToVideoDeviceList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useSubscribeToVideoDeviceList_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useSubscribeToVideoDeviceList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useSubscribeToVideoDeviceList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var useSubscribeToVideoDeviceList=function(){var _useCallingContext=CallingProvider_useCallingContext(),videoDevicePermission=_useCallingContext.videoDevicePermission,videoDeviceInfo=_useCallingContext.videoDeviceInfo,setVideoDeviceInfo=_useCallingContext.setVideoDeviceInfo,setVideoDeviceList=_useCallingContext.setVideoDeviceList,deviceManager=_useCallingContext.deviceManager;Object(react.useEffect)((function(){if(deviceManager&&"Granted"===videoDevicePermission){promptVideoDevices(deviceManager);var onVideoDevicesUpdated=function onVideoDevicesUpdated(){promptVideoDevices(deviceManager)};return deviceManager.on("videoDevicesUpdated",onVideoDevicesUpdated),function(){deviceManager.off("videoDevicesUpdated",onVideoDevicesUpdated)}}function promptVideoDevices(_x){return _promptVideoDevices.apply(this,arguments)}function _promptVideoDevices(){return(_promptVideoDevices=useSubscribeToVideoDeviceList_asyncToGenerator(regeneratorRuntime.mark((function _callee(deviceManager){var cameraList;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,deviceManager.getCameras();case 2:cameraList=_context.sent,setVideoDeviceList(cameraList),!(cameraList.length>0)||videoDeviceInfo&&isSelectedDeviceInList(videoDeviceInfo,cameraList)||setVideoDeviceInfo(cameraList[0]);case 5:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}}),[deviceManager,videoDevicePermission,videoDeviceInfo,setVideoDeviceList,setVideoDeviceInfo])};__webpack_require__(109);function useGroupCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var useGroupCall_useGroupCall=function useGroupCall(){var callAgent=CallingProvider_useCallingContext().callAgent,_useCallContext=CallProvider_useCallContext(),call=_useCallContext.call,setCall=_useCallContext.setCall,localVideoStream=_useCallContext.localVideoStream,isMicrophoneEnabled=_useCallContext.isMicrophoneEnabled;return{join:Object(react.useCallback)((function(context,joinCallOptions){if(!callAgent)throw new CommunicationUiError.a({message:"CallAgent is undefined",code:CommunicationUiError.b.CONFIGURATION_ERROR});var audioOptions={muted:!isMicrophoneEnabled},videoOptions={localVideoStreams:localVideoStream?[localVideoStream]:void 0};try{var _joinCallOptions$vide,_joinCallOptions$audi,_call=callAgent.join(context,{videoOptions:null!==(_joinCallOptions$vide=null==joinCallOptions?void 0:joinCallOptions.videoOptions)&&void 0!==_joinCallOptions$vide?_joinCallOptions$vide:videoOptions,audioOptions:null!==(_joinCallOptions$audi=null==joinCallOptions?void 0:joinCallOptions.audioOptions)&&void 0!==_joinCallOptions$audi?_joinCallOptions$audi:audioOptions});return setCall(_call),_call}catch(error){throw new CommunicationUiError.a({message:"Error joining call",code:CommunicationUiError.b.JOIN_CALL_ERROR,error:error})}}),[callAgent,isMicrophoneEnabled,localVideoStream]),leave:Object(react.useCallback)(function(){var _ref=function useGroupCall_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useGroupCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useGroupCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(hangupCallOptions){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(call){_context.next=2;break}throw new CommunicationUiError.a({message:"Call is invalid",code:CommunicationUiError.b.LEAVE_CALL_ERROR});case 2:return _context.prev=2,_context.next=5,call.hangUp(hangupCallOptions);case 5:setCall(void 0),_context.next=11;break;case 8:throw _context.prev=8,_context.t0=_context.catch(2),new CommunicationUiError.a({message:"Error hanging up call",code:CommunicationUiError.b.LEAVE_CALL_ERROR,error:_context.t0});case 11:case"end":return _context.stop()}}),_callee,null,[[2,8]])})));return function(_x){return _ref.apply(this,arguments)}}(),[call])}};function useMicrophone_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useMicrophone_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useMicrophone_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useMicrophone_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var useMicrophone_useMicrophone=function useMicrophone(){var _useCallingContext=CallingProvider_useCallingContext(),audioDevicePermission=_useCallingContext.audioDevicePermission,callAgent=_useCallingContext.callAgent,_useCallContext=CallProvider_useCallContext(),isMicrophoneEnabled=_useCallContext.isMicrophoneEnabled,setIsMicrophoneEnabled=_useCallContext.setIsMicrophoneEnabled,call=null==callAgent?void 0:callAgent.calls[0],unmute=Object(react.useCallback)(useMicrophone_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if("Granted"===audioDevicePermission){_context.next=2;break}throw new CommunicationUiError.a({message:"Cannot unmute microphone - microphone permission has not been granted.",code:CommunicationUiError.b.UNMUTE_ERROR});case 2:if(_context.prev=2,null==call||!call.isMuted){_context.next=6;break}return _context.next=6,call.unmute();case 6:setIsMicrophoneEnabled(!0),_context.next=12;break;case 9:throw _context.prev=9,_context.t0=_context.catch(2),new CommunicationUiError.a({message:"Error unmuting microphone",code:CommunicationUiError.b.UNMUTE_ERROR,error:_context.t0});case 12:case"end":return _context.stop()}}),_callee,null,[[2,9]])}))),[audioDevicePermission,call,setIsMicrophoneEnabled]),mute=Object(react.useCallback)(useMicrophone_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_context2.prev=0,null!=call&&call.isMuted){_context2.next=4;break}return _context2.next=4,null==call?void 0:call.mute();case 4:setIsMicrophoneEnabled(!1),_context2.next=10;break;case 7:throw _context2.prev=7,_context2.t0=_context2.catch(0),new CommunicationUiError.a({message:"Error muting microphone",code:CommunicationUiError.b.MUTE_ERROR,error:_context2.t0});case 10:case"end":return _context2.stop()}}),_callee2,null,[[0,7]])}))),[call,setIsMicrophoneEnabled]),toggle=Object(react.useCallback)(useMicrophone_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,isMicrophoneEnabled?mute():unmute();case 2:return _context3.abrupt("return",_context3.sent);case 3:case"end":return _context3.stop()}}),_callee3)}))),[isMicrophoneEnabled,mute,unmute]);return{unmute:unmute,mute:mute,toggle:toggle}};function useLocalVideo_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useLocalVideo_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useLocalVideo_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useLocalVideo_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function useScreenShare_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useScreenShare_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useScreenShare_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useScreenShare_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function MapToCallControlBarProps_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function MapToCallControlBarProps_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){MapToCallControlBarProps_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){MapToCallControlBarProps_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var MapToCallControlBarProps_MapToCallControlBarProps=function MapToCallControlBarProps(){var _useCallingContext=CallingProvider_useCallingContext(),videoDevicePermission=_useCallingContext.videoDevicePermission,audioDevicePermission=_useCallingContext.audioDevicePermission,videoDeviceInfo=_useCallingContext.videoDeviceInfo,_useCallContext=CallProvider_useCallContext(),localVideoStream=_useCallContext.localVideoStream,isLocalVideoOn=_useCallContext.isLocalVideoOn,isLocalVideoRendererBusy=_useCallContext.isLocalVideoRendererBusy,screenShareStream=_useCallContext.screenShareStream,isMicrophoneEnabled=_useCallContext.isMicrophoneEnabled,localScreenShareActive=_useCallContext.localScreenShareActive,_useMicrophone=useMicrophone_useMicrophone(),unmute=_useMicrophone.unmute,mute=_useMicrophone.mute,toggle=_useMicrophone.toggle,_useLocalVideo=function(){var _useCallContext=CallProvider_useCallContext(),call=_useCallContext.call,setLocalVideoStream=_useCallContext.setLocalVideoStream,isLocalVideoRendererBusy=_useCallContext.isLocalVideoRendererBusy,setLocalVideoRendererBusy=_useCallContext.setLocalVideoRendererBusy,setLocalVideoOn=_useCallContext.setLocalVideoOn;return{startLocalVideo:Object(react.useCallback)(function(){var _ref=useLocalVideo_asyncToGenerator(regeneratorRuntime.mark((function _callee(videoDeviceInfo){var stream;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!isLocalVideoRendererBusy){_context.next=2;break}throw new CommunicationUiError.a({message:"Failed to start local video: local video renderer is busy",code:CommunicationUiError.b.START_VIDEO_ERROR});case 2:if(stream=new sdk_bundle.LocalVideoStream(videoDeviceInfo),setLocalVideoRendererBusy(!0),_context.prev=4,!call||call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context.next=8;break}return _context.next=8,call.startVideo(stream);case 8:setLocalVideoRendererBusy(!1),setLocalVideoStream(stream),setLocalVideoOn(!0),_context.next=17;break;case 13:throw _context.prev=13,_context.t0=_context.catch(4),setLocalVideoRendererBusy(!1),new CommunicationUiError.a({message:"Failed to start local video",code:CommunicationUiError.b.START_VIDEO_ERROR,error:_context.t0});case 17:case"end":return _context.stop()}}),_callee,null,[[4,13]])})));return function(_x){return _ref.apply(this,arguments)}}(),[isLocalVideoRendererBusy,setLocalVideoRendererBusy,call,setLocalVideoStream,setLocalVideoOn]),stopLocalVideo:Object(react.useCallback)(function(){var _ref2=useLocalVideo_asyncToGenerator(regeneratorRuntime.mark((function _callee2(stream){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(stream&&!isLocalVideoRendererBusy){_context2.next=2;break}throw new CommunicationUiError.a({message:"Failed to stop local video: ".concat(stream?"local video renderer is busy":"stream is not valid"),code:CommunicationUiError.b.STOP_VIDEO_ERROR});case 2:if(setLocalVideoRendererBusy(!0),_context2.prev=3,!call||!call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context2.next=7;break}return _context2.next=7,null==call?void 0:call.stopVideo(stream);case 7:setLocalVideoRendererBusy(!1),setLocalVideoStream(void 0),setLocalVideoOn(!1),_context2.next=16;break;case 12:throw _context2.prev=12,_context2.t0=_context2.catch(3),setLocalVideoRendererBusy(!1),new CommunicationUiError.a({message:"Failed to stop local video",code:CommunicationUiError.b.STOP_VIDEO_ERROR,error:_context2.t0});case 16:case"end":return _context2.stop()}}),_callee2,null,[[3,12]])})));return function(_x2){return _ref2.apply(this,arguments)}}(),[isLocalVideoRendererBusy,setLocalVideoRendererBusy,call,setLocalVideoStream,setLocalVideoOn])}}(),startLocalVideo=_useLocalVideo.startLocalVideo,_stopLocalVideo=_useLocalVideo.stopLocalVideo,_useScreenShare=function(){var callAgent=CallingProvider_useCallingContext().callAgent,_useCallContext=CallProvider_useCallContext(),localScreenShareActive=_useCallContext.localScreenShareActive,setLocalScreenShare=_useCallContext.setLocalScreenShare,call=null==callAgent?void 0:callAgent.calls[0];Object(react.useEffect)((function(){var isScreenSharingOnChangedCallback=function isScreenSharingOnChangedCallback(){call&&setLocalScreenShare(call.isScreenSharingOn)};return null==call||call.on("isScreenSharingOnChanged",isScreenSharingOnChangedCallback),function(){null==call||call.off("isScreenSharingOnChanged",isScreenSharingOnChangedCallback)}}),[call,setLocalScreenShare]);var startScreenShare=Object(react.useCallback)(useScreenShare_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,null!=call&&call.isScreenSharingOn){_context.next=4;break}return _context.next=4,null==call?void 0:call.startScreenSharing();case 4:setLocalScreenShare(!0),_context.next=10;break;case 7:throw _context.prev=7,_context.t0=_context.catch(0),new CommunicationUiError.a({message:"Error starting screen share",code:CommunicationUiError.b.START_SCREEN_SHARE_ERROR,error:_context.t0});case 10:case"end":return _context.stop()}}),_callee,null,[[0,7]])}))),[call,setLocalScreenShare]),stopScreenShare=Object(react.useCallback)(useScreenShare_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_context2.prev=0,null==call||!call.isScreenSharingOn){_context2.next=4;break}return _context2.next=4,null==call?void 0:call.stopScreenSharing();case 4:setLocalScreenShare(!1),_context2.next=10;break;case 7:throw _context2.prev=7,_context2.t0=_context2.catch(0),new CommunicationUiError.a({message:"Error stopping screen share",code:CommunicationUiError.b.STOP_SCREEN_SHARE_ERROR,error:_context2.t0});case 10:case"end":return _context2.stop()}}),_callee2,null,[[0,7]])}))),[call,setLocalScreenShare]),toggleScreenShare=Object(react.useCallback)(useScreenShare_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,localScreenShareActive?stopScreenShare():startScreenShare();case 2:return _context3.abrupt("return",_context3.sent);case 3:case"end":return _context3.stop()}}),_callee3)}))),[localScreenShareActive,stopScreenShare,startScreenShare]);return{startScreenShare:startScreenShare,stopScreenShare:stopScreenShare,toggleScreenShare:toggleScreenShare}}(),startScreenShare=_useScreenShare.startScreenShare,stopScreenShare=_useScreenShare.stopScreenShare,toggleScreenShare=_useScreenShare.toggleScreenShare,isRemoteScreenShareActive=!!screenShareStream,leave=useGroupCall_useGroupCall().leave;useSubscribeToDevicePermission("Camera"),useSubscribeToDevicePermission("Microphone"),useSubscribeToVideoDeviceList();var _leaveCall,startLocalVideoInternal=Object(react.useCallback)((function(){if(videoDeviceInfo)return startLocalVideo(videoDeviceInfo);throw new types.CommunicationUiError({message:"Cannot start local video - no video device info",code:types.CommunicationUiErrorCode.START_VIDEO_ERROR})}),[startLocalVideo,videoDeviceInfo]),toggleLocalVideo=function(){var _ref=MapToCallControlBarProps_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,isLocalVideoOn?_stopLocalVideo(localVideoStream):startLocalVideoInternal();case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)})));return function toggleLocalVideo(){return _ref.apply(this,arguments)}}();return{isMicrophoneActive:isMicrophoneEnabled,unmuteMicrophone:unmute,muteMicrophone:mute,toggleMicrophone:toggle,localVideoEnabled:isLocalVideoOn,localVideoBusy:isLocalVideoRendererBusy,startLocalVideo:startLocalVideoInternal,stopLocalVideo:function stopLocalVideo(){return _stopLocalVideo(localVideoStream)},toggleLocalVideo:toggleLocalVideo,isLocalScreenShareActive:localScreenShareActive,isRemoteScreenShareActive:isRemoteScreenShareActive,startScreenShare:startScreenShare,stopScreenShare:stopScreenShare,toggleScreenShare:toggleScreenShare,cameraPermission:videoDevicePermission,micPermission:audioDevicePermission,leaveCall:(_leaveCall=MapToCallControlBarProps_asyncToGenerator(regeneratorRuntime.mark((function _callee2(hangupCallOptions){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,leave(hangupCallOptions);case 2:case"end":return _context2.stop()}}),_callee2)}))),function leaveCall(_x){return _leaveCall.apply(this,arguments)})}};function useSubscribeToAudioDeviceList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useSubscribeToAudioDeviceList_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useSubscribeToAudioDeviceList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useSubscribeToAudioDeviceList_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallControls_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CallControls_CallOptionsButton=function CallOptionsButton(props){var videoDeviceInfo=props.videoDeviceInfo,videoDeviceList=props.videoDeviceList,audioDeviceInfo=props.audioDeviceInfo,audioDeviceList=props.audioDeviceList,updateLocalVideoStream=props.updateLocalVideoStream,updateAudioDeviceInfo=props.updateAudioDeviceInfo,callOptionsMenu={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:videoDeviceList.map((function(item){return{key:item.id,text:item.name,title:item.name,canCheck:!0,isChecked:(null==videoDeviceInfo?void 0:videoDeviceInfo.id)===item.id,onClick:function onClick(){return updateLocalVideoStream(item)}}}))}},{key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:audioDeviceList.map((function(item){return{key:item.id,text:item.name,title:item.name,canCheck:!0,isChecked:(null==audioDeviceInfo?void 0:audioDeviceInfo.id)===item.id,onClick:function onClick(){return updateAudioDeviceInfo(item)}}}))}}]};return Object(jsx_runtime.jsx)(dist_esm.g,{menuProps:callOptionsMenu})};CallControls_CallOptionsButton.displayName="CallOptionsButton";var CallOptionsButtonComponent=ConnectContext_connectFuncsToContext(CallControls_CallOptionsButton,(function MapToLocalDeviceSettingsProps(){var _useCallingContext=CallingProvider_useCallingContext(),deviceManager=_useCallingContext.deviceManager,audioDeviceInfo=_useCallingContext.audioDeviceInfo,audioDeviceList=_useCallingContext.audioDeviceList,setAudioDeviceInfo=_useCallingContext.setAudioDeviceInfo,videoDeviceInfo=_useCallingContext.videoDeviceInfo,videoDeviceList=_useCallingContext.videoDeviceList,setVideoDeviceInfo=_useCallingContext.setVideoDeviceInfo,_useCallContext=CallProvider_useCallContext(),call=_useCallContext.call,localVideoStream=_useCallContext.localVideoStream,setLocalVideoStream=_useCallContext.setLocalVideoStream;useSubscribeToDevicePermission("Camera"),useSubscribeToDevicePermission("Microphone"),useSubscribeToVideoDeviceList(),function(){var _useCallingContext=CallingProvider_useCallingContext(),audioDevicePermission=_useCallingContext.audioDevicePermission,setAudioDeviceInfo=_useCallingContext.setAudioDeviceInfo,setAudioDeviceList=_useCallingContext.setAudioDeviceList,deviceManager=_useCallingContext.deviceManager;Object(react.useEffect)((function(){if(deviceManager&&"Granted"===audioDevicePermission){promptAudioDevices(deviceManager);var onAudioDevicesUpdated=function onAudioDevicesUpdated(){promptAudioDevices(deviceManager)};return deviceManager.on("audioDevicesUpdated",onAudioDevicesUpdated),function(){deviceManager.off("audioDevicesUpdated",onAudioDevicesUpdated)}}function promptAudioDevices(_x){return _promptAudioDevices.apply(this,arguments)}function _promptAudioDevices(){return(_promptAudioDevices=useSubscribeToAudioDeviceList_asyncToGenerator(regeneratorRuntime.mark((function _callee(deviceManager){var microphoneList;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,deviceManager.getMicrophones();case 2:microphoneList=_context.sent,setAudioDeviceList(microphoneList),microphoneList.length>0&&setAudioDeviceInfo(microphoneList[0]);case 5:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}}),[deviceManager,audioDevicePermission,setAudioDeviceInfo,setAudioDeviceList])}();var onErrorCallback=ErrorProvider_useTriggerOnErrorCallback();return{videoDeviceInfo:videoDeviceInfo,videoDeviceList:videoDeviceList,audioDeviceInfo:audioDeviceInfo,audioDeviceList:audioDeviceList,updateLocalVideoStream:function updateLocalVideoStream(source){if(setVideoDeviceInfo(source),localVideoStream){var newLocalVideoStream=new sdk_bundle.LocalVideoStream(source);setLocalVideoStream(newLocalVideoStream),null==call||call.localVideoStreams[0].switchSource(source).catch((function(error){var uiError=new CommunicationUiError.a({message:"Error switching local video source",code:CommunicationUiError.b.SWITCH_VIDEO_SOURCE_ERROR,error:error});Object(SDKUtils.d)(uiError,onErrorCallback)}))}},updateAudioDeviceInfo:function updateAudioDeviceInfo(source){source&&(setAudioDeviceInfo(source),null==deviceManager||deviceManager.selectMicrophone(source))}}})),CallControls_HangupButton=function HangupButton(props){var muteMicrophone=props.muteMicrophone,stopScreenShare=props.stopScreenShare,localVideoEnabled=props.localVideoEnabled,stopLocalVideo=props.stopLocalVideo,leaveCall=props.leaveCall,onEndCallClick=props.onEndCallClick,onErrorCallback=props.onErrorCallback,styles=props.styles,text=props.text,hangup=Object(react.useCallback)(CallControls_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,muteMicrophone();case 2:return _context.next=4,stopScreenShare();case 4:return _context.next=6,localVideoEnabled&&stopLocalVideo();case 6:return _context.next=8,leaveCall({forEveryone:!1});case 8:onEndCallClick();case 9:case"end":return _context.stop()}}),_callee)}))),[muteMicrophone,stopScreenShare,localVideoEnabled,stopLocalVideo,leaveCall,onEndCallClick]);return Object(jsx_runtime.jsx)(dist_esm.c,{checked:!1,onClick:function onClick(){hangup().catch((function(error){Object(utils.d)(error,onErrorCallback)}))},styles:styles,text:text})};CallControls_HangupButton.displayName="HangupButton";var HangupButtonComponent=ConnectContext_connectFuncsToContext(CallControls_HangupButton,MapToCallControlBarProps_MapToCallControlBarProps),CallControls_OutgoingCallControlBar=function OutgoingCallControlBar(props){var localVideoEnabled=props.localVideoEnabled,onEndCallClick=props.onEndCallClick,cameraPermission=props.cameraPermission,micPermission=props.micPermission,localVideoBusy=props.localVideoBusy,toggleLocalVideo=props.toggleLocalVideo,toggleMicrophone=props.toggleMicrophone,isMicrophoneActive=props.isMicrophoneActive,onErrorCallback=props.onErrorCallback,cameraDisabled="Denied"===cameraPermission,micDisabled="Denied"===micPermission;return Object(jsx_runtime.jsxs)(dist_esm.b,Object.assign({},props,{children:[Object(jsx_runtime.jsx)(dist_esm.a,{checked:localVideoEnabled,disabled:cameraDisabled||localVideoBusy,onClick:function onClick(){toggleLocalVideo().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}}),Object(jsx_runtime.jsx)(dist_esm.f,{checked:isMicrophoneActive,disabled:micDisabled,onClick:function onClick(){toggleMicrophone().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}}),Object(jsx_runtime.jsx)(CallOptionsButtonComponent,{}),Object(jsx_runtime.jsx)(HangupButtonComponent,{onEndCallClick:onEndCallClick})]}))};CallControls_OutgoingCallControlBar.displayName="OutgoingCallControlBar";var OutgoingCallControlBarComponent=ConnectContext_connectFuncsToContext(CallControls_OutgoingCallControlBar,MapToCallControlBarProps_MapToCallControlBarProps),CallControls_IncomingCallControlBar=function IncomingCallControlBar(props){var localVideoEnabled=props.localVideoEnabled,cameraPermission=props.cameraPermission,micPermission=props.micPermission,localVideoBusy=props.localVideoBusy,toggleLocalVideo=props.toggleLocalVideo,toggleMicrophone=props.toggleMicrophone,isMicrophoneActive=props.isMicrophoneActive,onErrorCallback=props.onErrorCallback,cameraDisabled="Denied"===cameraPermission,micDisabled="Denied"===micPermission;return Object(jsx_runtime.jsxs)(dist_esm.b,Object.assign({},props,{children:[Object(jsx_runtime.jsx)(dist_esm.a,{checked:localVideoEnabled,disabled:cameraDisabled||localVideoBusy,onClick:function onClick(){toggleLocalVideo().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}}),Object(jsx_runtime.jsx)(dist_esm.f,{checked:isMicrophoneActive,disabled:micDisabled,onClick:function onClick(){toggleMicrophone().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}}),Object(jsx_runtime.jsx)(CallOptionsButtonComponent,{})]}))};CallControls_IncomingCallControlBar.displayName="IncomingCallControlBar";ConnectContext_connectFuncsToContext(CallControls_IncomingCallControlBar,MapToCallControlBarProps_MapToCallControlBarProps);var CallControls_CallControlBar=function CallControlBar(props){var localVideoEnabled=props.localVideoEnabled,onEndCallClick=props.onEndCallClick,cameraPermission=props.cameraPermission,micPermission=props.micPermission,isRemoteScreenShareActive=props.isRemoteScreenShareActive,localVideoBusy=props.localVideoBusy,toggleLocalVideo=props.toggleLocalVideo,toggleMicrophone=props.toggleMicrophone,isMicrophoneActive=props.isMicrophoneActive,toggleScreenShare=props.toggleScreenShare,isLocalScreenShareActive=props.isLocalScreenShareActive,onErrorCallback=props.onErrorCallback,cameraDisabled="Denied"===cameraPermission,micDisabled="Denied"===micPermission,screenShareDisabled=isRemoteScreenShareActive;return Object(jsx_runtime.jsxs)(dist_esm.b,Object.assign({},props,{children:[Object(jsx_runtime.jsx)(dist_esm.a,{checked:localVideoEnabled,disabled:cameraDisabled||localVideoBusy,onClick:function onClick(){toggleLocalVideo().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}}),Object(jsx_runtime.jsx)(dist_esm.f,{checked:isMicrophoneActive,disabled:micDisabled,onClick:function onClick(){toggleMicrophone().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}}),isLocalScreenShareSupportedInBrowser()&&Object(jsx_runtime.jsx)(dist_esm.i,{checked:isLocalScreenShareActive,disabled:screenShareDisabled,onClick:function onClick(){toggleScreenShare().catch((function(error){Object(utils.d)(error,onErrorCallback)}))}}),Object(jsx_runtime.jsx)(CallOptionsButtonComponent,{}),Object(jsx_runtime.jsx)(HangupButtonComponent,{onEndCallClick:onEndCallClick})]}))};CallControls_CallControlBar.displayName="CallControlBar";var CallControlBarComponent=ConnectContext_connectFuncsToContext(CallControls_CallControlBar,MapToCallControlBarProps_MapToCallControlBarProps);CallControls_HangupButton.__docgenInfo={description:"",methods:[],displayName:"HangupButton",props:{styles:{required:!1,tsType:{name:"IButtonStyles"},description:""},text:{required:!1,tsType:{name:"string"},description:""}},composes:["CallControlBarContainerProps","ErrorHandlingProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/CallControls.tsx"]={name:"HangupButton",docgenInfo:CallControls_HangupButton.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/CallControls.tsx"}),CallControls_OutgoingCallControlBar.__docgenInfo={description:"",methods:[],displayName:"OutgoingCallControlBar",composes:["ControlBarProps","CallControlBarContainerProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/CallControls.tsx"]={name:"OutgoingCallControlBar",docgenInfo:CallControls_OutgoingCallControlBar.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/CallControls.tsx"}),CallControls_IncomingCallControlBar.__docgenInfo={description:"",methods:[],displayName:"IncomingCallControlBar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/CallControls.tsx"]={name:"IncomingCallControlBar",docgenInfo:CallControls_IncomingCallControlBar.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/CallControls.tsx"}),CallControls_CallControlBar.__docgenInfo={description:"An Azure Calling Services Call Control Bar with built in call handling.\n@param props - CallControlBarProps & ErrorHandlingProps & LocalDeviceSettingsContainerProps",methods:[],displayName:"CallControlBar",composes:["CallControlBarContainerProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/CallControls.tsx"]={name:"CallControlBar",docgenInfo:CallControls_CallControlBar.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/CallControls.tsx"});var mediaGallery1To1Style=Object(lib.G)({position:"relative",height:"100%",width:"100%"}),localMediaGalleryTileStyle=Object(lib.G)({width:"12rem",height:"7rem",marginTop:"-7.25rem",marginRight:".25rem",background:lib.c.neutralLighterAlt,border:"1px solid rgba(0,0,0,0.05)"}),remoteMediaGalleryTileStyle=Object(lib.G)({height:"100%",width:"100%",background:lib.c.neutralLighterAlt}),videoHint=Object(lib.G)({backgroundColor:lib.c.neutralSecondary,bottom:"5%",boxShadow:"0 0 1px 0 rgba(0,0,0,.5)",color:lib.c.neutralLighter,textAlign:"left",left:"2%",overflow:"hidden",position:"absolute",padding:"0.25rem",lineHeight:"1.4286rem",whiteSpace:"nowrap",maxWidth:"95%",borderRadius:4}),disabledVideoHint=Object(lib.G)(videoHint,{backgroundColor:"transparent",color:lib.c.neutralSecondary,boxShadow:"none"}),TypeConverter_convertSdkRemoteParticipantToGalleryParticipant=function convertSdkRemoteParticipantToGalleryParticipant(remoteParticipantFromSDK){var _remoteParticipantFro,identifier=getACSId(remoteParticipantFromSDK.identifier);return{userId:identifier,displayName:null!==(_remoteParticipantFro=remoteParticipantFromSDK.displayName)&&void 0!==_remoteParticipantFro?_remoteParticipantFro:identifier,videoStream:remoteParticipantFromSDK.videoStreams[0]}};function MapToMediaGallery1To1Props_slicedToArray(arr,i){return function MapToMediaGallery1To1Props_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MapToMediaGallery1To1Props_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MapToMediaGallery1To1Props_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MapToMediaGallery1To1Props_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MapToMediaGallery1To1Props_arrayLikeToArray(o,minLen)}(arr,i)||function MapToMediaGallery1To1Props_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MapToMediaGallery1To1Props_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MapToMediaGallery1To1Props_DisplayNameChangedSubscriber=function DisplayNameChangedSubscriber(participant,setRemoteParticipant){var _this=this;!function MapToMediaGallery1To1Props_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DisplayNameChangedSubscriber),this._participant=void 0,this._setRemoteParticipant=void 0,this.onDisplayNameChanged=function(){_this._setRemoteParticipant(TypeConverter_convertSdkRemoteParticipantToGalleryParticipant(_this._participant))},this.unsubscribe=function(){_this._participant.off("displayNameChanged",_this.onDisplayNameChanged)},this._participant=participant,this._setRemoteParticipant=setRemoteParticipant,this._participant.on("displayNameChanged",this.onDisplayNameChanged)};function useLocalVideoStreamRenderer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useLocalVideoStreamRenderer_slicedToArray(arr,i){return function useLocalVideoStreamRenderer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useLocalVideoStreamRenderer_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function useLocalVideoStreamRenderer_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useLocalVideoStreamRenderer_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useLocalVideoStreamRenderer_arrayLikeToArray(o,minLen)}(arr,i)||function useLocalVideoStreamRenderer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useLocalVideoStreamRenderer_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var useLocalVideoStreamRenderer=function(stream,rendererOptions){var onErrorCallback=ErrorProvider_useTriggerOnErrorCallback(),setLocalVideoRendererBusy=CallProvider_useCallContext().setLocalVideoRendererBusy,_useState2=useLocalVideoStreamRenderer_slicedToArray(Object(react.useState)(null),2),render=_useState2[0],setRender=_useState2[1],_useState4=useLocalVideoStreamRenderer_slicedToArray(Object(react.useState)(!1),2),isAvailable=_useState4[0],setIsAvailable=_useState4[1],options=useLocalVideoStreamRenderer_slicedToArray(Object(react.useState)(rendererOptions),1)[0],rendererViewRef=Object(react.useRef)(null),cleanUp=function cleanUp(){rendererViewRef.current&&rendererViewRef.current.dispose&&(rendererViewRef.current.dispose(),setRender(null))};return Object(react.useEffect)((function(){return stream?function(){var _ref=function useLocalVideoStreamRenderer_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useLocalVideoStreamRenderer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useLocalVideoStreamRenderer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(stream){var renderer;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setLocalVideoRendererBusy(!0),renderer=new sdk_bundle.VideoStreamRenderer(stream),_context.prev=2,_context.next=5,renderer.createView(options);case 5:rendererViewRef.current=_context.sent,_context.next=11;break;case 8:throw _context.prev=8,_context.t0=_context.catch(2),new CommunicationUiError.a({message:"Error rendering remove video",code:CommunicationUiError.b.RENDER_LOCAL_VIDEO_ERROR,error:_context.t0});case 11:setRender(rendererViewRef.current.target),setIsAvailable(!0),setLocalVideoRendererBusy(!1);case 14:case"end":return _context.stop()}}),_callee,null,[[2,8]])})));return function renderStream(_x){return _ref.apply(this,arguments)}}()(stream).catch((function(error){Object(SDKUtils.d)(error,onErrorCallback)})):(cleanUp(),setIsAvailable(!1)),cleanUp}),[stream,options,setLocalVideoRendererBusy,onErrorCallback]),{render:render,isAvailable:isAvailable}};function useRemoteVideoStreamRenderer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useRemoteVideoStreamRenderer_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useRemoteVideoStreamRenderer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useRemoteVideoStreamRenderer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function useRemoteVideoStreamRenderer_slicedToArray(arr,i){return function useRemoteVideoStreamRenderer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useRemoteVideoStreamRenderer_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function useRemoteVideoStreamRenderer_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useRemoteVideoStreamRenderer_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useRemoteVideoStreamRenderer_arrayLikeToArray(o,minLen)}(arr,i)||function useRemoteVideoStreamRenderer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useRemoteVideoStreamRenderer_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MapToVideoProps_MapToLocalVideoProps=function MapToLocalVideoProps(ownProps){var _ownProps$scalingMode2,_useLocalVideoStreamR=useLocalVideoStreamRenderer(ownProps.stream,{scalingMode:null!==(_ownProps$scalingMode2=ownProps.scalingMode)&&void 0!==_ownProps$scalingMode2?_ownProps$scalingMode2:"Crop"});return{isVideoReady:_useLocalVideoStreamR.isAvailable,videoStreamElement:_useLocalVideoStreamR.render}},RemoteVideoTile_RemoteVideoTileComponentBase=function RemoteVideoTileComponentBase(props){var displayName=props.displayName,isVideoReady=props.isVideoReady,videoStreamElement=props.videoStreamElement;return Object(jsx_runtime.jsx)(dist_esm.n,{isVideoReady:isVideoReady,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:videoStreamElement}),displayName:displayName,styles:{displayNameContainer:isVideoReady?videoHint:disabledVideoHint}})};RemoteVideoTile_RemoteVideoTileComponentBase.displayName="RemoteVideoTileComponentBase";var RemoteVideoTile=ConnectContext_connectFuncsToContext((function RemoteVideoTileComponent(props){return WithErrorHandling_WithErrorHandling(RemoteVideoTile_RemoteVideoTileComponentBase,props)}),(function MapToRemoteVideoProps(ownProps){var _ownProps$scalingMode,_useRemoteVideoStream=function(stream,options){var onErrorCallback=ErrorProvider_useTriggerOnErrorCallback(),_useState2=useRemoteVideoStreamRenderer_slicedToArray(Object(react.useState)(null),2),render=_useState2[0],setRender=_useState2[1],_useState4=useRemoteVideoStreamRenderer_slicedToArray(Object(react.useState)(!1),2),isAvailable=_useState4[0],setIsAvailable=_useState4[1],rendererViewRef=Object(react.useRef)(null);return Object(react.useEffect)((function(){var renderStream=function(){var _ref=useRemoteVideoStreamRenderer_asyncToGenerator(regeneratorRuntime.mark((function _callee(stream,renderViewRef){var renderer;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(stream||(setRender(null),setIsAvailable(!1)),!stream||!stream.isAvailable){_context.next=17;break}if(null!==render){_context.next=14;break}return renderer=new sdk_bundle.VideoStreamRenderer(stream),_context.prev=4,_context.next=7,renderer.createView(options);case 7:renderViewRef=_context.sent,_context.next=13;break;case 10:throw _context.prev=10,_context.t0=_context.catch(4),new CommunicationUiError.a({message:"Error rendering remove video",code:CommunicationUiError.b.RENDER_REMOTE_VIDEO_ERROR,error:_context.t0});case 13:setRender(renderViewRef.target);case 14:setIsAvailable(!0),_context.next=19;break;case 17:rendererViewRef.current&&(rendererViewRef.current.dispose(),setRender(null)),setIsAvailable(!1);case 19:case"end":return _context.stop()}}),_callee,null,[[4,10]])})));return function renderStream(_x,_x2){return _ref.apply(this,arguments)}}();stream||(setRender(null),setIsAvailable(!1)),null!=stream&&stream.isAvailable&&renderStream(stream,rendererViewRef.current).catch((function(error){Object(SDKUtils.d)(error,onErrorCallback)}));var onAvailabilityChanged=function(){var _ref2=useRemoteVideoStreamRenderer_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,renderStream(stream,rendererViewRef.current);case 3:_context2.next=8;break;case 5:_context2.prev=5,_context2.t0=_context2.catch(0),Object(SDKUtils.d)(_context2.t0,onErrorCallback);case 8:case"end":return _context2.stop()}}),_callee2,null,[[0,5]])})));return function onAvailabilityChanged(){return _ref2.apply(this,arguments)}}();return null==stream||stream.on("isAvailableChanged",onAvailabilityChanged),function(){null==stream||stream.off("isAvailableChanged",onAvailabilityChanged)}}),[stream,options,render,rendererViewRef,onErrorCallback]),{render:render,isAvailable:isAvailable}}(ownProps.stream,{scalingMode:null!==(_ownProps$scalingMode=ownProps.scalingMode)&&void 0!==_ownProps$scalingMode?_ownProps$scalingMode:"Crop"}),render=_useRemoteVideoStream.render;return{isVideoReady:_useRemoteVideoStream.isAvailable,videoStreamElement:render}})),MediaGallery1To1_MediaGallery1To1Component=function MediaGallery1To1Component(props){var localParticipantDisplayName=props.localParticipantDisplayName,showLocalParticipantName=props.showLocalParticipantName,remoteVideoScalingMode=props.remoteVideoScalingMode,localVideoScalingMode=props.localVideoScalingMode,remoteParticipant=props.remoteParticipant,localVideoInverted=props.localVideoInverted,localVideoStream=props.localVideoStream,remoteParticipantDisplayName=null==remoteParticipant?void 0:remoteParticipant.displayName,stream=null==remoteParticipant?void 0:remoteParticipant.videoStream,_MapToLocalVideoProps=MapToVideoProps_MapToLocalVideoProps({stream:localVideoStream,scalingMode:null!=localVideoScalingMode?localVideoScalingMode:"Crop"}),isLocalVideoReady=_MapToLocalVideoProps.isVideoReady,localVideoStreamElement=_MapToLocalVideoProps.videoStreamElement,mediaGalleryRemoteParticipant=Object(jsx_runtime.jsx)(Stack.a,{className:remoteMediaGalleryTileStyle,children:Object(jsx_runtime.jsx)(RemoteVideoTile,{stream:stream,scalingMode:null!=remoteVideoScalingMode?remoteVideoScalingMode:"Crop",displayName:remoteParticipantDisplayName})}),mediaGalleryLocalParticipant=Object(jsx_runtime.jsx)(Stack.a.Item,{align:"end",children:Object(jsx_runtime.jsx)(Stack.a,{className:localMediaGalleryTileStyle,children:Object(jsx_runtime.jsx)(dist_esm.n,{isVideoReady:isLocalVideoReady,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:localVideoStreamElement}),displayName:localParticipantDisplayName,showDisplayName:showLocalParticipantName,styles:{displayNameContainer:isLocalVideoReady?videoHint:disabledVideoHint},isMirrored:localVideoInverted})})});return Object(jsx_runtime.jsxs)(Stack.a,{className:mediaGallery1To1Style,children:[mediaGalleryRemoteParticipant,mediaGalleryLocalParticipant]})};MediaGallery1To1_MediaGallery1To1Component.displayName="MediaGallery1To1Component";var MediaGallery1To1=ConnectContext_connectFuncsToContext(MediaGallery1To1_MediaGallery1To1Component,(function MapToMediaGallery1To1Props(){var _useCallContext=CallProvider_useCallContext(),call=_useCallContext.call,localVideoStream=_useCallContext.localVideoStream,displayName=CallingProvider_useCallingContext().displayName,_useState2=MapToMediaGallery1To1Props_slicedToArray(Object(react.useState)(),2),remoteParticipant=_useState2[0],setRemoteParticipant=_useState2[1],displayNameChangedSubscriber=Object(react.useRef)(void 0);return Object(react.useEffect)((function(){return call&&call.remoteParticipants.length>0&&(setRemoteParticipant(TypeConverter_convertSdkRemoteParticipantToGalleryParticipant(call.remoteParticipants[0])),displayNameChangedSubscriber.current=new MapToMediaGallery1To1Props_DisplayNameChangedSubscriber(call.remoteParticipants[0],setRemoteParticipant)),function(){displayNameChangedSubscriber.current&&displayNameChangedSubscriber.current.unsubscribe()}}),[call]),{localParticipantDisplayName:displayName,remoteParticipant:remoteParticipant,localVideoStream:localVideoStream}}));MediaGallery1To1_MediaGallery1To1Component.__docgenInfo={description:"",methods:[],displayName:"MediaGallery1To1Component",props:{remoteParticipant:{required:!0,tsType:{name:"union",raw:"GalleryParticipant | undefined",elements:[{name:"GalleryParticipant"},{name:"undefined"}]},description:"Determines the remote participant in the media gallery."},localParticipantDisplayName:{required:!1,tsType:{name:"string"},description:"Determines the local participant label/avatar."},showLocalParticipantName:{required:!1,tsType:{name:"boolean"},description:"Show local participant label"},localVideoScalingMode:{required:!1,tsType:{name:"ScalingMode"},description:"Optional property to set the local media gallery tile scaling mode."},localVideoInverted:{required:!1,tsType:{name:"boolean"},description:"Optional property for inverting(mirroring) local video"},remoteVideoScalingMode:{required:!1,tsType:{name:"ScalingMode"},description:"Optional property to set the remote media gallery tile scaling mode."}},composes:["MediaGallery1To1ContainerProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/MediaGallery1To1.tsx"]={name:"MediaGallery1To1Component",docgenInfo:MediaGallery1To1_MediaGallery1To1Component.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/MediaGallery1To1.tsx"});var OutgoingCallScreen_renderEmptyPlaceholder=function renderEmptyPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},OutgoingCallScreen_OutgoingCallScreen=function OutgoingCallScreen(props){var callState=props.callState,endCallHandler=props.endCallHandler,_useCallContext=CallProvider_useCallContext(),localVideoStream=_useCallContext.localVideoStream,isLocalVideoOn=_useCallContext.isLocalVideoOn,isMicrophoneEnabled=_useCallContext.isMicrophoneEnabled,_useCallingContext=CallingProvider_useCallingContext(),videoDeviceInfo=_useCallingContext.videoDeviceInfo,audioDeviceInfo=_useCallingContext.audioDeviceInfo,unmute=useMicrophone_useMicrophone().unmute,_MapToCallControlBarP=MapToCallControlBarProps_MapToCallControlBarProps(),startLocalVideo=_MapToCallControlBarP.startLocalVideo,stopLocalVideo=_MapToCallControlBarP.stopLocalVideo,_MapToLocalVideoProps=MapToVideoProps_MapToLocalVideoProps({stream:localVideoStream,scalingMode:"Crop"}),isVideoReady=_MapToLocalVideoProps.isVideoReady,videoStreamElement=_MapToLocalVideoProps.videoStreamElement;return Object(react.useEffect)((function(){isMicrophoneEnabled&&audioDeviceInfo&&unmute()}),[audioDeviceInfo]),Object(react.useEffect)((function(){return isLocalVideoOn&&videoDeviceInfo&&startLocalVideo(),function(){isVideoReady&&stopLocalVideo()}}),[videoDeviceInfo]),Object(jsx_runtime.jsx)(dist_esm.n,{styles:{root:{height:"100%",width:"100%"},videoContainer:{zIndex:-1}},renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:videoStreamElement}),isVideoReady:isVideoReady,onRenderPlaceholder:OutgoingCallScreen_renderEmptyPlaceholder,children:Object(jsx_runtime.jsxs)(Stack.a,{style:{width:"100%",height:"100%",background:"rgb(0, 0, 0, 0.5)"},children:[Object(jsx_runtime.jsxs)("p",{style:{fontSize:"1.75rem",margin:"auto",color:"white",fontWeight:500},children:[callState,"..."]}),Object(jsx_runtime.jsx)(OutgoingCallControlBarComponent,{layout:"floatingBottom",styles:{root:{background:"white"}},onEndCallClick:endCallHandler})]})})};OutgoingCallScreen_OutgoingCallScreen.displayName="OutgoingCallScreen",OutgoingCallScreen_OutgoingCallScreen.__docgenInfo={description:"",methods:[],displayName:"OutgoingCallScreen",props:{callState:{required:!0,tsType:{name:"string"},description:""},endCallHandler:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/OutgoingCallScreen.tsx"]={name:"OutgoingCallScreen",docgenInfo:OutgoingCallScreen_OutgoingCallScreen.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/OutgoingCallScreen.tsx"});var PermissionsBanner_styles=__webpack_require__(279),PermissionsBanner=__webpack_require__(416),CallScreen_CallScreenComponent=function CallScreenComponent(props){var callState=props.callState,isCallInitialized=props.isCallInitialized,screenShareStream=props.screenShareStream,isLocalScreenSharingOn=props.isLocalScreenSharingOn,endCallHandler=props.endCallHandler,callFailedHandler=props.callFailedHandler,context=Object(react.useContext)(CallingContext),deviceAccess=Object(react.useMemo)((function(){return context?{cameraPermissionGranted:"Granted"===context.videoDevicePermission||"Denied"!==context.videoDevicePermission&&void 0,microphonePermissionGranted:"Granted"===context.audioDevicePermission||"Denied"!==context.audioDevicePermission&&void 0}:{cameraPermissionGranted:void 0,microphonePermissionGranted:void 0}}),[context]);return Object(react.useEffect)((function(){callState&&"Disconnected"!==callState||callFailedHandler()}),[callState,callFailedHandler]),isCallInitialized&&"None"!==callState&&"Connecting"!==callState&&"Ringing"!==callState?Object(jsx_runtime.jsxs)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:containerStyles,children:[Object(jsx_runtime.jsx)(CallControlBarComponent,{layout:"floatingBottom",styles:{root:{background:"white"}},onEndCallClick:endCallHandler}),Object(jsx_runtime.jsx)(Stack.a.Item,{style:PermissionsBanner_styles.a,children:Object(jsx_runtime.jsx)(PermissionsBanner.a,Object.assign({},deviceAccess))}),Object(jsx_runtime.jsx)(Stack.a.Item,{styles:containerStyles,children:isLocalScreenSharingOn?Object(jsx_runtime.jsx)("div",{className:loadingStyle,children:Object(jsx_runtime.jsx)(Label.a,{children:"Your screen is being shared"})}):"Connected"===callState&&Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,styles:containerStyles,children:screenShareStream?Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,styles:activeContainerClassName,children:Object(jsx_runtime.jsx)(MediaFullScreen,{activeScreenShareStream:screenShareStream})}):Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,styles:activeContainerClassName,children:Object(jsx_runtime.jsx)(MediaGallery1To1,{showLocalParticipantName:!1})})})})]}):Object(jsx_runtime.jsx)(OutgoingCallScreen_OutgoingCallScreen,{callState:callState,endCallHandler:endCallHandler})};CallScreen_CallScreenComponent.displayName="CallScreenComponent",CallScreen_CallScreenComponent.__docgenInfo={description:"",methods:[],displayName:"CallScreenComponent",props:{screenWidth:{required:!0,tsType:{name:"number"},description:""}},composes:["CallContainerProps"]};var CallScreen=ConnectContext_connectFuncsToContext(CallScreen_CallScreenComponent,(function MapToOneToOneCallProps(){var _useCallingContext=CallingProvider_useCallingContext(),callAgent=_useCallingContext.callAgent,deviceManager=_useCallingContext.deviceManager,_useCallContext=CallProvider_useCallContext();return{isCallInitialized:!(!callAgent||!deviceManager),callState:_useCallContext.callState,screenShareStream:_useCallContext.screenShareStream,isLocalScreenSharingOn:_useCallContext.localScreenShareActive,leaveCall:useOutgoingCall_useOutgoingCall().endCall}}));"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/CallScreen.tsx"]={name:"CallScreenComponent",docgenInfo:CallScreen_CallScreenComponent.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/CallScreen.tsx"});var PrimaryButton=__webpack_require__(1815),CallEndScreen_CallEndScreen=function CallEndScreen(props){var acknowledgeCallback=props.acknowledgeCallback;return Object(jsx_runtime.jsxs)(Stack.a,{className:mainContainerStyle,horizontalAlign:"center",verticalAlign:"center",children:["Call Ended",Object(jsx_runtime.jsx)(PrimaryButton.a,{className:buttonStyle,onClick:acknowledgeCallback,children:"Call again!"})]})};CallEndScreen_CallEndScreen.displayName="CallEndScreen",CallEndScreen_CallEndScreen.__docgenInfo={description:"",methods:[],displayName:"CallEndScreen"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/CallEndScreen.tsx"]={name:"CallEndScreen",docgenInfo:CallEndScreen_CallEndScreen.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/CallEndScreen.tsx"});var Persona=__webpack_require__(1852),Persona_types=__webpack_require__(26),DialogContent_types=__webpack_require__(242),Dialog=__webpack_require__(1854),DialogFooter=__webpack_require__(828),useTheme=__webpack_require__(402),CallEndIcon=__webpack_require__(1831),CallVideoIcon=__webpack_require__(1829),CallVideoOffIcon=__webpack_require__(1830),IncomingCallAlerts_styles_theme=Object(lib.B)(),IncomingCallAlerts_styles_palette=IncomingCallAlerts_styles_theme.palette,incomingCallToastStyle=Object(lib.G)({minWidth:"20rem",width:"100%",height:"100%",backgroundColor:IncomingCallAlerts_styles_palette.whiteTranslucent40,opacity:.95,borderRadius:"0.5rem",boxShadow:IncomingCallAlerts_styles_theme.effects.elevation8,padding:"1rem"}),incomingCallToastAvatarContainerStyle=Object(lib.G)({marginRight:"0.5rem"}),incomingCallAcceptButtonStyle=Object(lib.G)({backgroundColor:IncomingCallAlerts_styles_palette.greenDark,color:IncomingCallAlerts_styles_palette.white,borderRadius:"2rem",minWidth:"2rem",width:"2rem",border:"none",":hover, :active":{backgroundColor:IncomingCallAlerts_styles_palette.green,color:IncomingCallAlerts_styles_palette.white}}),incomingCallRejectButtonStyle=Object(lib.G)({backgroundColor:IncomingCallAlerts_styles_palette.redDark,color:IncomingCallAlerts_styles_palette.white,borderRadius:"2rem",minWidth:"2rem",width:"2rem",border:"none",":hover, :active":{backgroundColor:IncomingCallAlerts_styles_palette.red,color:IncomingCallAlerts_styles_palette.white}}),incomingCallModalContainerStyle={borderRadius:"0.75rem"},incomingCallModalLocalPreviewStyle=Object(lib.G)({height:"10rem",background:IncomingCallAlerts_styles_palette.neutralLighterAlt,margin:"1.5rem 0",borderRadius:"0.25rem","& video":{borderRadius:"0.25rem"}}),useBoolean=__webpack_require__(1843);function IncomingCallAlerts_slicedToArray(arr,i){return function IncomingCallAlerts_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function IncomingCallAlerts_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function IncomingCallAlerts_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return IncomingCallAlerts_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IncomingCallAlerts_arrayLikeToArray(o,minLen)}(arr,i)||function IncomingCallAlerts_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IncomingCallAlerts_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var IncomingCallAlerts_IncomingCallToast=function IncomingCallToast(props){var callerName=props.callerName,alertText=props.alertText,avatar=props.avatar,onClickAccept=props.onClickAccept,onClickReject=props.onClickReject;return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalAlign:"center",className:incomingCallToastStyle,children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",className:incomingCallToastAvatarContainerStyle,children:Object(jsx_runtime.jsx)(Persona.a,{imageUrl:avatar,text:callerName,size:Persona_types.c.size40,hidePersonaDetails:!0,"aria-label":callerName})}),Object(jsx_runtime.jsxs)(Stack.a,{grow:1,horizontalAlign:"center",style:{alignItems:"flex-start",fontFamily:"Segoe UI"},children:[Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.875rem"},children:Object(jsx_runtime.jsx)("b",{children:null!=callerName?callerName:"No display name"})}),Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.75rem"},children:Object(jsx_runtime.jsx)("span",{children:null!=alertText?alertText:"Incoming call"})})]}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:10},children:[Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickReject()},className:incomingCallRejectButtonStyle,children:Object(jsx_runtime.jsx)(CallEndIcon.a,{size:"medium"})}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickAccept()},className:incomingCallAcceptButtonStyle,children:Object(jsx_runtime.jsx)(CallIcon.a,{size:"medium"})})]})]})};IncomingCallAlerts_IncomingCallToast.displayName="IncomingCallToast";var IncomingCallAlerts_IncomingCallModal=function IncomingCallModal(props){var alertText=props.alertText,avatar=props.avatar,callerName=props.callerName,callerNameAlt=props.callerNameAlt,callerTitle=props.callerTitle,localParticipantDisplayName=props.localParticipantDisplayName,localVideoInverted=props.localVideoInverted,onClickAccept=props.onClickAccept,onClickReject=props.onClickReject,onClickVideoToggle=props.onClickVideoToggle,showLocalVideo=props.showLocalVideo,localVideoStreamElement=props.localVideoStreamElement,palette=Object(useTheme.a)().palette,_useBoolean2=IncomingCallAlerts_slicedToArray(Object(useBoolean.a)(!1),2),hideDialog=_useBoolean2[0],toggleHideDialog=_useBoolean2[1].toggle,dialogContentProps={type:DialogContent_types.a.normal,title:null!=alertText?alertText:"Incoming Video Call"},mediaGalleryLocalParticipant=Object(jsx_runtime.jsx)(dist_esm.n,{isVideoReady:showLocalVideo,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:localVideoStreamElement}),displayName:localParticipantDisplayName,isMirrored:localVideoInverted});return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsxs)(Dialog.a,{hidden:hideDialog,onDismiss:toggleHideDialog,dialogContentProps:dialogContentProps,modalProps:{isBlocking:!0,styles:{main:incomingCallModalContainerStyle}},children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",style:{marginRight:"0.5rem"},children:Object(jsx_runtime.jsx)(Persona.a,{imageUrl:avatar,text:callerName,size:Persona_types.c.size40,hidePersonaDetails:!0,"aria-label":callerName})}),Object(jsx_runtime.jsxs)(Stack.a,{grow:1,horizontalAlign:"center",style:{alignItems:"flex-start"},children:[Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.875rem",color:palette.black,fontWeight:"bold"},children:Object(jsx_runtime.jsxs)("span",{children:[null!=callerName?callerName:"No display name",callerNameAlt?Object(jsx_runtime.jsxs)("span",{style:{opacity:.5,marginLeft:"0.2rem"},children:[" • ",callerNameAlt]}):null]})}),Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.75rem",color:palette.neutralDark},children:Object(jsx_runtime.jsx)("span",{children:null!=callerTitle?callerTitle:""})})]})]}),showLocalVideo?Object(jsx_runtime.jsx)(Stack.a,{className:incomingCallModalLocalPreviewStyle,children:mediaGalleryLocalParticipant}):null,Object(jsx_runtime.jsxs)(DialogFooter.a,{children:[Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickVideoToggle()},style:{background:palette.neutralLighterAlt,border:"none"},children:showLocalVideo?Object(jsx_runtime.jsx)(CallVideoIcon.a,{size:"small"}):Object(jsx_runtime.jsx)(CallVideoOffIcon.a,{size:"small"})}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickAccept()},text:"Accept",style:{background:palette.green,border:"none"}}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickReject()},text:"Decline",style:{background:palette.redDark,border:"none"}})]})]})})};IncomingCallAlerts_IncomingCallToast.__docgenInfo={description:"",methods:[],displayName:"IncomingCallToast",props:{callerName:{required:!1,tsType:{name:"string"},description:"Caller's Name"},alertText:{required:!1,tsType:{name:"string"},description:'Alert Text. For example "incoming vido call..."'},avatar:{required:!1,tsType:{name:"string"},description:"Caller's Avatar/Profile Image"},onClickAccept:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Accept Button is clicked"},onClickReject:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Reject Button is clicked"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/IncomingCallAlerts.tsx"]={name:"IncomingCallToast",docgenInfo:IncomingCallAlerts_IncomingCallToast.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/IncomingCallAlerts.tsx"}),IncomingCallAlerts_IncomingCallModal.__docgenInfo={description:"",methods:[],displayName:"IncomingCallModal",props:{callerName:{required:!1,tsType:{name:"string"},description:"Caller's Name"},alertText:{required:!1,tsType:{name:"string"},description:'Alert Text. For example "incoming vido call..."'},avatar:{required:!1,tsType:{name:"string"},description:"Caller's Avatar/Profile Image"},onClickAccept:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Accept Button is clicked"},onClickReject:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Reject Button is clicked"},callerNameAlt:{required:!1,tsType:{name:"string"},description:"Text to the right of a Caller's Name"},callerTitle:{required:!1,tsType:{name:"string"},description:"A Caller's subtitle. Displayed right below the callers name"},localParticipantDisplayName:{required:!1,tsType:{name:"string"},description:"Receiver's Name"},localVideoInverted:{required:!1,tsType:{name:"boolean"},description:"If set to `true`, mirrors the local video preview of the receiver"},showLocalVideo:{required:!1,tsType:{name:"boolean"},description:"Toggle local video preview on or off"},localVideoStreamElement:{required:!0,tsType:{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]},description:"Local Video Stream Element. An HTML Element containing a video stream."},onClickVideoToggle:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Video Toggle Button is clicked"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/IncomingCallAlerts.tsx"]={name:"IncomingCallModal",docgenInfo:IncomingCallAlerts_IncomingCallModal.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/IncomingCallAlerts.tsx"});__webpack_require__(50);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return IncomingCallsProvider_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||IncomingCallsProvider_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IncomingCallsProvider_slicedToArray(arr,i){return function IncomingCallsProvider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function IncomingCallsProvider_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||IncomingCallsProvider_unsupportedIterableToArray(arr,i)||function IncomingCallsProvider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IncomingCallsProvider_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return IncomingCallsProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IncomingCallsProvider_arrayLikeToArray(o,minLen):void 0}}function IncomingCallsProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var IncomingCallsContext=Object(react.createContext)(void 0),IncomingCallsProvider_IncomingCallsProvider=function IncomingCallsProvider(props){var _useState2=IncomingCallsProvider_slicedToArray(Object(react.useState)([]),2),incomingCalls=_useState2[0],setIncomingCalls=_useState2[1],callAgent=CallingProvider_useCallingContext().callAgent;return Object(react.useEffect)((function(){var onIncomingCall=function onIncomingCall(incomingCallEvent){setIncomingCalls([].concat(_toConsumableArray(incomingCalls),[incomingCallEvent.incomingCall]));incomingCallEvent.incomingCall.on("callEnded",(function onIncomingCallEnded(){var _step,incomingCallWithEndedOneRemoved=[],_iterator=function IncomingCallsProvider_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=IncomingCallsProvider_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(incomingCalls);try{for(_iterator.s();!(_step=_iterator.n()).done;){var incomingCall=_step.value;incomingCall!==incomingCallEvent.incomingCall&&incomingCallWithEndedOneRemoved.push(incomingCall)}}catch(err){_iterator.e(err)}finally{_iterator.f()}setIncomingCalls(incomingCallWithEndedOneRemoved)}))};return null==callAgent||callAgent.on("incomingCall",onIncomingCall),function(){return null==callAgent?void 0:callAgent.off("incomingCall",onIncomingCall)}}),[callAgent,incomingCalls]),Object(jsx_runtime.jsx)(IncomingCallsContext.Provider,{value:{incomingCalls:incomingCalls,setIncomingCalls:setIncomingCalls},children:props.children})};IncomingCallsProvider_IncomingCallsProvider.displayName="IncomingCallsProvider";function useIncomingCall_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function useIncomingCall_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useIncomingCall_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useIncomingCall_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function useIncomingCall_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function useIncomingCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useIncomingCall_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useIncomingCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useIncomingCall_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}IncomingCallsProvider_IncomingCallsProvider.__docgenInfo={description:"",methods:[],displayName:"IncomingCallsProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/providers/IncomingCallsProvider.tsx"]={name:"IncomingCallsProvider",docgenInfo:IncomingCallsProvider_IncomingCallsProvider.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/providers/IncomingCallsProvider.tsx"});var useIncomingCall_useIncomingCall=function useIncomingCall(){var _useIncomingCallsCont=function useIncomingCallsContext(){return ValidContext_useValidContext(IncomingCallsContext)}(),incomingCalls=_useIncomingCallsCont.incomingCalls,setIncomingCalls=_useIncomingCallsCont.setIncomingCalls,_useCallContext=CallProvider_useCallContext(),setCall=_useCallContext.setCall,localVideoStream=_useCallContext.localVideoStream,setScreenShareStream=_useCallContext.setScreenShareStream,screenShareStream=_useCallContext.screenShareStream;return{accept:function(){var _ref=useIncomingCall_asyncToGenerator(regeneratorRuntime.mark((function _callee(incomingCall,acceptCallOptions){var videoOptions,call,incomingCallsFiltered,_iterator,_step,incomingCallCandidate;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(incomingCall){_context.next=2;break}throw new Error("incomingCall is null or undefined");case 2:return videoOptions=(null==acceptCallOptions?void 0:acceptCallOptions.videoOptions)||{localVideoStreams:localVideoStream?[localVideoStream]:void 0},_context.next=5,incomingCall.accept({videoOptions:videoOptions});case 5:call=_context.sent,setCall(call),incomingCallsFiltered=[],_iterator=useIncomingCall_createForOfIteratorHelper(incomingCalls);try{for(_iterator.s();!(_step=_iterator.n()).done;)(incomingCallCandidate=_step.value)!==incomingCall&&incomingCallsFiltered.push(incomingCallCandidate)}catch(err){_iterator.e(err)}finally{_iterator.f()}setIncomingCalls(incomingCallsFiltered),call.remoteParticipants.forEach((function(participant){participant.on("videoStreamsUpdated",(function(e){e.added.forEach((function(addedStream){"Video"!==addedStream.mediaStreamType&&(addedStream.on("isAvailableChanged",(function(){var _screenShareStream$st;addedStream.isAvailable?setScreenShareStream({stream:addedStream,user:participant}):screenShareStream&&(null==screenShareStream||null===(_screenShareStream$st=screenShareStream.stream)||void 0===_screenShareStream$st?void 0:_screenShareStream$st.id)!==addedStream.id||setScreenShareStream(void 0)})),addedStream.isAvailable&&setScreenShareStream({stream:addedStream,user:participant}))}))}))}));case 12:case"end":return _context.stop()}}),_callee)})));return function accept(_x,_x2){return _ref.apply(this,arguments)}}(),reject:function(){var _ref2=useIncomingCall_asyncToGenerator(regeneratorRuntime.mark((function _callee2(incomingCall){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(incomingCall){_context2.next=2;break}throw new Error("incomingCall is null or undefined");case 2:return _context2.next=4,incomingCall.reject();case 4:case"end":return _context2.stop()}}),_callee2)})));return function reject(_x3){return _ref2.apply(this,arguments)}}(),incomingCalls:incomingCalls}};function CallListener_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallListener_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallListener_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallListener_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CallListener_slicedToArray(arr,i){return function CallListener_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallListener_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallListener_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallListener_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallListener_arrayLikeToArray(o,minLen)}(arr,i)||function CallListener_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallListener_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallListener_IncomingCallAlertACSWrapper=function IncomingCallAlertACSWrapper(props){var call=props.call,_useState2=CallListener_slicedToArray(Object(react.useState)(void 0),2),callerName=_useState2[0],setCallerName=_useState2[1];return Object(react.useEffect)((function(){setCallerName(call.callerInfo.displayName)}),[call]),Object(jsx_runtime.jsx)(IncomingCallAlerts_IncomingCallToast,Object.assign({},props,{callerName:callerName}))};CallListener_IncomingCallAlertACSWrapper.displayName="IncomingCallAlertACSWrapper";var CallListener_IncomingCallContainer=function IncomingCallContainer(props){var _useIncomingCall=useIncomingCall_useIncomingCall(),accept=_useIncomingCall.accept,reject=_useIncomingCall.reject,incomingCalls=_useIncomingCall.incomingCalls,unmute=useMicrophone_useMicrophone().unmute;return incomingCalls&&incomingCalls.length>0?Object(jsx_runtime.jsx)(Stack.a,{children:incomingCalls.map((function(call){return Object(jsx_runtime.jsx)("div",{style:{marginTop:"8px",marginBottom:"8px"},children:Object(jsx_runtime.jsx)(CallListener_IncomingCallAlertACSWrapper,{call:call,onClickReject:CallListener_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,reject(call);case 2:props.onIncomingCallRejected&&props.onIncomingCallRejected();case 3:case"end":return _context.stop()}}),_callee)}))),onClickAccept:CallListener_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,accept(call);case 2:return _context2.next=4,unmute();case 4:props.onIncomingCallAccepted&&props.onIncomingCallAccepted();case 5:case"end":return _context2.stop()}}),_callee2)})))})},call.id)}))}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},CallListener_CallListener=function CallListener(props){var _useCallingContext=CallingProvider_useCallingContext(),callAgent=_useCallingContext.callAgent,deviceManager=_useCallingContext.deviceManager;return callAgent&&deviceManager?Object(jsx_runtime.jsx)(IncomingCallsProvider_IncomingCallsProvider,{children:Object(jsx_runtime.jsx)(CallListener_IncomingCallContainer,{onIncomingCallAccepted:props.onIncomingCallAccepted,onIncomingCallRejected:props.onIncomingCallRejected})}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})};CallListener_CallListener.__docgenInfo={description:"",methods:[],displayName:"CallListener",props:{onIncomingCallAccepted:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onIncomingCallRejected:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/CallListener.tsx"]={name:"CallListener",docgenInfo:CallListener_CallListener.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/CallListener.tsx"});Object(lib.G)({height:"100%",width:"100%",overflow:"auto"});var incomingCallHost=Object(lib.G)({position:"absolute",float:"right",bottom:"3rem",right:"3rem"});function OneToOneCall_slicedToArray(arr,i){return function OneToOneCall_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function OneToOneCall_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function OneToOneCall_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return OneToOneCall_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OneToOneCall_arrayLikeToArray(o,minLen)}(arr,i)||function OneToOneCall_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OneToOneCall_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var OneToOneCall_OneToOneCall=function OneToOneCall(props){var _window$innerWidth,_window,_useState2=OneToOneCall_slicedToArray(Object(react.useState)("landing"),2),page=_useState2[0],setPage=_useState2[1],_useState4=OneToOneCall_slicedToArray(Object(react.useState)(null!==(_window$innerWidth=null===(_window=window)||void 0===_window?void 0:_window.innerWidth)&&void 0!==_window$innerWidth?_window$innerWidth:0),2),screenWidth=_useState4[0],setScreenWidth=_useState4[1],displayName=props.displayName,calleeId=props.calleeId,token=props.token,callClientOptions=props.callClientOptions,refreshTokenCallback=props.refreshTokenCallback,onEndCall=props.onEndCall,onErrorCallback=props.onErrorCallback,callerId=Object(react.useCallback)((function(){return Object(utils.b)(token)}),[token])();Object(react.useEffect)((function(){var setWindowWidth=function setWindowWidth(){var width="undefined"!=typeof window?window.innerWidth:0;setScreenWidth(width)};return setWindowWidth(),window.addEventListener("resize",setWindowWidth),function(){return window.removeEventListener("resize",setWindowWidth)}}),[]);var goToCall=function goToCall(){setPage("call")},goToLanding=function goToLanding(){setPage("landing")};return Object(jsx_runtime.jsx)(ErrorProvider_ErrorProvider,{onErrorCallback:onErrorCallback,children:Object(jsx_runtime.jsx)(CallingProvider_CallingProvider,{token:token,displayName:displayName,callClientOptions:callClientOptions,refreshTokenCallback:refreshTokenCallback,children:Object(jsx_runtime.jsxs)(CallProvider_CallProvider,{children:[function(){switch(page){case"landing":return Object(jsx_runtime.jsx)(MakeCallScreen_MakeCallScreen,{callerId:callerId,calleeId:calleeId,onStartCall:goToCall});case"callEnd":return Object(jsx_runtime.jsx)(CallEndScreen_CallEndScreen,{acknowledgeCallback:goToLanding});case"call":return Object(jsx_runtime.jsx)(CallScreen,{callFailedHandler:function callFailedHandler(){return setPage("callEnd")},endCallHandler:function endCallHandler(){return onEndCall?onEndCall():setPage("callEnd")},screenWidth:screenWidth})}}(),Object(jsx_runtime.jsx)("div",{className:incomingCallHost,children:Object(jsx_runtime.jsx)(CallListener_CallListener,{onIncomingCallAccepted:function onIncomingCallAccepted(){return setPage("call")}})})]})})})};OneToOneCall_OneToOneCall.displayName="OneToOneCall",OneToOneCall_OneToOneCall.__docgenInfo={description:"",methods:[],displayName:"OneToOneCall",props:{displayName:{required:!0,tsType:{name:"string"},description:"Display name in the call"},calleeId:{required:!1,tsType:{name:"string"},description:"Id of the user to call"},token:{required:!0,tsType:{name:"string"},description:"ACS access token for the"},callClientOptions:{required:!1,tsType:{name:"CallClientOptions"},description:"Optional options for setting up the call client"},refreshTokenCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(abortSignal?: AbortSignalLike) => Promise<string>",signature:{arguments:[{name:"abortSignal",type:{name:"AbortSignalLike"}}],return:{name:"Promise",elements:[{name:"string"}],raw:"Promise<string>"}}},description:"Optional callback to refresh token once it's expired"},onEndCall:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Optional callback when call is ended"},onErrorCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(error: CommunicationUiErrorInfo) => void",signature:{arguments:[{name:"error",type:{name:"CommunicationUiErrorInfo"}}],return:{name:"void"}}},description:"Optional callback to call when error is detected"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/OneToOneCall/OneToOneCall.tsx"]={name:"OneToOneCall",docgenInfo:OneToOneCall_OneToOneCall.__docgenInfo,path:"../react-composites/src/composites/OneToOneCall/OneToOneCall.tsx"});__webpack_require__(113);var MessageBar_types=__webpack_require__(57),MessageBar=__webpack_require__(1696),errorBarSeverityToMessageBarType=new Map([["info",MessageBar_types.a.info],["warning",MessageBar_types.a.warning],["error",MessageBar_types.a.error]]),ErrorBar_ErrorBar=function ErrorBar(props){var message=props.message,severity=props.severity,onClose=props.onClose,styles=props.styles,type=severity&&errorBarSeverityToMessageBarType.has(severity)?errorBarSeverityToMessageBarType.get(severity):MessageBar_types.a.error,label=severity||"error";return message&&"ignore"!==severity?Object(jsx_runtime.jsx)(MessageBar.a,{className:Object(lib.G)(null==styles?void 0:styles.root),messageBarType:type,isMultiline:!1,onDismiss:onClose,dismissButtonAriaLabel:"Close",children:label+": "+message}):null};ErrorBar_ErrorBar.__docgenInfo={description:"`ErrorBar` displays a message on screen based on message and severity. If message is undefined or if\nseverity is IGNORE, then nothing will be displayed.",methods:[],displayName:"ErrorBar",props:{message:{required:!1,tsType:{name:"string"},description:"Message to show in ErrorBar."},severity:{required:!1,tsType:{name:"CommunicationUiErrorSeverity"},description:"Severity of error to determine type and color of ErrorBar. Defaults to 'error' type and color red."},onClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Optional callback called when ErrorBar is closed."},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<ErrorBar styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/ErrorBar.tsx"]={name:"ErrorBar",docgenInfo:ErrorBar_ErrorBar.__docgenInfo,path:"../react-composites/src/composites/common/ErrorBar.tsx"});var stories_utils=__webpack_require__(128),IncomingCallModal_IncomingCallModal=function IncomingCallModal(){var alertText=Object(dist.text)("Alert Text","Incoming Video Call"),callerName=Object(dist.text)("Caller Name","Maximus Aurelius"),callerNameAlt=Object(dist.text)("Caller Name Alt","1st"),callerTitle=Object(dist.text)("Caller Title","Emperor and Philosopher, Rome"),images=Object(dist.files)("Avatar",".jpeg, .jpg, .png",[]),localParticipantDisplayName=Object(dist.text)("Local Participant displayName","John Doe"),localVideoStreamEnabled=Object(dist.boolean)("Turn Local Video On",!0),showLocalVideo=Object(dist.boolean)("Show Local Video",!0),localVideoInverted=Object(dist.boolean)("Invert Local Video",!0),streamElement=localVideoStreamEnabled?Object(stories_utils.a)():null;return Object(jsx_runtime.jsx)(IncomingCallAlerts_IncomingCallModal,{callerName:callerName,callerNameAlt:callerNameAlt,callerTitle:callerTitle,alertText:alertText,avatar:images.length>0?images[0]:void 0,onClickVideoToggle:function onClickVideoToggle(){return null},onClickAccept:function onClickAccept(){return null},onClickReject:function onClickReject(){return null},localParticipantDisplayName:localParticipantDisplayName,localVideoInverted:localVideoInverted,showLocalVideo:showLocalVideo,localVideoStreamElement:streamElement})};IncomingCallModal_IncomingCallModal.displayName="IncomingCallModal",IncomingCallModal_IncomingCallModal.__docgenInfo={description:"",methods:[],displayName:"IncomingCallModal"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/IncomingCallModal.tsx"]={name:"IncomingCallModal",docgenInfo:IncomingCallModal_IncomingCallModal.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/IncomingCallModal.tsx"});var IncomingCallToast_IncomingCallToast=function IncomingCallToast(){var callerName=Object(dist.text)("Caller Name","John Doe"),alertText=Object(dist.text)("Alert Text","Incoming Call"),images=Object(dist.files)("Avatar",".jpeg, .jpg, .png",[]);return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(IncomingCallAlerts_IncomingCallToast,{callerName:callerName,alertText:alertText,avatar:images.length>0?images[0]:void 0,onClickAccept:function onClickAccept(){return null},onClickReject:function onClickReject(){return null}})})};IncomingCallToast_IncomingCallToast.displayName="IncomingCallToast",IncomingCallToast_IncomingCallToast.__docgenInfo={description:"",methods:[],displayName:"IncomingCallToast"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/IncomingCallToast.tsx"]={name:"IncomingCallToast",docgenInfo:IncomingCallToast_IncomingCallToast.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/IncomingCallToast.tsx"});__webpack_exports__.default={id:"".concat(constants.d,"-incomingcallalerts"),title:"".concat(constants.d,"/Incoming Call Alerts"),parameters:{docs:{page:function page(){return IncomingCallAlertsDocs_getDocs()}}}}},1652:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"MessageThread",(function(){return MessageThread}));__webpack_require__(45),__webpack_require__(61),__webpack_require__(70),__webpack_require__(50),__webpack_require__(80),__webpack_require__(10),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(41);var src=__webpack_require__(6),Stack=__webpack_require__(435),Persona=__webpack_require__(1852),Persona_types=__webpack_require__(26),PrimaryButton=__webpack_require__(1815),Divider=__webpack_require__(1874),blocks=__webpack_require__(5),dist=__webpack_require__(18),react=__webpack_require__(0),constants=__webpack_require__(23),MessageThreadContainerStyles=(__webpack_require__(51),__webpack_require__(42),{width:"100%",height:"100%",maxWidth:"50rem",maxHeight:"30rem"}),MessageThreadStyles={root:{margin:"20px auto",border:"1px solid",padding:"0 10px"}},UserOne={senderId:"user1",senderDisplayName:"Elliot Woodward"},UserTwo={senderId:"user2",senderDisplayName:"Katri Ahokas"},UserThree={senderId:"user3",senderDisplayName:"Miguel Garcia"},GetAvatarUrlByUserId=function GetAvatarUrlByUserId(userId){switch(userId){case"user1":return"images/avatars/avatar-4.jpg";case"user2":return"images/avatars/avatar-9.jpg";case"user3":return"images/avatars/avatar-6.jpg";default:return""}},GenerateMockNewChatMessage=function GenerateMockNewChatMessage(){return{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"I just sent a new Message!",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),mine:!0,attached:!1,status:"seen",type:"text"})}},GenerateMockNewChatMessageFromOthers=function GenerateMockNewChatMessageFromOthers(){return{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Sure! Let's checkout calling UI components as well!",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),mine:!1,attached:!1,type:"text"})}},GenerateMockSystemMessage=function GenerateMockSystemMessage(){return{type:"system",payload:{messageId:Math.random().toString(),iconName:"PeopleAdd",content:"Elliot Woodward added Carole Poland to the chat and shared all chat history."}}},GenerateMockCustomMessage=function GenerateMockCustomMessage(){return{type:"custom",payload:{messageId:Math.random().toString(),content:"Today"}}},GenerateMockHistoryChatMessages=function GenerateMockHistoryChatMessages(){return[{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!1,attached:!1,type:"text"})}]};function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var GetHistoryChatMessages=function GetHistoryChatMessages(){return[{type:"chat",payload:{senderId:"user1",senderDisplayName:"Kat Larsson",messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,status:"seen",type:"text"}},{type:"chat",payload:{senderId:"user2",senderDisplayName:"Robert Tolbert",messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"}},{type:"chat",payload:{senderId:"user3",senderDisplayName:"Carole Poland",messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"}}]},GetHistoryWithSystemMessages=function GetHistoryWithSystemMessages(){return[].concat(_toConsumableArray(GetHistoryChatMessages()),[{type:"system",payload:{messageId:Math.random().toString(),iconName:"PeopleAdd",content:"Miguel Garcia is added to the chat"}}])},GetHistoryWithCustomMessages=function GetHistoryWithCustomMessages(){return[{type:"custom",payload:{messageId:Math.random().toString(),content:"Today"}}].concat(_toConsumableArray(GetHistoryChatMessages()))},placeholdermessages_GetAvatarUrlByUserId=function GetAvatarUrlByUserId(userId){switch(userId){case"user1":return"images/avatars/avatar-1.jpg";case"user2":return"images/avatars/avatar-2.jpg";case"user3":return"images/avatars/avatar-8.jpg";default:return""}},jsx_runtime=__webpack_require__(1),CustomAvatar_snippet_MessageThreadWithCustomAvatarExample=function MessageThreadWithCustomAvatarExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:GetHistoryChatMessages(),onRenderAvatar:function onRenderAvatar(userId){return Object(jsx_runtime.jsx)(Persona.a,{size:Persona_types.c.size32,hidePersonaDetails:!0,presence:Persona_types.b.online,text:userId,imageUrl:placeholdermessages_GetAvatarUrlByUserId(userId)})}})})};CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.displayName="MessageThreadWithCustomAvatarExample",CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomAvatarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomAvatar.snippet.tsx"]={name:"MessageThreadWithCustomAvatarExample",docgenInfo:CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomAvatar.snippet.tsx"});var CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample=function MessageThreadWithCustomChatContainerExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:GetHistoryChatMessages(),styles:{chatContainer:{backgroundColor:"lightgray",padding:"15px"}}})})};CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.displayName="MessageThreadWithCustomChatContainerExample",CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomChatContainerExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomChatContainer.snippet.tsx"]={name:"MessageThreadWithCustomChatContainerExample",docgenInfo:CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomChatContainer.snippet.tsx"});var CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample=function MessageThreadWithCustomMessageContainerExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",styles:{chatMessageContainer:{fontStyle:"italic",boxShadow:"0px 3.2px 7.2px rgb(0 0 0 / 13%), 0px 0.6px 1.8px rgb(0 0 0 / 11%)"},systemMessageContainer:{fontWeight:"bold",border:"double red"}},messages:GetHistoryWithSystemMessages()})})};CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.displayName="MessageThreadWithCustomMessageContainerExample",CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessageContainerExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessageContainer.snippet.tsx"]={name:"MessageThreadWithCustomMessageContainerExample",docgenInfo:CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessageContainer.snippet.tsx"});var CustomMessages_snippet_MessageThreadWithCustomMessagesExample=function MessageThreadWithCustomMessagesExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:GetHistoryWithCustomMessages(),onRenderMessage:function onRenderMessage(messageProps,defaultOnRender){return"custom"===messageProps.message.type?Object(jsx_runtime.jsx)(Divider.a,{content:messageProps.message.payload.content,color:"brand",important:!0}):defaultOnRender?defaultOnRender(messageProps):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}})})};CustomMessages_snippet_MessageThreadWithCustomMessagesExample.displayName="MessageThreadWithCustomMessagesExample",CustomMessages_snippet_MessageThreadWithCustomMessagesExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessagesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessages.snippet.tsx"]={name:"MessageThreadWithCustomMessagesExample",docgenInfo:CustomMessages_snippet_MessageThreadWithCustomMessagesExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessages.snippet.tsx"});var Text=__webpack_require__(1869),CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample=function MessageThreadWithCustomMessageStatusIndicatorExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:GetHistoryChatMessages(),showMessageStatus:!0,onRenderMessageStatus:function onRenderMessageStatus(messageStatusIndicatorProps){return"seen"===messageStatusIndicatorProps.status?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic",fontWeight:"bold",color:"green"},children:"seen"}):null}})})};CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.displayName="MessageThreadWithCustomMessageStatusIndicatorExample",CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessageStatusIndicatorExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessageStatusIndicator.snippet.tsx"]={name:"MessageThreadWithCustomMessageStatusIndicatorExample",docgenInfo:CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessageStatusIndicator.snippet.tsx"});var Default_snippet_DefaultMessageThreadExample=function DefaultMessageThreadExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:GetHistoryChatMessages()})})};Default_snippet_DefaultMessageThreadExample.displayName="DefaultMessageThreadExample",Default_snippet_DefaultMessageThreadExample.__docgenInfo={description:"",methods:[],displayName:"DefaultMessageThreadExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/Default.snippet.tsx"]={name:"DefaultMessageThreadExample",docgenInfo:Default_snippet_DefaultMessageThreadExample.__docgenInfo,path:"stories/MessageThread/snippets/Default.snippet.tsx"});var MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample=function MessageThreadWithMessageStatusIndicatorExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:GetHistoryChatMessages(),showMessageStatus:!0})})};MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.displayName="MessageThreadWithMessageStatusIndicatorExample",MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithMessageStatusIndicatorExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/MessageStatusIndicator.snippet.tsx"]={name:"MessageThreadWithMessageStatusIndicatorExample",docgenInfo:MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.__docgenInfo,path:"stories/MessageThread/snippets/MessageStatusIndicator.snippet.tsx"});var SystemMessages_snippet_MessageThreadWithSystemMessagesExample=function MessageThreadWithSystemMessagesExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:GetHistoryWithSystemMessages()})})};SystemMessages_snippet_MessageThreadWithSystemMessagesExample.displayName="MessageThreadWithSystemMessagesExample",SystemMessages_snippet_MessageThreadWithSystemMessagesExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithSystemMessagesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/SystemMessages.snippet.tsx"]={name:"MessageThreadWithSystemMessagesExample",docgenInfo:SystemMessages_snippet_MessageThreadWithSystemMessagesExample.__docgenInfo,path:"stories/MessageThread/snippets/SystemMessages.snippet.tsx"});var WithMessageDate_snippet_MessageThreadWithMessageDateExample=function MessageThreadWithMessageDateExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.i,{userId:"1",showMessageDate:!0,messages:GetHistoryChatMessages()})})};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function MessageThread_stories_toConsumableArray(arr){return function MessageThread_stories_arrayWithoutHoles(arr){if(Array.isArray(arr))return MessageThread_stories_arrayLikeToArray(arr)}(arr)||function MessageThread_stories_iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||MessageThread_stories_unsupportedIterableToArray(arr)||function MessageThread_stories_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||MessageThread_stories_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageThread_stories_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return MessageThread_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MessageThread_stories_arrayLikeToArray(o,minLen):void 0}}function MessageThread_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}WithMessageDate_snippet_MessageThreadWithMessageDateExample.displayName="MessageThreadWithMessageDateExample",WithMessageDate_snippet_MessageThreadWithMessageDateExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithMessageDateExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/WithMessageDate.snippet.tsx"]={name:"MessageThreadWithMessageDateExample",docgenInfo:WithMessageDate_snippet_MessageThreadWithMessageDateExample.__docgenInfo,path:"stories/MessageThread/snippets/WithMessageDate.snippet.tsx"});var MessageThreadWithCustomAvatarExampleText=__webpack_require__(1622).default,MessageThreadWithCustomChatContainerExampleText=__webpack_require__(1623).default,MessageThreadWithCustomMessageContainerExampleText=__webpack_require__(1624).default,MessageThreadWithCustomMessagesExampleText=__webpack_require__(1625).default,MessageThreadWithCustomMessageStatusIndicatorExampleText=__webpack_require__(1626).default,DefaultMessageThreadExampleText=__webpack_require__(1627).default,MessageThreadWithMessageStatusIndicatorExampleText=__webpack_require__(1628).default,ExampleConstantsText=__webpack_require__(1629).default,MessageThreadWithSystemMessagesExampleText=__webpack_require__(1630).default,MessageThreadWithMessageDateExampleText=__webpack_require__(1631).default,MessageThread_stories_MessageThreadStory=function MessageThreadStory(){var _useState2=_slicedToArray(Object(react.useState)(function GenerateMockChatMessages(){return[{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"Hey folks!",createdOn:new Date("2020-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Hey how are you?",createdOn:new Date("2020-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Hey everyone!",createdOn:new Date("2020-04-13T00:00:00.000+08:08"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"Doing well!",createdOn:new Date("2020-04-13T00:00:00.000+08:07"),mine:!0,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Checking out the new UI Components for Azure Communication Services!",createdOn:new Date("2020-04-13T00:00:00.000+08:06"),mine:!1,attached:"top",type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"The chat thread is very responsive.",createdOn:new Date("2020-04-13T00:00:00.000+08:05"),mine:!1,attached:!0,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"It even scrolls!",createdOn:new Date("2020-04-13T00:00:00.000+08:05"),mine:!1,attached:"bottom",type:"text"})},{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Can you customize it?",createdOn:new Date("2020-04-13T00:00:00.000+08:04"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Yes you can customize it.",createdOn:new Date("2020-04-13T00:00:00.000+08:03"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"I saw there are also calling UI components",createdOn:new Date("2020-04-13T00:00:00.000+08:02"),mine:!0,attached:!1,status:"seen",type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Yeah you can combine chat and calling components to build full communication experiences!",createdOn:new Date("2020-04-13T00:00:00.000+08:01"),mine:!1,attached:!1,type:"text"})}]}()),2),chatMessages=_useState2[0],setChatMessages=_useState2[1],showMessageDate=Object(dist.boolean)("Enable Message Date",!0),showMessageStatus=Object(dist.boolean)("Enable Message Status Indicator",!0),enableJumpToNewMessageButton=Object(dist.boolean)("Enable Jump To New Message",!0),onLoadPreviousMessages=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setChatMessages([].concat(MessageThread_stories_toConsumableArray(GenerateMockHistoryChatMessages()),MessageThread_stories_toConsumableArray(chatMessages))),_context.abrupt("return",!1);case 2:case"end":return _context.stop()}}),_callee)})));return function onLoadPreviousMessages(){return _ref.apply(this,arguments)}}();return Object(jsx_runtime.jsxs)(Stack.a,{style:MessageThreadContainerStyles,children:[Object(jsx_runtime.jsx)(src.i,{styles:MessageThreadStyles,userId:UserOne.senderId,messages:chatMessages,showMessageDate:showMessageDate,showMessageStatus:showMessageStatus,disableJumpToNewMessageButton:!enableJumpToNewMessageButton,onLoadPreviousChatMessages:onLoadPreviousMessages,onRenderMessage:function onRenderMessage(messageProps,defaultOnRender){return"custom"===messageProps.message.type?Object(jsx_runtime.jsx)(Divider.a,{content:messageProps.message.payload.content,color:"brand",important:!0}):defaultOnRender?defaultOnRender(messageProps):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},onRenderAvatar:function onRenderAvatar(userId){return Object(jsx_runtime.jsx)(Persona.a,{size:Persona_types.c.size32,hidePersonaDetails:!0,presence:Persona_types.b.online,text:userId,imageUrl:GetAvatarUrlByUserId(userId)})}}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:"1rem"},children:[Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new message from others",onClick:function onSendNewMessageFromOthers(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockNewChatMessageFromOthers()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new message",onClick:function onSendNewMessage(){var existingChatMessages=chatMessages;existingChatMessages.forEach((function(message){"chat"===message.type&&(message.payload.status=void 0)})),setChatMessages([].concat(MessageThread_stories_toConsumableArray(existingChatMessages),[GenerateMockNewChatMessage()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new system message",onClick:function onSendNewSystemMessage(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockSystemMessage()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new custom message",onClick:function onSendCustomMessage(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockCustomMessage()]))}})]})]})};MessageThread_stories_MessageThreadStory.displayName="MessageThreadStory";var MessageThread=MessageThread_stories_MessageThreadStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-messagethread"),title:"".concat(constants.a,"/Message Thread"),component:src.i,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"MessageThread"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.i}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { FluentThemeProvider, MessageThread } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Sample Messages"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Create a `placeholdermessages.ts` file in the current folder you are working on. Then copy paste the code below into that file."}),Object(jsx_runtime.jsx)(blocks.Source,{code:ExampleConstantsText}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Default MessageThread"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"By default, MessageThread displays Chat messages with display name of only for other users and creation time of message when available."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:DefaultMessageThreadExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_DefaultMessageThreadExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"MessageThread With Message Date"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithMessageDateExampleText,children:Object(jsx_runtime.jsx)(WithMessageDate_snippet_MessageThreadWithMessageDateExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"System Message"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The example below shows a message thread with a system message."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithSystemMessagesExampleText,children:Object(jsx_runtime.jsx)(SystemMessages_snippet_MessageThreadWithSystemMessagesExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom Message"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The example below shows how to render a `custom` message with `onRenderMessage` in `MessageThread`"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithCustomMessagesExampleText,children:Object(jsx_runtime.jsx)(CustomMessages_snippet_MessageThreadWithCustomMessagesExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Messages with Customized Chat Container"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The example below shows how to render a `custom` chat container with `styles.chatContainer` in `MessageThread`"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithCustomChatContainerExampleText,children:Object(jsx_runtime.jsx)(CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Messages with Customized Message Container"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The example below shows how to render a `custom` message container with `styles.chatMessageContainer` or `styles.systemMessageContainer` in `MessageThread`"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: In the code example, all `%` characters were replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithCustomMessageContainerExampleText,children:Object(jsx_runtime.jsx)(CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Default Message Status Indicator"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithMessageStatusIndicatorExampleText,children:Object(jsx_runtime.jsx)(MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Cutom Message Status Indicator"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The example below shows how to render a `custom` message status indicator with `onRenderMessageStatus` in `MessageThread`"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithCustomMessageStatusIndicatorExampleText,children:Object(jsx_runtime.jsx)(CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom Avatar"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MessageThreadWithCustomAvatarExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_MessageThreadWithCustomAvatarExample,{})}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: You can view the details of the [Persona](https://developer.microsoft.com/en-us/fluentui#/controls/web/persona) component"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.i})]})}()}},storyshots:{disable:!0}}};MessageThread.parameters=Object.assign({storySource:{source:'() => {\n  const [chatMessages, setChatMessages] = useState<(SystemMessage | CustomMessage | ChatMessage)[]>(\n    GenerateMockChatMessages()\n  );\n  const showMessageDate = boolean(\'Enable Message Date\', true);\n  const showMessageStatus = boolean(\'Enable Message Status Indicator\', true);\n  const enableJumpToNewMessageButton = boolean(\'Enable Jump To New Message\', true);\n\n  const onSendNewMessage = (): void => {\n    const existingChatMessages = chatMessages;\n    // We dont want to render the status for previous messages\n    existingChatMessages.forEach((message) => {\n      if (message.type === \'chat\') {\n        message.payload.status = undefined;\n      }\n    });\n    setChatMessages([...existingChatMessages, GenerateMockNewChatMessage()]);\n  };\n\n  const onSendNewMessageFromOthers = (): void => {\n    setChatMessages([...chatMessages, GenerateMockNewChatMessageFromOthers()]);\n  };\n\n  const onLoadPreviousMessages = async (): Promise<boolean> => {\n    setChatMessages([...GenerateMockHistoryChatMessages(), ...chatMessages]);\n    return false;\n  };\n\n  const onSendNewSystemMessage = (): void => {\n    setChatMessages([...chatMessages, GenerateMockSystemMessage()]);\n  };\n\n  const onSendCustomMessage = (): void => {\n    setChatMessages([...chatMessages, GenerateMockCustomMessage()]);\n  };\n\n  const onRenderMessage = (messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType): JSX.Element => {\n    if (messageProps.message.type === \'custom\') {\n      return <Divider content={messageProps.message.payload.content} color="brand" important />;\n    }\n\n    return defaultOnRender ? defaultOnRender(messageProps) : <></>;\n  };\n\n  return (\n    <Stack style={MessageThreadContainerStyles}>\n      <MessageThreadComponent\n        styles={MessageThreadStyles}\n        userId={UserOne.senderId}\n        messages={chatMessages}\n        showMessageDate={showMessageDate}\n        showMessageStatus={showMessageStatus}\n        disableJumpToNewMessageButton={!enableJumpToNewMessageButton}\n        onLoadPreviousChatMessages={onLoadPreviousMessages}\n        onRenderMessage={onRenderMessage}\n        onRenderAvatar={(userId: string) => {\n          return (\n            <Persona\n              size={PersonaSize.size32}\n              hidePersonaDetails\n              presence={PersonaPresence.online}\n              text={userId}\n              imageUrl={GetAvatarUrlByUserId(userId)}\n            />\n          );\n        }}\n      />\n      {/* We need to use these two buttons to render more messages in the chat thread and showcase the "new message" button.\n      Using storybook knobs would trigger the whole story to do a fresh re-render, not just components inside the story. */}\n      <Stack horizontal horizontalAlign="space-between" tokens={{ childrenGap: \'1rem\' }}>\n        <PrimaryButton text="Send new message from others" onClick={onSendNewMessageFromOthers} />\n        <PrimaryButton text="Send new message" onClick={onSendNewMessage} />\n        <PrimaryButton text="Send new system message" onClick={onSendNewSystemMessage} />\n        <PrimaryButton text="Send new custom message" onClick={onSendCustomMessage} />\n      </Stack>\n    </Stack>\n  );\n}'}},MessageThread.parameters)},1653:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample_BasicExample})),__webpack_require__.d(__webpack_exports__,"CustomBehaviorExample",(function(){return CustomBehavior_CustomBehaviorExample})),__webpack_require__.d(__webpack_exports__,"CustomDataModelExample",(function(){return CustomDataModelExample_CustomDataModelExample})),__webpack_require__.d(__webpack_exports__,"ThemeExample",(function(){return ThemesExample_ThemeExample})),__webpack_require__.d(__webpack_exports__,"JoinExistingChatThread",(function(){return JoinExistingChatThread_JoinExistingChatThread}));var src=__webpack_require__(6),blocks=__webpack_require__(5),react=__webpack_require__(0),constants=__webpack_require__(23),jsx_runtime=__webpack_require__(1),dist=(__webpack_require__(10),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(41),__webpack_require__(45),__webpack_require__(18)),CompositeStringUtils=__webpack_require__(106);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var Container_snippet_ContosoChatContainer=function ContosoChatContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];return Object(react.useEffect)((function(){props&&function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(src.u)(props.token,props.endpointUrl,props.threadId,props.displayName);case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref.apply(this,arguments)}}()()}),[props]),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter?Object(jsx_runtime.jsx)(src.c,{adapter:adapter,fluentTheme:props.fluentTheme}):Object(jsx_runtime.jsx)("h3",{children:"Loading..."})})};Container_snippet_ContosoChatContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoChatContainer",props:{token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Container.snippet.tsx"]={name:"ContosoChatContainer",docgenInfo:Container_snippet_ContosoChatContainer.__docgenInfo,path:"stories/ChatComposite/snippets/Container.snippet.tsx"});__webpack_require__(51),__webpack_require__(42),__webpack_require__(260),__webpack_require__(99),__webpack_require__(55),__webpack_require__(104);var src_chatClient=__webpack_require__(1850),communicationTokenCredential=__webpack_require__(422),communicationIdentityClient=__webpack_require__(1855);function Server_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var createUserAndThread=function(){var _ref=function Server_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){Server_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){Server_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(resourceConnectionString,displayName){var _yield$chatClient$cre,_yield$chatClient$cre2,tokenClient,user,endpointUrl,chatClient,threadId;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return tokenClient=new communicationIdentityClient.a(resourceConnectionString),_context.next=3,tokenClient.createUserAndToken(["chat"]);case 3:return user=_context.sent,endpointUrl=new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),chatClient=new src_chatClient.a(endpointUrl,new communicationTokenCredential.a(user.token)),_context.next=8,chatClient.createChatThread({topic:"DemoThread"});case 8:if(_context.t2=_yield$chatClient$cre2=_context.sent.chatThread,_context.t1=null===_context.t2,_context.t1){_context.next=12;break}_context.t1=void 0===_yield$chatClient$cre2;case 12:if(!_context.t1){_context.next=16;break}_context.t3=void 0,_context.next=17;break;case 16:_context.t3=_yield$chatClient$cre2.id;case 17:if(_context.t4=_yield$chatClient$cre=_context.t3,_context.t0=null!==_context.t4,!_context.t0){_context.next=21;break}_context.t0=void 0!==_yield$chatClient$cre;case 21:if(!_context.t0){_context.next=25;break}_context.t5=_yield$chatClient$cre,_context.next=26;break;case 25:_context.t5="";case 26:return threadId=_context.t5,_context.next=29,chatClient.getChatThreadClient(threadId).addParticipants({participants:[{id:user.user,displayName:displayName}]});case 29:return _context.next=31,chatClient.getChatThreadClient(threadId).updateTopic("Chat with a friendly bot");case 31:return _context.abrupt("return",{token:user.token,endpointUrl:endpointUrl,displayName:displayName,threadId:threadId});case 32:case"end":return _context.stop()}}),_callee)})));return function createUserAndThread(_x,_x2){return _ref.apply(this,arguments)}}();__webpack_require__(207);function Utils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function Utils_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){Utils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){Utils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var addParrotBotToThread=function(){var _ref=Utils_asyncToGenerator(regeneratorRuntime.mark((function _callee(resourceConnectionString,token,threadId,messages){var tokenClient,bot,endpointUrl,chatClient;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return tokenClient=new communicationIdentityClient.a(resourceConnectionString),_context.next=3,tokenClient.createUserAndToken(["chat"]);case 3:return bot=_context.sent,endpointUrl=new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),chatClient=new src_chatClient.a(endpointUrl,new communicationTokenCredential.a(token)),_context.next=8,chatClient.getChatThreadClient(threadId).addParticipants({participants:[{id:bot.user,displayName:"A simple bot"}]});case 8:return sendMessagesAsBot(bot.token,endpointUrl,threadId,messages),_context.abrupt("return",bot);case 10:case"end":return _context.stop()}}),_callee)})));return function addParrotBotToThread(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}(),sendMessagesAsBot=function(){var _ref2=Utils_asyncToGenerator(regeneratorRuntime.mark((function _callee2(token,envUrl,threadId,messages){var chatClient,threadClient,index;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return chatClient=new src_chatClient.a(envUrl,new communicationTokenCredential.a(token)),_context2.next=3,chatClient.getChatThreadClient(threadId);case 3:threadClient=_context2.sent,index=0,messages.length>0&&threadClient.sendMessage({content:messages[index++]}),setInterval((function(){index<messages.length&&threadClient.sendMessage({content:messages[index++]})}),5e3);case 7:case"end":return _context2.stop()}}),_callee2)})));return function sendMessagesAsBot(_x5,_x6,_x7,_x8){return _ref2.apply(this,arguments)}}(),Utils_ConfigHintBanner=function ConfigHintBanner(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(CompositeStringUtils.b)(["Please provide the connection string and display name to use."])})},Utils_ConfigJoinChatThreadHintBanner=function ConfigJoinChatThreadHintBanner(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(CompositeStringUtils.b)(["Please provide a token, thread id, endpoint url, and display name to use."])})};function BasicExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function BasicExample_slicedToArray(arr,i){return function BasicExample_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function BasicExample_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function BasicExample_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return BasicExample_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BasicExample_arrayLikeToArray(o,minLen)}(arr,i)||function BasicExample_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function BasicExample_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}Utils_ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:Utils_ConfigHintBanner.__docgenInfo,path:"stories/ChatComposite/snippets/Utils.tsx"}),Utils_ConfigJoinChatThreadHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinChatThreadHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Utils.tsx"]={name:"ConfigJoinChatThreadHintBanner",docgenInfo:Utils_ConfigJoinChatThreadHintBanner.__docgenInfo,path:"stories/ChatComposite/snippets/Utils.tsx"});var BasicExample_BasicExample=function BasicExample(){var _useState2=BasicExample_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1],knobs=Object(react.useRef)({connectionString:Object(dist.text)(CompositeStringUtils.a,"","Server Simulator"),displayName:Object(dist.text)("Display Name","","Server Simulator")});return Object(react.useEffect)((function(){(function(){var _ref=function BasicExample_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){BasicExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){BasicExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!knobs.current.connectionString||!knobs.current.displayName){_context.next=7;break}return _context.next=3,createUserAndThread(knobs.current.connectionString,knobs.current.displayName);case 3:return newProps=_context.sent,_context.next=6,addParrotBotToThread(knobs.current.connectionString,newProps.token,newProps.threadId,messageArray);case 6:setContainerProps(newProps);case 7:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[knobs]),Object(jsx_runtime.jsx)("div",{style:constants.b,children:containerProps?Object(jsx_runtime.jsx)(Container_snippet_ContosoChatContainer,Object.assign({},containerProps)):Object(jsx_runtime.jsx)(Utils_ConfigHintBanner,{})})};BasicExample_BasicExample.displayName="BasicExample";var messageArray=["Hello ACS!","Congratulations! You can see this message because you successfully passed in a connection string!","In production environment, it is recommended to issue tokens in server side.","You can also issue a token by creating your own server and input them in required tab below.","Have fun!"];BasicExample_BasicExample.__docgenInfo={description:"",methods:[],displayName:"BasicExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/BasicExample.tsx"]={name:"BasicExample",docgenInfo:BasicExample_BasicExample.__docgenInfo,path:"stories/ChatComposite/BasicExample.tsx"});__webpack_require__(80);function CustomBehaviorExampleContainer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomBehaviorExampleContainer_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomBehaviorExampleContainer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomBehaviorExampleContainer_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CustomBehaviorExampleContainer_slicedToArray(arr,i){return function CustomBehaviorExampleContainer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomBehaviorExampleContainer_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomBehaviorExampleContainer_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomBehaviorExampleContainer_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomBehaviorExampleContainer_arrayLikeToArray(o,minLen)}(arr,i)||function CustomBehaviorExampleContainer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomBehaviorExampleContainer_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomBehaviorExampleContainer_ContosoChatContainer=function ContosoChatContainer(props){var _useState2=CustomBehaviorExampleContainer_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];return Object(react.useEffect)((function(){props&&function(){var _ref=CustomBehaviorExampleContainer_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var newAdapter,superSendMessage;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(src.u)(props.token,props.endpointUrl,props.threadId,props.displayName);case 2:newAdapter=_context2.sent,superSendMessage=newAdapter.sendMessage.bind(newAdapter),newAdapter.sendMessage=function(){var _ref2=CustomBehaviorExampleContainer_asyncToGenerator(regeneratorRuntime.mark((function _callee(content){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,superSendMessage(content.toUpperCase());case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),setAdapter(newAdapter);case 6:case"end":return _context2.stop()}}),_callee2)})));return function createAdapter(){return _ref.apply(this,arguments)}}()()}),[props]),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter?Object(jsx_runtime.jsx)(src.c,{adapter:adapter}):Object(jsx_runtime.jsx)("h3",{children:"Loading..."})})};function CustomBehavior_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomBehavior_slicedToArray(arr,i){return function CustomBehavior_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomBehavior_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomBehavior_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomBehavior_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomBehavior_arrayLikeToArray(o,minLen)}(arr,i)||function CustomBehavior_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomBehavior_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CustomBehaviorExampleContainer_ContosoChatContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoChatContainer",props:{token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/CustomBehaviorExampleContainer.tsx"]={name:"ContosoChatContainer",docgenInfo:CustomBehaviorExampleContainer_ContosoChatContainer.__docgenInfo,path:"stories/ChatComposite/CustomBehaviorExampleContainer.tsx"});var CustomBehavior_CustomBehaviorExample=function CustomBehaviorExample(){var _useState2=CustomBehavior_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1],knobs=Object(react.useRef)({connectionString:Object(dist.text)(CompositeStringUtils.a,"","Server Simulator"),displayName:Object(dist.text)("Display Name","","Server Simulator")});return Object(react.useEffect)((function(){(function(){var _ref=function CustomBehavior_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomBehavior_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomBehavior_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!knobs.current.connectionString||!knobs.current.displayName){_context.next=7;break}return _context.next=3,createUserAndThread(knobs.current.connectionString,knobs.current.displayName);case 3:return newProps=_context.sent,_context.next=6,addParrotBotToThread(knobs.current.connectionString,newProps.token,newProps.threadId,CustomBehavior_messageArray);case 6:setContainerProps(newProps);case 7:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[knobs]),Object(jsx_runtime.jsx)("div",{style:constants.b,children:containerProps?Object(jsx_runtime.jsx)(CustomBehaviorExampleContainer_ContosoChatContainer,Object.assign({},containerProps)):Object(jsx_runtime.jsx)(Utils_ConfigHintBanner,{})})};CustomBehavior_CustomBehaviorExample.displayName="CustomBehaviorExample";var CustomBehavior_messageArray=["Welcome to an example on how to add powerful customizations to the ChatComposite","In this example, Contoso intercepts the messages being sent by the local user and CAPITALIZES THEM ALL.","The adapter pattern allows for very powerful customizations, should you need them.","Have fun!"];function CustomDataModelExampleContainer_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomDataModelExampleContainer_snippet_slicedToArray(arr,i){return function CustomDataModelExampleContainer_snippet_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomDataModelExampleContainer_snippet_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomDataModelExampleContainer_snippet_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomDataModelExampleContainer_snippet_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomDataModelExampleContainer_snippet_arrayLikeToArray(o,minLen)}(arr,i)||function CustomDataModelExampleContainer_snippet_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomDataModelExampleContainer_snippet_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CustomBehavior_CustomBehaviorExample.__docgenInfo={description:"",methods:[],displayName:"CustomBehaviorExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/CustomBehavior.tsx"]={name:"CustomBehaviorExample",docgenInfo:CustomBehavior_CustomBehaviorExample.__docgenInfo,path:"stories/ChatComposite/CustomBehavior.tsx"});var CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer=function CustomDataModelExampleContainer(props){var _useState2=CustomDataModelExampleContainer_snippet_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];Object(react.useEffect)((function(){props&&function(){var _ref=function CustomDataModelExampleContainer_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomDataModelExampleContainer_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomDataModelExampleContainer_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(src.u)(props.token,props.endpointUrl,props.threadId,props.displayName);case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref.apply(this,arguments)}}()()}),[props]);var onRenderAvatar=Object(react.useCallback)((function(userId){return userId===props.botUserId?Object(jsx_runtime.jsx)("label",{children:props.botAvatar}):Object(jsx_runtime.jsx)("label",{children:"?"})}),[props.botUserId,props.botAvatar]);return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter?Object(jsx_runtime.jsx)(src.c,{adapter:adapter,onRenderAvatar:onRenderAvatar}):Object(jsx_runtime.jsx)("h3",{children:"Loading..."})})};function CustomDataModelExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomDataModelExample_slicedToArray(arr,i){return function CustomDataModelExample_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomDataModelExample_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomDataModelExample_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomDataModelExample_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomDataModelExample_arrayLikeToArray(o,minLen)}(arr,i)||function CustomDataModelExample_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomDataModelExample_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExampleContainer",props:{token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},botUserId:{required:!0,tsType:{name:"string"},description:""},botAvatar:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"]={name:"CustomDataModelExampleContainer",docgenInfo:CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo,path:"stories/ChatComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"});var CustomDataModelExample_CustomDataModelExample=function CustomDataModelExample(){var _useState2=CustomDataModelExample_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1],knobs=Object(react.useRef)({connectionString:Object(dist.text)(CompositeStringUtils.a,"","Server Simulator"),displayName:Object(dist.text)("Local User Display Name","","Server Simulator"),avatar:Object(dist.radios)("Bot Avatar",avatars,"Default","Server Simulator")});return Object(react.useEffect)((function(){(function(){var _ref=function CustomDataModelExample_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomDataModelExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomDataModelExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newPrerequisites,botUserToken;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!knobs.current.connectionString||!knobs.current.displayName){_context.next=8;break}return _context.next=3,createUserAndThread(knobs.current.connectionString,knobs.current.displayName);case 3:return newPrerequisites=_context.sent,_context.next=6,addParrotBotToThread(knobs.current.connectionString,newPrerequisites.token,newPrerequisites.threadId,CustomDataModelExample_messageArray);case 6:botUserToken=_context.sent,setContainerProps(Object.assign({},newPrerequisites,{botUserId:Object(src.x)(botUserToken.user),botAvatar:knobs.current.avatar}));case 8:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[knobs]),Object(jsx_runtime.jsx)("div",{style:constants.b,children:containerProps?Object(jsx_runtime.jsx)(CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer,Object.assign({},containerProps)):Object(jsx_runtime.jsx)(Utils_ConfigHintBanner,{})})};CustomDataModelExample_CustomDataModelExample.displayName="CustomDataModelExample";var avatars={Default:"🤖",Cat:"🐱",Fox:"🦊",Koala:"🐨"},CustomDataModelExample_messageArray=["Welcome to the custom data model example!","Your display name is shown in the participant list, so is mine: A simple bot.","Additionally, you can change my avatar from the default Robot symbol to furrier creatures.","Have fun!"];CustomDataModelExample_CustomDataModelExample.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/CustomDataModelExample.tsx"]={name:"CustomDataModelExample",docgenInfo:CustomDataModelExample_CustomDataModelExample.__docgenInfo,path:"stories/ChatComposite/CustomDataModelExample.tsx"});var DefaultCustomizations=__webpack_require__(1838),DarkCustomizations=__webpack_require__(1864),TeamsCustomizations=__webpack_require__(1840),WordCustomizations=__webpack_require__(1841);function ThemesExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ThemesExample_slicedToArray(arr,i){return function ThemesExample_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ThemesExample_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ThemesExample_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ThemesExample_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ThemesExample_arrayLikeToArray(o,minLen)}(arr,i)||function ThemesExample_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ThemesExample_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var themeChoices={Default:"default",Dark:"dark",Teams:"teams",Word:"word"},ThemesExample_getTheme=function getTheme(choice){switch(choice){case"default":return DefaultCustomizations.a;case"dark":return DarkCustomizations.a;case"teams":return TeamsCustomizations.a;case"word":return WordCustomizations.a}return DefaultCustomizations.a},ThemesExample_ThemeExample=function ThemeExample(){var _useState2=ThemesExample_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1],knobs=Object(react.useRef)({connectionString:Object(dist.text)(CompositeStringUtils.a,"","Server Simulator"),displayName:Object(dist.text)("Display Name","","Server Simulator"),theme:Object(dist.radios)("Theme",themeChoices,"Default","Server Simulator")});return Object(react.useEffect)((function(){(function(){var _ref=function ThemesExample_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ThemesExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ThemesExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!knobs.current.connectionString||!knobs.current.displayName){_context.next=7;break}return _context.next=3,createUserAndThread(knobs.current.connectionString,knobs.current.displayName);case 3:return newProps=_context.sent,_context.next=6,addParrotBotToThread(knobs.current.connectionString,newProps.token,newProps.threadId,ThemesExample_messageArray);case 6:setContainerProps(newProps);case 7:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[knobs]),Object(jsx_runtime.jsx)("div",{style:constants.b,children:containerProps?Object(jsx_runtime.jsx)(Container_snippet_ContosoChatContainer,Object.assign({},containerProps,{fluentTheme:ThemesExample_getTheme(knobs.current.theme)})):Object(jsx_runtime.jsx)(Utils_ConfigHintBanner,{})})};ThemesExample_ThemeExample.displayName="ThemeExample";var ThemesExample_messageArray=["Welcome to the theming example!","The ChatComposite can be themed with a Fluent UI theme, just like the base components.","Here, you can play around with some themes from the @fluentui/theme-samples package.","To build your own theme, we recommend using https://aka.ms/themedesigner","Have fun!"];ThemesExample_ThemeExample.__docgenInfo={description:"",methods:[],displayName:"ThemeExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/ThemesExample.tsx"]={name:"ThemeExample",docgenInfo:ThemesExample_ThemeExample.__docgenInfo,path:"stories/ChatComposite/ThemesExample.tsx"});var JoinExistingChatThread_JoinExistingChatThread=function JoinExistingChatThread(){var knobs=Object(react.useRef)({endpointUrl:Object(dist.text)("Azure Communication Services endpoint URL","","External chat"),threadId:Object(dist.text)("Existing thread","","External chat"),token:Object(dist.text)("Valid token for user","","External chat"),displayName:Object(dist.text)("Display name","","External chat")}),areAllKnobsSet=!!(knobs.current.endpointUrl&&knobs.current.threadId&&knobs.current.token&&knobs.current.displayName);return Object(jsx_runtime.jsx)("div",{style:constants.b,children:areAllKnobsSet?Object(jsx_runtime.jsx)(Container_snippet_ContosoChatContainer,{endpointUrl:knobs.current.endpointUrl,threadId:knobs.current.threadId,token:knobs.current.token,displayName:knobs.current.displayName}):Object(jsx_runtime.jsx)(Utils_ConfigJoinChatThreadHintBanner,{})})};JoinExistingChatThread_JoinExistingChatThread.displayName="JoinExistingChatThread",JoinExistingChatThread_JoinExistingChatThread.__docgenInfo={description:"",methods:[],displayName:"JoinExistingChatThread"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/JoinExistingChatThread.tsx"]={name:"JoinExistingChatThread",docgenInfo:JoinExistingChatThread_JoinExistingChatThread.__docgenInfo,path:"stories/ChatComposite/snippets/JoinExistingChatThread.tsx"});var containerText=__webpack_require__(1586).default,customDataModelExampleContainerText=__webpack_require__(1587).default,customBehaviorExampleText=__webpack_require__(1588).default,serverText=__webpack_require__(1589).default,ChatComposite_stories_getDocs=(__webpack_exports__.default={id:"".concat(constants.c,"-chat"),title:"".concat(constants.c,"/ChatComposite"),component:src.c,parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return ChatComposite_stories_getDocs()}}}},function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"ChatComposite"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"ChatComposite brings together key components to provide a full chat experience out of the box."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Basic usage"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"There are two parts to the composite - a `ChatComposite` react component and a `ChatAdapter` that connects the react component to the backend APIs."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The key thing to note is that initialization of `ChatAdapter` is asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(jsx_runtime.jsx)(blocks.Source,{code:containerText}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Prerequisites"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"ChatComposite provides the UI for an *existing user* in an *existing thread*. Thus, the user and thread must be created beforehand. Typically, the user and thread are created on a Contoso-owned service and authentication tokens are served to the client application that then passes it to the ChatComposite."}),Object(jsx_runtime.jsx)(blocks.Source,{code:serverText}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Theming"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"ChatComposite can be themed with Fluent UI themes, just like the base components. Look at the [ChatComposite themes canvas](./?path=/story/composites-chat--theme-example) to see theming in action or the [overall theming example](./?path=/story/theming--page) to see how theming works for all the components in this UI library."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom Data Model"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"It is a primary tenet of Azure Communication Services that customers bring their own user identities. Customers then use the Azure Communication Services identity service to create corresponding authentication tokens for their users. The ChatComposite allows developers to easily inject custom data associated with these user identities. Look at the [example canvas](./?path=/story/composites-chat--custom-data-model-example) to see how the name and avatar displayed for users can be provided by Contoso."}),Object(jsx_runtime.jsx)(blocks.Source,{code:customDataModelExampleContainerText}),Object(jsx_runtime.jsx)(blocks.Description,{children:"See the [Custom data model example documentation](./?path=/docs/customuserdatamodel--page) to understand how custom data model can be injected for all the components in this UI library."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Customize Behavior"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The `ChatAdapter` makes it possible to arbitrarily modify the communication between the `ChatComposite` component and the Azure Communication Services backend. This adds powerful customization possibilities. The [Customized Behavior Example](./?path=/story/composites-chat--custom-behavior-example) shows a way to intercept messages entered by the user and modify them before sending them on to the backend."}),Object(jsx_runtime.jsx)(blocks.Source,{code:customBehaviorExampleText}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Joining existing Chat"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The [join existing chat thread](./?path=/story/composites-chat--join-existing-chat-thread) provides an easy playground to join an existing Azure Communication Services chat thread. This is useful if you want to explore the composite with multiple users."})]})})},1654:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample_BasicExample})),__webpack_require__.d(__webpack_exports__,"CustomDataModelExample",(function(){return CustomDataModelExample_CustomDataModelExample})),__webpack_require__.d(__webpack_exports__,"ThemeExample",(function(){return ThemeExample_ThemeExample})),__webpack_require__.d(__webpack_exports__,"JoinExistingCall",(function(){return JoinExistingCall_JoinExistingCall}));var src=__webpack_require__(6),blocks=__webpack_require__(5),react=__webpack_require__(0),constants=__webpack_require__(23),jsx_runtime=__webpack_require__(1),dist=(__webpack_require__(10),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(41),__webpack_require__(45),__webpack_require__(18)),CompositeStringUtils=__webpack_require__(106);__webpack_require__(199);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isTeamsMeetingLink=function isTeamsMeetingLink(link){return link.startsWith("https://teams.microsoft.com/l/meetup-join")},Container_snippet_ContosoCallContainer=function ContosoCallContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];return Object(react.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var callLocator;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:props.token&&props.locator&&props.displayName&&(callLocator=isTeamsMeetingLink(props.locator)?{meetingLink:props.locator}:{groupId:props.locator},function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(src.t)(props.token,callLocator,props.displayName);case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref2.apply(this,arguments)}}()());case 1:case"end":return _context2.stop()}}),_callee2)})))()}),[props]),Object(react.useEffect)((function(){return function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(adapter){_context3.next=2;break}return _context3.abrupt("return");case 2:return _context3.next=4,adapter.leaveCall().catch((function(e){console.error("Failed to leave call",e)}));case 4:adapter.dispose();case 5:case"end":return _context3.stop()}}),_callee3)})))()}}),[adapter]),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter&&Object(jsx_runtime.jsx)(src.a,{adapter:adapter,fluentTheme:props.fluentTheme})})};Container_snippet_ContosoCallContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoCallContainer",props:{token:{required:!0,tsType:{name:"string"},description:""},locator:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Container.snippet.tsx"]={name:"ContosoCallContainer",docgenInfo:Container_snippet_ContosoCallContainer.__docgenInfo,path:"stories/CallComposite/snippets/Container.snippet.tsx"});__webpack_require__(51),__webpack_require__(42),__webpack_require__(260),__webpack_require__(99),__webpack_require__(55),__webpack_require__(104);var communicationIdentityClient=__webpack_require__(1855),v1=__webpack_require__(1837);function Server_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var createUserAndGroup=function(){var _ref=function Server_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){Server_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){Server_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(resourceConnectionString){var tokenClient,user;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return tokenClient=new communicationIdentityClient.a(resourceConnectionString),_context.next=3,tokenClient.createUserAndToken(["voip"]);case 3:return user=_context.sent,_context.abrupt("return",{token:user.token,endpointUrl:new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),locator:Object(v1.a)()});case 5:case"end":return _context.stop()}}),_callee)})));return function createUserAndGroup(_x){return _ref.apply(this,arguments)}}(),Utils_ConfigHintBanner=function ConfigHintBanner(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(CompositeStringUtils.b)(["Please provide the connection string and display name to use."])})},Utils_ConfigJoinCallHintBanner=function ConfigJoinCallHintBanner(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(CompositeStringUtils.b)(["Please provide a token, call locator, and display name to use."])})};function BasicExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function BasicExample_slicedToArray(arr,i){return function BasicExample_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function BasicExample_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function BasicExample_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return BasicExample_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BasicExample_arrayLikeToArray(o,minLen)}(arr,i)||function BasicExample_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function BasicExample_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}Utils_ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:Utils_ConfigHintBanner.__docgenInfo,path:"stories/CallComposite/snippets/Utils.tsx"}),Utils_ConfigJoinCallHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinCallHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Utils.tsx"]={name:"ConfigJoinCallHintBanner",docgenInfo:Utils_ConfigJoinCallHintBanner.__docgenInfo,path:"stories/CallComposite/snippets/Utils.tsx"});var BasicExample_BasicExample=function BasicExample(){var _useState2=BasicExample_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1],knobs=Object(react.useRef)({connectionString:Object(dist.text)(CompositeStringUtils.a,"","Server Simulator"),displayName:Object(dist.text)("Display Name","","Server Simulator")});return Object(react.useEffect)((function(){(function(){var _ref=function BasicExample_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){BasicExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){BasicExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!knobs.current.connectionString||!knobs.current.displayName){_context.next=5;break}return _context.next=3,createUserAndGroup(knobs.current.connectionString);case 3:newProps=_context.sent,setContainerProps(newProps);case 5:case"end":return _context.stop()}}),_callee)})));return function fetchContainerProps(){return _ref.apply(this,arguments)}})()()}),[knobs]),Object(jsx_runtime.jsx)("div",{style:constants.b,children:containerProps?Object(jsx_runtime.jsx)(Container_snippet_ContosoCallContainer,Object.assign({displayName:knobs.current.displayName},containerProps)):Object(jsx_runtime.jsx)(Utils_ConfigHintBanner,{})})};function CustomDataModelExampleContainer_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomDataModelExampleContainer_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomDataModelExampleContainer_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomDataModelExampleContainer_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CustomDataModelExampleContainer_snippet_slicedToArray(arr,i){return function CustomDataModelExampleContainer_snippet_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomDataModelExampleContainer_snippet_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomDataModelExampleContainer_snippet_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomDataModelExampleContainer_snippet_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomDataModelExampleContainer_snippet_arrayLikeToArray(o,minLen)}(arr,i)||function CustomDataModelExampleContainer_snippet_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomDataModelExampleContainer_snippet_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}BasicExample_BasicExample.displayName="BasicExample",BasicExample_BasicExample.__docgenInfo={description:"",methods:[],displayName:"BasicExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/BasicExample.tsx"]={name:"BasicExample",docgenInfo:BasicExample_BasicExample.__docgenInfo,path:"stories/CallComposite/BasicExample.tsx"});var CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer=function CustomDataModelExampleContainer(props){var _useState2=CustomDataModelExampleContainer_snippet_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];Object(react.useEffect)((function(){if(props.token&&props.groupId){var groupLocator={groupId:props.groupId};(function(){var _ref=CustomDataModelExampleContainer_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(src.t)(props.token,groupLocator,props.displayName);case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref.apply(this,arguments)}})()()}}),[props]),Object(react.useEffect)((function(){return function(){CustomDataModelExampleContainer_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(adapter){_context2.next=2;break}return _context2.abrupt("return");case 2:return _context2.next=4,adapter.leaveCall().catch((function(e){console.error("Failed to leave call",e)}));case 4:adapter.dispose();case 5:case"end":return _context2.stop()}}),_callee2)})))()}}),[adapter]);var onRenderAvatar=Object(react.useCallback)((function(onRenderAvatarprops,defaultOnRender){return onRenderAvatarprops.displayName="".concat(props.avatarInitials),defaultOnRender(onRenderAvatarprops)}),[props.avatarInitials]);return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter&&Object(jsx_runtime.jsx)(src.a,{adapter:adapter,onRenderAvatar:onRenderAvatar})})};function CustomDataModelExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomDataModelExample_slicedToArray(arr,i){return function CustomDataModelExample_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomDataModelExample_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomDataModelExample_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomDataModelExample_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomDataModelExample_arrayLikeToArray(o,minLen)}(arr,i)||function CustomDataModelExample_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomDataModelExample_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExampleContainer",props:{token:{required:!0,tsType:{name:"string"},description:""},groupId:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},avatarInitials:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"]={name:"CustomDataModelExampleContainer",docgenInfo:CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo,path:"stories/CallComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"});var CustomDataModelExample_CustomDataModelExample=function CustomDataModelExample(){var _useState2=CustomDataModelExample_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setupContainerProps=_useState2[1],knobs=Object(react.useRef)({connectionString:Object(dist.text)(CompositeStringUtils.a,"","Server Simulator"),displayName:Object(dist.text)("Display Name","","Server Simulator"),avatarInitials:Object(dist.text)("Avatar initials","A B","Server Simulator")});return Object(react.useEffect)((function(){(function(){var _ref=function CustomDataModelExample_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomDataModelExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomDataModelExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!knobs.current.connectionString||!knobs.current.displayName){_context.next=5;break}return _context.next=3,createUserAndGroup(knobs.current.connectionString);case 3:newProps=_context.sent,setupContainerProps(newProps);case 5:case"end":return _context.stop()}}),_callee)})));return function fetchContainerProps(){return _ref.apply(this,arguments)}})()()}),[knobs]),Object(jsx_runtime.jsx)("div",{style:constants.b,children:containerProps?Object(jsx_runtime.jsx)(CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer,Object.assign({displayName:knobs.current.displayName,avatarInitials:knobs.current.avatarInitials},containerProps)):Object(jsx_runtime.jsx)(Utils_ConfigHintBanner,{})})};CustomDataModelExample_CustomDataModelExample.displayName="CustomDataModelExample",CustomDataModelExample_CustomDataModelExample.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/CustomDataModelExample.tsx"]={name:"CustomDataModelExample",docgenInfo:CustomDataModelExample_CustomDataModelExample.__docgenInfo,path:"stories/CallComposite/CustomDataModelExample.tsx"});var DefaultCustomizations=__webpack_require__(1838),DarkCustomizations=__webpack_require__(1864),TeamsCustomizations=__webpack_require__(1840),WordCustomizations=__webpack_require__(1841);function ThemeExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ThemeExample_slicedToArray(arr,i){return function ThemeExample_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ThemeExample_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ThemeExample_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ThemeExample_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ThemeExample_arrayLikeToArray(o,minLen)}(arr,i)||function ThemeExample_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ThemeExample_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var themeChoices={Default:"default",Dark:"dark",Teams:"teams",Word:"word"},ThemeExample_getTheme=function getTheme(choice){switch(choice){case"default":return DefaultCustomizations.a;case"dark":return DarkCustomizations.a;case"teams":return TeamsCustomizations.a;case"word":return WordCustomizations.a}return DefaultCustomizations.a},ThemeExample_ThemeExample=function ThemeExample(){var _useState2=ThemeExample_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1],knobs=Object(react.useRef)({connectionString:Object(dist.text)(CompositeStringUtils.a,"","Server Simulator"),displayName:Object(dist.text)("Display Name","","Server Simulator"),theme:Object(dist.radios)("Theme",themeChoices,"Default","Server Simulator")});return Object(react.useEffect)((function(){(function(){var _ref=function ThemeExample_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ThemeExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ThemeExample_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!knobs.current.connectionString||!knobs.current.displayName){_context.next=5;break}return _context.next=3,createUserAndGroup(knobs.current.connectionString);case 3:newProps=_context.sent,setContainerProps(newProps);case 5:case"end":return _context.stop()}}),_callee)})));return function fetchContainerProps(){return _ref.apply(this,arguments)}})()()}),[knobs]),Object(jsx_runtime.jsx)("div",{style:constants.b,children:containerProps?Object(jsx_runtime.jsx)(Container_snippet_ContosoCallContainer,Object.assign({displayName:knobs.current.displayName,fluentTheme:ThemeExample_getTheme(knobs.current.theme)},containerProps)):Object(jsx_runtime.jsx)(Utils_ConfigHintBanner,{})})};ThemeExample_ThemeExample.displayName="ThemeExample",ThemeExample_ThemeExample.__docgenInfo={description:"",methods:[],displayName:"ThemeExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/ThemeExample.tsx"]={name:"ThemeExample",docgenInfo:ThemeExample_ThemeExample.__docgenInfo,path:"stories/CallComposite/snippets/ThemeExample.tsx"});var JoinExistingCall_JoinExistingCall=function JoinExistingCall(){var knobs=Object(react.useRef)({callLocator:Object(dist.text)("Call locator (ACS group ID or Teams meeting link)","","External call"),token:Object(dist.text)("Valid token for user","","External call"),displayName:Object(dist.text)("Display name","","External call")}),areAllKnobsSet=!!knobs.current.callLocator&&!!knobs.current.token&&!!knobs.current.displayName;return Object(jsx_runtime.jsx)("div",{style:constants.b,children:areAllKnobsSet?Object(jsx_runtime.jsx)(Container_snippet_ContosoCallContainer,{locator:knobs.current.callLocator,token:knobs.current.token,displayName:knobs.current.displayName}):Object(jsx_runtime.jsx)(Utils_ConfigJoinCallHintBanner,{})})};JoinExistingCall_JoinExistingCall.displayName="JoinExistingCall",JoinExistingCall_JoinExistingCall.__docgenInfo={description:"",methods:[],displayName:"JoinExistingCall"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/JoinExistingCall.tsx"]={name:"JoinExistingCall",docgenInfo:JoinExistingCall_JoinExistingCall.__docgenInfo,path:"stories/CallComposite/snippets/JoinExistingCall.tsx"});var containerText=__webpack_require__(1584).default,serverText=__webpack_require__(1585).default,CallComposite_stories_getDocs=(__webpack_exports__.default={id:"".concat(constants.c,"-call"),title:"".concat(constants.c,"/CallComposite"),component:src.a,parameters:{docs:{page:function page(){return CallComposite_stories_getDocs()}}}},function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"CallComposite"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"CallComposite brings together key components to provide a full calling experience out of the box."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Basic usage"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"There are two parts to the composite - a `CallComposite` react component and a `CallAdapter` that connects the react component to the backend APIs."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The key thing to note is that initialization of `CallAdapter` is asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(jsx_runtime.jsx)(blocks.Source,{code:containerText}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Prerequisites"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"CallComposite provides the UI for an *existing user* to join a call. The user must be created beforehand. Typically, the user and group call or teams meeting are created on a Contoso-owned service and provided to the client application that then passes it to the CallComposite."}),Object(jsx_runtime.jsx)(blocks.Source,{code:serverText}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Theming"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"CallComposite can be themed with Fluent UI themes, just like the base components. Look at the [CallComposite theme example](./?path=/story/composites-call--theme-example) to see theming in action or the [overall theming example](./?path=/docs/theming--page) to see how theming works for all the components in this UI library."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Joining an existing Call"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The [join existing call](./?path=/story/composites-call--join-existing-call) provides an easy playground to join an existing Azure Communication Services group call or an existing Teams meeting. This is useful if you want to explore the composite with multiple users."})]})})},1655:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8);var react=__webpack_require__(0),esm=__webpack_require__(2),blocks=__webpack_require__(5),src=(__webpack_require__(21),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(6)),Stack=__webpack_require__(435),lib=__webpack_require__(34),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallingComponents_CallingComponents=function CallingComponents(){var exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},_useState2=_slicedToArray(Object(react.useState)(!1),2),videoButtonChecked=_useState2[0],setVideoButtonChecked=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!1),2),audioButtonChecked=_useState4[0],setAudioButtonChecked=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(!1),2),screenshareButtonChecked=_useState6[0],setScreenshareButtonChecked=_useState6[1];return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)({height:"100%"}),children:[Object(jsx_runtime.jsx)("div",{style:{height:"30rem",width:"30rem",border:"1px solid"},children:Object(jsx_runtime.jsx)(src.g,{children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,renderElement:null,displayName:"Michael"})})}),Object(jsx_runtime.jsxs)(src.d,{styles:{root:{justifyContent:"center"}},children:[Object(jsx_runtime.jsx)(src.b,{checked:videoButtonChecked,onClick:function onClick(){return setVideoButtonChecked(!videoButtonChecked)}}),Object(jsx_runtime.jsx)(src.j,{checked:audioButtonChecked,onClick:function onClick(){return setAudioButtonChecked(!audioButtonChecked)}}),Object(jsx_runtime.jsx)(src.n,{checked:screenshareButtonChecked,onClick:function onClick(){return setScreenshareButtonChecked(!screenshareButtonChecked)}}),Object(jsx_runtime.jsx)(src.k,{menuProps:exampleOptionsMenuProps}),Object(jsx_runtime.jsx)(src.e,{})]})]})};CallingComponents_CallingComponents.displayName="CallingComponents",CallingComponents_CallingComponents.__docgenInfo={description:"",methods:[],displayName:"CallingComponents"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/CallingComponents.tsx"]={name:"CallingComponents",docgenInfo:CallingComponents_CallingComponents.__docgenInfo,path:"stories/QuickStarts/snippets/CallingComponents.tsx"});__webpack_require__(45),__webpack_require__(51),__webpack_require__(42),__webpack_require__(41);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var ChatComponents_ChatComponents=function ChatComponents(){return Object(jsx_runtime.jsxs)("div",{style:{height:"30rem",width:"30rem"},children:[Object(jsx_runtime.jsx)(src.i,{userId:"1",messages:function GetHistoryChatMessages(){return[{type:"chat",payload:{type:"text",senderId:"1",senderDisplayName:"User1",messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,status:"seen"}},{type:"chat",payload:{type:"text",senderId:"2",senderDisplayName:"User2",messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1}},{type:"chat",payload:{type:"text",senderId:"3",senderDisplayName:"User3",messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1}}]}(),showMessageStatus:!0}),Object(jsx_runtime.jsx)(src.o,{disabled:!1,onSendMessage:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)})))})]})};ChatComponents_ChatComponents.displayName="ChatComponents",ChatComponents_ChatComponents.__docgenInfo={description:"",methods:[],displayName:"ChatComponents"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/ChatComponents.tsx"]={name:"ChatComponents",docgenInfo:ChatComponents_ChatComponents.__docgenInfo,path:"stories/QuickStarts/snippets/ChatComponents.tsx"});function CompletedComponentsApp(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-evenly",styles:{root:{width:"100%"}},children:[Object(jsx_runtime.jsx)(CallingComponents_CallingComponents,{}),Object(jsx_runtime.jsx)(ChatComponents_ChatComponents,{})]})})}CompletedComponentsApp.displayName="CompletedComponentsApp",CompletedComponentsApp.__docgenInfo={description:"",methods:[],displayName:"CompletedComponentsApp"};var snippets_CompletedComponentsApp_snippet=CompletedComponentsApp;function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/CompletedComponentsApp.snippet.tsx"]={name:"CompletedComponentsApp",docgenInfo:CompletedComponentsApp.__docgenInfo,path:"stories/QuickStarts/snippets/CompletedComponentsApp.snippet.tsx"});var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(esm.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.mdx)(blocks.Meta,{id:"quickstarts-uicomponents",title:"Quickstarts/Get started with UI Components",mdxType:"Meta"}),Object(esm.mdx)("h1",{id:"quickstart-get-started-with-ui-components"},"Quickstart: Get started with UI Components"),Object(esm.mdx)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how to integrate UI Library base components into your application to build communication experiences."),Object(esm.mdx)("p",null,"UI Library components come in two flavors: UI and Composite."),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("strong",{parentName:"li"},"UI components")," represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences."),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("strong",{parentName:"li"},"Composite components")," are turn-key experiences for common communication scenarios that have been built using ",Object(esm.mdx)("strong",{parentName:"li"},"base components")," as building blocks and packaged to be easily integrated into applications.")),Object(esm.mdx)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.mdx)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 12 Recommended)."),Object(esm.mdx)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.mdx)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),".")),Object(esm.mdx)("h2",{id:"setting-up"},"Setting Up"),Object(esm.mdx)("p",null,"UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section."),Object(esm.mdx)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.mdx)("p",null,"We'll use the create-react-app template for this quickstart. For more information, see: ",Object(esm.mdx)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-toolkit-quickstart --template typescript\n\ncd ui-toolkit-quickstart\n\n")),Object(esm.mdx)("p",null,"At the end of this process, you should have a full application inside the folder ",Object(esm.mdx)("inlineCode",{parentName:"p"},"UI-ToolKit-Quickstart"),".\nFor this quickstart, we'll be modifying files inside the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.mdx)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.mdx)("p",null,"Use the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm install --save @azure/communication-react\n\n")),Object(esm.mdx)("p",null,"The ",Object(esm.mdx)("inlineCode",{parentName:"p"},"--save")," option lists the library as a dependency in your ",Object(esm.mdx)("strong",{parentName:"p"},"package.json")," file."),Object(esm.mdx)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.mdx)("p",null,"Let's test the Create React App installation by running:"),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.mdx)("h2",{id:"object-model"},"Object Model"),Object(esm.mdx)("p",null,"The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:"),Object(esm.mdx)("table",null,Object(esm.mdx)("thead",{parentName:"table"},Object(esm.mdx)("tr",{parentName:"thead"},Object(esm.mdx)("th",{parentName:"tr",align:null},"Name"),Object(esm.mdx)("th",{parentName:"tr",align:null},"Description"))),Object(esm.mdx)("tbody",{parentName:"table"},Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/theming--page"},"FluentThemeProvider")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Provider that controls Theming on the components. Can be used to override theme")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-gridlayout--grid-layout"},"GridLayout")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Base component that organizes video tiles into a grid")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-videotile--video-tile"},"VideoTile")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Base component to render participants either with or without video")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-controlbar--control-bar"},"ControlBar")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Base component to control call including mute, video, share screen")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-messagethread--message-thread"},"MessageThread")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Base component that renders a chat thread with typing indicators, read receipts, etc.")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/ui-components-sendbox--send-box"},"SendBox")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Base component that allows user to input messages that will be sent to the joined thread")))),Object(esm.mdx)("h2",{id:"set-up-fluent-theme-provider"},"Set Up Fluent Theme Provider"),Object(esm.mdx)("p",null,"The ",Object(esm.mdx)("inlineCode",{parentName:"p"},"FluentThemeProvider")," is a required wrapper around the UI Library components to provide theming that makes the components look amazing!\nIt is in charge of allowing developer customize the theme of the components as well. Check out ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/theming--page"},"Theming")," for more information. ",Object(esm.mdx)("inlineCode",{parentName:"p"},"FluentThemeProvider")," defaults to using light theme."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.mdx)(blocks.Source,{code:"import { FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  return (\n    <FluentThemeProvider>\n      <h1>Hooray! You set up Fluent Theme Provider 🎉🎉🎉</h1>\n    </FluentThemeProvider>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.mdx)("p",null,"Inside the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"FluentThemeProvider"),", you can add additional components.\nNext we'll use various UI components to showcase a sample experience.\nYou can customize the layout of these components and add any other custom components that you want to render with them."),Object(esm.mdx)("h2",{id:"calling-ui-components"},"Calling UI Components"),Object(esm.mdx)("p",null,"For Calling, we'll use the ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/ui-components-gridlayout--grid-layout-component"},Object(esm.mdx)("inlineCode",{parentName:"a"},"GridLayout"))," and ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/ui-components-controlbar--control-bar"},Object(esm.mdx)("inlineCode",{parentName:"a"},"ControlBar"))," components.\nTo start, in the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"src")," folder, create a new file called ",Object(esm.mdx)("inlineCode",{parentName:"p"},"CallingComponents.tsx"),".\nHere we'll initialize a function component that will hold our base components to then import in ",Object(esm.mdx)("inlineCode",{parentName:"p"},"app.tsx"),".\nYou can add extra layout and styling around the components."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"CallingComponents.tsx")),Object(esm.mdx)(blocks.Source,{code:"// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  GridLayout,\n  MicrophoneButton,\n  OptionsButton,\n  ScreenShareButton,\n  VideoTile\n} from '@azure/communication-react';\n\nimport { IContextualMenuProps, mergeStyles, Stack } from '@fluentui/react';\nimport React, { useState } from 'react';\n\nexport const CallingComponents = (): JSX.Element => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        onClick: () => alert('Choose Camera Menu Item Clicked!')\n      }\n    ]\n  };\n\n  const controlBarStyle = {\n    root: {\n      justifyContent: 'center'\n    }\n  };\n  const [videoButtonChecked, setVideoButtonChecked] = useState<boolean>(false);\n  const [audioButtonChecked, setAudioButtonChecked] = useState<boolean>(false);\n  const [screenshareButtonChecked, setScreenshareButtonChecked] = useState<boolean>(false);\n\n  return (\n    <Stack className={mergeStyles({ height: '100%' })}>\n      {/* GridLayout Component relies on the parent's height and width, so it's required to set the height and width on its parent. */}\n      <div style={{ height: '30rem', width: '30rem', border: '1px solid' }}>\n        <GridLayout>\n          <VideoTile isVideoReady={false} renderElement={null} displayName={'Michael'} />\n        </GridLayout>\n      </div>\n\n      {/* Control Bar with default set up */}\n      <ControlBar styles={controlBarStyle}>\n        <CameraButton checked={videoButtonChecked} onClick={() => setVideoButtonChecked(!videoButtonChecked)} />\n        <MicrophoneButton checked={audioButtonChecked} onClick={() => setAudioButtonChecked(!audioButtonChecked)} />\n        <ScreenShareButton\n          checked={screenshareButtonChecked}\n          onClick={() => setScreenshareButtonChecked(!screenshareButtonChecked)}\n        />\n        <OptionsButton menuProps={exampleOptionsMenuProps} />\n        <EndCallButton />\n      </ControlBar>\n    </Stack>\n  );\n};\n",mdxType:"Source"}),Object(esm.mdx)("p",null,"For this example we added a single ",Object(esm.mdx)("inlineCode",{parentName:"p"},"Video Tile")," to the grid, but additional can be added."),Object(esm.mdx)("h2",{id:"chat-ui-components"},"Chat UI Components"),Object(esm.mdx)("p",null,"For Chat, we will use the ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/docs/ui-components-chatthread--chat-thread-component"},Object(esm.mdx)("inlineCode",{parentName:"a"},"MessageThread"))," and ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/docs/ui-components-sendbox--send-box-story-book-component"},Object(esm.mdx)("inlineCode",{parentName:"a"},"SendBox"))," components.\nTo start, in the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"src")," folder, create a new file called ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatComponents.tsx"),".\nHere we'll initialize a function component that will hold our base components to then import in ",Object(esm.mdx)("inlineCode",{parentName:"p"},"app.tsx"),"."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatComponents.tsx")),Object(esm.mdx)(blocks.Source,{code:"import {\n  MessageThread,\n  ChatMessage as WebUiChatMessage,\n  SendBox,\n  MessageStatus,\n  MessageContentType\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const ChatComponents = (): JSX.Element => {\n  //A sample chat history\n  const GetHistoryChatMessages = (): WebUiChatMessage[] => {\n    return [\n      {\n        type: 'chat',\n        payload: {\n          type: 'text' as MessageContentType,\n          senderId: '1',\n          senderDisplayName: 'User1',\n          messageId: Math.random().toString(),\n          content: 'Hi everyone, I created this awesome group chat for us!',\n          createdOn: new Date('2019-04-13T00:00:00.000+08:10'),\n          mine: true,\n          attached: false,\n          status: 'seen' as MessageStatus\n        }\n      },\n      {\n        type: 'chat',\n        payload: {\n          type: 'text' as MessageContentType,\n          senderId: '2',\n          senderDisplayName: 'User2',\n          messageId: Math.random().toString(),\n          content: 'Nice! This looks great!',\n          createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n          mine: false,\n          attached: false\n        }\n      },\n      {\n        type: 'chat',\n        payload: {\n          type: 'text' as MessageContentType,\n          senderId: '3',\n          senderDisplayName: 'User3',\n          messageId: Math.random().toString(),\n          content: \"Yeah agree, let's chat here from now on!\",\n          createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n          mine: false,\n          attached: false\n        }\n      }\n    ];\n  };\n\n  return (\n    <div style={{ height: '30rem', width: '30rem' }}>\n      {/* Chat thread component with message status indicator feature enabled */}\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} showMessageStatus={true} />\n\n      <SendBox\n        disabled={false}\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n      />\n    </div>\n  );\n};\n",mdxType:"Source"}),Object(esm.mdx)("h2",{id:"add-calling-and-chat-components"},"Add Calling and Chat Components"),Object(esm.mdx)("p",null,"Back in the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"app.tsx")," file, we will now add the components to the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"FluentThemeProvider")," like shown below."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.mdx)(blocks.Source,{code:"import { FluentThemeProvider } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\nimport { CallingComponents } from './CallingComponents';\nimport { ChatComponents } from './ChatComponents';\n\nfunction CompletedComponentsApp(): JSX.Element {\n  const stackStyle = {\n    root: {\n      width: '100%'\n    }\n  };\n  return (\n    <FluentThemeProvider>\n      <Stack horizontal horizontalAlign=\"space-evenly\" styles={stackStyle}>\n        <CallingComponents />\n        <ChatComponents />\n      </Stack>\n    </FluentThemeProvider>\n  );\n}\n\nexport default CompletedComponentsApp;\n",mdxType:"Source"}),Object(esm.mdx)(blocks.Canvas,{withSource:"none",mdxType:"Canvas"},Object(esm.mdx)(snippets_CompletedComponentsApp_snippet,{mdxType:"CompletedComponentsApp"})),Object(esm.mdx)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.mdx)("p",null,"To run the code above use the command:"),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-console"},"\nnpm run start\n\n")),Object(esm.mdx)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.mdx)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.mdx)("h2",{id:"next-steps"},"Next Steps"),Object(esm.mdx)("p",null,Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/quickstarts-statefulclient--page"},"Try UI Library Stateful Client")),Object(esm.mdx)("p",null,"For more information, see the following resources:"),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/styling--page"},"UI Library Styling")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Quickstarts/Get started with UI Components",id:"quickstarts-uicomponents",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.mdx)(blocks.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.mdx)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1656:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var esm=__webpack_require__(2),blocks=__webpack_require__(5),src=__webpack_require__(6),jsx_runtime=__webpack_require__(1),FluentThemeProvider_snippet_FluentThemeProviderSnippet=function FluentThemeProviderSnippet(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.d,{children:[Object(jsx_runtime.jsx)(src.b,{}),Object(jsx_runtime.jsx)(src.j,{}),Object(jsx_runtime.jsx)(src.n,{}),Object(jsx_runtime.jsx)(src.e,{})]})})};FluentThemeProvider_snippet_FluentThemeProviderSnippet.displayName="FluentThemeProviderSnippet",FluentThemeProvider_snippet_FluentThemeProviderSnippet.__docgenInfo={description:"",methods:[],displayName:"FluentThemeProviderSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/FluentThemeProvider.snippet.tsx"]={name:"FluentThemeProviderSnippet",docgenInfo:FluentThemeProvider_snippet_FluentThemeProviderSnippet.__docgenInfo,path:"stories/snippets/FluentThemeProvider.snippet.tsx"});var DarkControlBar_snippet_DarkControlBar=function DarkControlBar(){return Object(jsx_runtime.jsx)(src.f,{fluentTheme:src.v,children:Object(jsx_runtime.jsxs)(src.d,{children:[Object(jsx_runtime.jsx)(src.b,{}),Object(jsx_runtime.jsx)(src.j,{}),Object(jsx_runtime.jsx)(src.n,{}),Object(jsx_runtime.jsx)(src.k,{}),Object(jsx_runtime.jsx)(src.e,{})]})})};DarkControlBar_snippet_DarkControlBar.displayName="DarkControlBar",DarkControlBar_snippet_DarkControlBar.__docgenInfo={description:"",methods:[],displayName:"DarkControlBar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/DarkControlBar.snippet.tsx"]={name:"DarkControlBar",docgenInfo:DarkControlBar_snippet_DarkControlBar.__docgenInfo,path:"stories/snippets/DarkControlBar.snippet.tsx"});var DefaultButton=__webpack_require__(425),useTheme=__webpack_require__(402),ThemedButton_snippet_ThemedButton=function ThemedButton(){var defaultButtonStyle={root:{background:Object(useTheme.a)().palette.neutralLight}};return Object(jsx_runtime.jsx)(DefaultButton.a,{text:"exampleButton",styles:defaultButtonStyle})};function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}ThemedButton_snippet_ThemedButton.displayName="ThemedButton",ThemedButton_snippet_ThemedButton.__docgenInfo={description:"",methods:[],displayName:"ThemedButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/ThemedButton.snippet.tsx"]={name:"ThemedButton",docgenInfo:ThemedButton_snippet_ThemedButton.__docgenInfo,path:"stories/snippets/ThemedButton.snippet.tsx"});var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(esm.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.mdx)(blocks.Meta,{id:"theming",title:"Theming",mdxType:"Meta"}),Object(esm.mdx)("h1",{id:"theming"},"Theming"),Object(esm.mdx)("p",null,"ACS UI SDK use components and icons from both ",Object(esm.mdx)("a",{parentName:"p",href:"https://developer.microsoft.com/en-us/fluentui#/controls/web",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent UI"),"\nand ",Object(esm.mdx)("a",{parentName:"p",href:"https://fluentsite.z22.web.core.windows.net",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent React Northstar"),". The ",Object(esm.mdx)("inlineCode",{parentName:"p"},"FluentThemeProvider"),"\ncomponent ensures:"),Object(esm.mdx)("ol",null,Object(esm.mdx)("li",{parentName:"ol"},"ACS UI SDK and Fluent UI components and icons are themed together"),Object(esm.mdx)("li",{parentName:"ol"},"Fluent React Northstar icons are provided")),Object(esm.mdx)("h2",{id:"usage"},"Usage"),Object(esm.mdx)("p",null,"To use the FluentThemeProvider, simply import it from ",Object(esm.mdx)("inlineCode",{parentName:"p"},"@azure/communication-react")," and wrap it around\nACS UI SDK components and Fluent UI components. For the example below we will provide theming and icons to\nthe ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ControlBar"),"."),Object(esm.mdx)(blocks.Source,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const FluentThemeProviderSnippet = (): JSX.Element => {\n  return (\n    <FluentThemeProvider>\n      <ControlBar>\n        <CameraButton />\n        <MicrophoneButton />\n        <ScreenShareButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.mdx)(blocks.Canvas,{withSource:"none",mdxSource:"%0A%3CFluentThemeProviderSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.mdx)(FluentThemeProvider_snippet_FluentThemeProviderSnippet,{mdxType:"FluentThemeProviderSnippet"})),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"FluentThemeProvider")," does two things here:"),Object(esm.mdx)("ol",null,Object(esm.mdx)("li",{parentName:"ol"},Object(esm.mdx)("inlineCode",{parentName:"li"},"FluentThemeProvider")," loads the icons used by components such as ",Object(esm.mdx)("inlineCode",{parentName:"li"},"CameraButton")),Object(esm.mdx)("li",{parentName:"ol"},Object(esm.mdx)("inlineCode",{parentName:"li"},"FluentThemeProvider")," applies theme (light theme by default) to the ",Object(esm.mdx)("inlineCode",{parentName:"li"},"ControlBar"))),Object(esm.mdx)("p",null,"To illustrate how another theme can be applied, import ",Object(esm.mdx)("inlineCode",{parentName:"p"},"darkTheme")," from ",Object(esm.mdx)("inlineCode",{parentName:"p"},"@azure/communication-react"),"\nand assign it to the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"fluentTheme")," property."),Object(esm.mdx)(blocks.Source,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  OptionsButton,\n  ScreenShareButton,\n  darkTheme\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const DarkControlBar = (): JSX.Element => {\n  return (\n    <FluentThemeProvider fluentTheme={darkTheme}>\n      <ControlBar>\n        <CameraButton />\n        <MicrophoneButton />\n        <ScreenShareButton />\n        <OptionsButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.mdx)(blocks.Canvas,{withSource:"none",mdxSource:"%0A%3CDarkControlBar%20/%3E%0A",mdxType:"Canvas"},Object(esm.mdx)(DarkControlBar_snippet_DarkControlBar,{mdxType:"DarkControlBar"})),Object(esm.mdx)("p",null,"The dark theme is applied to the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ControlBar"),". The icon colors in the predefined button components are themed correctly\nbecause they are built using the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"DefaultButton")," Fluent UI component."),Object(esm.mdx)("h2",{id:"fluentthemeprovider-props"},"FluentThemeProvider Props"),Object(esm.mdx)(blocks.Props,{of:src.f,mdxType:"Props"}),Object(esm.mdx)("h2",{id:"creating-your-own-theme"},"Creating your own theme"),Object(esm.mdx)("p",null,"If you wish to use your own theme, we strongly advise using Microsoft's ",Object(esm.mdx)("a",{parentName:"p",href:"https://aka.ms/themedesigner",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent UI Theme Designer"),".\nPlease ensure that the Accessibility checker on the same page passes when creating your own theme."),Object(esm.mdx)("img",{src:"images/accessibility_checker_pass.png",alt:"Accessibility checker pass"}),Object(esm.mdx)("p",null,"The default light theme we export looks like this:"),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-typescript"},"export const lightTheme = {\n  palette: {\n    themePrimary: '#0078d4',\n    themeLighterAlt: '#f3f9fd',\n    themeLighter: '#d0e7f8',\n    themeLight: '#a9d3f2',\n    themeTertiary: '#5ca9e5',\n    themeSecondary: '#1a86d9',\n    themeDarkAlt: '#006cbe',\n    themeDark: '#005ba1',\n    themeDarker: '#004377',\n    neutralLighterAlt: '#faf9f8',\n    neutralLighter: '#f3f2f1',\n    neutralLight: '#edebe9',\n    neutralQuaternaryAlt: '#e1dfdd',\n    neutralQuaternary: '#d0d0d0',\n    neutralTertiaryAlt: '#c8c6c4',\n    neutralTertiary: '#a19f9d',\n    neutralSecondary: '#605e5c',\n    neutralPrimaryAlt: '#3b3a39',\n    neutralPrimary: '#323130',\n    neutralDark: '#201f1e',\n    black: '#000000',\n    white: '#ffffff'\n  }\n};\n")),Object(esm.mdx)("h2",{id:"custom-theme-mapping"},"Custom Theme Mapping"),Object(esm.mdx)("p",null,"The ACS UI SDK and Fluent UI components automatically handles the mapping of palette slots to components.\nIf you wish to override the mapping, we advise that you use the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"useTheme")," hook provided by Fluent UI."),Object(esm.mdx)(blocks.Source,{code:"import { DefaultButton } from '@fluentui/react';\nimport { useTheme } from '@fluentui/react-theme-provider';\nimport React from 'react';\n\nexport const ThemedButton = (): JSX.Element => {\n  const theme = useTheme();\n\n  const defaultButtonStyle = {\n    root: {\n      background: theme.palette.neutralLight\n    }\n  };\n  return <DefaultButton text=\"exampleButton\" styles={defaultButtonStyle} />;\n};\n",mdxType:"Source"}),Object(esm.mdx)(blocks.Canvas,{withSource:"none",mdxSource:"%0A%3CThemedButton%20/%3E%0A",mdxType:"Canvas"},Object(esm.mdx)(ThemedButton_snippet_ThemedButton,{mdxType:"ThemedButton"})),Object(esm.mdx)("p",null,"Should you override your own mappings, please note that ACS SDK UI components abide by the general Fluent UI\nmappings. Foreground colors are used for text, icons, and outlines while background colors for component\nbackgrounds. Primary colors are also used for component backgrounds or icons."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Theming",id:"theming",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.mdx)(blocks.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.mdx)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1657:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ControlBar",(function(){return ControlBar}));__webpack_require__(199),__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),jsx_runtime=__webpack_require__(1),AllButtonsControlBar_snippet_AllButtonsControlBarExample=function AllButtonsControlBarExample(){var exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]};return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.d,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.b,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.j,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.n,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.k,{menuProps:exampleOptionsMenuProps}),Object(jsx_runtime.jsx)(src.e,{onClick:function onClick(){}})]})})};AllButtonsControlBar_snippet_AllButtonsControlBarExample.displayName="AllButtonsControlBarExample",AllButtonsControlBar_snippet_AllButtonsControlBarExample.__docgenInfo={description:"",methods:[],displayName:"AllButtonsControlBarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/AllButtonsControlBar.snippet.tsx"]={name:"AllButtonsControlBarExample",docgenInfo:AllButtonsControlBar_snippet_AllButtonsControlBarExample.__docgenInfo,path:"stories/ControlBar/snippets/AllButtonsControlBar.snippet.tsx"});var componentMainDivStyle={display:"flex",border:"solid 0.5px lightgray",height:"24rem",alignItems:"center",justifyContent:"center"},ControlBarLayout_snippet_ControlBarLayoutExample=function ControlBarLayoutExample(){return Object(jsx_runtime.jsx)("div",{style:componentMainDivStyle,children:Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.d,{layout:"floatingLeft",children:[Object(jsx_runtime.jsx)(src.b,{}),Object(jsx_runtime.jsx)(src.j,{}),Object(jsx_runtime.jsx)(src.n,{}),Object(jsx_runtime.jsx)(src.k,{}),Object(jsx_runtime.jsx)(src.e,{})]})})})};ControlBarLayout_snippet_ControlBarLayoutExample.displayName="ControlBarLayoutExample",ControlBarLayout_snippet_ControlBarLayoutExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/ControlBarLayout.snippet.tsx"]={name:"ControlBarLayoutExample",docgenInfo:ControlBarLayout_snippet_ControlBarLayoutExample.__docgenInfo,path:"stories/ControlBar/snippets/ControlBarLayout.snippet.tsx"});var CallEndIcon=__webpack_require__(1831),CustomButtons_snippet_CustomButtonsExample=function CustomButtonsExample(){var CustomEndCallButton=function CustomEndCallButton(){return Object(jsx_runtime.jsx)(src.e,{styles:{root:{height:"inherit",background:"darkorange",color:"white",width:"10rem"},rootHovered:{background:"darkred",color:"white"},flexContainer:{flexFlow:"row"}},showLabel:!0,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(CallEndIcon.a,{},"hangupBtnIconKey")},onRenderText:function onRenderText(){return Object(jsx_runtime.jsx)("span",{style:{marginLeft:"0.5rem"},children:"End Call"},"hangupBtnTextKey")},onClick:function onClick(){}})};return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.d,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.b,{}),Object(jsx_runtime.jsx)(src.j,{}),Object(jsx_runtime.jsx)(CustomEndCallButton,{})]})})};CustomButtons_snippet_CustomButtonsExample.displayName="CustomButtonsExample",CustomButtons_snippet_CustomButtonsExample.__docgenInfo={description:"",methods:[],displayName:"CustomButtonsExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/CustomButtons.snippet.tsx"]={name:"CustomButtonsExample",docgenInfo:CustomButtons_snippet_CustomButtonsExample.__docgenInfo,path:"stories/ControlBar/snippets/CustomButtons.snippet.tsx"});var CustomControlBarStyles_snippet_CustomControlBarStylesExample=function CustomControlBarStylesExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.d,{layout:"horizontal",styles:{root:{backgroundColor:"lightgray",border:"solid black",borderRadius:"0.3rem",maxWidth:"fit-content"}},children:[Object(jsx_runtime.jsx)(src.b,{}),Object(jsx_runtime.jsx)(src.j,{}),Object(jsx_runtime.jsx)(src.e,{})]})})};CustomControlBarStyles_snippet_CustomControlBarStylesExample.displayName="CustomControlBarStylesExample",CustomControlBarStyles_snippet_CustomControlBarStylesExample.__docgenInfo={description:"",methods:[],displayName:"CustomControlBarStylesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/CustomControlBarStyles.snippet.tsx"]={name:"CustomControlBarStylesExample",docgenInfo:CustomControlBarStyles_snippet_CustomControlBarStylesExample.__docgenInfo,path:"stories/ControlBar/snippets/CustomControlBarStyles.snippet.tsx"});var OptionsButton_snippet_OptionsButtonExample=function OptionsButtonExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.d,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.b,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.k,{menuProps:{items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"camera1",text:"Full HD Webcam",title:"Full HD Webcam",canCheck:!0,isChecked:!0},{key:"camera2",text:"Macbook Pro Webcam",title:"Macbook Pro Webcam"}]}},{key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"mic1",text:"Realtek HD Audio",title:"Realtek HD Audio"},{key:"mic2",text:"Macbook Pro Mic",title:"Macbook Pro Mic",canCheck:!0,isChecked:!0}]}}]}})]})})};OptionsButton_snippet_OptionsButtonExample.displayName="OptionsButtonExample",OptionsButton_snippet_OptionsButtonExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/OptionsButton.snippet.tsx"]={name:"OptionsButtonExample",docgenInfo:OptionsButton_snippet_OptionsButtonExample.__docgenInfo,path:"stories/ControlBar/snippets/OptionsButton.snippet.tsx"});var AllButtonsControlBarExampleText=__webpack_require__(1605).default,ControlBarLayoutExampleText=__webpack_require__(1606).default,CustomButtonsExampleText=__webpack_require__(1607).default,CustomControlBarStylesExampleText=__webpack_require__(1608).default,OptionsButtonExampleText=__webpack_require__(1609).default,CONTROL_BAR_LAYOUTS=["horizontal","vertical","dockedTop","dockedBottom","dockedLeft","dockedRight","floatingTop","floatingBottom","floatingLeft","floatingRight"],ControlBar_stories_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"camera1",text:"Full HD Webcam",title:"Full HD Webcam",canCheck:!0,isChecked:!0},{key:"camera2",text:"Macbook Pro Webcam",title:"Macbook Pro Webcam"}]}},{key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"mic1",text:"Realtek HD Audio",title:"Realtek HD Audio"},{key:"mic2",text:"Macbook Pro Mic",title:"Macbook Pro Mic",canCheck:!0,isChecked:!0}]}}]},ControlBar_stories_ControlBarStory=function ControlBarStory(args,_ref){var theme=_ref.globals.theme,layout=Object(dist.select)("Layout",CONTROL_BAR_LAYOUTS,"floatingBottom"),toggleButtons=Object(dist.boolean)("Toggle Buttons",!1),showLabels=Object(dist.boolean)("Show Labels",!1),background="#f8f8f8";return"Dark"===theme&&(background=layout.startsWith("floating")?"#252423":"#161514"),Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",display:"inherit",background:background},children:Object(jsx_runtime.jsxs)(src.d,{layout:layout,children:[Object(jsx_runtime.jsx)(src.b,{showLabel:showLabels,checked:toggleButtons}),Object(jsx_runtime.jsx)(src.j,{showLabel:showLabels,checked:toggleButtons}),Object(jsx_runtime.jsx)(src.n,{showLabel:showLabels,checked:toggleButtons}),Object(jsx_runtime.jsx)(src.k,{showLabel:showLabels,menuProps:ControlBar_stories_exampleOptionsMenuProps}),Object(jsx_runtime.jsx)(src.e,{showLabel:showLabels})]})})};ControlBar_stories_ControlBarStory.displayName="ControlBarStory";var ControlBar=ControlBar_stories_ControlBarStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-controlbar"),title:"".concat(constants.a,"/ControlBar"),component:src.d,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"ControlBar"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.d}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { FluentThemeProvider, ControlBar } from '@azure/communication-react';\nimport { DefaultButton } from '@fluentui/react';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"We recommend using our pre-defined buttons you can start find [here](./?path=/docs/ui-components-controlbar-buttons) or `DefaultButton`, a [Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) component from Fluent UI, as controls inside `ControlBar`. Pre-defined styles like `controlButtonStyles` or `controlButtonLabelStyles` can also be imported and used as `DefaultButton` styles for easy styling. `FluentThemeProvider` is needed around `ControlBar` to provide theming and icons. Learn more about theming [here](./?path=/docs/theming--page)."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:AllButtonsControlBarExampleText,children:Object(jsx_runtime.jsx)(AllButtonsControlBar_snippet_AllButtonsControlBarExample,{})}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: In the example above, `menuProps` is a property of `Button`. The property type is [IContextualMenuProps](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuProps), an interface for defining dropdown menu items."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Layouts"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can change the layout of `ControlBar` by providing a preset layout to the `layout` prop. Preset layouts are `horizontal`, `vertical`, `dockedTop`, `dockedBottom`, `dockedLeft`, `dockedRight`, `floatingTop`, `floatingBottom`, `floatingLeft` and `floatingRight`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:ControlBarLayoutExampleText,children:Object(jsx_runtime.jsx)(ControlBarLayout_snippet_ControlBarLayoutExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom ControlBar Styles"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can change the styles of the `ControlBar` by customizing its `styles` prop like in the example below."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomControlBarStylesExampleText,children:Object(jsx_runtime.jsx)(CustomControlBarStyles_snippet_CustomControlBarStylesExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom Buttons"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can also easily change the styles of included button components. They are built on Fluent UI `DefaultButton` and accept all the same props. In the example below we import `CameraButton` and `MicrophoneButton` for the 1st and 2nd buttons and style our own hang up button for the 3rd button. Learn more about styling [here](./?path=/docs/styling--page)."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomButtonsExampleText,children:Object(jsx_runtime.jsx)(CustomButtons_snippet_CustomButtonsExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Dropdown Options Button"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The `OptionsButton` can be used for any dropdown items defined through `menuProps`. For more information, check out the [official Fluent UI documentation](https://developer.microsoft.com/en-us/fluentui#/controls/web/button)"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:OptionsButtonExampleText,children:Object(jsx_runtime.jsx)(OptionsButton_snippet_OptionsButtonExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"ControlBar Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.d})]})}()}}}};ControlBar.parameters=Object.assign({storySource:{source:"(args, { globals: { theme } }) => {\n  const layout = select('Layout', CONTROL_BAR_LAYOUTS, 'floatingBottom');\n  const toggleButtons = boolean('Toggle Buttons', false);\n  const showLabels = boolean('Show Labels', false);\n\n  // This is code to set the color of the background div to show contrast to the control bar based on the theme like shown in the Figma design.\n  let background = '#f8f8f8';\n  if (theme === 'Dark') {\n    if (layout.startsWith('floating')) {\n      background = '#252423';\n    } else {\n      background = '#161514';\n    }\n  }\n\n  return (\n    <div\n      style={{\n        width: '100%',\n        height: '100%',\n        alignItems: 'center',\n        justifyContent: 'center',\n        display: 'inherit',\n        background: background\n      }}\n    >\n      <ControlBarComponent layout={layout}>\n        <CameraButton showLabel={showLabels} checked={toggleButtons} />\n        <MicrophoneButton showLabel={showLabels} checked={toggleButtons} />\n        <ScreenShareButton showLabel={showLabels} checked={toggleButtons} />\n        <OptionsButton showLabel={showLabels} menuProps={exampleOptionsMenuProps} />\n        <EndCallButton showLabel={showLabels} />\n      </ControlBarComponent>\n    </div>\n  );\n}"}},ControlBar.parameters)},1659:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var esm=__webpack_require__(2),blocks=__webpack_require__(5);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(esm.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.mdx)(blocks.Meta,{id:"quickstarts-statefulclient",title:"Quickstarts/Get started with Stateful Client",mdxType:"Meta"}),Object(esm.mdx)("h1",{id:"quickstart-get-started-with-stateful-clients"},"Quickstart: Get started with Stateful Clients"),Object(esm.mdx)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications.\nIn this quickstart, you'll learn how to integrate UI Library stateful clients into your application to build communication experiences.\nTo learn more about how to build applications with UI Library UI Components, see ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/docs/quickstarts-uicomponents--page"},"Get started with UI Components"),"\nStateful clients make it easier for developers to build UI applications on top of Azure Communication Services by providing built-in state that UI components can use to render.\nFind more information about ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/docs/statefulclient-overview--page"},"Stateful client here."),"."),Object(esm.mdx)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.mdx)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 12 Recommended)."),Object(esm.mdx)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.mdx)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),"."),Object(esm.mdx)("li",{parentName:"ul"},"Knowledge of ",Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/quickstarts-uicomponents--page"},"UI Library Components"),". We will be using the UI Components in this quickstart."),Object(esm.mdx)("li",{parentName:"ul"},"Knowledge of Azure Communication Services ",Object(esm.mdx)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat patterns"),".\nYou will need to create a thread and a user to that thread to use the UI Library. Look at the ",Object(esm.mdx)("a",{parentName:"li",href:"/?path=/docs/usecases--page#recommended-architecture"},"recommended architecture for the UI Library"))),Object(esm.mdx)("h2",{id:"setting-up"},"Setting Up"),Object(esm.mdx)("p",null,"UI Library requires a React environment to be setup as described below. If you already have a React App, you can skip this section."),Object(esm.mdx)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.mdx)("p",null,"We'll use the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"create-react-app")," template for this quickstart. For more information, see: ",Object(esm.mdx)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-toolkit-starting-with-stateful --template typescript\n\ncd ui-toolkit-quickstart\n\n")),Object(esm.mdx)("p",null,"At the end of this process, you should have a full application inside the folder ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ui-toolkit-starting-with-stateful"),".\nFor this quickstart, we'll be modifying files inside the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.mdx)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.mdx)("p",null,"Use the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"npm install")," command to install the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"@azure/communication-react")," library."),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm install --save @azure/communication-react\n\n")),Object(esm.mdx)("p",null,"The ",Object(esm.mdx)("inlineCode",{parentName:"p"},"--save")," option lists the library as a dependency in your ",Object(esm.mdx)("strong",{parentName:"p"},"package.json")," file."),Object(esm.mdx)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.mdx)("p",null,"Let's test the Create React App installation by running:"),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.mdx)("h2",{id:"object-model"},"Object Model"),Object(esm.mdx)("p",null,"The following classes and interfaces from the Azure Communication Services UI client library are referenced in this quickstart:"),Object(esm.mdx)("table",null,Object(esm.mdx)("thead",{parentName:"table"},Object(esm.mdx)("tr",{parentName:"thead"},Object(esm.mdx)("th",{parentName:"tr",align:null},"Name"),Object(esm.mdx)("th",{parentName:"tr",align:null},"Description"))),Object(esm.mdx)("tbody",{parentName:"table"},Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"https://azuresdkdocs.blob.core.windows.net/$web/javascript/azure-communication-chat/1.0.0/classes/chatclient.html",target:"_blank",rel:"nofollow noopener noreferrer"},"ChatClient")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Low-level chat library client.")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/statefulclient-overview--page"},"createStatefulChatClient")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Method to translate low-level library client into a stateful client for the UI Library")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/statefulclient-reacthooks-setup--page"},"ChatClientProvider")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Chat Client to the components inside of it")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/statefulclient-reacthooks-setup--page"},"ChatThreadClientProvider")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Chat Thread Client to the components inside of it")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Hook to generate required props to enable UI Components")))),Object(esm.mdx)("h2",{id:"instantiate-stateful-chat-client-and-chat-thread-client"},"Instantiate Stateful Chat Client and Chat Thread Client"),Object(esm.mdx)("p",null,"Update the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")," file to create a ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatClient")," off the low-level ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatClient")," using the method ",Object(esm.mdx)("inlineCode",{parentName:"p"},"createStatefulChatClient"),".\nMake sure to populate the constants at the top of the App code with information from your Azure Communication Services Resource.\nThese properties will be used to instantiate the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatClient")," and ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatClient"),". Review ",Object(esm.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat patterns")," for questions on these properties."),Object(esm.mdx)("p",null,"Once the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatClient")," is instantiated, we will then generate the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," off it to join the desired chat thread."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.mdx)(blocks.Source,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { createStatefulChatClient } from '@azure/communication-react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  // Instantiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { kind: 'communicationUser', communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n\n  //Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  return <>{chatThreadClient && <h1>Hooray! You set up chat client 🎉🎉🎉</h1>};</>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.mdx)("h2",{id:"add-providers"},"Add Providers"),Object(esm.mdx)("p",null,"Next we will add three providers that will encapsulate our UI components.\nFirst, the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"FluentThemeProvider")," which provides visual theme to the underlying components.\nSecond, the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatClientProvider")," which provides state from the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatClient")," to the components. For this provider, we will pass the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatClient")," as a prop to the provider.\nThird, the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatThreadClientProvider")," which provides state from the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," to the components. For this provider, we will pass the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," as a prop to the provider."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.mdx)(blocks.Source,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  createStatefulChatClient,\n  FluentThemeProvider,\n  ChatClientProvider,\n  ChatThreadClientProvider\n} from '@azure/communication-react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  //Instatiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { kind: 'communicationUser', communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n\n  //Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  return (\n    <FluentThemeProvider>\n      <ChatClientProvider chatClient={statefulChatClient}>\n        <ChatThreadClientProvider chatThreadClient={chatThreadClient}>\n          <h1>Hooray! You set up providers 🎉🎉🎉</h1>\n        </ChatThreadClientProvider>\n      </ChatClientProvider>\n    </FluentThemeProvider>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.mdx)("p",null,"Similarly to how we used chat providers for this example, you can use calling providers.\nFor more information on ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/statefulclient-reacthooks-setup--page"},"Calling Providers"),"."),Object(esm.mdx)("h2",{id:"compose-chat-components"},"Compose Chat Components"),Object(esm.mdx)("p",null,"Now that we have our structure ready, we will now create our chat experience using UI Components.\nFor Chat, we will use the ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/docs/ui-components-messagethread--message-thread"},"MessageThread")," and ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/docs/ui-components-sendbox--send-box"},"SendBox")," components.\nTo start add the code below to a new file ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatComponentsStateful.tsx"),".\nFor more information on getting started with UI Components follow the ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/quickstarts-uicomponents--page"},"quickstart"),"\nHere we will use the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"usePropsFor")," hook to connect our components to the stateful clients.\nThe ",Object(esm.mdx)("inlineCode",{parentName:"p"},"usePropsFor")," method takes in the component for which we want props generated, in this case ",Object(esm.mdx)("inlineCode",{parentName:"p"},"MessageThread")," and ",Object(esm.mdx)("inlineCode",{parentName:"p"},"SendBox"),"."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"ChatComponentsStateful.tsx")),Object(esm.mdx)(blocks.Source,{code:"import { useChatPropsFor, MessageThread, SendBox } from '@azure/communication-react';\nimport React from 'react';\n\nfunction ChatComponents(): JSX.Element {\n  const messageThreadProps = useChatPropsFor(MessageThread);\n  const sendBoxProps = useChatPropsFor(SendBox);\n\n  return (\n    <div style={{ height: '50rem', width: '50rem' }}>\n      {/*Props are updated asynchronously, so only render the component once props are populated.*/}\n      {messageThreadProps && <MessageThread {...messageThreadProps} />}\n      {sendBoxProps && <SendBox {...sendBoxProps} />}\n    </div>\n  );\n}\n\nexport default ChatComponents;\n",mdxType:"Source"}),Object(esm.mdx)("p",null,"Similarly to how we used ",Object(esm.mdx)("inlineCode",{parentName:"p"},"usePropsFor")," with chat UI Components, it can be used for calling UI Components.\nFor more information on ",Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor"),"."),Object(esm.mdx)("h2",{id:"add-components-to-app"},"Add Components to App"),Object(esm.mdx)("p",null,"Now that we have configured our providers and the chat components we can put them together."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.mdx)(blocks.Source,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  createStatefulChatClient,\n  FluentThemeProvider,\n  ChatClientProvider,\n  ChatThreadClientProvider\n} from '@azure/communication-react';\nimport React from 'react';\nimport ChatComponents from './ChatComponentsStateful';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  //Instantiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { kind: 'communicationUser', communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n\n  //Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  return (\n    <FluentThemeProvider>\n      <ChatClientProvider chatClient={statefulChatClient}>\n        <ChatThreadClientProvider chatThreadClient={chatThreadClient}>\n          <ChatComponents />\n        </ChatThreadClientProvider>\n      </ChatClientProvider>\n    </FluentThemeProvider>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.mdx)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.mdx)("p",null,"At this point your app should have two UI Components hooked up to\nTo run the code above use the command:"),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-console"},"\nnpm run start\n\n")),Object(esm.mdx)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.mdx)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.mdx)("h2",{id:"next-steps"},"Next Steps"),Object(esm.mdx)("p",null,Object(esm.mdx)("a",{parentName:"p",href:"/?path=/docs/quickstarts-composites--page"},"Try UI Library Composite Components")),Object(esm.mdx)("p",null,"For more information, see the following resources:"),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/styling--page"},"UI Library Styling")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Quickstarts/Get started with Stateful Client",id:"quickstarts-statefulclient",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.mdx)(blocks.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.mdx)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1660:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"OneToOneCallLayout",(function(){return OneToOneCallLayout_OneToOneCallLayout})),__webpack_require__.d(__webpack_exports__,"ScreenShareLayout",(function(){return ScreenShareLayout_ScreenShareLayout}));var blocks=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(23)),src=__webpack_require__(6),Persona=__webpack_require__(1852),Persona_types=__webpack_require__(26),lib=__webpack_require__(34),Stack=__webpack_require__(435),jsx_runtime=__webpack_require__(1),OneToOneCallLayout_snippet_renderPersona=function renderPersona(){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};OneToOneCallLayout_snippet_renderPersona.displayName="renderPersona";var OneToOneCallLayout_snippet_OneToOneCallLayoutExample=function OneToOneCallLayoutExample(){var videoStreamStyle=Object(lib.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"25%",width:"30%"});return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"500px",width:"600px",border:"1px"},horizontal:!0,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,styles:{overlayContainer:videoStreamStyle},displayName:"Holly",showDisplayName:!1,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,onRenderPlaceholder:OneToOneCallLayout_snippet_renderPersona})})})};OneToOneCallLayout_snippet_OneToOneCallLayoutExample.displayName="OneToOneCallLayoutExample",OneToOneCallLayout_snippet_OneToOneCallLayoutExample.__docgenInfo={description:"",methods:[],displayName:"OneToOneCallLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Layouts/snippets/OneToOneCallLayout.snippet.tsx"]={name:"OneToOneCallLayoutExample",docgenInfo:OneToOneCallLayout_snippet_OneToOneCallLayoutExample.__docgenInfo,path:"stories/Examples/Layouts/snippets/OneToOneCallLayout.snippet.tsx"});__webpack_require__(39);var ScreenShareLayout_snippet_renderPersona=function renderPersona(props){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:props.displayName,initialsTextColor:"white"})};ScreenShareLayout_snippet_renderPersona.displayName="renderPersona";var ScreenShareLayout_snippet_renderScreenSharePlaceholder=function renderScreenSharePlaceholder(){return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)({height:"100%"}),children:Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",horizontalAlign:"center",className:Object(lib.G)({height:"100%"}),children:"Your Screen Share Stream"})})};ScreenShareLayout_snippet_renderScreenSharePlaceholder.displayName="renderScreenSharePlaceholder";var ScreenShareLayout_snippet_renderSharePersonaPlaceholder=function renderSharePersonaPlaceholder(){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};ScreenShareLayout_snippet_renderSharePersonaPlaceholder.displayName="renderSharePersonaPlaceholder";var ScreenShareLayout_snippet_ScreenShareLayoutExample=function ScreenShareLayoutExample(){var aspectRatioBoxStyle=Object(lib.G)({borderWidth:".063rem .063rem .025rem .063rem",borderStyle:"solid",width:"100%",height:0,position:"relative",paddingTop:"56.25%"}),aspectRatioBoxContentStyle=Object(lib.G)({position:"absolute",top:0,left:0,width:"100%",height:"100%"}),videoStreamStyle=Object(lib.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"20%",width:"30%"}),participantsComponents=["Michael","Jim","Pam","Dwight","Kelly","Ryan","Andy"].map((function(participantDisplayName,index){return Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,displayName:participantDisplayName,onRenderPlaceholder:ScreenShareLayout_snippet_renderPersona})})},index)}));return Object(jsx_runtime.jsxs)(Stack.a,{style:{height:"31.25rem",width:"53.125rem",border:".063rem"},horizontal:!0,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{className:Object(lib.G)({height:"100%",width:"30%"}),children:Object(jsx_runtime.jsx)(Stack.a,{grow:!0,className:Object(lib.G)({height:"100%",overflow:"auto"}),children:participantsComponents})}),Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,className:Object(lib.G)({height:"100%"}),children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,styles:{overlayContainer:videoStreamStyle},onRenderPlaceholder:ScreenShareLayout_snippet_renderScreenSharePlaceholder,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,onRenderPlaceholder:ScreenShareLayout_snippet_renderSharePersonaPlaceholder})})})]})};ScreenShareLayout_snippet_ScreenShareLayoutExample.displayName="ScreenShareLayoutExample",ScreenShareLayout_snippet_ScreenShareLayoutExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Layouts/snippets/ScreenShareLayout.snippet.tsx"]={name:"ScreenShareLayoutExample",docgenInfo:ScreenShareLayout_snippet_ScreenShareLayoutExample.__docgenInfo,path:"stories/Examples/Layouts/snippets/ScreenShareLayout.snippet.tsx"});var dist=__webpack_require__(18),OneToOneCallLayout_renderPersona=function renderPersona(){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};OneToOneCallLayout_renderPersona.displayName="renderPersona";var OneToOneCallLayout_OneToOneCallLayout=function OneToOneCallLayout(){var width=Object(dist.number)("Width (px)",constants.i,constants.j),height=Object(dist.number)("Height (px)",constants.g,constants.h),videoStreamStyle=Object(lib.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"25%",width:"30%"});return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"".concat(height,"px"),width:"".concat(width,"px"),border:"1px"},horizontal:!0,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,styles:{overlayContainer:videoStreamStyle},displayName:"Holly",showDisplayName:!1,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,onRenderPlaceholder:OneToOneCallLayout_renderPersona})})})};OneToOneCallLayout_OneToOneCallLayout.displayName="OneToOneCallLayout",OneToOneCallLayout_OneToOneCallLayout.__docgenInfo={description:"",methods:[],displayName:"OneToOneCallLayout"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Layouts/OneToOneCallLayout.tsx"]={name:"OneToOneCallLayout",docgenInfo:OneToOneCallLayout_OneToOneCallLayout.__docgenInfo,path:"stories/Examples/Layouts/OneToOneCallLayout.tsx"});__webpack_require__(99),__webpack_require__(55),__webpack_require__(371);var ScreenShareLayout_renderPersona=function renderPersona(props){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:props.displayName,initialsTextColor:"white"})};ScreenShareLayout_renderPersona.displayName="renderPersona";var ScreenShareLayout_renderScreenSharePlaceholder=function renderScreenSharePlaceholder(){return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)({height:"100%"}),children:Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",horizontalAlign:"center",className:Object(lib.G)({height:"100%"}),children:"Your Screen Share Stream"})})};ScreenShareLayout_renderScreenSharePlaceholder.displayName="renderScreenSharePlaceholder";var ScreenShareLayout_renderSharePersonaPlaceholder=function renderSharePersonaPlaceholder(){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};ScreenShareLayout_renderSharePersonaPlaceholder.displayName="renderSharePersonaPlaceholder";var ScreenShareLayout_ScreenShareLayout=function ScreenShareLayout(){var width=Object(dist.number)("Width (px)",850,constants.j),height=Object(dist.number)("Height (px)",constants.g,constants.h),sidePanelWidthRatio=Object(dist.select)("Side Panel Width Ratio",["30%","35%","40%","45%","50%"],"30%"),aspectRatioNumberArray=Object(dist.select)("Side Panel Tile Aspect Ratio (Width:Height)",["16:9","3:2","4:3","5:9","1:1"],"16:9").split(":"),aspectRatio=100*parseInt(aspectRatioNumberArray[1])/parseInt(aspectRatioNumberArray[0])+"%",aspectRatioBoxStyle=Object(lib.G)({borderWidth:".063rem .063rem .025rem .063rem",borderStyle:"solid",width:"100%",height:0,position:"relative",paddingTop:aspectRatio}),aspectRatioBoxContentStyle=Object(lib.G)({position:"absolute",top:0,left:0,width:"100%",height:"100%"}),videoStreamStyle=Object(lib.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"20%",width:"30%"}),screenShareLayoutStyle={height:"".concat(height,"px"),width:"".concat(width,"px"),border:".063rem"},participantsComponents=["Michael","Jim","Pam","Dwight","Kelly","Ryan","Andy"].map((function(participantDisplayName,index){return Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,displayName:participantDisplayName,onRenderPlaceholder:ScreenShareLayout_renderPersona})})},index)}));return Object(jsx_runtime.jsxs)(Stack.a,{style:screenShareLayoutStyle,horizontal:!0,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{className:Object(lib.G)({height:"100%",width:sidePanelWidthRatio}),children:Object(jsx_runtime.jsx)(Stack.a,{grow:!0,className:Object(lib.G)({height:"100%",overflow:"auto"}),children:participantsComponents})}),Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,className:Object(lib.G)({height:"100%"}),children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,styles:{overlayContainer:videoStreamStyle},onRenderPlaceholder:ScreenShareLayout_renderScreenSharePlaceholder,children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,onRenderPlaceholder:ScreenShareLayout_renderSharePersonaPlaceholder})})})]})};ScreenShareLayout_ScreenShareLayout.displayName="ScreenShareLayout",ScreenShareLayout_ScreenShareLayout.__docgenInfo={description:"",methods:[],displayName:"ScreenShareLayout"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Layouts/ScreenShareLayout.tsx"]={name:"ScreenShareLayout",docgenInfo:ScreenShareLayout_ScreenShareLayout.__docgenInfo,path:"stories/Examples/Layouts/ScreenShareLayout.tsx"});var OneToOneCallLayoutExampleText=__webpack_require__(1612).default,ScreenShareLayoutExampleText=__webpack_require__(1613).default;__webpack_exports__.default={id:"".concat(constants.d,"-layouts"),title:"".concat(constants.d,"/Layouts"),parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"Layouts"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"In this section, we showcase different examples of building your own calling gallery layouts using `VideoTile` component from `@azure/communication-react` package and `@fluentui/react` package."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"In these examples, we use [Stack](https://developer.microsoft.com/en-us/fluentui#/controls/web/stack) component from `fluentui` to build a layout for our video tiles. For the individual elements in this layout we use `VideoTile` from `@azure/communication-react` to render each participant. We are not passing in video stream to the `VideoTile` component in these examples, instead a [Persona](https://developer.microsoft.com/en-us/fluentui#/controls/web/persona) component is used as a placeholder component."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: In the code examples, all `%` characters wer replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"OneToOne Call Layout"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:OneToOneCallLayoutExampleText,children:Object(jsx_runtime.jsx)(OneToOneCallLayout_snippet_OneToOneCallLayoutExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Screenshare Layout"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:ScreenShareLayoutExampleText,children:Object(jsx_runtime.jsx)(ScreenShareLayout_snippet_ScreenShareLayoutExample,{})}),Object(jsx_runtime.jsx)(blocks.Description,{children:"In the example above, we show a layout containing 30% of side panel on the left and 70% screen share stream on the right. To customize the proportion of the side panel, you can change the `width` of the side panel component and the screen share component will take the rest of the width automatically."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"For the individual video tile in the side panel, it has aspect ratio `16:9`. To customize the aspect ratio of the video tile, you can change the `paddingTop` field in the `aspectRatioBoxStyle` to be the ratio you want."})]})}()}}}}},1661:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SendBox",(function(){return SendBox}));__webpack_require__(41),__webpack_require__(9),__webpack_require__(80),__webpack_require__(10),__webpack_require__(45);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Icon=__webpack_require__(1866),jsx_runtime=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CustomIcon_snippet_CustomIconExample=function CustomIconExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.o,{onSendMessage:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"AirplaneSolid"})}})})})};function CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomStyling_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}CustomIcon_snippet_CustomIconExample.displayName="CustomIconExample",CustomIcon_snippet_CustomIconExample.__docgenInfo={description:"",methods:[],displayName:"CustomIconExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/CustomIcon.snippet.tsx"]={name:"CustomIconExample",docgenInfo:CustomIcon_snippet_CustomIconExample.__docgenInfo,path:"stories/SendBox/snippets/CustomIcon.snippet.tsx"});var CustomStyling_snippet_CustomStylingExample=function CustomStylingExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.o,{onSendMessage:CustomStyling_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:CustomStyling_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),styles:{root:{border:"2px solid gray",borderRadius:"10px",padding:"10px"},systemMessage:{border:"1px solid darkred",background:"lightpink"},textField:{background:"ghostwhite"}},systemMessage:"This is a system message"})})})};function SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SendBox_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}CustomStyling_snippet_CustomStylingExample.displayName="CustomStylingExample",CustomStyling_snippet_CustomStylingExample.__docgenInfo={description:"",methods:[],displayName:"CustomStylingExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/CustomStyling.snippet.tsx"]={name:"CustomStylingExample",docgenInfo:CustomStyling_snippet_CustomStylingExample.__docgenInfo,path:"stories/SendBox/snippets/CustomStyling.snippet.tsx"});var SendBox_snippet_SendBoxExample=function SendBoxExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.o,{onSendMessage:SendBox_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:SendBox_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)})))})})})};function SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SendBoxWithSystemMessage_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}SendBox_snippet_SendBoxExample.displayName="SendBoxExample",SendBox_snippet_SendBoxExample.__docgenInfo={description:"",methods:[],displayName:"SendBoxExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/SendBox.snippet.tsx"]={name:"SendBoxExample",docgenInfo:SendBox_snippet_SendBoxExample.__docgenInfo,path:"stories/SendBox/snippets/SendBox.snippet.tsx"});var SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample=function SendBoxWithSystemMessageExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.o,{onSendMessage:SendBoxWithSystemMessage_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:SendBoxWithSystemMessage_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),systemMessage:"Please wait 30 seconds to send new messages"})})})};function SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.displayName="SendBoxWithSystemMessageExample",SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.__docgenInfo={description:"",methods:[],displayName:"SendBoxWithSystemMessageExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/SendBoxWithSystemMessage.snippet.tsx"]={name:"SendBoxWithSystemMessageExample",docgenInfo:SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.__docgenInfo,path:"stories/SendBox/snippets/SendBoxWithSystemMessage.snippet.tsx"});var CustomIconExampleText=__webpack_require__(1638).default,CustomStylingExampleText=__webpack_require__(1639).default,SendBoxExampleText=__webpack_require__(1640).default,SendBoxWithSystemMessageExampleText=__webpack_require__(1641).default,SendBox_stories_SendBoxStory=function SendBoxStory(){return Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.o,{disabled:Object(dist.boolean)("Disable SendBox",!1,"Injected by ACS Context"),onSendMessage:function(){var _ref=function SendBox_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(message){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",alert("sent message: ".concat(message," ")));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),onTyping:function onTyping(){return console.log("sending typing notifications"),Promise.resolve()},systemMessage:Object(dist.boolean)("Has warning/information message",!1,"Injected by ACS Context")?Object(dist.text)("Warning/information message for SendBox","Please wait 30 seconds to send new messages","Injected by ACS Context"):void 0})})};SendBox_stories_SendBoxStory.displayName="SendBoxStory";var SendBox=SendBox_stories_SendBoxStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-sendbox"),title:"".concat(constants.a,"/Send Box"),component:src.o,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"SendBox"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.o}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"import { SendBox } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:SendBoxExampleText,children:Object(jsx_runtime.jsx)(SendBox_snippet_SendBoxExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Add a system message"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To add a system message, use the systemMessage property like in the example below."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:SendBoxWithSystemMessageExampleText,children:Object(jsx_runtime.jsx)(SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Customize send icon"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To customize the send icon, use the `onRenderIcon` property like in the example below. A Fluent UI [Icon](https://developer.microsoft.com/en-us/fluentui#/controls/web/icon) is used in this example but you can use any `JSX.Element`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomIconExampleText,children:Object(jsx_runtime.jsx)(CustomIcon_snippet_CustomIconExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Customize styling"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To customize the style of SendBox, use the `styles` property like in the example below. Notice that the keys of `styles` property are the root and sub-components of `SendBox`, each of which can be styled independently."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomStylingExampleText,children:Object(jsx_runtime.jsx)(CustomStyling_snippet_CustomStylingExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.o})]})}()}}}};SendBox.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  return (\n    <div style={{ width: '31.25rem' }}>\n      <SendBoxComponent\n        disabled={boolean('Disable SendBox', false, 'Injected by ACS Context')}\n        onSendMessage={async (message) => alert(`sent message: ${message} `)}\n        onTyping={(): Promise<void> => {\n          console.log(`sending typing notifications`);\n          return Promise.resolve();\n        }}\n        systemMessage={\n          boolean('Has warning/information message', false, 'Injected by ACS Context')\n            ? text(\n                'Warning/information message for SendBox',\n                'Please wait 30 seconds to send new messages',\n                'Injected by ACS Context'\n              )\n            : undefined\n        }\n      />\n    </div>\n  );\n}"}},SendBox.parameters)},1662:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Camera",(function(){return Camera}));__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Icon=__webpack_require__(1866),Label=__webpack_require__(1865),jsx_runtime=__webpack_require__(1),Custom_snippet_CustomCameraButtonExample=function CustomCameraButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Camera",style:{color:"green",fontSize:"25px"}},"CameraIconKey"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Camera",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"CameraIconKey")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Label.a,{style:{fontStyle:"italic"},children:"Turn off"},"CameraLabelKey"):Object(jsx_runtime.jsx)(Label.a,{children:"Turn on"},"CameraLabelKey")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.b,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"camera 1"),Object(jsx_runtime.jsx)(src.b,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"camera 2")]})};Custom_snippet_CustomCameraButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomCameraButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/Custom.snippet.tsx"]={name:"CustomCameraButtonExample",docgenInfo:Custom_snippet_CustomCameraButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/Custom.snippet.tsx"});var Default_snippet_CameraButtonExample=function CameraButtonExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.b,{checked:!0},"camBtn1"),Object(jsx_runtime.jsx)(src.b,{},"camBtn2")]})};Default_snippet_CameraButtonExample.displayName="CameraButtonExample",Default_snippet_CameraButtonExample.__docgenInfo={description:"",methods:[],displayName:"CameraButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/Default.snippet.tsx"]={name:"CameraButtonExample",docgenInfo:Default_snippet_CameraButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/Default.snippet.tsx"});var WithLabel_snippet_CameraButtonWithLabelExample=function CameraButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.b,{showLabel:!0,checked:!0})})};WithLabel_snippet_CameraButtonWithLabelExample.displayName="CameraButtonWithLabelExample",WithLabel_snippet_CameraButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"CameraButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/WithLabel.snippet.tsx"]={name:"CameraButtonWithLabelExample",docgenInfo:WithLabel_snippet_CameraButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/WithLabel.snippet.tsx"});var CustomButtonExampleText=__webpack_require__(1590).default,DefaultButtonExampleText=__webpack_require__(1591).default,ButtonWithLabelExampleText=__webpack_require__(1592).default,Camera_stories_CameraStory=function CameraStory(){var toggleButtons=Object(dist.boolean)("Toggle Buttons",!1),showLabels=Object(dist.boolean)("Show Labels",!1);return Object(jsx_runtime.jsx)(src.b,{showLabel:showLabels,checked:toggleButtons})};Camera_stories_CameraStory.displayName="CameraStory";var Camera=Camera_stories_CameraStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-controlbar-buttons-camera"),title:"".concat(constants.a,"/ControlBar/Buttons/Camera"),component:src.b,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"CameraButton"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.b}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { CameraButton } from '@azure/communication-ui';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The default `CameraButton` component shows a Camera icon with no label. The following example displays the `CameraButton` with camera turned on and off."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:DefaultButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_CameraButtonExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Camera with default label"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can display the button label which, by default, will show below the icon as `Turn on` or `Turn off`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:ButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_CameraButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom CameraButton Styles"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can change the styles of the `CameraButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomCameraButtonExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"CameraButton Props"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"`CameraButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties:"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.b})]})}()}},storyshots:{disable:!0}}};Camera.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const toggleButtons = boolean('Toggle Buttons', false);\n  const showLabels = boolean('Show Labels', false);\n\n  return <CameraButton showLabel={showLabels} checked={toggleButtons} />;\n}"}},Camera.parameters)},1663:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"EndCall",(function(){return EndCall}));__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Icon=__webpack_require__(1866),Label=__webpack_require__(1865),jsx_runtime=__webpack_require__(1),Custom_snippet_EndCallButtonCustomExample=function EndCallButtonCustomExample(){return Object(jsx_runtime.jsx)(src.e,{style:{background:"cyan"},showLabel:!0,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"DeclineCall",style:{color:"black",fontSize:"25px"}},"endCallCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"blue",fontStyle:"italic"},children:"end call"},"endCallCustomLabelKey")}},"endCallCustomBtnKey")};Custom_snippet_EndCallButtonCustomExample.displayName="EndCallButtonCustomExample",Custom_snippet_EndCallButtonCustomExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonCustomExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/Custom.snippet.tsx"]={name:"EndCallButtonCustomExample",docgenInfo:Custom_snippet_EndCallButtonCustomExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/Custom.snippet.tsx"});var Default_snippet_EndCallButtonDefaultExample=function EndCallButtonDefaultExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.e,{})})};Default_snippet_EndCallButtonDefaultExample.displayName="EndCallButtonDefaultExample",Default_snippet_EndCallButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/Default.snippet.tsx"]={name:"EndCallButtonDefaultExample",docgenInfo:Default_snippet_EndCallButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/Default.snippet.tsx"});var WithLabel_snippet_EndCallButtonWithLabelExample=function EndCallButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.e,{showLabel:!0})})};WithLabel_snippet_EndCallButtonWithLabelExample.displayName="EndCallButtonWithLabelExample",WithLabel_snippet_EndCallButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/WithLabel.snippet.tsx"]={name:"EndCallButtonWithLabelExample",docgenInfo:WithLabel_snippet_EndCallButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/WithLabel.snippet.tsx"});var EndCallButtonCustomExampleText=__webpack_require__(1593).default,EndCallButtonDefaultExampleText=__webpack_require__(1594).default,EndCallButtonWithLabelExampleText=__webpack_require__(1595).default,EndCall_stories_EndCallStory=function EndCallStory(){var showLabels=Object(dist.boolean)("Show Labels",!1);return Object(jsx_runtime.jsx)(src.e,{showLabel:showLabels})};EndCall_stories_EndCallStory.displayName="EndCallStory";var EndCall=EndCall_stories_EndCallStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-controlbar-buttons-endcall"),title:"".concat(constants.a,"/ControlBar/Buttons/End Call"),component:src.e,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"EndCallButton"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.e}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The default `EndCallButton` component shows a hangup icon with no label as in the example below."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:EndCallButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_EndCallButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"EndCallButton with default label"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can display the button label which, by default, will show below the icon as `Hangup`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:EndCallButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_EndCallButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom EndCallButton Styles"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can change the styles of the `EndCallButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:EndCallButtonCustomExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_EndCallButtonCustomExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"EndCallButton Props"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"`EndCallButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.e})]})}()}}}};EndCall.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const showLabels = boolean('Show Labels', false);\n\n  return <EndCallButton showLabel={showLabels} />;\n}"}},EndCall.parameters)},1664:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Microphone",(function(){return Microphone}));__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Icon=__webpack_require__(1866),Text=__webpack_require__(1869),Label=__webpack_require__(1865),jsx_runtime=__webpack_require__(1),Custom_snippet_CustomMicrophoneButtonExample=function CustomMicrophoneButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Microphone",style:{color:"green",fontSize:"25px"}},"micCustomIcon1"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Microphone",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"micCustomIcon2")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic"},children:"unmuted"},"micCustomText"):Object(jsx_runtime.jsx)(Label.a,{children:"muted"},"micCustomLabel")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.j,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"micCustomBtn1"),Object(jsx_runtime.jsx)(src.j,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"micCustomBtn2")]})};Custom_snippet_CustomMicrophoneButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomMicrophoneButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/Custom.snippet.tsx"]={name:"CustomMicrophoneButtonExample",docgenInfo:Custom_snippet_CustomMicrophoneButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/Custom.snippet.tsx"});var Default_snippet_MicrophoneButtonExample=function MicrophoneButtonExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.j,{checked:!0},"micBtn1"),Object(jsx_runtime.jsx)(src.j,{},"micBtn2")]})};Default_snippet_MicrophoneButtonExample.displayName="MicrophoneButtonExample",Default_snippet_MicrophoneButtonExample.__docgenInfo={description:"",methods:[],displayName:"MicrophoneButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/Default.snippet.tsx"]={name:"MicrophoneButtonExample",docgenInfo:Default_snippet_MicrophoneButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/Default.snippet.tsx"});var WithLabel_snippet_MicrophoneButtonWithLabelExample=function MicrophoneButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.j,{showLabel:!0,checked:!0})})};WithLabel_snippet_MicrophoneButtonWithLabelExample.displayName="MicrophoneButtonWithLabelExample",WithLabel_snippet_MicrophoneButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"MicrophoneButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/WithLabel.snippet.tsx"]={name:"MicrophoneButtonWithLabelExample",docgenInfo:WithLabel_snippet_MicrophoneButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/WithLabel.snippet.tsx"});var CustomMicrophoneButtonExampleText=__webpack_require__(1596).default,MicrophoneButtonExampleText=__webpack_require__(1597).default,MicrophoneButtonWithLabelExampleText=__webpack_require__(1598).default,Microphone_stories_MicrophoneStory=function MicrophoneStory(){var toggleButtons=Object(dist.boolean)("Toggle Buttons",!1),showLabels=Object(dist.boolean)("Show Labels",!1);return Object(jsx_runtime.jsx)(src.j,{showLabel:showLabels,checked:toggleButtons})};Microphone_stories_MicrophoneStory.displayName="MicrophoneStory";var Microphone=Microphone_stories_MicrophoneStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-controlbar-buttons-microphone"),title:"".concat(constants.a,"/ControlBar/Buttons/Microphone"),component:src.j,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"MicrophoneButton"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.j}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { MicrophoneButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The default `MicrophoneButton` component shows a microphone icon with no label. The following example displays an unmuted `MicrophoneButton` and a muted `MicrophoneButton`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MicrophoneButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_MicrophoneButtonExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Microphone with default label"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can display the button label which, by default, will show below the icon as `Mute` or `Unmute`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:MicrophoneButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_MicrophoneButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom MicrophoneButton Styles"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can change the styles of the `MicrophoneButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomMicrophoneButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomMicrophoneButtonExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"MicrophoneButton Props"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"`MicrophoneButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the additional following properties."}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.j})]})}()}}}};Microphone.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const toggleButtons = boolean('Toggle Buttons', false);\n  const showLabels = boolean('Show Labels', false);\n\n  return <MicrophoneButton showLabel={showLabels} checked={toggleButtons} />;\n}"}},Microphone.parameters)},1665:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Options",(function(){return Options}));__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Icon=__webpack_require__(1866),Label=__webpack_require__(1865),jsx_runtime=__webpack_require__(1),exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"Camera"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},Custom_snippet_OptionsButtonCustomExample=function OptionsButtonCustomExample(){return Object(jsx_runtime.jsx)(src.k,{showLabel:!0,menuProps:exampleOptionsMenuProps,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"CircleAddition",style:{color:"orange",fontSize:"20px"}},"optionsCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"darkviolet",fontStyle:"italic"},children:"More"},"optionsCustomLabelKey")}},"optionsCustomBtnKey")};Custom_snippet_OptionsButtonCustomExample.displayName="OptionsButtonCustomExample",Custom_snippet_OptionsButtonCustomExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonCustomExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Options/snippets/Custom.snippet.tsx"]={name:"OptionsButtonCustomExample",docgenInfo:Custom_snippet_OptionsButtonCustomExample.__docgenInfo,path:"stories/ControlBar/Buttons/Options/snippets/Custom.snippet.tsx"});var Default_snippet_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},Default_snippet_OptionsButtonDefaultExample=function OptionsButtonDefaultExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{menuProps:Default_snippet_exampleOptionsMenuProps})})};Default_snippet_OptionsButtonDefaultExample.displayName="OptionsButtonDefaultExample",Default_snippet_OptionsButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Options/snippets/Default.snippet.tsx"]={name:"OptionsButtonDefaultExample",docgenInfo:Default_snippet_OptionsButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/Options/snippets/Default.snippet.tsx"});var WithLabel_snippet_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},WithLabel_snippet_OptionsButtonWithLabelExample=function OptionsButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{showLabel:!0,menuProps:WithLabel_snippet_exampleOptionsMenuProps})})};WithLabel_snippet_OptionsButtonWithLabelExample.displayName="OptionsButtonWithLabelExample",WithLabel_snippet_OptionsButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Options/snippets/WithLabel.snippet.tsx"]={name:"OptionsButtonWithLabelExample",docgenInfo:WithLabel_snippet_OptionsButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Options/snippets/WithLabel.snippet.tsx"});var OptionsButtonCustomExampleText=__webpack_require__(1599).default,OptionsButtonDefaultExampleText=__webpack_require__(1600).default,OptionsButtonWithLabelExampleText=__webpack_require__(1601).default,Options_stories_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"camera1",text:"Full HD Webcam",title:"Full HD Webcam",canCheck:!0,isChecked:!0},{key:"camera2",text:"Macbook Pro Webcam",title:"Macbook Pro Webcam"}]}},{key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"mic1",text:"Realtek HD Audio",title:"Realtek HD Audio"},{key:"mic2",text:"Macbook Pro Mic",title:"Macbook Pro Mic",canCheck:!0,isChecked:!0}]}}]},Options_stories_OptionsStory=function OptionsStory(){var showLabels=Object(dist.boolean)("Show Labels",!1);return Object(jsx_runtime.jsx)(src.k,{showLabel:showLabels,menuProps:Options_stories_exampleOptionsMenuProps})};Options_stories_OptionsStory.displayName="OptionsStory";var Options=Options_stories_OptionsStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-controlbar-buttons-options"),title:"".concat(constants.a,"/ControlBar/Buttons/Options"),component:src.k,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"OptionsButton"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.k}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { OptionsButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The default `OptionsButton` component shows an horizontal `More` icon with no label as in the example below."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:OptionsButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_OptionsButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"OptionsButton with default label"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can display the button label which, by default, will show below the icon as `Options`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:OptionsButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_OptionsButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom OptionsButton Styles"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can change the styles of the `OptionsButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:OptionsButtonCustomExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_OptionsButtonCustomExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"OptionsButton Props"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"`OptionsButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.k})]})}()}}}};Options.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const showLabels = boolean('Show Labels', false);\n\n  return <OptionsButton showLabel={showLabels} menuProps={exampleOptionsMenuProps} />;\n}"}},Options.parameters)},1666:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ScreenShare",(function(){return ScreenShare}));__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Icon=__webpack_require__(1866),Label=__webpack_require__(1865),jsx_runtime=__webpack_require__(1),Custom_snippet_CustomScreenShareButtonExample=function CustomScreenShareButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Presentation",style:{color:"green",fontSize:"25px"}},"screenShareIconKey"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Presentation",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"screenShareIconKey")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Label.a,{style:{fontStyle:"italic"},children:"sharing screen"},"screenShareLabelKey"):Object(jsx_runtime.jsx)(Label.a,{children:"not sharing screen"},"screenShareLabelKey")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.n,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText}),Object(jsx_runtime.jsx)(src.n,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText})]})};Custom_snippet_CustomScreenShareButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomScreenShareButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/Custom.snippet.tsx"]={name:"CustomScreenShareButtonExample",docgenInfo:Custom_snippet_CustomScreenShareButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/Custom.snippet.tsx"});var Default_snippet_ScreenShareButtonExample=function ScreenShareButtonExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.n,{checked:!0},"micBtn1"),Object(jsx_runtime.jsx)(src.n,{},"micBtn2")]})};Default_snippet_ScreenShareButtonExample.displayName="ScreenShareButtonExample",Default_snippet_ScreenShareButtonExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/Default.snippet.tsx"]={name:"ScreenShareButtonExample",docgenInfo:Default_snippet_ScreenShareButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/Default.snippet.tsx"});var WithLabel_snippet_ScreenShareButtonWithLabelExample=function ScreenShareButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.n,{showLabel:!0,checked:!0})})};WithLabel_snippet_ScreenShareButtonWithLabelExample.displayName="ScreenShareButtonWithLabelExample",WithLabel_snippet_ScreenShareButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/WithLabel.snippet.tsx"]={name:"ScreenShareButtonWithLabelExample",docgenInfo:WithLabel_snippet_ScreenShareButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/WithLabel.snippet.tsx"});var CustomButtonExampleText=__webpack_require__(1602).default,DefaultButtonExampleText=__webpack_require__(1603).default,ButtonWithLabelExampleText=__webpack_require__(1604).default,ScreenShare_stories_ScreenShareStory=function ScreenShareStory(){var toggleButtons=Object(dist.boolean)("Toggle Buttons",!1),showLabels=Object(dist.boolean)("Show Labels",!1);return Object(jsx_runtime.jsx)(src.n,{showLabel:showLabels,checked:toggleButtons})};ScreenShare_stories_ScreenShareStory.displayName="ScreenShareStory";var ScreenShare=ScreenShare_stories_ScreenShareStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-controlbar-buttons-screenshare"),title:"".concat(constants.a,"/ControlBar/Buttons/Screen Share"),component:src.n,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"ScreenShareButton"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.n}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { ScreenShareButton } from '@azure/communication-ui';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The default `ScreenShareButton` component shows a ScreenShare icon with no label. The following example displays the `ScreenShareButton` with screen sharing enabled and disabled."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:DefaultButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_ScreenShareButtonExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"ScreenShare with default label"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can display the button label which, by default, will show below the icon as `Share` or `Stop`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:ButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_ScreenShareButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom ScreenShareButton Styles"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"You can change the styles of the `ScreenShareButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomScreenShareButtonExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"ScreenShareButton Props"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"`ScreenShareButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties:"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.n})]})}()}}}};ScreenShare.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const toggleButtons = boolean('Toggle Buttons', false);\n  const showLabels = boolean('Show Labels', false);\n\n  return <ScreenShareButton showLabel={showLabels} checked={toggleButtons} />;\n}"}},ScreenShare.parameters)},1667:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ParticipantItem",(function(){return ParticipantItem}));__webpack_require__(40),__webpack_require__(39),__webpack_require__(83),__webpack_require__(99),__webpack_require__(55),__webpack_require__(206),__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),Stack=__webpack_require__(435),CallControlPresentNewIcon=__webpack_require__(1827),MicOffIcon=__webpack_require__(1828),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Persona_types=__webpack_require__(26),jsx_runtime=__webpack_require__(1),CustomAvatar_snippet_CustomAvatarExample=function CustomAvatarExample(){var avatarStyle={borderRadius:20,display:"block"};return Object(jsx_runtime.jsx)(src.l,{displayName:"Annie Lindqvist",presence:Persona_types.b.online,onRenderAvatar:function onRenderAvatar(){return Object(jsx_runtime.jsx)("img",{src:"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png",width:"32px",height:"32px",style:avatarStyle})}})};CustomAvatar_snippet_CustomAvatarExample.displayName="CustomAvatarExample",CustomAvatar_snippet_CustomAvatarExample.__docgenInfo={description:"",methods:[],displayName:"CustomAvatarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/CustomAvatar.snippet.tsx"]={name:"CustomAvatarExample",docgenInfo:CustomAvatar_snippet_CustomAvatarExample.__docgenInfo,path:"stories/ParticipantItem/snippets/CustomAvatar.snippet.tsx"});var Icon=__webpack_require__(1866),CustomIcon_snippet_CustomIconExample=function CustomIconExample(){var onRenderIcon=function onRenderIcon(props){return"Patrick"===(null==props?void 0:props.displayName)?Object(jsx_runtime.jsx)(Icon.a,{iconName:"FavoriteStar"}):null!=props&&props.me?null:Object(jsx_runtime.jsx)(Icon.a,{iconName:"AddFriend"})};return Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)(src.l,{displayName:"Spongebob",presence:Persona_types.b.online,me:!0,onRenderIcon:onRenderIcon}),Object(jsx_runtime.jsx)(src.l,{displayName:"Patrick",presence:Persona_types.b.online,onRenderIcon:onRenderIcon}),Object(jsx_runtime.jsx)(src.l,{displayName:"Sandy",presence:Persona_types.b.online,onRenderIcon:onRenderIcon})]})};CustomIcon_snippet_CustomIconExample.displayName="CustomIconExample",CustomIcon_snippet_CustomIconExample.__docgenInfo={description:"",methods:[],displayName:"CustomIconExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/CustomIcon.snippet.tsx"]={name:"CustomIconExample",docgenInfo:CustomIcon_snippet_CustomIconExample.__docgenInfo,path:"stories/ParticipantItem/snippets/CustomIcon.snippet.tsx"});var ParticipantItem_snippet_ParticipantItemExample=function ParticipantItemExample(){var menuItems=[{key:"Mute",text:"Mute",onClick:function onClick(){return alert("Mute")}},{key:"Remove",text:"Remove",onClick:function onClick(){return alert("Remove")}}];return Object(jsx_runtime.jsx)(src.l,{displayName:"Johnny Bravo",menuItems:menuItems,presence:Persona_types.b.online})};ParticipantItem_snippet_ParticipantItemExample.displayName="ParticipantItemExample",ParticipantItem_snippet_ParticipantItemExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantItemExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/ParticipantItem.snippet.tsx"]={name:"ParticipantItemExample",docgenInfo:ParticipantItem_snippet_ParticipantItemExample.__docgenInfo,path:"stories/ParticipantItem/snippets/ParticipantItem.snippet.tsx"});var CustomAvatarExampleText=__webpack_require__(1632).default,CustomIconExampleText=__webpack_require__(1633).default,ParticipantItemExampleText=__webpack_require__(1634).default,onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},ParticipantItem_stories_ParticipantItemStory=function ParticipantItemStory(){var displayName=Object(dist.text)("Name","Jim"),isScreenSharing=Object(dist.boolean)("Is screen sharing",!1),isMuted=Object(dist.boolean)("Is muted",!1),me=Object(dist.boolean)("Is You",!1),menuItems=Object(dist.text)("Menu items (comma separated)","Mute, Remove").split(",").map((function(menuItem){return menuItem.trim()})).filter(onlyUnique).map((function(menuItem){return{key:menuItem,text:menuItem}})),tokenProps={childrenGap:"0.5rem"};return Object(jsx_runtime.jsx)("div",{style:{width:"12rem"},children:Object(jsx_runtime.jsx)(src.l,{displayName:displayName,me:me,menuItems:menuItems,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:tokenProps,children:[isScreenSharing&&Object(jsx_runtime.jsx)(CallControlPresentNewIcon.a,{size:"small"}),isMuted&&Object(jsx_runtime.jsx)(MicOffIcon.a,{size:"small"})]})}})})};ParticipantItem_stories_ParticipantItemStory.displayName="ParticipantItemStory";var ParticipantItem=ParticipantItem_stories_ParticipantItemStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-participantitem"),title:"".concat(constants.a,"/Participant Item"),component:src.l,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"ParticipantItem"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.l}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { ParticipantItem, ParticipantItemProps } from '@azure/communication-react';\nimport { IContextualMenuItem, PersonaPresence } from '@fluentui/react';"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Usage"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Here is an example of how to use `ParticipantItem.` In this example, the `menuItems` property is used to add a context menu. The type of `menuItems` is an array of [IContextualMenuItem](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuItem). Click on the rendered participant below to see the menu items."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:ParticipantItemExampleText,children:Object(jsx_runtime.jsx)(ParticipantItem_snippet_ParticipantItemExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom avatar"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To customize the avatar, use the `onRenderAvatar` property like in the example below. We recommend the avatar element to be within 32 by 32 pixels."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomAvatarExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_CustomAvatarExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Add icon"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To add an icon, use the `onRenderIcon` property like in the example below."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomIconExampleText,children:Object(jsx_runtime.jsx)(CustomIcon_snippet_CustomIconExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.l})]})}()}}}};ParticipantItem.parameters=Object.assign({storySource:{source:"() => {\n  const displayName = text('Name', 'Jim');\n  const isScreenSharing = boolean('Is screen sharing', false);\n  const isMuted = boolean('Is muted', false);\n  const me = boolean('Is You', false);\n  const menuItemsStr = text('Menu items (comma separated)', 'Mute, Remove');\n\n  const menuItems = menuItemsStr\n    .split(',')\n    .map((menuItem) => menuItem.trim())\n    .filter(onlyUnique)\n    .map((menuItem) => {\n      return {\n        key: menuItem,\n        text: menuItem\n      };\n    });\n\n  const containerStyle = { width: '12rem' };\n\n  const tokenProps = { childrenGap: '0.5rem' };\n\n  return (\n    <div style={containerStyle}>\n      <ParticipantItemComponent\n        displayName={displayName}\n        me={me}\n        menuItems={menuItems}\n        onRenderIcon={() => (\n          <Stack horizontal={true} tokens={tokenProps}>\n            {isScreenSharing && <CallControlPresentNewIcon size=\"small\" />}\n            {isMuted && <MicOffIcon size=\"small\" />}\n          </Stack>\n        )}\n      />\n    </div>\n  );\n}"}},ParticipantItem.parameters)},1668:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ParticipantList",(function(){return ParticipantList}));__webpack_require__(40),__webpack_require__(83),__webpack_require__(39),__webpack_require__(99),__webpack_require__(55),__webpack_require__(206),__webpack_require__(50),__webpack_require__(61),__webpack_require__(70),__webpack_require__(80),__webpack_require__(10),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(24),__webpack_require__(20),__webpack_require__(13);var src=__webpack_require__(6),Stack=__webpack_require__(435),blocks=__webpack_require__(5),dist=__webpack_require__(18),react=__webpack_require__(0),constants=__webpack_require__(23),jsx_runtime=__webpack_require__(1),DefaultCall_snippet_DefaultCallParticipantListExample=function DefaultCallParticipantListExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.m,{participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],myUserId:"user1"})]})})};DefaultCall_snippet_DefaultCallParticipantListExample.displayName="DefaultCallParticipantListExample",DefaultCall_snippet_DefaultCallParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"DefaultCallParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/DefaultCall.snippet.tsx"]={name:"DefaultCallParticipantListExample",docgenInfo:DefaultCall_snippet_DefaultCallParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/DefaultCall.snippet.tsx"});var DefaultChat_snippet_DefaultChatParticipantListExample=function DefaultChatParticipantListExample(){return Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.m,{participants:[{userId:"user 1",displayName:"You"},{userId:"user 2",displayName:"Hal Jordan"},{userId:"user 3",displayName:"Barry Allen"},{userId:"user 4",displayName:"Bruce Wayne"}]})]})};DefaultChat_snippet_DefaultChatParticipantListExample.displayName="DefaultChatParticipantListExample",DefaultChat_snippet_DefaultChatParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"DefaultChatParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/DefaultChat.snippet.tsx"]={name:"DefaultChatParticipantListExample",docgenInfo:DefaultChat_snippet_DefaultChatParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/DefaultChat.snippet.tsx"});var Persona_types=__webpack_require__(26),Icon=__webpack_require__(1866);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var InteractiveCall_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0},{userId:"user2",displayName:"Peter Parker",state:"Connected",isMuted:!1},{userId:"user3",displayName:"Matthew Murdock",state:"Idle",isMuted:!1},{userId:"user4",displayName:"Frank Castiglione",state:"Connecting",isMuted:!1}],InteractiveCall_snippet_InteractiveCallParticipantListExample=function InteractiveCallParticipantListExample(){var _useState2=_slicedToArray(Object(react.useState)(InteractiveCall_snippet_mockParticipants),2),participants=_useState2[0],setParticpants=_useState2[1];return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.m,{participants:participants,myUserId:"user1",onRenderParticipant:function onRenderParticipant(participant){var participantIndex=participants.map((function(p){return p.userId})).indexOf(participant.userId),callingParticipant=participants[participantIndex],presence=void 0;callingParticipant&&("Connected"===callingParticipant.state?presence=Persona_types.b.online:"Idle"===callingParticipant.state?presence=Persona_types.b.away:"Connecting"===callingParticipant.state&&(presence=Persona_types.b.offline));var menuItems=[{key:"mute",text:callingParticipant.isMuted?"Unmute":"Mute",onClick:function onClick(){var newParticipants=_toConsumableArray(participants);newParticipants[participantIndex].isMuted=!participants[participantIndex].isMuted,setParticpants(newParticipants)}}],onRenderIcon=null!=callingParticipant&&callingParticipant.isMuted?function(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"MicOff2"})}:function(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})};return participant.displayName?Object(jsx_runtime.jsx)(src.l,{displayName:participant.displayName,me:"user1"===participant.userId,menuItems:menuItems,presence:presence,onRenderIcon:onRenderIcon}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}})]})})};function ParticipantList_stories_toConsumableArray(arr){return function ParticipantList_stories_arrayWithoutHoles(arr){if(Array.isArray(arr))return ParticipantList_stories_arrayLikeToArray(arr)}(arr)||function ParticipantList_stories_iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function ParticipantList_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantList_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantList_stories_arrayLikeToArray(o,minLen)}(arr)||function ParticipantList_stories_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantList_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}InteractiveCall_snippet_InteractiveCallParticipantListExample.displayName="InteractiveCallParticipantListExample",InteractiveCall_snippet_InteractiveCallParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"InteractiveCallParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/InteractiveCall.snippet.tsx"]={name:"InteractiveCallParticipantListExample",docgenInfo:InteractiveCall_snippet_InteractiveCallParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/InteractiveCall.snippet.tsx"});var DefaultCallParticipantListExampleText=__webpack_require__(1635).default,DefaultChatParticipantListExampleText=__webpack_require__(1636).default,InteractiveCallParticipantListExampleText=__webpack_require__(1637).default,onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},ParticipantList_stories_ParticipantListStory=function ParticipantListStory(){var participantNames=Object(dist.text)("Other participants (comma separated)","Rick, Daryl, Michonne").split(",").map((function(p){return p.trim()})).filter((function(p){return p})).filter(onlyUnique);participantNames.push("You");var screenSharer=Object(dist.select)("Screensharer",["None"].concat(ParticipantList_stories_toConsumableArray(participantNames)),"screensharer"),callStates=[],mutedFlags=[];participantNames.forEach((function(p){callStates.push(Object(dist.select)("Call status of "+p,["Idle","Connecting","Ringing","Connected","Hold","InLobby","EarlyMedia","Disconnected"],"Connected")),mutedFlags.push(Object(dist.boolean)("Is "+p+" muted",!1))}));var mockParticipants=participantNames.map((function(p,i){return{userId:"userId ".concat(i),displayName:p,state:callStates[i],isMuted:mutedFlags[i],isScreenSharing:p===screenSharer}})),myUserId=mockParticipants[mockParticipants.length-1].userId;return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(src.m,{participants:mockParticipants,myUserId:myUserId,onParticipantRemove:function onParticipantRemove(_userId){}})})};ParticipantList_stories_ParticipantListStory.displayName="ParticipantListStory";var ParticipantList=ParticipantList_stories_ParticipantListStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-participantlist"),title:"".concat(constants.a,"/Participant List"),component:src.m,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"Participant List"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.m}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Default example for Chat"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The ParticipantList for chat is by default a list of [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components linked with state around each chat participant."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:DefaultChatParticipantListExampleText,children:Object(jsx_runtime.jsx)(DefaultChat_snippet_DefaultChatParticipantListExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Default example for Calling"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"ParticipantList for calling is by default a list of [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components with presence linked to the participant call state, as well as icons for microphone and screen sharing states"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:DefaultCallParticipantListExampleText,children:Object(jsx_runtime.jsx)(DefaultCall_snippet_DefaultCallParticipantListExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Interactive Call example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"ParticpantList is designed with a rendering override, `onRenderParticipant`, which allows you to have your own design or use the your own [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components with their context menu style enabling interaction with this participant. For example, let us add menu items and icons to the participants using `menuItems` and `onRenderIcon` properties of [ParticipantItem](./?path=/docs/ui-components-participantitem--participant-item#props) like in the code below."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"For simplicity, we are using React `useState` to keep the state of every participant to decide which menu items and icons to show. You can now mute and unmute by clicking a participant in the rendered example below."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: Each `ParticipantItem` needs a unique key to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:InteractiveCallParticipantListExampleText,children:Object(jsx_runtime.jsx)(InteractiveCall_snippet_InteractiveCallParticipantListExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.m})]})}()}}}};ParticipantList.parameters=Object.assign({storySource:{source:"() => {\n  const remoteParticipantsKnob = text('Other participants (comma separated)', 'Rick, Daryl, Michonne');\n  const participantNames = remoteParticipantsKnob\n    .split(',')\n    .map((p) => p.trim())\n    .filter((p) => p)\n    .filter(onlyUnique);\n\n  participantNames.push('You');\n\n  const screenSharer = select('Screensharer', ['None', ...participantNames], 'screensharer');\n  const callStates: string[] = [];\n  const mutedFlags: boolean[] = [];\n\n  participantNames.forEach((p) => {\n    callStates.push(\n      select(\n        'Call status of ' + p,\n        ['Idle', 'Connecting', 'Ringing', 'Connected', 'Hold', 'InLobby', 'EarlyMedia', 'Disconnected'],\n        'Connected'\n      )\n    );\n    mutedFlags.push(boolean('Is ' + p + ' muted', false));\n  });\n\n  const mockParticipants = participantNames.map((p, i) => {\n    return {\n      userId: `userId ${i}`,\n      displayName: p,\n      state: callStates[i],\n      isMuted: mutedFlags[i],\n      isScreenSharing: p === screenSharer\n    };\n  });\n\n  const myUserId = mockParticipants[mockParticipants.length - 1].userId;\n\n  \n  const onParticipantRemove = (_userId: string): void => {\n    // Do something when remove a participant from list\n  };\n\n  return (\n    <Stack>\n      <ParticipantListComponent\n        participants={mockParticipants}\n        myUserId={myUserId}\n        onParticipantRemove={onParticipantRemove}\n      />\n    </Stack>\n  );\n}"}},ParticipantList.parameters)},1669:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TypingIndicator",(function(){return TypingIndicator}));__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),jsx_runtime=__webpack_require__(1),CustomStyling_snippet_CustomStylingSnippet=function CustomStylingSnippet(){return Object(jsx_runtime.jsx)(src.q,{typingUsers:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}],styles:{root:{border:"1px solid darkblue",width:"400px",padding:"5px"},typingUserDisplayName:{font:"15px Tahoma , sans-serif;"},typingString:{color:"slategrey"}}})};CustomStyling_snippet_CustomStylingSnippet.displayName="CustomStylingSnippet",CustomStyling_snippet_CustomStylingSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomStylingSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/CustomStyling.snippet.tsx"]={name:"CustomStylingSnippet",docgenInfo:CustomStyling_snippet_CustomStylingSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/CustomStyling.snippet.tsx"});__webpack_require__(39),__webpack_require__(56);var lib=__webpack_require__(34);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var CustomUserRender_snippet_CustomUserRenderSnippet=function CustomUserRenderSnippet(){var _imageMap,avatarStyle={borderRadius:20,display:"block"},imageMap=(_defineProperty(_imageMap={},"1","https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png"),_defineProperty(_imageMap,"2","https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-male.png"),_imageMap),verticallyCenterStyle=Object(lib.G)({display:"flex",alignItems:"center"}),spanStyle=Object(lib.G)({whiteSpace:"nowrap",paddingRight:"3px"});return Object(jsx_runtime.jsx)(src.q,{typingUsers:[{userId:"1",displayName:"Annie Lindqvist"},{userId:"2",displayName:"Ted Randall"}],onRenderUsers:function onRenderUsers(users){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:users.map((function(user,index){return Object(jsx_runtime.jsxs)("div",{className:verticallyCenterStyle,children:[Object(jsx_runtime.jsx)("img",{src:imageMap[user.userId],width:"32px",height:"32px",style:avatarStyle}),Object(jsx_runtime.jsxs)("span",{className:spanStyle,children:[user.displayName,index<users.length-1&&", "]})]},"".concat(user.displayName,"UserKey"))}))})}})};CustomUserRender_snippet_CustomUserRenderSnippet.displayName="CustomUserRenderSnippet",CustomUserRender_snippet_CustomUserRenderSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomUserRenderSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/CustomUserRender.snippet.tsx"]={name:"CustomUserRenderSnippet",docgenInfo:CustomUserRender_snippet_CustomUserRenderSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/CustomUserRender.snippet.tsx"});var TypingIndicator_snippet_TypingIndicatorSnippet=function TypingIndicatorSnippet(){for(var oneTypingUsers=[{userId:"1",displayName:"User1"}],twentyUsers=[],idx=0;idx<20;idx++)twentyUsers.push({userId:"".concat(idx),displayName:"User".concat(idx)});return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.q,{typingUsers:oneTypingUsers}),Object(jsx_runtime.jsx)(src.q,{typingUsers:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}]}),Object(jsx_runtime.jsx)(src.q,{typingUsers:twentyUsers}),Object(jsx_runtime.jsx)(src.q,{typingUsers:oneTypingUsers,typingString:" is composing a message..."})]})};TypingIndicator_snippet_TypingIndicatorSnippet.__docgenInfo={description:"",methods:[],displayName:"TypingIndicatorSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/TypingIndicator.snippet.tsx"]={name:"TypingIndicatorSnippet",docgenInfo:TypingIndicator_snippet_TypingIndicatorSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/TypingIndicator.snippet.tsx"});var CustomStylingSnippetText=__webpack_require__(1642).default,CustomUserRenderSnippetText=__webpack_require__(1643).default,TypingIndicatorSnippetText=__webpack_require__(1644).default,TypingIndicator_stories_TypingIndicatorStory=function TypingIndicatorStory(){var typingUsers=Object(dist.object)("Typing Users",[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}]),typingString=Object(dist.boolean)("Override typing string?",!1)?Object(dist.text)("Typing String"," are typing away..."):void 0;return Object(jsx_runtime.jsx)(src.q,{typingUsers:typingUsers,typingString:typingString})};TypingIndicator_stories_TypingIndicatorStory.displayName="TypingIndicatorStory";var TypingIndicator=TypingIndicator_stories_TypingIndicatorStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-typingindicator"),title:"".concat(constants.a,"/Typing Indicator"),component:src.q,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"TypingIndicator"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.q}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"import { TypingIndicator } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:TypingIndicatorSnippetText,children:Object(jsx_runtime.jsx)(TypingIndicator_snippet_TypingIndicatorSnippet,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Customize style"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To customize the style of `TypingIndicator`, use the `styles` property like in the example below. Notice that the keys of `styles` property are the root and sub-components of `TypingIndicator`, each of which can be styled independently."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomStylingSnippetText,children:Object(jsx_runtime.jsx)(CustomStyling_snippet_CustomStylingSnippet,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Customize user rendering"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To customize user rendering of `TypingIndicator`, use the `onRenderUsers` property like in the example below. Note when this property is assigned you must apply style directly. The `styles` property will not apply."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomUserRenderSnippetText,children:Object(jsx_runtime.jsx)(CustomUserRender_snippet_CustomUserRenderSnippet,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.q})]})}()}}}};TypingIndicator.parameters=Object.assign({storySource:{source:"() => {\n  const typingUsers = object('Typing Users', [\n    {\n      userId: '1',\n      displayName: 'User1'\n    },\n    {\n      userId: '2',\n      displayName: 'User2'\n    }\n  ]);\n  const overrideTypingString = boolean('Override typing string?', false);\n  const typingString = overrideTypingString ? text('Typing String', ' are typing away...') : undefined;\n  return <TypingIndicatorComponent typingUsers={typingUsers} typingString={typingString} />;\n}"}},TypingIndicator.parameters)},1670:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"VideoGallery",(function(){return VideoGallery}));__webpack_require__(40),__webpack_require__(39),__webpack_require__(83),__webpack_require__(99),__webpack_require__(55),__webpack_require__(206),__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),Stack=__webpack_require__(435),jsx_runtime=__webpack_require__(1),MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker",state:"Connected",isMuted:!1},{userId:"user3",displayName:"Thor",state:"Connecting",isMuted:!1},{userId:"user4",displayName:"Matthew Murdock",state:"Idle",isMuted:!1},{userId:"user5",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],CustomAvatar_snippet_CustomAvatarVideoGalleryExample=function CustomAvatarVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"30rem"},children:Object(jsx_runtime.jsx)(src.r,{localParticipant:MockLocalParticipant,remoteParticipants:MockRemoteParticipants,onRenderAvatar:function onRenderAvatar(placeholderProps,defaultOnRender){switch(placeholderProps.displayName){case"You":return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"100px",width:"100px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})});case"Thor":return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/7FgZWm6sGY0CNphZDJ/giphy.gif",style:{width:"100px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})});default:return defaultOnRender(placeholderProps)}}})})};CustomAvatar_snippet_CustomAvatarVideoGalleryExample.displayName="CustomAvatarVideoGalleryExample",CustomAvatar_snippet_CustomAvatarVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"CustomAvatarVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/CustomAvatar.snippet.tsx"]={name:"CustomAvatarVideoGalleryExample",docgenInfo:CustomAvatar_snippet_CustomAvatarVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/CustomAvatar.snippet.tsx"});var CustomStyle_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},CustomStyle_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],CustomStyle_snippet_CustomStyleVideoGalleryExample=function CustomStyleVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"30rem"},children:Object(jsx_runtime.jsx)(src.r,{styles:{root:{border:"solid 5px red"}},localParticipant:CustomStyle_snippet_MockLocalParticipant,remoteParticipants:CustomStyle_snippet_MockRemoteParticipants})})};CustomStyle_snippet_CustomStyleVideoGalleryExample.displayName="CustomStyleVideoGalleryExample",CustomStyle_snippet_CustomStyleVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"CustomStyleVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/CustomStyle.snippet.tsx"]={name:"CustomStyleVideoGalleryExample",docgenInfo:CustomStyle_snippet_CustomStyleVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/CustomStyle.snippet.tsx"});var Default_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},Default_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],Default_snippet_DefaultVideoGalleryExample=function DefaultVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"30rem"},children:Object(jsx_runtime.jsx)(src.r,{localParticipant:Default_snippet_MockLocalParticipant,remoteParticipants:Default_snippet_MockRemoteParticipants})})};Default_snippet_DefaultVideoGalleryExample.displayName="DefaultVideoGalleryExample",Default_snippet_DefaultVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"DefaultVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/Default.snippet.tsx"]={name:"DefaultVideoGalleryExample",docgenInfo:Default_snippet_DefaultVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/Default.snippet.tsx"});var CustomAvatarVideoGalleryExampleText=__webpack_require__(1645).default,CustomStyleVideoGalleryExampleText=__webpack_require__(1646).default,DefaultVideoGalleryExampleText=__webpack_require__(1647).default,VideoGallery_stories_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},VideoGallery_stories_VideoGalleryStory=function VideoGalleryStory(){var remoteParticipants=Object(dist.text)("Other participants (comma separated)","Rick, Daryl, Michonne, Dwight").split(",").map((function(p){return p.trim()})).filter((function(p){return p})).filter(onlyUnique).map((function(p,i){return{userId:"user".concat(i),displayName:p}}));return Object(jsx_runtime.jsx)(src.r,{localParticipant:VideoGallery_stories_MockLocalParticipant,remoteParticipants:remoteParticipants})};VideoGallery_stories_VideoGalleryStory.displayName="VideoGalleryStory";var VideoGallery=VideoGallery_stories_VideoGalleryStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-videogallery"),title:"".concat(constants.a,"/Video Gallery"),component:src.r,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"Video Gallery"}),Object(jsx_runtime.jsx)(blocks.Description,{of:src.r}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"import { VideoGallery } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Default Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"VideoGallery is by default a grid of [VideoTile](./?path=/docs/ui-components-videotile--video-tile) components representing each participant to the call."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:DefaultVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_DefaultVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom Avatar"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Rendering of avatars can be customized through the VideoGallery callback `onRenderAvatar`."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomAvatarVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_CustomAvatarVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Custom Style"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Style of the VideoGallery container can be customized through its `styles` props."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:CustomStyleVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(CustomStyle_snippet_CustomStyleVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.r})]})}()}}}};VideoGallery.parameters=Object.assign({storySource:{source:"() => {\n  const remoteParticipantsKnob = text('Other participants (comma separated)', 'Rick, Daryl, Michonne, Dwight');\n  const remoteParticipants = remoteParticipantsKnob\n    .split(',')\n    .map((p) => p.trim())\n    .filter((p) => p)\n    .filter(onlyUnique)\n    .map((p, i) => {\n      return {\n        userId: `user${i}`,\n        displayName: p\n      };\n    });\n\n  return <VideoGalleryComponent localParticipant={MockLocalParticipant} remoteParticipants={remoteParticipants} />;\n}"}},VideoGallery.parameters)},1672:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"parameters",(function(){return parameters})),__webpack_require__.d(__webpack_exports__,"decorators",(function(){return decorators})),__webpack_require__.d(__webpack_exports__,"globalTypes",(function(){return globalTypes}));__webpack_require__(10),__webpack_require__(13);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),dist=__webpack_require__(18),src=__webpack_require__(6),lib=__webpack_require__(34),icons_lib=__webpack_require__(1846),blocks=__webpack_require__(5),storybook_docs_toc_lib=(__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(24),__webpack_require__(565)),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TOC_TOC=function TOC(props){var _useState2=_slicedToArray(Object(react.useState)(window.matchMedia("(max-width: 1200px)").matches),2),narrowDocs=_useState2[0],setNarrowDocs=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(window.matchMedia("(max-width: 900px)").matches),2),hideToc=_useState4[0],setHideToc=_useState4[1];Object(react.useEffect)((function(){var setNarrowDocsHandler=function setNarrowDocsHandler(e){return setNarrowDocs(e.matches)},setHideTocHandler=function setHideTocHandler(e){return setHideToc(e.matches)};return window.matchMedia("(max-width: 1200px)").addEventListener("change",setNarrowDocsHandler),window.matchMedia("(max-width: 900px)").addEventListener("change",setHideTocHandler),function(){window.matchMedia("(max-width: 1200px)").removeEventListener("change",setNarrowDocsHandler),window.matchMedia("(max-width: 900px)").removeEventListener("change",setHideTocHandler)}}));var tocStyles=Object(lib.G)({display:hideToc?"none":"block",fontFamily:"Segoe UI Regular",fontSize:"12px","& nav":{top:0,maxWidth:"10rem",right:0,"div > ol > li.toc-list-item":{padding:"0 0.5rem"},"div > ol > li > a.toc-link":{whiteSpace:"break-spaces !important",marginBottom:"4px",marginTop:"4px"},"a.toc-link":{whiteSpace:"break-spaces !important",marginBottom:"2px",marginTop:"2px"}}});return Object(jsx_runtime.jsxs)(react_default.a.Fragment,{children:[Object(jsx_runtime.jsx)("div",{className:tocStyles,children:Object(jsx_runtime.jsx)(storybook_docs_toc_lib.TableOfContents,{})}),Object(jsx_runtime.jsx)("div",{style:narrowDocs?{maxWidth:"768px"}:{},children:props.children}),Object(jsx_runtime.jsx)("div",{className:Object(lib.G)({"> button":{right:16}}),children:Object(jsx_runtime.jsx)(storybook_docs_toc_lib.BackToTop,{})})]})};TOC_TOC.displayName="TOC",TOC_TOC.__docgenInfo={description:"Table Of Contents component used for displaying a floating table of content\ninside Storybook Docs.\n@param props \n@returns",methods:[],displayName:"TOC",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES[".storybook/TOC.tsx"]={name:"TOC",docgenInfo:TOC_TOC.__docgenInfo,path:".storybook/TOC.tsx"});var constants=__webpack_require__(23),THEMES={Light:{name:"Light",theme:src.w},Dark:{name:"Dark",theme:src.v}};Object(lib.E)({}),Object(icons_lib.a)();var parameters={layout:"fullscreen",docs:{container:function container(props){return Object(jsx_runtime.jsx)(TOC_TOC,{children:Object(jsx_runtime.jsx)(blocks.DocsContainer,Object.assign({},props))})}},options:{storySort:{order:["Overview","Use Cases","Styling","Theming","Localization","Accessibility","Custom User Data Model","Feedback",constants.f,["Overview","Best Practices","React Hooks",["Setting up","UsePropsFor","UseSelector"]],constants.e,constants.c,constants.a,constants.d]}}},preview_withThemeProvider=function withThemeProvider(Story,context){var _THEMES$themeName,themeName=context.globals.theme,theme=null===(_THEMES$themeName=THEMES[themeName])||void 0===_THEMES$themeName?void 0:_THEMES$themeName.theme;if(context.globals.customTheme)try{theme=JSON.parse(context.globals.customTheme)}catch(e){console.log("Could not parse the following theme JSON: "+context.globals.customTheme)}return Object(jsx_runtime.jsx)(src.f,{fluentTheme:theme,children:Object(jsx_runtime.jsx)(Story,Object.assign({},context))})};preview_withThemeProvider.displayName="withThemeProvider";var preview_withCenterStory=function withCenterStory(Story){return Object(jsx_runtime.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:Object(jsx_runtime.jsx)(Story,{})})};preview_withCenterStory.displayName="withCenterStory";var decorators=[dist.withKnobs,preview_withCenterStory,preview_withThemeProvider],globalTypes={theme:{name:"Theme",description:"Global theme for components",defaultValue:THEMES.Light.name},customTheme:{name:"Custom theme",description:"Custom global theme for components",defaultValue:""}}},1673:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var esm=__webpack_require__(2),blocks=__webpack_require__(5);__webpack_require__(6);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(esm.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.mdx)(blocks.Meta,{id:"quickstarts-composites",title:"Quickstarts/Get started with Composites",mdxType:"Meta"}),Object(esm.mdx)("h1",{id:"quickstart-get-started-with-composites"},"Quickstart: Get started with Composites"),Object(esm.mdx)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how to integrate UI Library base components into your application to build communication experiences."),Object(esm.mdx)("p",null,"UI Library components come in two flavors: UI and Composite."),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("strong",{parentName:"li"},"UI components")," represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences."),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("strong",{parentName:"li"},"Composite components")," are turn-key experiences for common communication scenarios that have been built using ",Object(esm.mdx)("strong",{parentName:"li"},"base components")," as building blocks and packaged to be easily integrated into applications.")),Object(esm.mdx)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.mdx)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 12 Recommended)."),Object(esm.mdx)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.mdx)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),".")),Object(esm.mdx)("h2",{id:"setting-up"},"Setting Up"),Object(esm.mdx)("p",null,"UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section."),Object(esm.mdx)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.mdx)("p",null,"We'll use the create-react-app template for this quickstart. For more information, see: ",Object(esm.mdx)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-toolkit-quickstart-composites --template typescript\n\ncd ui-toolkit-quickstart-composites\n\n")),Object(esm.mdx)("p",null,"At the end of this process, you should have a full application inside of the folder ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ui-toolkit-quickstart-composites"),".\nFor this quickstart, we'll be modifying files inside of the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.mdx)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.mdx)("p",null,"Use the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm install --save @azure/communication-react\n\n")),Object(esm.mdx)("p",null,"The ",Object(esm.mdx)("inlineCode",{parentName:"p"},"--save")," option lists the library as a dependency in your ",Object(esm.mdx)("strong",{parentName:"p"},"package.json")," file."),Object(esm.mdx)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.mdx)("p",null,"Let's test the Create React App installation by running:"),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.mdx)("h2",{id:"object-model"},"Object Model"),Object(esm.mdx)("p",null,"The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:"),Object(esm.mdx)("table",null,Object(esm.mdx)("thead",{parentName:"table"},Object(esm.mdx)("tr",{parentName:"thead"},Object(esm.mdx)("th",{parentName:"tr",align:null},"Name"),Object(esm.mdx)("th",{parentName:"tr",align:null},"Description"))),Object(esm.mdx)("tbody",{parentName:"table"},Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/composites-call--basic-example"},"CallComposite")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Composite component that renders a calling experience with participant gallery and controls.")),Object(esm.mdx)("tr",{parentName:"tbody"},Object(esm.mdx)("td",{parentName:"tr",align:null},Object(esm.mdx)("a",{parentName:"td",href:"/?path=/story/composites-chat--basic-example"},"ChatComposite")),Object(esm.mdx)("td",{parentName:"tr",align:null},"Composite component that renders a chat experience with chat thread and input")))),Object(esm.mdx)("h2",{id:"set-up-adapters"},"Set Up Adapters"),Object(esm.mdx)("p",null,"Before we initialize the actual composite components, we need to set up the adapters that will power them.\nThese adapters take care of the entire state of the composites truly making them a turn-key solution.\nTo setup the adapters, developers needs to pass information on the call or chat they want to join."),Object(esm.mdx)("p",null,"The adapters require access tokens, group IDs, or thread IDs to be setup.\nThese elements come from services that go through the proper steps to generate these IDs and pass them to the client application.\nFor more information, see: ",Object(esm.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/client-and-server-architecture",target:"_blank",rel:"nofollow noopener noreferrer"},"Client Server Architecture"),".\nFor Example: The Group Chat composite expects that the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"userId")," associated to the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"token")," being used to initialize it has already been joined to the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"threadId")," being provided.\nIf the token hasn't been joined to the thread ID, then the Group Chat composite will fail.\nFor more information on chat, see: ",Object(esm.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/chat/get-started?pivots=programming-language-csharp",target:"_blank",rel:"nofollow noopener noreferrer"},"Getting Started with Chat")),Object(esm.mdx)("p",null,"Go to the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"src")," folder inside of ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ui-toolkit-quickstart-composites")," and look for the file ",Object(esm.mdx)("inlineCode",{parentName:"p"},"app.tsx"),"."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.mdx)(blocks.Source,{code:"import {\n  CallAdapter,\n  createAzureCommunicationCallAdapter,\n  ChatAdapter,\n  createAzureCommunicationChatAdapter\n} from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const displayName = '<Display Name>';\n  const token = '<Azure Communication Services Access Token>';\n\n  //Calling Variables\n  //For Group Id, developers can pass any GUID they can generate\n  const groupId = '<Developer generated GUID>';\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n\n  //Chat Variables\n  const threadId = '<Get thread id from chat service>';\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n\n  useEffect(() => {\n    const createAdapter = async (): Promise<void> => {\n      setChatAdapter(await createAzureCommunicationChatAdapter(token, endpointUrl, threadId, displayName));\n      setCallAdapter(await createAzureCommunicationCallAdapter(token, { groupId }, displayName));\n    };\n    createAdapter();\n  }, []);\n\n  return <>{callAdapter && chatAdapter && <h1>Hooray! You set up adapters 🎉🎉🎉</h1>}</>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.mdx)("p",null,"Next we will initialize the composite components with the adapters."),Object(esm.mdx)("h2",{id:"initialize-composites"},"Initialize Composites"),Object(esm.mdx)("p",null,"Go to the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"src")," folder inside of ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ui-toolkit-quickstart-composites")," and look for the file ",Object(esm.mdx)("inlineCode",{parentName:"p"},"app.tsx"),".\nHere we'll drop the following code to initialize our Composite Components for Chat and Calling using the adapters we set up above.\nYou can choose which one to use depending on the type of communication experience you're building.\nIf needed, you can use both at the same time."),Object(esm.mdx)("p",null,Object(esm.mdx)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.mdx)(blocks.Source,{code:"import {\n  CallComposite,\n  CallAdapter,\n  createAzureCommunicationCallAdapter,\n  ChatComposite,\n  ChatAdapter,\n  createAzureCommunicationChatAdapter\n} from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const displayName = '<Display Name>';\n  const token = '<Azure Communication Services Access Token>';\n\n  //Calling Variables\n  //For Group Id, developers can pass any GUID they can generate\n  const groupId = '<Developer generated GUID>';\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n\n  //Chat Variables\n  const threadId = '<Get thread id from chat service>';\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n\n  useEffect(() => {\n    const createAdapter = async (): Promise<void> => {\n      setChatAdapter(await createAzureCommunicationChatAdapter(token, endpointUrl, threadId, displayName));\n      setCallAdapter(await createAzureCommunicationCallAdapter(token, { groupId }, displayName));\n    };\n    createAdapter();\n  }, []);\n\n  return (\n    <>\n      {chatAdapter && <ChatComposite adapter={chatAdapter} />}\n      {callAdapter && <CallComposite adapter={callAdapter} />}\n    </>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.mdx)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.mdx)("p",null,"To run the code above use the command:"),Object(esm.mdx)("pre",null,Object(esm.mdx)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.mdx)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.mdx)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.mdx)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.mdx)("h2",{id:"next-steps"},"Next Steps"),Object(esm.mdx)("p",null,Object(esm.mdx)("a",{parentName:"p",href:"/?path=/story/quickstarts-uicomponents--page"},"Try UI Library UI Components")),Object(esm.mdx)("p",null,"For more information, see the following resources:"),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/styling--page"},"UI Library Styling")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("a",{parentName:"li",href:"/?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Quickstarts/Get started with Composites",id:"quickstarts-composites",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.mdx)(blocks.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.mdx)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1674:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(10),__webpack_require__(38),__webpack_require__(40),__webpack_require__(8),__webpack_require__(0);var esm=__webpack_require__(2),blocks=__webpack_require__(5),src=__webpack_require__(6),jsx_runtime=__webpack_require__(1),styles={root:{background:"white",border:"2px solid firebrick","& button":{":hover":{background:"black",color:"white"}}}},StylingControlBar_snippet_ControlBarExample=function ControlBarExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.d,{styles:styles,children:[Object(jsx_runtime.jsx)(src.b,{}),Object(jsx_runtime.jsx)(src.j,{}),Object(jsx_runtime.jsx)(src.e,{})]})})};StylingControlBar_snippet_ControlBarExample.displayName="ControlBarExample",StylingControlBar_snippet_ControlBarExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Styling/snippets/StylingControlBar.snippet.tsx"]={name:"ControlBarExample",docgenInfo:StylingControlBar_snippet_ControlBarExample.__docgenInfo,path:"stories/Styling/snippets/StylingControlBar.snippet.tsx"});var StylingVideoTile_snippet=__webpack_require__(417),snippets_StylingVideoTile_snippet=__webpack_require__(551);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,["components"]);return Object(esm.mdx)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.mdx)(blocks.Meta,{id:"styling",title:"Styling",mdxType:"Meta"}),Object(esm.mdx)("h1",{id:"styling"},"Styling"),Object(esm.mdx)("p",null,"The ability to style components using custom CSS is an important feature of Azure Communication UI Library.\nAll the UI Components have complete CSS support and provide complex styling capabilities."),Object(esm.mdx)("h2",{id:"overview"},"Overview"),Object(esm.mdx)("ul",null,Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("p",{parentName:"li"},"UI Components expose a ",Object(esm.mdx)("inlineCode",{parentName:"p"},"prop")," named ",Object(esm.mdx)("inlineCode",{parentName:"p"},"styles")," that accepts an Object containing custom CSS for the component root as well as it's child components.")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("p",{parentName:"li"},"Users can always provide the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"root")," property in ",Object(esm.mdx)("inlineCode",{parentName:"p"},"styles")," object and apply custom CSS to the component root.")),Object(esm.mdx)("li",{parentName:"ul"},Object(esm.mdx)("p",{parentName:"li"},"Properties in ",Object(esm.mdx)("inlineCode",{parentName:"p"},"styles")," object will vary from component to component."))),Object(esm.mdx)("h2",{id:"example---controlbar"},"Example - ControlBar"),Object(esm.mdx)("p",null,"Let's style the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"ControlBar")," component and components inside it using the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"root")," styles property."),Object(esm.mdx)(blocks.Source,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport React from 'react';\n\n// ControlBar component accepts a `styles` prop with only the `root` key as a valid property.\nconst styles = {\n  root: {\n    background: 'white',\n    border: '2px solid firebrick',\n    '& button': {\n      ':hover': {\n        background: 'black',\n        color: 'white'\n      }\n    }\n  }\n};\n\nexport const ControlBarExample = (): JSX.Element => {\n  return (\n    <FluentThemeProvider>\n      <ControlBar styles={styles}>\n        <CameraButton />\n        <MicrophoneButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.mdx)(blocks.Canvas,{withSource:"none",mdxSource:"%0A%3CControlBarExample%20/%3E%0A",mdxType:"Canvas"},Object(esm.mdx)(StylingControlBar_snippet_ControlBarExample,{mdxType:"ControlBarExample"})),Object(esm.mdx)("h2",{id:"example---videotile"},"Example - VideoTile"),Object(esm.mdx)("p",null,"Let's style the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"VideoTile")," component.\n",Object(esm.mdx)("inlineCode",{parentName:"p"},"VideoTile")," component allows you to style its ",Object(esm.mdx)("inlineCode",{parentName:"p"},"root")," element, the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"Video Container")," and the ",Object(esm.mdx)("inlineCode",{parentName:"p"},"Overlay Container")," (Content rendered in front of the Video Container)."),Object(esm.mdx)(blocks.Source,{code:snippets_StylingVideoTile_snippet.default,mdxType:"Source"}),Object(esm.mdx)(blocks.Canvas,{withSource:"none",mdxSource:"%0A%3CVideoTileExample%20/%3E%0A",mdxType:"Canvas"},Object(esm.mdx)(StylingVideoTile_snippet.a,{mdxType:"VideoTileExample"})))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Styling",id:"styling",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.mdx)(blocks.AddContext,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.mdx)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1675:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"VideoTile",(function(){return VideoTile}));__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),StylingVideoTile_snippet=__webpack_require__(417),utils=__webpack_require__(128),jsx_runtime=__webpack_require__(1),VideoTile_snippet_VideoTileExample=function VideoTileExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.s,{styles:{root:{height:"300px",width:"400px",border:"1px solid #999"}},displayName:"Maximus Aurelius",renderElement:Object(jsx_runtime.jsx)(src.p,{videoStreamElement:Object(utils.a)()}),isVideoReady:!1,isMirrored:!0})})};VideoTile_snippet_VideoTileExample.displayName="VideoTileExample",VideoTile_snippet_VideoTileExample.__docgenInfo={description:"",methods:[],displayName:"VideoTileExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoTile/snippets/VideoTile.snippet.tsx"]={name:"VideoTileExample",docgenInfo:VideoTile_snippet_VideoTileExample.__docgenInfo,path:"stories/VideoTile/snippets/VideoTile.snippet.tsx"});var Stack=__webpack_require__(435),VideoTilePlaceholder_snippet_onRenderPlaceholder=function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"150px",width:"150px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})})};VideoTilePlaceholder_snippet_onRenderPlaceholder.displayName="onRenderPlaceholder";var VideoTilePlaceholder_snippet_VideoTilePlaceholderExample=function VideoTilePlaceholderExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.s,{userId:"UserIdPlaceholder",styles:{root:{height:"300px",width:"400px",border:"1px solid #999"}},displayName:"Maximus Aurelius",renderElement:Object(jsx_runtime.jsx)(src.p,{videoStreamElement:Object(utils.a)()}),isVideoReady:!1,isMirrored:!0,onRenderPlaceholder:VideoTilePlaceholder_snippet_onRenderPlaceholder})})};VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.displayName="VideoTilePlaceholderExample",VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.__docgenInfo={description:"",methods:[],displayName:"VideoTilePlaceholderExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoTile/snippets/VideoTilePlaceholder.snippet.tsx"]={name:"VideoTilePlaceholderExample",docgenInfo:VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.__docgenInfo,path:"stories/VideoTile/snippets/VideoTilePlaceholder.snippet.tsx"});var VideoTileStylineExampleText=__webpack_require__(551).default,VideoTileExampleText=__webpack_require__(1648).default,VideoTilePlaceholderText=__webpack_require__(1649).default,VideoTile_stories_VideoTileStory=function VideoTileStory(){var displayName=Object(dist.text)("Display Name","John Krasinski"),showDisplayName=Object(dist.boolean)("show displayName",!0),isVideoReady=Object(dist.boolean)("Is Video Ready",!1),isMirrored=Object(dist.boolean)("Is Mirrored",!1),width=Object(dist.number)("Width",400,{range:!0,min:400,max:1200,step:10}),videoTileStyles={root:{height:Object(dist.number)("Height",300,{range:!0,min:300,max:800,step:10}),width:width}};return Object(jsx_runtime.jsx)(src.s,{isVideoReady:isVideoReady,renderElement:Object(jsx_runtime.jsx)(src.p,{videoStreamElement:Object(utils.a)()}),displayName:displayName,showDisplayName:showDisplayName,isMirrored:isMirrored,styles:{root:{videoTileStyles:videoTileStyles}}})};VideoTile_stories_VideoTileStory.displayName="VideoTileStory";var VideoTile=VideoTile_stories_VideoTileStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-videotile"),title:"".concat(constants.a,"/Video Tile"),component:src.s,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"VideoTile"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The VideoTile component displays a static component or the available video stream of a participant."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"import { VideoTile } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Subheading,{children:"Default Usage"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The default VideoTile component shows a displayName and a Persona with the initials of `displayName` when no video is available."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:VideoTileExampleText,children:Object(jsx_runtime.jsx)(VideoTile_snippet_VideoTileExample,{})}),Object(jsx_runtime.jsx)(blocks.Subheading,{children:"Custom Placeholder"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"A custom placeholder can be provided to override the default Persona avatar by providing a JSX element to the `placeholder` prop."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:VideoTilePlaceholderText,children:Object(jsx_runtime.jsx)(VideoTilePlaceholder_snippet_VideoTilePlaceholderExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Styling"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"A VideoTile component can be styled just like other components using the `styles` property."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:VideoTileStylineExampleText,children:Object(jsx_runtime.jsx)(StylingVideoTile_snippet.a,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.s})]})}()}}}};VideoTile.parameters=Object.assign({storySource:{source:"() => {\n  const displayName = text('Display Name', 'John Krasinski');\n  const showDisplayName = boolean('show displayName', true);\n  const isVideoReady = boolean('Is Video Ready', false);\n  const isMirrored = boolean('Is Mirrored', false);\n  const width = number('Width', 400, {\n    range: true,\n    min: 400,\n    max: 1200,\n    step: 10\n  });\n  const height = number('Height', 300, {\n    range: true,\n    min: 300,\n    max: 800,\n    step: 10\n  });\n\n  const videoTileStyles = {\n    root: {\n      height,\n      width\n    }\n  };\n\n  return (\n    <VideoTileComponent\n      isVideoReady={isVideoReady}\n      renderElement={<StreamMedia videoStreamElement={renderVideoStream()} />}\n      displayName={displayName}\n      showDisplayName={showDisplayName}\n      isMirrored={isMirrored}\n      styles={{\n        root: { videoTileStyles }\n      }}\n    />\n  );\n}"}},VideoTile.parameters)},1676:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"DeviceSettings",(function(){return DeviceSettings}));__webpack_require__(80),__webpack_require__(10);var Stack=__webpack_require__(435),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),src=(__webpack_require__(39),__webpack_require__(6)),Dropdown=__webpack_require__(1849),useTheme=__webpack_require__(402),jsx_runtime=__webpack_require__(1),DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample=function DeviceSettingDropdownExample(_ref){var devices=_ref.devices,onChange=_ref.onChange,theme=Object(useTheme.a)();return Object(jsx_runtime.jsx)(src.f,{fluentTheme:theme,children:Object(jsx_runtime.jsx)(Dropdown.a,{style:{width:"15rem"},placeholder:"Select an option",onChange:onChange,options:devices.map((function(device){return{selected:!1,key:device,text:device}}))})})};DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.displayName="DeviceSettingDropdownExample",DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.__docgenInfo={description:"",methods:[],displayName:"DeviceSettingDropdownExample",props:{devices:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption, index?: number) => void",signature:{arguments:[{name:"event",type:{name:"ReactFormEvent",raw:"React.FormEvent<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]}},{name:"option",type:{name:"IDropdownOption"}},{name:"index",type:{name:"number"}}],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/DevicesDropdown/snippets/DeviceSettingsDropdown.snippet.tsx"]={name:"DeviceSettingDropdownExample",docgenInfo:DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.__docgenInfo,path:"stories/Examples/DevicesDropdown/snippets/DeviceSettingsDropdown.snippet.tsx"});var DevicesDropdownExampleText=__webpack_require__(1610).default,DeviceSettingsDropDown_stories_DeviceSettingsStory=function DeviceSettingsStory(){return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample,{devices:["Logitech C920S HD Pro Webcam","Lenovo Essential FHD Webcam","Aukey PC-LM1E Full HD Webcam","AVerMedia PW315","Razer Kiyo"],onChange:function onChange(_,option){alert(null==option?void 0:option.text)}})})};DeviceSettingsDropDown_stories_DeviceSettingsStory.displayName="DeviceSettingsStory";var DeviceSettings=DeviceSettingsDropDown_stories_DeviceSettingsStory.bind({});__webpack_exports__.default={id:"".concat(constants.d,"-devicesettings"),title:"".concat(constants.d,"/Device Settings"),component:DeviceSettings,parameters:{docs:{page:function page(){return function getDocs(){var cameras=Object(dist.array)("Cameras",["Logitech C920S HD Pro Webcam","Lenovo Essential FHD Webcam","Aukey PC-LM1E Full HD Webcam","AVerMedia PW315","Razer Kiyo"]);return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"Device Setting"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Create a dropdown of cameras to select"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To build a UI component for device settings, we recommend using the Fluent UI [Dropdown](https://developer.microsoft.com/en-us/fluentui#/controls/web/dropdown). Using the retrieved devices from the calling sdk, apply the devices as options in the dropdown. When a user selects an element from the dropdown, use the `onChange` callback to save the result. For this case we are just going to use an array of placeholder cameras (strings) and we are going to demonstrate how to use a FluentUI `Dropdown` to create a list of devices for a user to select."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:DevicesDropdownExampleText,children:Object(jsx_runtime.jsx)(DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample,{devices:cameras,onChange:function onChange(_,option){alert(null==option?void 0:option.text)}})})]})}()}}}};DeviceSettings.parameters=Object.assign({storySource:{source:"() => {\n  const cameras = [\n    'Logitech C920S HD Pro Webcam',\n    'Lenovo Essential FHD Webcam',\n    'Aukey PC-LM1E Full HD Webcam',\n    'AVerMedia PW315',\n    'Razer Kiyo'\n  ];\n  return (\n    <Stack>\n      <DeviceSettingDropdownExample\n        devices={cameras}\n        onChange={(_, option) => {\n          alert(option?.text);\n        }}\n      />\n    </Stack>\n  );\n}"}},DeviceSettings.parameters)},1677:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"LocalPreview",(function(){return LocalPreview}));__webpack_require__(80),__webpack_require__(10);var blocks=__webpack_require__(5),dist=__webpack_require__(18),react=__webpack_require__(0),constants=__webpack_require__(23),src=(__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(6)),lib=__webpack_require__(34),Stack=__webpack_require__(435),Text=__webpack_require__(1869),CallVideoOffIcon=__webpack_require__(1830),useTheme=__webpack_require__(402),utils=__webpack_require__(128),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var LocalPreviewExample_snippet_LocalPreviewExample=function LocalPreviewExample(_ref){var isVideoAvailable=_ref.isVideoAvailable,isCameraEnabled=_ref.isCameraEnabled,isMicrophoneEnabled=_ref.isMicrophoneEnabled,_useState2=_slicedToArray(Object(react.useState)(!1),2),microphone=_useState2[0],setMicrophone=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!1),2),camera=_useState4[0],setCamera=_useState4[1],theme=Object(useTheme.a)(),palette=theme.palette,localPreviewContainerStyle=Object(lib.G)({minWidth:"25rem",width:"100%",height:"100%",maxHeight:"18.75rem",minHeight:"16.875rem",margin:"0 auto",background:palette.neutralLighter,color:palette.neutralTertiary}),cameraOffLabelStyle=Object(lib.G)({fontFamily:"Segoe UI Regular",fontSize:"0.625rem",color:palette.neutralTertiary}),renderCameraOffPlaceholder=Object(react.useCallback)((function(){return Object(jsx_runtime.jsxs)(Stack.a,{style:{width:"100%",height:"100%"},verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(CallVideoOffIcon.a,{})}),Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Text.a,{className:cameraOffLabelStyle,children:"Your camera is turned off"})})]})}),[cameraOffLabelStyle]);return Object(jsx_runtime.jsx)(src.f,{fluentTheme:theme,children:Object(jsx_runtime.jsx)(Stack.a,{style:{width:"100%",height:"100%"},verticalAlign:"center",children:Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Stack.a,{className:localPreviewContainerStyle,children:Object(jsx_runtime.jsx)(src.s,{styles:{root:{minHeight:"14rem"}},isVideoReady:isVideoAvailable,renderElement:Object(jsx_runtime.jsx)(src.p,{videoStreamElement:Object(utils.a)()}),onRenderPlaceholder:renderCameraOffPlaceholder,children:Object(jsx_runtime.jsxs)(src.d,{layout:"floatingBottom",children:[Object(jsx_runtime.jsx)(src.b,{disabled:!isCameraEnabled,checked:camera,onClick:function onClick(){return setCamera(!camera)}}),Object(jsx_runtime.jsx)(src.j,{disabled:!isMicrophoneEnabled,checked:microphone,onClick:function onClick(){return setMicrophone(!microphone)}})]})})})})})})};LocalPreviewExample_snippet_LocalPreviewExample.displayName="LocalPreviewExample",LocalPreviewExample_snippet_LocalPreviewExample.__docgenInfo={description:"",methods:[],displayName:"LocalPreviewExample",props:{isVideoAvailable:{required:!0,tsType:{name:"boolean"},description:""},isCameraEnabled:{required:!0,tsType:{name:"boolean"},description:""},isMicrophoneEnabled:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/LocalPreview/snippets/LocalPreviewExample.snippet.tsx"]={name:"LocalPreviewExample",docgenInfo:LocalPreviewExample_snippet_LocalPreviewExample.__docgenInfo,path:"stories/Examples/LocalPreview/snippets/LocalPreviewExample.snippet.tsx"});var LocalPreviewExampleText=__webpack_require__(1614).default,LocalPreview_stories_LocalPreviewStory=function LocalPreviewStory(){var isVideoAvailable=Object(dist.boolean)("Is video available",!0),isCameraEnabled=Object(dist.boolean)("Is camera available",!0),isMicrophoneEnabled=Object(dist.boolean)("Is microphone available",!0);return Object(jsx_runtime.jsx)(LocalPreviewExample_snippet_LocalPreviewExample,{isVideoAvailable:isVideoAvailable,isCameraEnabled:isCameraEnabled,isMicrophoneEnabled:isMicrophoneEnabled})};LocalPreview_stories_LocalPreviewStory.displayName="LocalPreviewStory";var LocalPreview=LocalPreview_stories_LocalPreviewStory.bind({});__webpack_exports__.default={id:"".concat(constants.d,"-localpreview"),title:"".concat(constants.d,"/Local Preview"),component:LocalPreview,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"Local Preview"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Basic example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"To build a local preview, we recommend using the Fluent UI [Stack](https://developer.microsoft.com/en-us/fluentui#/controls/web/stack) as a container as shown in the code below. For enabling and disabling the camera or microphone we suggest using the [Toggle](https://developer.microsoft.com/en-us/fluentui#/controls/web/toggle) component. The area for showing your local preview is a [VideoTile](./?path=/docs/ui-components-videotile--video-tile) which can also be used in our video grid layouts."}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Note: In the code example, all `%` characters were replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:LocalPreviewExampleText,children:Object(jsx_runtime.jsx)("div",{style:{height:"17.188rem"},children:Object(jsx_runtime.jsx)(LocalPreviewExample_snippet_LocalPreviewExample,{isVideoAvailable:!0,isCameraEnabled:!0,isMicrophoneEnabled:!0})})})]})}()}}}};LocalPreview.parameters=Object.assign({storySource:{source:"() => {\n  const isVideoAvailable = boolean('Is video available', true);\n  const isCameraEnabled = boolean('Is camera available', true);\n  const isMicrophoneEnabled = boolean('Is microphone available', true);\n\n  return (\n    <LocalPreviewExample\n      isVideoAvailable={isVideoAvailable}\n      isCameraEnabled={isCameraEnabled}\n      isMicrophoneEnabled={isMicrophoneEnabled}\n    />\n  );\n}"}},LocalPreview.parameters)},1678:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ComplianceBanner",(function(){return ComplianceBanner_stories_ComplianceBanner}));__webpack_require__(80),__webpack_require__(10),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24);var dist=__webpack_require__(18),react=__webpack_require__(0),constants=__webpack_require__(23),Link=__webpack_require__(1867),MessageBar=__webpack_require__(1696),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_snippet_ComplianceBanner=function ComplianceBanner(props){var _useState2=_slicedToArray(Object(react.useState)(!1),2),previousCallTranscribeState=_useState2[0],setPreviousCallTranscribeState=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!1),2),previousCallRecordState=_useState4[0],setPreviousCallRecordState=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(0),2),variant=_useState6[0],setVariant=_useState6[1],callTranscribeState=props.callTranscribeState,callRecordState=props.callRecordState;function PrivacyPolicy(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://privacy.microsoft.com/en-US/privacystatement#mainnoticetoendusersmodule",target:"_blank",underline:!0,children:"Privacy policy"})}function LearnMore(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://support.microsoft.com/en-us/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24",target:"_blank",underline:!0,children:"Learn more"})}return Object(react.useEffect)((function(){previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&!callTranscribeState?1:!callRecordState&&callTranscribeState?2:callRecordState||callTranscribeState?0:3):previousCallRecordState&&!previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?5:callRecordState||callTranscribeState?0:6):!previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?7:callRecordState||callTranscribeState?0:8):previousCallRecordState||previousCallTranscribeState||setVariant(callRecordState&&callTranscribeState?4:callRecordState&&!callTranscribeState?7:!callRecordState&&callTranscribeState?5:0),setPreviousCallTranscribeState(callTranscribeState),setPreviousCallRecordState(callRecordState)}),[callTranscribeState,callRecordState]),0===variant?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(MessageBar.a,{onDismiss:function onDismiss(){setVariant(0)},dismissButtonAriaLabel:"Close",children:function getBannerMessage(variant){switch(variant){case 1:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has stopped."})," You are now only recording this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 2:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has stopped."})," You are now only transcribing this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 3:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription are being saved. "})," Recording and transcription have stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 4:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription have started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 5:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 6:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording is being saved."})," Recording has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 7:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 8:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription is being saved."})," Transcription has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}(variant)})};ComplianceBanner_snippet_ComplianceBanner.__docgenInfo={description:"",methods:[],displayName:"ComplianceBanner",props:{callTranscribeState:{required:!1,tsType:{name:"boolean"},description:""},callRecordState:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/snippets/ComplianceBanner.snippet.tsx"]={name:"ComplianceBanner",docgenInfo:ComplianceBanner_snippet_ComplianceBanner.__docgenInfo,path:"stories/Examples/TeamsInterop/snippets/ComplianceBanner.snippet.tsx"});var TeamsInteropDocs=__webpack_require__(419);function ComplianceBanner_stories_slicedToArray(arr,i){return function ComplianceBanner_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ComplianceBanner_stories_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ComplianceBanner_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ComplianceBanner_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ComplianceBanner_stories_arrayLikeToArray(o,minLen)}(arr,i)||function ComplianceBanner_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ComplianceBanner_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_stories_ComplianceBannerStory=function ComplianceBannerStory(){var _useState2=ComplianceBanner_stories_slicedToArray(Object(react.useState)({recordingEnabled:!1,transcriptionEnabled:!1}),2),teamsInterop=_useState2[0],setTeamsInterop=_useState2[1];return Object(dist.button)("Toggle Recording",(function(){return setTeamsInterop({recordingEnabled:!teamsInterop.recordingEnabled,transcriptionEnabled:teamsInterop.transcriptionEnabled}),!1})),Object(dist.button)("Toggle Transcription",(function(){return setTeamsInterop({recordingEnabled:teamsInterop.recordingEnabled,transcriptionEnabled:!teamsInterop.transcriptionEnabled}),!1})),Object(jsx_runtime.jsx)(ComplianceBanner_snippet_ComplianceBanner,{callRecordState:teamsInterop.recordingEnabled,callTranscribeState:teamsInterop.transcriptionEnabled})};ComplianceBanner_stories_ComplianceBannerStory.displayName="ComplianceBannerStory";var ComplianceBanner_stories_ComplianceBanner=ComplianceBanner_stories_ComplianceBannerStory.bind({});__webpack_exports__.default={id:"".concat(constants.d,"-teamsinterop-compliancebanner"),title:"".concat(constants.d,"/Teams Interop/Compliance Banner"),component:ComplianceBanner_stories_ComplianceBanner,parameters:{docs:{page:function page(){return Object(TeamsInteropDocs.a)()}}}};ComplianceBanner_stories_ComplianceBanner.parameters=Object.assign({storySource:{source:"() => {\n  const [teamsInterop, setTeamsInterop] = useState({\n    recordingEnabled: false,\n    transcriptionEnabled: false\n  });\n\n  button('Toggle Recording', () => {\n    setTeamsInterop({\n      recordingEnabled: !teamsInterop.recordingEnabled,\n      transcriptionEnabled: teamsInterop.transcriptionEnabled\n    });\n    // Without an explicit return, the Canvas iframe is re-rendered, and all Components are recreated.\n    // This causes the state in this component to be lost.\n    return false;\n  });\n  button('Toggle Transcription', () => {\n    setTeamsInterop({\n      recordingEnabled: teamsInterop.recordingEnabled,\n      transcriptionEnabled: !teamsInterop.transcriptionEnabled\n    });\n    // Without an explicit return, the Canvas iframe is re-rendered, and all Components are recreated.\n    // This causes the state in this component to be lost.\n    return false;\n  });\n\n  // TODO: Fix dark theming.\n  // Once https://github.com/Azure/communication-ui-library/pull/169 lands, same fix should be applied here.\n  return (\n    <Banner callRecordState={teamsInterop.recordingEnabled} callTranscribeState={teamsInterop.transcriptionEnabled} />\n  );\n}"}},ComplianceBanner_stories_ComplianceBanner.parameters)},1679:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Lobby",(function(){return Lobby_stories_Lobby}));__webpack_require__(80),__webpack_require__(10);var dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),src=__webpack_require__(6),useTheme=__webpack_require__(402),jsx_runtime=__webpack_require__(1),Lobby_snippet_Lobby=function Lobby(props){var theme=Object(useTheme.a)(),palette=theme.palette,ControlBarStyles={root:{background:theme.palette.white,minHeight:"4.25rem",alignItems:"center"}};return Object(jsx_runtime.jsxs)(src.s,{styles:{root:{height:"100%",width:"100%"},overlayContainer:{}},isMirrored:!0,isVideoReady:props.isVideoReady,onRenderPlaceholder:function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},renderElement:Object(jsx_runtime.jsx)(src.p,{videoStreamElement:{}}),children:[Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",background:props.isVideoReady?"#201f1e":palette.neutralLight,opacity:.75}}),Object(jsx_runtime.jsx)("div",{style:{zIndex:0,textAlign:"center",width:"50%",height:"25%",overflow:"none",margin:"auto",position:"absolute",top:0,left:0,bottom:0,right:0},children:Object(jsx_runtime.jsxs)("p",{style:{fontSize:"1.75rem",color:props.isVideoReady?"white":palette.neutralPrimary},children:["☕ ",Object(jsx_runtime.jsx)("br",{})," ",props.callStateText]})}),Object(jsx_runtime.jsxs)(src.d,{layout:"dockedBottom",styles:ControlBarStyles,children:[Object(jsx_runtime.jsx)(src.b,{showLabel:!0,checked:!0}),Object(jsx_runtime.jsx)(src.j,{showLabel:!0,checked:!0}),Object(jsx_runtime.jsx)(src.k,{showLabel:!0}),Object(jsx_runtime.jsx)(src.e,{showLabel:!0,style:{borderRadius:"0.25rem",marginLeft:"0.25rem"}})]})]})};Lobby_snippet_Lobby.displayName="Lobby",Lobby_snippet_Lobby.__docgenInfo={description:"",methods:[],displayName:"Lobby",props:{isVideoReady:{required:!0,tsType:{name:"boolean"},description:""},callStateText:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/snippets/Lobby.snippet.tsx"]={name:"Lobby",docgenInfo:Lobby_snippet_Lobby.__docgenInfo,path:"stories/Examples/TeamsInterop/snippets/Lobby.snippet.tsx"});var TeamsInteropDocs=__webpack_require__(419),Lobby_stories_LobbyStory=function LobbyStory(){var callStateText=Object(dist.text)("Call State Text","Waiting for others to join"),isVideoReady=Object(dist.boolean)("Show Video",!1);return Object(jsx_runtime.jsx)(Lobby_snippet_Lobby,{isVideoReady:isVideoReady,callStateText:callStateText})};Lobby_stories_LobbyStory.displayName="LobbyStory";var Lobby_stories_Lobby=Lobby_stories_LobbyStory.bind({});__webpack_exports__.default={id:"".concat(constants.d,"-teamsinterop-lobby"),title:"".concat(constants.d,"/Teams Interop/Lobby"),component:Lobby_stories_Lobby,parameters:{docs:{page:function page(){return Object(TeamsInteropDocs.a)()}}}};Lobby_stories_Lobby.parameters=Object.assign({storySource:{source:"() => {\n  const callStateText = text('Call State Text', 'Waiting for others to join');\n  const isVideoReady = boolean('Show Video', false);\n\n  return <LobbyComponent isVideoReady={isVideoReady} callStateText={callStateText} />;\n}"}},Lobby_stories_Lobby.parameters)},1680:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Teams",(function(){return Teams}));__webpack_require__(80),__webpack_require__(10);var blocks=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(23)),src=__webpack_require__(6),lib=__webpack_require__(34),Stack=__webpack_require__(435),useTheme=__webpack_require__(402),jsx_runtime=__webpack_require__(1),teamsTheme={palette:{themePrimary:"#4b53bc",themeLighterAlt:"#030308",themeLighter:"#0c0d1e",themeLight:"#171939",themeTertiary:"#2d3271",themeSecondary:"#4249a6",themeDarkAlt:"#5a61c3",themeDark:"#6f76cd",themeDarker:"#9196da",neutralLighterAlt:"#1e1e1e",neutralLighter:"#1d1d1d",neutralLight:"#1c1c1c",neutralQuaternaryAlt:"#1a1a1a",neutralQuaternary:"#191919",neutralTertiaryAlt:"#181818",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#1f1f1f"}},TeamsTheme_snippet_TeamsTheme=function TeamsTheme(){return Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",maxWidth:"50rem",maxHeight:"30rem"},children:Object(jsx_runtime.jsx)(src.f,{fluentTheme:teamsTheme,children:Object(jsx_runtime.jsx)(TeamsTheme_snippet_App,{})})})};TeamsTheme_snippet_TeamsTheme.displayName="TeamsTheme";var TeamsTheme_snippet_App=function App(){var theme=Object(useTheme.a)(),headerContainer=Object(lib.G)({width:"100%",height:"3.875rem",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2,background:theme.palette.white}),teamsButtonStyle={root:{minWidth:"2.75rem"},rootHovered:{color:theme.palette.themePrimary,background:"none"}},videoTileStyle={root:{background:theme.palette.white}};return Object(jsx_runtime.jsxs)(Stack.a,{style:{height:"100%",width:"100%",background:theme.palette.neutralQuaternaryAlt},children:[Object(jsx_runtime.jsx)(Stack.a,{className:headerContainer,children:Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(src.d,{styles:{root:{marginRight:".5rem",alignItems:"center"}},children:[Object(jsx_runtime.jsx)(src.b,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.j,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.n,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.e,{onClick:function onClick(){},showLabel:!0,onRenderText:function onRenderText(){return Object(jsx_runtime.jsx)("span",{style:{marginLeft:"0.5rem"},children:"Leave"},"endCallBtnTextKey")},styles:{root:{height:"2rem",minHeight:"2rem",width:"6.5rem",borderRadius:"0.125rem"}}})]})})}),Object(jsx_runtime.jsx)(src.g,{children:Object(jsx_runtime.jsx)(src.s,{isVideoReady:!1,renderElement:null,displayName:"Michael",styles:videoTileStyle})})]})};TeamsTheme_snippet_App.displayName="App",TeamsTheme_snippet_TeamsTheme.__docgenInfo={description:"",methods:[],displayName:"TeamsTheme"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Themes/snippets/TeamsTheme.snippet.tsx"]={name:"TeamsTheme",docgenInfo:TeamsTheme_snippet_TeamsTheme.__docgenInfo,path:"stories/Examples/Themes/snippets/TeamsTheme.snippet.tsx"});var exampleTeamsTheme=__webpack_require__(1618).default,TeamsTheme_stories_TeamsStory=function TeamsStory(){return Object(jsx_runtime.jsx)(TeamsTheme_snippet_TeamsTheme,{})};TeamsTheme_stories_TeamsStory.displayName="TeamsStory";var Teams=TeamsTheme_stories_TeamsStory.bind({});__webpack_exports__.default={id:"".concat(constants.d,"-themes-teams"),title:"".concat(constants.d,"/Themes/Teams"),parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"Themes"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"Example Themes that can be leveraged by developers to provide color schemes to UI Components"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Teams-Like Theme"}),Object(jsx_runtime.jsx)(blocks.Source,{code:exampleTeamsTheme})]})}()}}}};Teams.parameters=Object.assign({storySource:{source:"() => {\n  return <TeamsTheme />;\n}"}},Teams.parameters)},1681:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"GridLayout",(function(){return GridLayout}));__webpack_require__(39),__webpack_require__(80),__webpack_require__(10);var src=__webpack_require__(6),blocks=__webpack_require__(5),dist=__webpack_require__(18),constants=(__webpack_require__(0),__webpack_require__(23)),utils=__webpack_require__(128),jsx_runtime=__webpack_require__(1),GridLayout_snippet_GridLayoutExample=function GridLayoutExample(){var videoTileStyles={root:{padding:"10px",border:"1px solid #999"}};return Object(jsx_runtime.jsx)("div",{style:{height:"530px",width:"830px"},children:Object(jsx_runtime.jsxs)(src.g,{children:[Object(jsx_runtime.jsx)(src.s,{styles:videoTileStyles,displayName:"Michael"}),Object(jsx_runtime.jsx)(src.s,{styles:videoTileStyles,displayName:"Jim"}),Object(jsx_runtime.jsx)(src.s,{styles:videoTileStyles,displayName:"Pam"}),Object(jsx_runtime.jsx)(src.s,{styles:videoTileStyles,displayName:"Dwight"})]})})};GridLayout_snippet_GridLayoutExample.displayName="GridLayoutExample",GridLayout_snippet_GridLayoutExample.__docgenInfo={description:"",methods:[],displayName:"GridLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/GridLayout/snippets/GridLayout.snippet.tsx"]={name:"GridLayoutExample",docgenInfo:GridLayout_snippet_GridLayoutExample.__docgenInfo,path:"stories/GridLayout/snippets/GridLayout.snippet.tsx"});var GridLayoutExampleText=__webpack_require__(1619).default,GridLayout_stories_GridLayoutStory=function GridLayoutStory(){var width=Object(dist.number)("Width",constants.i,constants.j),height=Object(dist.number)("Height",constants.g,constants.h),participantsComponents=Object(dist.object)("Participants",[{displayName:"Michael",isVideoReady:!1},{displayName:"Jim",isVideoReady:!1},{displayName:"Pam",isVideoReady:!1},{displayName:"Dwight",isVideoReady:!1}]).map((function(participant,index){return Object(jsx_runtime.jsx)(src.s,{isVideoReady:participant.isVideoReady,renderElement:Object(jsx_runtime.jsx)(src.p,{videoStreamElement:participant.isVideoReady?Object(utils.a)():null}),displayName:participant.displayName},index)}));return Object(jsx_runtime.jsx)("div",{style:{height:"".concat(height,"px"),width:"".concat(width,"px")},children:Object(jsx_runtime.jsx)(src.g,{children:participantsComponents})})};GridLayout_stories_GridLayoutStory.displayName="GridLayoutStory";var GridLayout=GridLayout_stories_GridLayoutStory.bind({});__webpack_exports__.default={id:"".concat(constants.a,"-gridlayout"),title:"".concat(constants.a,"/Grid Layout"),component:src.g,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(blocks.Title,{children:"GridLayout"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The `GridLayout` organizes components passed to it as children in a grid layout. It can display a grid of call participants through the use of `VideoTile` component."}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Importing"}),Object(jsx_runtime.jsx)(blocks.Source,{code:"\nimport { GridLayout, VideoTile } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Example"}),Object(jsx_runtime.jsx)(blocks.Description,{children:"The following example shows how you can render `VideoTile` components inside a grid layout. For styling the children video tiles, please read the [VideoTile component docs](./?path=/docs/ui-components-videotile--video-tile)."}),Object(jsx_runtime.jsx)(blocks.Canvas,{mdxSource:GridLayoutExampleText,children:Object(jsx_runtime.jsx)(GridLayout_snippet_GridLayoutExample,{})}),Object(jsx_runtime.jsx)(blocks.Heading,{children:"Props"}),Object(jsx_runtime.jsx)(blocks.Props,{of:src.g})]})}()}}}};GridLayout.parameters=Object.assign({storySource:{source:"() => {\n  const width = number('Width', mediaGalleryWidthDefault, mediaGalleryWidthOptions);\n  const height = number('Height', mediaGalleryHeightDefault, mediaGalleryHeightOptions);\n\n  const defaultParticipants = [\n    {\n      displayName: 'Michael',\n      isVideoReady: false\n    },\n    {\n      displayName: 'Jim',\n      isVideoReady: false\n    },\n    {\n      displayName: 'Pam',\n      isVideoReady: false\n    },\n    {\n      displayName: 'Dwight',\n      isVideoReady: false\n    }\n  ];\n\n  const participants = object('Participants', defaultParticipants);\n\n  const participantsComponents = participants.map((participant, index) => {\n    return (\n      <VideoTile\n        isVideoReady={participant.isVideoReady}\n        renderElement={<StreamMedia videoStreamElement={participant.isVideoReady ? renderVideoStream() : null} />}\n        displayName={participant.displayName}\n        key={index}\n      />\n    );\n  });\n\n  return (\n    <div\n      style={{\n        height: `${height}px`,\n        width: `${width}px`\n      }}\n    >\n      <GridLayoutComponent>{participantsComponents}</GridLayoutComponent>\n    </div>\n  );\n}"}},GridLayout.parameters)},188:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return createDefaultChatHandlers})),__webpack_require__.d(__webpack_exports__,"b",(function(){return chatThreadSelector})),__webpack_require__.d(__webpack_exports__,"e",(function(){return typingIndicatorSelector})),__webpack_require__.d(__webpack_exports__,"d",(function(){return sendBoxSelector})),__webpack_require__.d(__webpack_exports__,"a",(function(){return chatParticipantListSelector}));__webpack_require__(41),__webpack_require__(9),__webpack_require__(45);var src=__webpack_require__(35),memoize_one_esm=__webpack_require__(398);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var createDefaultChatHandlers=Object(memoize_one_esm.a)((function(chatClient,chatThreadClient){var _onLoadPreviousChatMessages,_updateThreadTopicName,_onParticipantRemove,_onTyping,_onMessageSeen,_onSendMessage,messageIterator=chatThreadClient.listMessages();return{onSendMessage:(_onSendMessage=_asyncToGenerator(regeneratorRuntime.mark((function _callee(content){var sendMessageRequest;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return sendMessageRequest={content:content,senderDisplayName:chatClient.getState().displayName},_context.next=3,chatThreadClient.sendMessage(sendMessageRequest);case 3:case"end":return _context.stop()}}),_callee)}))),function onSendMessage(_x){return _onSendMessage.apply(this,arguments)}),onMessageSeen:(_onMessageSeen=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(chatMessageId){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,chatThreadClient.sendReadReceipt({chatMessageId:chatMessageId});case 2:case"end":return _context2.stop()}}),_callee2)}))),function onMessageSeen(_x2){return _onMessageSeen.apply(this,arguments)}),onTyping:(_onTyping=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,chatThreadClient.sendTypingNotification();case 2:case"end":return _context3.stop()}}),_callee3)}))),function onTyping(){return _onTyping.apply(this,arguments)}),onParticipantRemove:(_onParticipantRemove=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(userId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,chatThreadClient.removeParticipant(Object(src.a)(userId));case 2:case"end":return _context4.stop()}}),_callee4)}))),function onParticipantRemove(_x3){return _onParticipantRemove.apply(this,arguments)}),updateThreadTopicName:(_updateThreadTopicName=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(topicName){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,chatThreadClient.updateTopic(topicName);case 2:case"end":return _context5.stop()}}),_callee5)}))),function updateThreadTopicName(_x4){return _updateThreadTopicName.apply(this,arguments)}),onLoadPreviousChatMessages:(_onLoadPreviousChatMessages=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(messagesToLoad){var remainingMessagesToGet,isAllChatMessagesLoaded,_message$value,message;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:remainingMessagesToGet=messagesToLoad,isAllChatMessagesLoaded=!1;case 2:if(!(remainingMessagesToGet>=1)){_context6.next=12;break}return _context6.next=5,messageIterator.next();case 5:if(message=_context6.sent,null!==(_message$value=message.value)&&void 0!==_message$value&&_message$value.type&&"text"===message.value.type&&remainingMessagesToGet--,!message.done){_context6.next=10;break}return isAllChatMessagesLoaded=!0,_context6.abrupt("break",12);case 10:_context6.next=2;break;case 12:return _context6.abrupt("return",isAllChatMessagesLoaded);case 13:case"end":return _context6.stop()}}),_callee6)}))),function onLoadPreviousChatMessages(_x5){return _onLoadPreviousChatMessages.apply(this,arguments)})}})),react=__webpack_require__(0),jsx_runtime=__webpack_require__(1),ChatClientContext=Object(react.createContext)(void 0),ChatClientProvider_ChatClientProvider=function ChatClientProvider(props){return Object(jsx_runtime.jsx)(ChatClientContext.Provider,{value:props.chatClient,children:props.children})};ChatClientProvider_ChatClientProvider.displayName="ChatClientProvider";ChatClientProvider_ChatClientProvider.__docgenInfo={description:"ChatClientProvider requires valid StatefulChatClient. It provides a global access to the\nstateful chat client for the contoso app\n\n@param props - only one parameter StatefulChatClient",methods:[],displayName:"ChatClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},chatClient:{required:!0,tsType:{name:"StatefulChatClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../chat-component-bindings/src/providers/ChatClientProvider.tsx"]={name:"ChatClientProvider",docgenInfo:ChatClientProvider_ChatClientProvider.__docgenInfo,path:"../chat-component-bindings/src/providers/ChatClientProvider.tsx"});var ChatThreadClientContext=Object(react.createContext)(void 0),ChatThreadClientProvider_ChatThreadClientProvider=function ChatThreadClientProvider(props){return Object(jsx_runtime.jsx)(ChatThreadClientContext.Provider,{value:props.chatThreadClient,children:props.children})};ChatThreadClientProvider_ChatThreadClientProvider.displayName="ChatThreadClientProvider";ChatThreadClientProvider_ChatThreadClientProvider.__docgenInfo={description:"ChatThreadClientProvider requires valid StatefulChatThreadClient. It provides a global access to the\nstateful chat thread client for the contoso app\n\n@param props - includes one parameter StatefulChatThreadClient",methods:[],displayName:"ChatThreadClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},chatThreadClient:{required:!0,tsType:{name:"ChatThreadClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../chat-component-bindings/src/providers/ChatThreadClientProvider.tsx"]={name:"ChatThreadClientProvider",docgenInfo:ChatThreadClientProvider_ChatThreadClientProvider.__docgenInfo,path:"../chat-component-bindings/src/providers/ChatThreadClientProvider.tsx"});__webpack_require__(10),__webpack_require__(27),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24);var es=__webpack_require__(62),baseSelectors_getUserId=(__webpack_require__(113),__webpack_require__(42),function getUserId(state){return Object(src.c)(state.userId)}),getDisplayName=function getDisplayName(state){return state.displayName},getParticipants=function getParticipants(state,props){var _state$threads$get3;return props.threadId&&(null===(_state$threads$get3=state.threads.get(props.threadId))||void 0===_state$threads$get3?void 0:_state$threads$get3.participants)||new Map},sanitizedMessageContentType=function sanitizedMessageContentType(type){var lowerCaseType=type.toLowerCase();return"text"===lowerCaseType||"html"===lowerCaseType||"richtext/html"===lowerCaseType?lowerCaseType:"unknown"},sendBoxSelector=Object(es.a)([baseSelectors_getUserId,getDisplayName],(function(userId,displayName){return{displayName:displayName,userId:userId}})),compareMessages=(__webpack_require__(39),__webpack_require__(83),__webpack_require__(652),__webpack_require__(61),__webpack_require__(70),function compareMessages(firstMessage,secondMessage){return void 0===firstMessage.payload.createdOn?1:void 0===secondMessage.payload.createdOn?-1:new Date(firstMessage.payload.createdOn).getTime()-new Date(secondMessage.payload.createdOn).getTime()}),memoizedAllConvertChatMessage=Object(src.b)((function(_key,chatMessage,userId,isSeen,isLargeGroup){var _chatMessage$content;return{type:"chat",payload:{createdOn:chatMessage.createdOn,content:null===(_chatMessage$content=chatMessage.content)||void 0===_chatMessage$content?void 0:_chatMessage$content.message,type:sanitizedMessageContentType(chatMessage.type),status:!isLargeGroup&&"delivered"===chatMessage.status&&isSeen?"seen":chatMessage.status,senderDisplayName:chatMessage.senderDisplayName,senderId:void 0!==chatMessage.sender?Object(src.c)(chatMessage.sender):userId,messageId:chatMessage.id,clientMessageId:chatMessage.clientMessageId}}})),chatThreadSelector=Object(es.a)([baseSelectors_getUserId,function getChatMessages(state,props){var _state$threads$get;return props.threadId&&(null===(_state$threads$get=state.threads.get(props.threadId))||void 0===_state$threads$get?void 0:_state$threads$get.chatMessages)||new Map},function getLatestReadTime(state,props){var _state$threads$get5;return props.threadId&&(null===(_state$threads$get5=state.threads.get(props.threadId))||void 0===_state$threads$get5?void 0:_state$threads$get5.latestReadTime)||new Date(0)},function getIsLargeGroup(state,props){var _state$threads$get4,participants=null===(_state$threads$get4=state.threads.get(props.threadId))||void 0===_state$threads$get4?void 0:_state$threads$get4.participants;return!!participants&&participants.size>20}],(function(userId,chatMessages,latestReadTime,isLargeGroup){var convertedMessages=memoizedAllConvertChatMessage((function(memoizedFn){return Array.from(chatMessages.values()).filter((function(message){return"text"===message.type.toLowerCase()||"richtext/html"===message.type.toLowerCase()||void 0!==message.clientMessageId})).map((function(message){var _message$id;return memoizedFn(null!==(_message$id=message.id)&&void 0!==_message$id?_message$id:message.clientMessageId,message,userId,message.createdOn<=latestReadTime,isLargeGroup)}))}));return chatThreadSelector_updateMessagesWithAttached(convertedMessages,userId),{userId:userId,showMessageStatus:!isLargeGroup,messages:convertedMessages}})),chatThreadSelector_updateMessagesWithAttached=function updateMessagesWithAttached(chatMessagesWithStatus,userId){chatMessagesWithStatus.sort(compareMessages),chatMessagesWithStatus.forEach((function(message,index,messages){var mine=message.payload.senderId===userId,attached=!1;0===index?index!==messages.length-1&&messages[index].payload.senderId===messages[index+1].payload.senderId&&(attached="top"):messages[index].payload.senderId===messages[index-1].payload.senderId?attached=index!==messages.length-1&&messages[index].payload.senderId===messages[index+1].payload.senderId||"bottom":index!==messages.length-1&&messages[index].payload.senderId===messages[index+1].payload.senderId&&(attached="top"),message.payload.attached=attached,message.payload.mine=mine}))},typingIndicatorSelector=(__webpack_require__(258),__webpack_require__(772),es.a([function getTypingIndicators(state,props){var _state$threads$get7;return props.threadId&&(null===(_state$threads$get7=state.threads.get(props.threadId))||void 0===_state$threads$get7?void 0:_state$threads$get7.typingIndicators)||[]},getParticipants,baseSelectors_getUserId],(function(typingIndicators,participants,userId){return participants.size>=20?{typingUsers:[]}:{typingUsers:function convertSdkTypingIndicatorsToCommunicationParticipants(typingIndicators,participants){return typingIndicators.map((function(typingIndicator){var _participants$get;return{userId:Object(src.c)(typingIndicator.sender),displayName:null===(_participants$get=participants.get(Object(src.c)(typingIndicator.sender)))||void 0===_participants$get?void 0:_participants$get.displayName}}))}(function filterTypingIndicators(typingIndicators,userId){for(var filteredTypingIndicators=[],seen=new Set,date8SecondsAgo=new Date(Date.now()-8e3),i=typingIndicators.length-1;i>=0;i--){var typingIndicator=typingIndicators[i];Object(src.c)(typingIndicator.sender)!==userId&&(typingIndicator.receivedOn<date8SecondsAgo||seen.has(Object(src.c)(typingIndicator.sender))||(seen.add(Object(src.c)(typingIndicator.sender)),filteredTypingIndicators.push(typingIndicator)))}return filteredTypingIndicators}(typingIndicators,userId),participants)}}))),chatParticipantListSelector=(__webpack_require__(40),es.a([baseSelectors_getUserId,getParticipants,getDisplayName],(function(userId,chatParticipants,displayName){var participants=function convertChatParticipantsToCommunicationParticipants(chatParticipants){return chatParticipants.map((function(participant){return{userId:Object(src.c)(participant.id),displayName:participant.displayName}}))}(Array.from(chatParticipants.values()));if(0!==participants.length){var moderatorIdx=function moderatorIndex(participants){return participants.map((function(p){return p.displayName})).indexOf(void 0)}(participants);if(-1!==moderatorIdx)moderatorIdx===participants.map((function(p){return p.userId})).indexOf(userId)?participants[moderatorIdx].displayName=displayName:participants=participants.filter((function(p){return p.displayName}))}return{myUserId:userId,participants:participants}})))},23:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"j",(function(){return mediaGalleryWidthOptions})),__webpack_require__.d(__webpack_exports__,"i",(function(){return mediaGalleryWidthDefault})),__webpack_require__.d(__webpack_exports__,"h",(function(){return mediaGalleryHeightOptions})),__webpack_require__.d(__webpack_exports__,"g",(function(){return mediaGalleryHeightDefault})),__webpack_require__.d(__webpack_exports__,"b",(function(){return COMPOSITE_EXPERIENCE_CONTAINER_STYLE})),__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPONENT_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"c",(function(){return COMPOSITE_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"d",(function(){return EXAMPLES_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"e",(function(){return QUICKSTARTS_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"f",(function(){return STATEFUL_CLIENT_PREFIX}));var mediaGalleryWidthOptions={range:!0,min:500,max:1e3,step:10},mediaGalleryWidthDefault=600,mediaGalleryHeightOptions={range:!0,min:500,max:1e3,step:10},mediaGalleryHeightDefault=500,COMPOSITE_EXPERIENCE_CONTAINER_STYLE={width:"90vw",height:"90vh"},COMPONENT_FOLDER_PREFIX="UI Components",COMPOSITE_FOLDER_PREFIX="Composites",EXAMPLES_FOLDER_PREFIX="Examples",QUICKSTARTS_FOLDER_PREFIX="Quickstarts",STATEFUL_CLIENT_PREFIX="Stateful Client"},269:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return StatefulCallClient_createStatefulCallClient}));__webpack_require__(234),__webpack_require__(56),__webpack_require__(41),__webpack_require__(9),__webpack_require__(45),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(24),__webpack_require__(20),__webpack_require__(13);var sdk_bundle=__webpack_require__(90);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ProxyDeviceManager=function(){function ProxyDeviceManager(deviceManager,context){var _this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyDeviceManager),this._deviceManager=void 0,this._context=void 0,this.setDeviceManager=function(){_this._context.setDeviceManagerIsSpeakerSelectionAvailable(_this._deviceManager.isSpeakerSelectionAvailable),_this._context.setDeviceManagerSelectedMicrophone(_this._deviceManager.selectedMicrophone),_this._context.setDeviceManagerSelectedSpeaker(_this._deviceManager.selectedSpeaker)},this.subscribe=function(){_this._deviceManager.on("videoDevicesUpdated",_this.videoDevicesUpdated),_this._deviceManager.on("audioDevicesUpdated",_this.audioDevicesUpdated),_this._deviceManager.on("selectedMicrophoneChanged",_this.selectedMicrophoneChanged),_this._deviceManager.on("selectedSpeakerChanged",_this.selectedSpeakerChanged)},this.unsubscribe=function(){_this._deviceManager.off("videoDevicesUpdated",_this.videoDevicesUpdated),_this._deviceManager.off("audioDevicesUpdated",_this.audioDevicesUpdated),_this._deviceManager.off("selectedMicrophoneChanged",_this.selectedMicrophoneChanged),_this._deviceManager.off("selectedSpeakerChanged",_this.selectedSpeakerChanged)},this.selectCamera=function(videoDeviceInfo){_this._context.setDeviceManagerSelectedCamera(videoDeviceInfo)},this.videoDevicesUpdated=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=_this._context,_context.next=3,_this._deviceManager.getCameras();case 3:_context.t1=_context.sent,_context.t0.setDeviceManagerCameras.call(_context.t0,_context.t1);case 5:case"end":return _context.stop()}}),_callee)}))),this.audioDevicesUpdated=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.t0=_this._context,_context2.next=3,_this._deviceManager.getMicrophones();case 3:return _context2.t1=_context2.sent,_context2.t0.setDeviceManagerMicrophones.call(_context2.t0,_context2.t1),_context2.t2=_this._context,_context2.next=8,_this._deviceManager.getSpeakers();case 8:_context2.t3=_context2.sent,_context2.t2.setDeviceManagerSpeakers.call(_context2.t2,_context2.t3);case 10:case"end":return _context2.stop()}}),_callee2)}))),this.selectedMicrophoneChanged=function(){_this._context.setDeviceManagerSelectedMicrophone(_this._deviceManager.selectedMicrophone)},this.selectedSpeakerChanged=function(){_this._context.setDeviceManagerSelectedSpeaker(_this._deviceManager.selectedSpeaker)},this._deviceManager=deviceManager,this._context=context,this.setDeviceManager(),this.subscribe()}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ProxyDeviceManager,[{key:"get",value:function get(target,prop){var _this2=this;switch(prop){case"getCameras":return function(){return target.getCameras().then((function(cameras){return _this2._context.setDeviceManagerCameras(_toConsumableArray(cameras)),cameras}))};case"getMicrophones":return function(){return target.getMicrophones().then((function(microphones){return _this2._context.setDeviceManagerMicrophones(_toConsumableArray(microphones)),microphones}))};case"getSpeakers":return function(){return target.getSpeakers().then((function(speakers){return _this2._context.setDeviceManagerSpeakers(_toConsumableArray(speakers)),speakers}))};case"selectMicrophone":return function(){return target.selectMicrophone.apply(target,arguments).then((function(){_this2._context.setDeviceManagerSelectedMicrophone(target.selectedMicrophone)}))};case"selectSpeaker":return function(){return target.selectSpeaker.apply(target,arguments).then((function(){_this2._context.setDeviceManagerSelectedSpeaker(target.selectedSpeaker)}))};case"askDevicePermission":return function(){return target.askDevicePermission.apply(target,arguments).then((function(deviceAccess){return _this2._context.setDeviceManagerDeviceAccess(deviceAccess),_this2.setDeviceManager(),deviceAccess}))};default:return Reflect.get(target,prop)}}}]),ProxyDeviceManager}(),deviceManagerDeclaratify=function deviceManagerDeclaratify(deviceManager,context){var proxyDeviceManager=new ProxyDeviceManager(deviceManager,context);return Object.defineProperty(deviceManager,"unsubscribe",{configurable:!1,value:function value(){return proxyDeviceManager.unsubscribe()}}),Object.defineProperty(deviceManager,"selectCamera",{configurable:!1,value:function value(videoDeviceInfo){return proxyDeviceManager.selectCamera(videoDeviceInfo)}}),new Proxy(deviceManager,proxyDeviceManager)},events=(__webpack_require__(113),__webpack_require__(516),__webpack_require__(42),__webpack_require__(61),__webpack_require__(70),__webpack_require__(151)),events_default=__webpack_require__.n(events),immer_esm=__webpack_require__(43),src=__webpack_require__(35);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function CallContext_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallContext_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallContext_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function CallContext_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CallContext_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object(immer_esm.b)();var CallContext_CallContext=function(){function CallContext(userId,maxListeners){!function CallContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CallContext),this._state=void 0,this._emitter=void 0,this._atomicId=void 0,this._state={calls:new Map,callsEnded:[],incomingCalls:new Map,incomingCallsEnded:[],deviceManager:{isSpeakerSelectionAvailable:!1,cameras:[],microphones:[],speakers:[],unparentedViews:new Map},callAgent:void 0,userId:userId},this._emitter=new events_default.a,maxListeners&&this._emitter.setMaxListeners(maxListeners),this._atomicId=0}return function CallContext_createClass(Constructor,protoProps,staticProps){return protoProps&&CallContext_defineProperties(Constructor.prototype,protoProps),staticProps&&CallContext_defineProperties(Constructor,staticProps),Constructor}(CallContext,[{key:"setState",value:function setState(state){this._state=state,this._emitter.emit("stateChanged",this._state)}},{key:"getState",value:function getState(){return this._state}},{key:"onStateChange",value:function onStateChange(handler){this._emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this._emitter.off("stateChanged",handler)}},{key:"clearCallRelatedState",value:function clearCallRelatedState(){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.calls.clear(),draft.incomingCalls.clear(),draft.callsEnded.splice(0,draft.callsEnded.length),draft.incomingCallsEnded.splice(0,draft.incomingCallsEnded.length)})))}},{key:"setCallAgent",value:function setCallAgent(callAgent){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.callAgent=callAgent})))}},{key:"setCall",value:function setCall(call){this.setState(Object(immer_esm.c)(this._state,(function(draft){var existingCall=draft.calls.get(call.id);existingCall?(existingCall.callerInfo=call.callerInfo,existingCall.state=call.state,existingCall.callEndReason=call.callEndReason,existingCall.direction=call.direction,existingCall.isMuted=call.isMuted,existingCall.isScreenSharingOn=call.isScreenSharingOn,existingCall.localVideoStreams=call.localVideoStreams,existingCall.remoteParticipants=call.remoteParticipants,existingCall.transcription.isTranscriptionActive=call.transcription.isTranscriptionActive,existingCall.recording.isRecordingActive=call.recording.isRecordingActive):draft.calls.set(call.id,call)})))}},{key:"removeCall",value:function removeCall(callId){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.calls.delete(callId)})))}},{key:"setCallEnded",value:function setCallEnded(callId,callEndReason){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.endTime=new Date,call.callEndReason=callEndReason,draft.calls.delete(callId),draft.callsEnded.length>=10&&draft.callsEnded.shift(),draft.callsEnded.push(call))})))}},{key:"setCallState",value:function setCallState(callId,state){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.state=state)})))}},{key:"setCallId",value:function setCallId(newCallId,oldCallId){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(oldCallId);call&&(draft.calls.delete(oldCallId),draft.calls.set(newCallId,call))})))}},{key:"setCallIsScreenSharingOn",value:function setCallIsScreenSharingOn(callId,isScreenSharingOn){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.isScreenSharingOn=isScreenSharingOn)})))}},{key:"setCallRemoteParticipants",value:function setCallRemoteParticipants(callId,addRemoteParticipant,removeRemoteParticipant){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(removeRemoteParticipant.forEach((function(id){call.remoteParticipants.delete(id)})),addRemoteParticipant.forEach((function(participant){call.remoteParticipants.set(Object(src.c)(participant.identifier),participant)})))})))}},{key:"setCallRemoteParticipantsEnded",value:function setCallRemoteParticipantsEnded(callId,addRemoteParticipant,removeRemoteParticipant){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(removeRemoteParticipant.forEach((function(id){call.remoteParticipantsEnded.delete(id)})),addRemoteParticipant.forEach((function(participant){call.remoteParticipantsEnded.set(Object(src.c)(participant.identifier),participant)})))})))}},{key:"setCallLocalVideoStream",value:function setCallLocalVideoStream(callId,streams){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.localVideoStreams=streams)})))}},{key:"setCallIsMicrophoneMuted",value:function setCallIsMicrophoneMuted(callId,isMicrophoneMuted){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.isMuted=isMicrophoneMuted)})))}},{key:"setCallRecordingActive",value:function setCallRecordingActive(callId,isRecordingActive){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.recording.isRecordingActive=isRecordingActive)})))}},{key:"setCallTranscriptionActive",value:function setCallTranscriptionActive(callId,isTranscriptionActive){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.transcription.isTranscriptionActive=isTranscriptionActive)})))}},{key:"setCallReceivedTransferRequest",value:function setCallReceivedTransferRequest(callId,transfer){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.transfer.receivedTransferRequests.length>=10&&call.transfer.receivedTransferRequests.shift(),call.transfer.receivedTransferRequests.push(transfer))})))}},{key:"setCallRequestedTransfer",value:function setCallRequestedTransfer(callId,transfer){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.transfer.requestedTransfers.length>=10&&call.transfer.requestedTransfers.shift(),call.transfer.requestedTransfers.push(transfer))})))}},{key:"setCallRequestedTransferState",value:function setCallRequestedTransferState(callId,transferId,state,error){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var _step,_iterator=_createForOfIteratorHelper(call.transfer.requestedTransfers);try{for(_iterator.s();!(_step=_iterator.n()).done;){var requestedTransfer=_step.value;if(requestedTransfer.id===transferId){requestedTransfer.state=state,requestedTransfer.error=error;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})))}},{key:"setCallScreenShareParticipant",value:function setCallScreenShareParticipant(callId,participantKey){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&(call.screenShareRemoteParticipant=participantKey)})))}},{key:"setLocalVideoStreamRendererView",value:function setLocalVideoStreamRendererView(callId,view){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);call&&call.localVideoStreams.length>0&&(call.localVideoStreams[0].view=view)})))}},{key:"setParticipantState",value:function setParticipantState(callId,participantKey,state){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);participant&&(participant.state=state)}})))}},{key:"setParticipantIsMuted",value:function setParticipantIsMuted(callId,participantKey,muted){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);participant&&(participant.isMuted=muted)}})))}},{key:"setParticipantDisplayName",value:function setParticipantDisplayName(callId,participantKey,displayName){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);participant&&(participant.displayName=displayName)}})))}},{key:"setParticipantIsSpeaking",value:function setParticipantIsSpeaking(callId,participantKey,isSpeaking){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);participant&&(participant.isSpeaking=isSpeaking)}})))}},{key:"setParticipantVideoStream",value:function setParticipantVideoStream(callId,participantKey,stream){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);if(participant){var existingStream=participant.videoStreams.get(stream.id);existingStream?(existingStream.isAvailable=stream.isAvailable,existingStream.mediaStreamType=stream.mediaStreamType):participant.videoStreams.set(stream.id,stream)}}})))}},{key:"setRemoteVideoStreamIsAvailable",value:function setRemoteVideoStreamIsAvailable(callId,participantKey,streamId,isAvailable){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);if(participant){var stream=participant.videoStreams.get(streamId);stream&&(stream.isAvailable=isAvailable)}}})))}},{key:"setRemoteVideoStreams",value:function setRemoteVideoStreams(callId,participantKey,addRemoteVideoStream,removeRemoteVideoStream){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);if(participant){var _step2,_iterator2=_createForOfIteratorHelper(removeRemoteVideoStream);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var id=_step2.value;participant.videoStreams.delete(id)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var _step3,_iterator3=_createForOfIteratorHelper(addRemoteVideoStream);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var newStream=_step3.value,stream=participant.videoStreams.get(newStream.id);stream?(stream.mediaStreamType=newStream.mediaStreamType,stream.isAvailable=newStream.isAvailable):participant.videoStreams.set(newStream.id,newStream)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}})))}},{key:"setRemoteVideoStreamRendererView",value:function setRemoteVideoStreamRendererView(callId,participantKey,streamId,view){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls.get(callId);if(call){var participant=call.remoteParticipants.get(participantKey);if(participant){var stream=participant.videoStreams.get(streamId);stream&&(stream.view=view)}}})))}},{key:"setIncomingCall",value:function setIncomingCall(call){this.setState(Object(immer_esm.c)(this._state,(function(draft){var existingCall=draft.incomingCalls.get(call.id);existingCall?existingCall.callerInfo=call.callerInfo:draft.incomingCalls.set(call.id,call)})))}},{key:"removeIncomingCall",value:function removeIncomingCall(callId){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.incomingCalls.delete(callId)})))}},{key:"setIncomingCallEnded",value:function setIncomingCallEnded(callId,callEndReason){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.incomingCalls.get(callId);call&&(call.endTime=new Date,call.callEndReason=callEndReason,draft.incomingCalls.delete(callId),draft.incomingCallsEnded.length>=10&&draft.incomingCallsEnded.shift(),draft.incomingCallsEnded.push(call))})))}},{key:"setDeviceManagerIsSpeakerSelectionAvailable",value:function setDeviceManagerIsSpeakerSelectionAvailable(isSpeakerSelectionAvailable){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.isSpeakerSelectionAvailable=isSpeakerSelectionAvailable})))}},{key:"setDeviceManagerSelectedMicrophone",value:function setDeviceManagerSelectedMicrophone(selectedMicrophone){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.selectedMicrophone=selectedMicrophone})))}},{key:"setDeviceManagerSelectedSpeaker",value:function setDeviceManagerSelectedSpeaker(selectedSpeaker){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.selectedSpeaker=selectedSpeaker})))}},{key:"setDeviceManagerSelectedCamera",value:function setDeviceManagerSelectedCamera(selectedCamera){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.selectedCamera=selectedCamera})))}},{key:"setDeviceManagerCameras",value:function setDeviceManagerCameras(cameras){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.cameras&&cameras.length>0&&(draft.deviceManager.selectedCamera=cameras[0]),draft.deviceManager.cameras=cameras})))}},{key:"setDeviceManagerMicrophones",value:function setDeviceManagerMicrophones(microphones){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.microphones=microphones})))}},{key:"setDeviceManagerSpeakers",value:function setDeviceManagerSpeakers(speakers){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.speakers=speakers})))}},{key:"setDeviceManagerDeviceAccess",value:function setDeviceManagerDeviceAccess(deviceAccess){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.deviceAccess=deviceAccess})))}},{key:"setDeviceManagerUnparentedView",value:function setDeviceManagerUnparentedView(localVideoStream,view){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.unparentedViews.set(localVideoStream,{source:localVideoStream.source,mediaStreamType:localVideoStream.mediaStreamType,view:view})})))}},{key:"deleteDeviceManagerUnparentedView",value:function deleteDeviceManagerUnparentedView(localVideoStream){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.unparentedViews.delete(localVideoStream)})))}},{key:"getAndIncrementAtomicId",value:function getAndIncrementAtomicId(){var id=this._atomicId;return this._atomicId++,id}}]),CallContext}();__webpack_require__(258),__webpack_require__(109),__webpack_require__(39);function Converter_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function Converter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Converter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Converter_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Converter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function convertSdkLocalStreamToDeclarativeLocalStream(stream){return{source:stream.source,mediaStreamType:stream.mediaStreamType,view:void 0}}function convertSdkRemoteStreamToDeclarativeRemoteStream(stream){return{id:stream.id,mediaStreamType:stream.mediaStreamType,isAvailable:stream.isAvailable,view:void 0}}function convertSdkParticipantToDeclarativeParticipant(participant){var _step,declarativeVideoStreams=new Map,_iterator=Converter_createForOfIteratorHelper(participant.videoStreams);try{for(_iterator.s();!(_step=_iterator.n()).done;){var videoStream=_step.value;declarativeVideoStreams.set(videoStream.id,convertSdkRemoteStreamToDeclarativeRemoteStream(videoStream))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return{identifier:participant.identifier,displayName:participant.displayName,state:participant.state,callEndReason:participant.callEndReason,videoStreams:declarativeVideoStreams,isMuted:participant.isMuted,isSpeaking:participant.isSpeaking}}function convertFromSDKToDeclarativeVideoStreamRendererView(view){return{scalingMode:view.scalingMode,isMirrored:view.isMirrored,target:view.target}}var RequestedTransferSubscriber=function RequestedTransferSubscriber(call,context,transfer,transferId){var _this=this;!function RequestedTransferSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RequestedTransferSubscriber),this._call=void 0,this._context=void 0,this._transfer=void 0,this._transferId=void 0,this.subscribe=function(){_this._transfer.on("stateChanged",_this.stateChanged)},this.unsubscribe=function(){_this._transfer.off("stateChanged",_this.stateChanged)},this.stateChanged=function(){_this._context.setCallRequestedTransferState(_this._call.id,_this._transferId,_this._transfer.state,_this._transfer.error)},this._call=call,this._context=context,this._transfer=transfer,this._transferId=transferId,this.subscribe()};function TransferCallFeatureDeclarative_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function TransferCallFeatureDeclarative_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return TransferCallFeatureDeclarative_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TransferCallFeatureDeclarative_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function TransferCallFeatureDeclarative_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function TransferCallFeatureDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var TransferCallFeatureDeclarative_ProxyTransferCallFeature=function(){function ProxyTransferCallFeature(call,context){!function TransferCallFeatureDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyTransferCallFeature),this._call=void 0,this._context=void 0,this._requestedTransferSubscribers=void 0,this._call=call,this._context=context,this._requestedTransferSubscribers=[]}return function TransferCallFeatureDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&TransferCallFeatureDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&TransferCallFeatureDeclarative_defineProperties(Constructor,staticProps),Constructor}(ProxyTransferCallFeature,[{key:"unsubscribe",value:function unsubscribe(){var _step,_iterator=TransferCallFeatureDeclarative_createForOfIteratorHelper(this._requestedTransferSubscribers);try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.unsubscribe()}}catch(err){_iterator.e(err)}finally{_iterator.f()}this._requestedTransferSubscribers=[]}},{key:"get",value:function get(target,prop){var _this=this;switch(prop){case"transfer":return function(targetParticipant,transferOptions){var transfer=target.transfer(targetParticipant,transferOptions),transferId=_this._context.getAndIncrementAtomicId();if(_this._context.setCallRequestedTransfer(_this._call.id,function convertSdkTransferToDeclarativeTransfer(transfer,targetParticipant,transferId){return{id:transferId,targetParticipant:targetParticipant,state:transfer.state,error:transfer.error}}(transfer,targetParticipant.targetParticipant,transferId)),_this._requestedTransferSubscribers.length>=10){var subscriber=_this._requestedTransferSubscribers.shift();null==subscriber||subscriber.unsubscribe()}return _this._requestedTransferSubscribers.push(new RequestedTransferSubscriber(_this._call,_this._context,transfer,transferId)),transfer};default:return Reflect.get(target,prop)}}}]),ProxyTransferCallFeature}();function CallDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallDeclarative_ProxyCall=function(){function ProxyCall(call,context){!function CallDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCall),this._call=void 0,this._context=void 0,this._transfer=void 0,this._call=call,this._context=context}return function CallDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&CallDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&CallDeclarative_defineProperties(Constructor,staticProps),Constructor}(ProxyCall,[{key:"unsubscribe",value:function unsubscribe(){this._transfer&&this._transfer.unsubscribe()}},{key:"get",value:function get(target,prop){var _this=this;switch(prop){case"api":return function(cls){var feature=target.api(cls);return feature.transfer?(_this._transfer||(_this._transfer=function transferCallFeatureDeclaratify(call,transfer,context){var proxyTransferCallFeature=new TransferCallFeatureDeclarative_ProxyTransferCallFeature(call,context);return Object.defineProperty(transfer,"unsubscribe",{configurable:!1,value:function value(){return proxyTransferCallFeature.unsubscribe()}}),new Proxy(transfer,proxyTransferCallFeature)}(_this._call,feature,_this._context)),_this._transfer):feature};default:return Reflect.get(target,prop)}}}]),ProxyCall}(),callDeclaratify=function callDeclaratify(call,context){var proxyCall=new CallDeclarative_ProxyCall(call,context);return Object.defineProperty(call,"unsubscribe",{configurable:!1,value:function value(){return proxyCall.unsubscribe()}}),new Proxy(call,proxyCall)};__webpack_require__(50);var ReceivedTransferSubscriber_ReceivedTransferSubscriber=function ReceivedTransferSubscriber(callIdRef,context,transfer){var _this=this;!function ReceivedTransferSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ReceivedTransferSubscriber),this._callIdRef=void 0,this._context=void 0,this._transfer=void 0,this.subscribe=function(){_this._transfer.on("transferRequested",_this.transferRequested)},this.unsubscribe=function(){_this._transfer.off("transferRequested",_this.transferRequested)},this.transferRequested=function(transferRequested){_this._context.setCallReceivedTransferRequest(_this._callIdRef.callId,function convertSdkTransferRequestedToDeclarativeTransferRequested(transferRequested){return{targetParticipant:transferRequested.targetParticipant}}(transferRequested))},this._callIdRef=callIdRef,this._context=context,this._transfer=transfer,this.subscribe()};function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||RemoteVideoStreamSubscriber_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function RemoteVideoStreamSubscriber_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return RemoteVideoStreamSubscriber_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?RemoteVideoStreamSubscriber_arrayLikeToArray(o,minLen):void 0}}function RemoteVideoStreamSubscriber_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var RemoteVideoStreamSubscriber=function RemoteVideoStreamSubscriber(callIdRef,participantKey,remoteVideoStream,context){var _this=this;!function RemoteVideoStreamSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RemoteVideoStreamSubscriber),this._callIdRef=void 0,this._participantKey=void 0,this._remoteVideoStream=void 0,this._context=void 0,this.subscribe=function(){_this._remoteVideoStream.on("isAvailableChanged",_this.isAvailableChanged),_this.checkAndUpdateScreenShareState()},this.unsubscribe=function(){_this._remoteVideoStream.off("isAvailableChanged",_this.isAvailableChanged)},this.includesActiveScreenShareStream=function(streams){var _step,_iterator=function RemoteVideoStreamSubscriber_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=RemoteVideoStreamSubscriber_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(streams.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _ref2=_slicedToArray(_step.value,2),stream=(_ref2[0],_ref2[1]);if("ScreenSharing"===stream.mediaStreamType&&stream.isAvailable)return!0}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1},this.checkAndUpdateScreenShareState=function(){var _this$_context$getSta,_this$_context$getSta2,_this$_context$getSta3;if("ScreenSharing"===_this._remoteVideoStream.mediaStreamType)if(_this._remoteVideoStream.isAvailable)_this._context.setCallScreenShareParticipant(_this._callIdRef.callId,_this._participantKey);else{var existingScreenShare=null===(_this$_context$getSta=_this._context.getState().calls.get(_this._callIdRef.callId))||void 0===_this$_context$getSta?void 0:_this$_context$getSta.screenShareRemoteParticipant;if(existingScreenShare&&existingScreenShare!==_this._participantKey){var streams=null===(_this$_context$getSta2=_this._context.getState().calls.get(_this._callIdRef.callId))||void 0===_this$_context$getSta2||null===(_this$_context$getSta3=_this$_context$getSta2.remoteParticipants.get(existingScreenShare))||void 0===_this$_context$getSta3?void 0:_this$_context$getSta3.videoStreams;streams&&_this.includesActiveScreenShareStream(streams)||_this._context.setCallScreenShareParticipant(_this._callIdRef.callId,void 0)}else _this._context.setCallScreenShareParticipant(_this._callIdRef.callId,void 0)}},this.isAvailableChanged=function(){_this._context.setRemoteVideoStreamIsAvailable(_this._callIdRef.callId,_this._participantKey,_this._remoteVideoStream.id,_this._remoteVideoStream.isAvailable),_this.checkAndUpdateScreenShareState()},this._callIdRef=callIdRef,this._participantKey=participantKey,this._remoteVideoStream=remoteVideoStream,this._context=context,this.subscribe()};function StreamUtils_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=StreamUtils_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function StreamUtils_slicedToArray(arr,i){return function StreamUtils_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function StreamUtils_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||StreamUtils_unsupportedIterableToArray(arr,i)||function StreamUtils_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function StreamUtils_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return StreamUtils_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?StreamUtils_arrayLikeToArray(o,minLen):void 0}}function StreamUtils_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StreamUtils_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _createViewRemoteVideo(){return(_createViewRemoteVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee(context,internalContext,callId,participantId,stream,options){var streamId,participantKey,renderInfo,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(streamId=stream.id,participantKey="string"==typeof participantId?participantId:Object(src.c)(participantId),renderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId)){_context.next=6;break}return console.warn("RemoteVideoStream not found in state"),_context.abrupt("return");case 6:if("Rendered"!==renderInfo.status){_context.next=9;break}return console.warn("RemoteVideoStream is already rendered"),_context.abrupt("return");case 9:if("Rendering"!==renderInfo.status){_context.next=12;break}return console.warn("RemoteVideoStream rendering is already in progress"),_context.abrupt("return");case 12:if("Stopping"!==renderInfo.status){_context.next=15;break}return console.warn("RemoteVideoStream is in the middle of stopping"),_context.abrupt("return");case 15:return renderer=new sdk_bundle.VideoStreamRenderer(renderInfo.stream),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"Rendering",void 0),_context.prev=17,_context.next=20,renderer.createView(options);case 20:view=_context.sent,_context.next=27;break;case 23:throw _context.prev=23,_context.t0=_context.catch(17),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"NotRendered",void 0),_context.t0;case 27:if(refreshedRenderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId)){_context.next=32;break}return renderer.dispose(),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0),_context.abrupt("return");case 32:if("Stopping"!==refreshedRenderInfo.status){_context.next=37;break}return renderer.dispose(),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,refreshedRenderInfo.stream,"NotRendered",void 0),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0),_context.abrupt("return");case 37:internalContext.setRemoteRenderInfo(callId,participantKey,streamId,refreshedRenderInfo.stream,"Rendered",renderer),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 39:case"end":return _context.stop()}}),_callee,null,[[17,23]])})))).apply(this,arguments)}function _createViewLocalVideo(){return(_createViewLocalVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee2(context,internalContext,callId,options){var renderInfo,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(renderInfo=internalContext.getLocalRenderInfo(callId)){_context2.next=4;break}return console.warn("LocalVideoStream not found in state"),_context2.abrupt("return");case 4:if("Rendered"!==renderInfo.status){_context2.next=7;break}return console.warn("LocalVideoStream is already rendered"),_context2.abrupt("return");case 7:if("Rendering"!==renderInfo.status){_context2.next=10;break}return console.warn("LocalVideoStream rendering is already in progress"),_context2.abrupt("return");case 10:if("Stopping"!==renderInfo.status){_context2.next=13;break}return console.warn("LocalVideoStream is in the middle of stopping"),_context2.abrupt("return");case 13:return renderer=new sdk_bundle.VideoStreamRenderer(renderInfo.stream),internalContext.setLocalRenderInfo(callId,renderInfo.stream,"Rendering",void 0),_context2.prev=15,_context2.next=18,renderer.createView(options);case 18:view=_context2.sent,_context2.next=25;break;case 21:throw _context2.prev=21,_context2.t0=_context2.catch(15),internalContext.setLocalRenderInfo(callId,renderInfo.stream,"NotRendered",void 0),_context2.t0;case 25:if(refreshedRenderInfo=internalContext.getLocalRenderInfo(callId)){_context2.next=30;break}return renderer.dispose(),context.setLocalVideoStreamRendererView(callId,void 0),_context2.abrupt("return");case 30:if("Stopping"!==refreshedRenderInfo.status){_context2.next=35;break}return renderer.dispose(),internalContext.setLocalRenderInfo(callId,refreshedRenderInfo.stream,"NotRendered",void 0),context.setLocalVideoStreamRendererView(callId,void 0),_context2.abrupt("return");case 35:internalContext.setLocalRenderInfo(callId,refreshedRenderInfo.stream,"Rendered",renderer),context.setLocalVideoStreamRendererView(callId,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 37:case"end":return _context2.stop()}}),_callee2,null,[[15,21]])})))).apply(this,arguments)}function _createViewUnparentedVideo(){return(_createViewUnparentedVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee3(context,internalContext,stream,options){var renderInfo,localVideoStream,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!(renderInfo=internalContext.getUnparentedRenderInfo(stream))||"Rendered"!==renderInfo.status){_context3.next=4;break}return console.warn("Unparented LocalVideoStream is already rendered"),_context3.abrupt("return");case 4:if(!renderInfo||"Rendering"!==renderInfo.status){_context3.next=7;break}return console.warn("Unparented LocalVideoStream rendering is already in progress"),_context3.abrupt("return");case 7:if(!renderInfo||"Stopping"!==renderInfo.status){_context3.next=10;break}return console.warn("Unparented LocalVideoStream is in the middle of stopping"),_context3.abrupt("return");case 10:return localVideoStream=new sdk_bundle.LocalVideoStream(stream.source),renderer=new sdk_bundle.VideoStreamRenderer(localVideoStream),internalContext.setUnparentedRenderInfo(stream,localVideoStream,"Rendering",void 0),_context3.prev=13,_context3.next=16,renderer.createView(options);case 16:view=_context3.sent,_context3.next=23;break;case 19:throw _context3.prev=19,_context3.t0=_context3.catch(13),internalContext.deleteUnparentedRenderInfo(stream),_context3.t0;case 23:if(refreshedRenderInfo=internalContext.getUnparentedRenderInfo(stream)){_context3.next=28;break}return renderer.dispose(),context.deleteDeviceManagerUnparentedView(stream),_context3.abrupt("return");case 28:if("Stopping"!==refreshedRenderInfo.status){_context3.next=32;break}return internalContext.deleteUnparentedRenderInfo(stream),context.deleteDeviceManagerUnparentedView(stream),_context3.abrupt("return");case 32:internalContext.setUnparentedRenderInfo(stream,localVideoStream,"Rendered",renderer),context.setDeviceManagerUnparentedView(stream,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 34:case"end":return _context3.stop()}}),_callee3,null,[[13,19]])})))).apply(this,arguments)}function createView(context,internalContext,callId,participantId,stream,options){return"id"in stream&&callId&&participantId?function createViewRemoteVideo(_x,_x2,_x3,_x4,_x5,_x6){return _createViewRemoteVideo.apply(this,arguments)}(context,internalContext,callId,participantId,stream,options):!("id"in stream)&&callId?function createViewLocalVideo(_x7,_x8,_x9,_x10){return _createViewLocalVideo.apply(this,arguments)}(context,internalContext,callId,options):"id"in stream||callId?(console.warn("Invalid combination of parameters"),Promise.resolve()):function createViewUnparentedVideo(_x11,_x12,_x13,_x14){return _createViewUnparentedVideo.apply(this,arguments)}(context,internalContext,stream,options)}function disposeView(context,internalContext,callId,participantId,stream){if("id"in stream&&callId&&participantId)!function disposeViewRemoteVideo(context,internalContext,callId,participantId,stream){var participantKey,streamId=stream.id;participantKey="string"==typeof participantId?participantId:Object(src.c)(participantId),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0);var renderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId);renderInfo&&("Rendering"===renderInfo.status?internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"Stopping",void 0):internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"NotRendered",void 0),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,callId,participantId,stream);else if(!("id"in stream)&&callId)!function disposeViewLocalVideo(context,internalContext,callId){context.setLocalVideoStreamRendererView(callId,void 0);var renderInfo=internalContext.getLocalRenderInfo(callId);renderInfo&&("Rendering"===renderInfo.status?internalContext.setLocalRenderInfo(callId,renderInfo.stream,"Stopping",void 0):internalContext.setLocalRenderInfo(callId,renderInfo.stream,"NotRendered",void 0),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,callId);else{if("id"in stream||callId)return void console.warn("Invalid combination of parameters");!function disposeViewUnparentedVideo(context,internalContext,stream){context.deleteDeviceManagerUnparentedView(stream);var renderInfo=internalContext.getUnparentedRenderInfo(stream);renderInfo&&("Rendering"===renderInfo.status?internalContext.setUnparentedRenderInfo(stream,renderInfo.stream,"Stopping",void 0):internalContext.deleteUnparentedRenderInfo(stream),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,stream)}}function disposeAllViewsFromCall(context,internalContext,callId){var callStreams=internalContext.getRemoteRenderInfoForCall(callId);if(callStreams){var _step,_iterator=StreamUtils_createForOfIteratorHelper(callStreams.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,_ref2=StreamUtils_slicedToArray(_step.value,2),participantKey=_ref2[0],_iterator2=StreamUtils_createForOfIteratorHelper(_ref2[1].entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref4=StreamUtils_slicedToArray(_step2.value,2);_ref4[0];disposeView(context,internalContext,callId,participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(_ref4[1].stream))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}var localStreamAndRenderer=internalContext.getLocalRenderInfo(callId);localStreamAndRenderer&&localStreamAndRenderer.renderer&&disposeView(context,internalContext,callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(localStreamAndRenderer.stream))}function ParticipantSubscriber_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function ParticipantSubscriber_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantSubscriber_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantSubscriber_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ParticipantSubscriber_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantSubscriber_ParticipantSubscriber=function ParticipantSubscriber(callIdRef,participant,context,internalContext){var _this=this;!function ParticipantSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ParticipantSubscriber),this._callIdRef=void 0,this._participant=void 0,this._context=void 0,this._internalContext=void 0,this._participantKey=void 0,this._remoteVideoStreamSubscribers=void 0,this.subscribe=function(){if(_this._participant.on("stateChanged",_this.stateChanged),_this._participant.on("isMutedChanged",_this.isMutedChanged),_this._participant.on("displayNameChanged",_this.displayNameChanged),_this._participant.on("isSpeakingChanged",_this.isSpeakingChanged),_this._participant.on("videoStreamsUpdated",_this.videoStreamsUpdated),_this._participant.videoStreams.length>0){var _step,_iterator=ParticipantSubscriber_createForOfIteratorHelper(_this._participant.videoStreams);try{for(_iterator.s();!(_step=_iterator.n()).done;){var stream=_step.value;_this._internalContext.setRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id,stream,"NotRendered",void 0),_this.addRemoteVideoStreamSubscriber(stream)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this._context.setRemoteVideoStreams(_this._callIdRef.callId,_this._participantKey,_this._participant.videoStreams.map(convertSdkRemoteStreamToDeclarativeRemoteStream),[])}},this.unsubscribe=function(){if(_this._participant.off("stateChanged",_this.stateChanged),_this._participant.off("isMutedChanged",_this.isMutedChanged),_this._participant.off("displayNameChanged",_this.displayNameChanged),_this._participant.off("isSpeakingChanged",_this.isSpeakingChanged),_this._participant.off("videoStreamsUpdated",_this.videoStreamsUpdated),_this._participant.videoStreams.length>0){var _step2,_iterator2=ParticipantSubscriber_createForOfIteratorHelper(_this._participant.videoStreams);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var stream=_step2.value;disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,_this._participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(stream)),_this._internalContext.deleteRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},this.addRemoteVideoStreamSubscriber=function(remoteVideoStream){var _this$_remoteVideoStr;null===(_this$_remoteVideoStr=_this._remoteVideoStreamSubscribers.get(remoteVideoStream.id))||void 0===_this$_remoteVideoStr||_this$_remoteVideoStr.unsubscribe(),_this._remoteVideoStreamSubscribers.set(remoteVideoStream.id,new RemoteVideoStreamSubscriber(_this._callIdRef,_this._participantKey,remoteVideoStream,_this._context))},this.stateChanged=function(){_this._context.setParticipantState(_this._callIdRef.callId,_this._participantKey,_this._participant.state)},this.isMutedChanged=function(){_this._context.setParticipantIsMuted(_this._callIdRef.callId,_this._participantKey,_this._participant.isMuted)},this.displayNameChanged=function(){_this._context.setParticipantDisplayName(_this._callIdRef.callId,_this._participantKey,_this._participant.displayName||"")},this.isSpeakingChanged=function(){_this._context.setParticipantIsSpeaking(_this._callIdRef.callId,_this._participantKey,_this._participant.isSpeaking)},this.videoStreamsUpdated=function(event){var _step3,_iterator3=ParticipantSubscriber_createForOfIteratorHelper(event.removed);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _this$_remoteVideoStr2,stream=_step3.value;null===(_this$_remoteVideoStr2=_this._remoteVideoStreamSubscribers.get(stream.id))||void 0===_this$_remoteVideoStr2||_this$_remoteVideoStr2.unsubscribe(),disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,_this._participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(stream)),_this._internalContext.deleteRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var _step4,_iterator4=ParticipantSubscriber_createForOfIteratorHelper(event.added);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _stream=_step4.value;_this._internalContext.setRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,_stream.id,_stream,"NotRendered",void 0),_this.addRemoteVideoStreamSubscriber(_stream)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}_this._context.setRemoteVideoStreams(_this._callIdRef.callId,_this._participantKey,event.added.map(convertSdkRemoteStreamToDeclarativeRemoteStream),event.removed.map((function(stream){return stream.id})))},this._callIdRef=callIdRef,this._participant=participant,this._context=context,this._internalContext=internalContext,this._participantKey=Object(src.c)(this._participant.identifier),this._remoteVideoStreamSubscribers=new Map,this.subscribe()};var RecordingSubscriber=function RecordingSubscriber(callIdRef,context,recording){var _this=this;!function RecordingSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RecordingSubscriber),this._callIdRef=void 0,this._context=void 0,this._recording=void 0,this.subscribe=function(){_this._recording.on("isRecordingActiveChanged",_this.isAvailableChanged)},this.unsubscribe=function(){_this._recording.off("isRecordingActiveChanged",_this.isAvailableChanged)},this.isAvailableChanged=function(){_this._context.setCallRecordingActive(_this._callIdRef.callId,_this._recording.isRecordingActive)},this._callIdRef=callIdRef,this._context=context,this._recording=recording,this._recording.isRecordingActive&&this._context.setCallRecordingActive(this._callIdRef.callId,this._recording.isRecordingActive),this.subscribe()};var TranscriptionSubscriber=function TranscriptionSubscriber(callIdRef,context,transcription){var _this=this;!function TranscriptionSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TranscriptionSubscriber),this._callIdRef=void 0,this._context=void 0,this._transcription=void 0,this.subscribe=function(){_this._transcription.on("isTranscriptionActiveChanged",_this.isTranscriptionActiveChanged)},this.unsubscribe=function(){_this._transcription.off("isTranscriptionActiveChanged",_this.isTranscriptionActiveChanged)},this.isTranscriptionActiveChanged=function(){_this._context.setCallTranscriptionActive(_this._callIdRef.callId,_this._transcription.isTranscriptionActive)},this._callIdRef=callIdRef,this._context=context,this._transcription=transcription,this._transcription.isTranscriptionActive&&this._context.setCallTranscriptionActive(this._callIdRef.callId,this._transcription.isTranscriptionActive),this.subscribe()};function CallSubscriber_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallSubscriber_CallSubscriber=function(){function CallSubscriber(call,context,internalContext){var _this=this;!function CallSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CallSubscriber),this._call=void 0,this._callIdRef=void 0,this._context=void 0,this._internalContext=void 0,this._participantSubscribers=void 0,this._recordingSubscriber=void 0,this._transcriptionSubscriber=void 0,this._receivedTransferSubscriber=void 0,this.subscribe=function(){_this._call.on("stateChanged",_this.stateChanged),_this._call.on("idChanged",_this.idChanged),_this._call.on("isScreenSharingOnChanged",_this.isScreenSharingOnChanged),_this._call.on("remoteParticipantsUpdated",_this.remoteParticipantsUpdated),_this._call.on("localVideoStreamsUpdated",_this.localVideoStreamsUpdated),_this._call.on("isMutedChanged",_this.isMuteChanged),_this._call.localVideoStreams.length>0&&_this._internalContext.setLocalRenderInfo(_this._callIdRef.callId,_this._call.localVideoStreams[0],"NotRendered",void 0),_this._call.remoteParticipants.length>0&&(_this._call.remoteParticipants.forEach((function(participant){_this.addParticipantListener(participant)})),_this._context.setCallRemoteParticipants(_this._callIdRef.callId,_this._call.remoteParticipants.map(convertSdkParticipantToDeclarativeParticipant),[]))},this.unsubscribe=function(){_this._call.off("stateChanged",_this.stateChanged),_this._call.off("idChanged",_this.idChanged),_this._call.off("isScreenSharingOnChanged",_this.isScreenSharingOnChanged),_this._call.off("remoteParticipantsUpdated",_this.remoteParticipantsUpdated),_this._call.off("localVideoStreamsUpdated",_this.localVideoStreamsUpdated),_this._call.off("isMutedChanged",_this.isMuteChanged),_this._participantSubscribers.forEach((function(participantSubscriber){participantSubscriber.unsubscribe()})),_this._participantSubscribers.clear(),_this._call.localVideoStreams&&_this._call.localVideoStreams[0]&&disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(_this._call.localVideoStreams[0])),_this._internalContext.deleteLocalRenderInfo(_this._callIdRef.callId),_this._recordingSubscriber.unsubscribe(),_this._transcriptionSubscriber.unsubscribe(),_this._receivedTransferSubscriber.unsubscribe()},this.stateChanged=function(){_this._context.setCallState(_this._callIdRef.callId,_this._call.state)},this.idChanged=function(){_this._internalContext.setCallId(_this._call.id,_this._callIdRef.callId),_this._context.setCallId(_this._call.id,_this._callIdRef.callId),_this._callIdRef.callId=_this._call.id},this.isScreenSharingOnChanged=function(){_this._context.setCallIsScreenSharingOn(_this._callIdRef.callId,_this._call.isScreenSharingOn)},this.isMuteChanged=function(){_this._context.setCallIsMicrophoneMuted(_this._callIdRef.callId,_this._call.isMuted)},this.remoteParticipantsUpdated=function(event){event.added.forEach((function(participant){_this.addParticipantListener(participant)})),event.removed.forEach((function(participant){_this.removeParticipantListener(participant)})),_this._context.setCallRemoteParticipantsEnded(_this._callIdRef.callId,event.removed.map(convertSdkParticipantToDeclarativeParticipant),event.added.map((function(participant){return Object(src.c)(participant.identifier)}))),_this._context.setCallRemoteParticipants(_this._callIdRef.callId,event.added.map(convertSdkParticipantToDeclarativeParticipant),event.removed.map((function(participant){return Object(src.c)(participant.identifier)})))},this.localVideoStreamsUpdated=function(event){if(event.added.length>0){var localVideoStreams=[convertSdkLocalStreamToDeclarativeLocalStream(_this._call.localVideoStreams[0])];_this._internalContext.setLocalRenderInfo(_this._callIdRef.callId,_this._call.localVideoStreams[0],"NotRendered",void 0),_this._context.setCallLocalVideoStream(_this._callIdRef.callId,[].concat(localVideoStreams))}event.removed.length>0&&(disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(event.removed[0])),_this._internalContext.deleteLocalRenderInfo(_this._callIdRef.callId),_this._context.setCallLocalVideoStream(_this._callIdRef.callId,[]))},this._call=call,this._callIdRef={callId:call.id},this._context=context,this._internalContext=internalContext,this._participantSubscribers=new Map,this._recordingSubscriber=new RecordingSubscriber(this._callIdRef,this._context,this._call.api(sdk_bundle.Features.Recording)),this._transcriptionSubscriber=new TranscriptionSubscriber(this._callIdRef,this._context,this._call.api(sdk_bundle.Features.Transcription)),this._receivedTransferSubscriber=new ReceivedTransferSubscriber_ReceivedTransferSubscriber(this._callIdRef,this._context,this._call.api(sdk_bundle.Features.Transfer)),this.subscribe()}return function CallSubscriber_createClass(Constructor,protoProps,staticProps){return protoProps&&CallSubscriber_defineProperties(Constructor.prototype,protoProps),staticProps&&CallSubscriber_defineProperties(Constructor,staticProps),Constructor}(CallSubscriber,[{key:"addParticipantListener",value:function addParticipantListener(participant){var _this$_participantSub,participantKey=Object(src.c)(participant.identifier);null===(_this$_participantSub=this._participantSubscribers.get(participantKey))||void 0===_this$_participantSub||_this$_participantSub.unsubscribe(),this._participantSubscribers.set(participantKey,new ParticipantSubscriber_ParticipantSubscriber(this._callIdRef,participant,this._context,this._internalContext))}},{key:"removeParticipantListener",value:function removeParticipantListener(participant){var participantKey=Object(src.c)(participant.identifier),participantSubscriber=this._participantSubscribers.get(participantKey);participantSubscriber&&(participantSubscriber.unsubscribe(),this._participantSubscribers.delete(participantKey))}}]),CallSubscriber}();var IncomingCallSubscriber=function IncomingCallSubscriber(incomingCall,setIncomingCallEnded){var _this=this;!function IncomingCallSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,IncomingCallSubscriber),this._incomingCall=void 0,this._setIncomingCallEnded=void 0,this.subscribe=function(){_this._incomingCall.on("callEnded",_this.callEnded)},this.unsubscribe=function(){_this._incomingCall.off("callEnded",_this.callEnded)},this.callEnded=function(event){_this._setIncomingCallEnded(_this._incomingCall.id,event.callEndReason)},this._incomingCall=incomingCall,this._setIncomingCallEnded=setIncomingCallEnded,this.subscribe()};function CallAgentDeclarative_slicedToArray(arr,i){return function CallAgentDeclarative_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallAgentDeclarative_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||CallAgentDeclarative_unsupportedIterableToArray(arr,i)||function CallAgentDeclarative_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallAgentDeclarative_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=CallAgentDeclarative_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function CallAgentDeclarative_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return CallAgentDeclarative_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CallAgentDeclarative_arrayLikeToArray(o,minLen):void 0}}function CallAgentDeclarative_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CallAgentDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallAgentDeclarative_ProxyCallAgent=function(){function ProxyCallAgent(callAgent,context,internalContext){var _this=this;!function CallAgentDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCallAgent),this._callAgent=void 0,this._context=void 0,this._internalContext=void 0,this._callSubscribers=void 0,this._incomingCallSubscribers=void 0,this._declarativeCalls=void 0,this._externalCallsUpdatedListeners=void 0,this.subscribe=function(){_this._callAgent.on("callsUpdated",_this.callsUpdated),_this._callAgent.on("incomingCall",_this.incomingCall);var _step,_iterator=CallAgentDeclarative_createForOfIteratorHelper(_this._callAgent.calls);try{for(_iterator.s();!(_step=_iterator.n()).done;){var call=_step.value;_this.addCall(call)}}catch(err){_iterator.e(err)}finally{_iterator.f()}},this.unsubscribe=function(){_this._callAgent.off("callsUpdated",_this.callsUpdated),_this._callAgent.off("incomingCall",_this.incomingCall);var _step2,_iterator2=CallAgentDeclarative_createForOfIteratorHelper(_this._callSubscribers.entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref2=CallAgentDeclarative_slicedToArray(_step2.value,2);_ref2[0];_ref2[1].unsubscribe()}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}_this._callSubscribers.clear();var _step3,_iterator3=CallAgentDeclarative_createForOfIteratorHelper(_this._incomingCallSubscribers.entries());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _ref4=CallAgentDeclarative_slicedToArray(_step3.value,2);_ref4[0];_ref4[1].unsubscribe()}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}_this._incomingCallSubscribers.clear();var _step4,_iterator4=CallAgentDeclarative_createForOfIteratorHelper(_this._declarativeCalls.entries());try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _ref6=CallAgentDeclarative_slicedToArray(_step4.value,2);_ref6[0];_ref6[1].unsubscribe()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}_this._declarativeCalls.clear()},this.callsUpdated=function(event){var _step5,addedStatefulCall=[],_iterator5=CallAgentDeclarative_createForOfIteratorHelper(event.added);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var call=_step5.value,statefulCall=_this.addCall(call);addedStatefulCall.push(statefulCall)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var _step6,removedStatefulCall=[],_iterator6=CallAgentDeclarative_createForOfIteratorHelper(event.removed);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _call=_step6.value;disposeAllViewsFromCall(_this._context,_this._internalContext,_call.id);var callSubscriber=_this._callSubscribers.get(_call);callSubscriber&&(callSubscriber.unsubscribe(),_this._callSubscribers.delete(_call)),_this._context.setCallEnded(_call.id,_call.callEndReason);var declarativeCall=_this._declarativeCalls.get(_call);declarativeCall?(declarativeCall.unsubscribe(),removedStatefulCall.push(declarativeCall),_this._declarativeCalls.delete(_call)):removedStatefulCall.push(callDeclaratify(_call,_this._context))}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}var _step7,_iterator7=CallAgentDeclarative_createForOfIteratorHelper(_this._externalCallsUpdatedListeners);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){(0,_step7.value)({added:addedStatefulCall,removed:removedStatefulCall})}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}},this.setIncomingCallEnded=function(incomingCallId,callEndReason){var incomingCallSubscriber=_this._incomingCallSubscribers.get(incomingCallId);incomingCallSubscriber&&(incomingCallSubscriber.unsubscribe(),_this._incomingCallSubscribers.delete(incomingCallId)),_this._context.setIncomingCallEnded(incomingCallId,callEndReason)},this.incomingCall=function(event){_this._incomingCallSubscribers.has(event.incomingCall.id)||_this._incomingCallSubscribers.set(event.incomingCall.id,new IncomingCallSubscriber(event.incomingCall,_this.setIncomingCallEnded)),_this._context.setIncomingCall(function convertSdkIncomingCallToDeclarativeIncomingCall(call){return{id:call.id,callerInfo:call.callerInfo,startTime:new Date,endTime:void 0}}(event.incomingCall))},this.addCall=function(call){var _this$_callSubscriber;return null===(_this$_callSubscriber=_this._callSubscribers.get(call))||void 0===_this$_callSubscriber||_this$_callSubscriber.unsubscribe(),_this._context.setCall(function convertSdkCallToDeclarativeCall(call){var declarativeRemoteParticipants=new Map;return call.remoteParticipants.forEach((function(participant){declarativeRemoteParticipants.set(Object(src.c)(participant.identifier),convertSdkParticipantToDeclarativeParticipant(participant))})),{id:call.id,callerInfo:call.callerInfo,state:call.state,callEndReason:call.callEndReason,direction:call.direction,isMuted:call.isMuted,isScreenSharingOn:call.isScreenSharingOn,localVideoStreams:call.localVideoStreams.map(convertSdkLocalStreamToDeclarativeLocalStream),remoteParticipants:declarativeRemoteParticipants,remoteParticipantsEnded:new Map,recording:{isRecordingActive:!1},transcription:{isTranscriptionActive:!1},transfer:{receivedTransferRequests:[],requestedTransfers:[]},screenShareRemoteParticipant:void 0,startTime:new Date,endTime:void 0}}(call)),_this._callSubscribers.set(call,new CallSubscriber_CallSubscriber(call,_this._context,_this._internalContext)),_this.getOrCreateDeclarativeCall(call)},this.getOrCreateDeclarativeCall=function(call){var declarativeCall=_this._declarativeCalls.get(call);if(declarativeCall)return declarativeCall;var newDeclarativeCall=callDeclaratify(call,_this._context);return _this._declarativeCalls.set(call,newDeclarativeCall),newDeclarativeCall},this._callAgent=callAgent,this._context=context,this._internalContext=internalContext,this._callSubscribers=new Map,this._incomingCallSubscribers=new Map,this._declarativeCalls=new Map,this._externalCallsUpdatedListeners=new Set,this.subscribe()}return function CallAgentDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&CallAgentDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&CallAgentDeclarative_defineProperties(Constructor,staticProps),Constructor}(ProxyCallAgent,[{key:"get",value:function get(target,prop){var _this2=this;switch(prop){case"startCall":return function(){var call=target.startCall.apply(target,arguments);return _this2.addCall(call),_this2.getOrCreateDeclarativeCall(call)};case"join":return function(){var call=target.join.apply(target,arguments);return _this2.addCall(call),_this2.getOrCreateDeclarativeCall(call)};case"calls":return Array.from(this._declarativeCalls.values());case"on":return function(){var isCallsUpdated="callsUpdated"===(arguments.length<=0?void 0:arguments[0]);if(isCallsUpdated){var listener=arguments.length<=1?void 0:arguments[1];_this2._externalCallsUpdatedListeners.add(listener)}else target.on.apply(target,arguments)};case"off":return function(){var isCallsUpdated="callsUpdated"===(arguments.length<=0?void 0:arguments[0]);if(isCallsUpdated){var listener=arguments.length<=1?void 0:arguments[1];_this2._externalCallsUpdatedListeners.delete(listener)}else target.off.apply(target,arguments)};case"dispose":return function(){return target.dispose().then((function(){_this2.unsubscribe()}))};default:return Reflect.get(target,prop)}}}]),ProxyCallAgent}(),CallAgentDeclarative_callAgentDeclaratify=function callAgentDeclaratify(callAgent,context,internalContext){return function disposeAllViews(context,internalContext){var _step3,_iterator3=StreamUtils_createForOfIteratorHelper(internalContext.getRemoteRenderInfos().entries());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){disposeAllViewsFromCall(context,internalContext,StreamUtils_slicedToArray(_step3.value,1)[0])}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}(context,internalContext),context.clearCallRelatedState(),internalContext.clearCallRelatedState(),new Proxy(callAgent,new CallAgentDeclarative_ProxyCallAgent(callAgent,context,internalContext))};function InternalCallContext_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var InternalCallContext=function(){function InternalCallContext(){!function InternalCallContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,InternalCallContext),this._remoteRenderInfos=void 0,this._localRenderInfos=void 0,this._unparentedRenderInfos=void 0,this._remoteRenderInfos=new Map,this._localRenderInfos=new Map,this._unparentedRenderInfos=new Map}return function InternalCallContext_createClass(Constructor,protoProps,staticProps){return protoProps&&InternalCallContext_defineProperties(Constructor.prototype,protoProps),staticProps&&InternalCallContext_defineProperties(Constructor,staticProps),Constructor}(InternalCallContext,[{key:"setCallId",value:function setCallId(newCallId,oldCallId){var remoteRenderInfos=this._remoteRenderInfos.get(oldCallId);remoteRenderInfos&&(this._remoteRenderInfos.delete(oldCallId),this._remoteRenderInfos.set(newCallId,remoteRenderInfos));var localRenderInfos=this._localRenderInfos.get(oldCallId);localRenderInfos&&(this._localRenderInfos.delete(oldCallId),this._localRenderInfos.set(newCallId,localRenderInfos))}},{key:"getRemoteRenderInfos",value:function getRemoteRenderInfos(){return this._remoteRenderInfos}},{key:"getRemoteRenderInfoForCall",value:function getRemoteRenderInfoForCall(callId){return this._remoteRenderInfos.get(callId)}},{key:"getRemoteRenderInfoForParticipant",value:function getRemoteRenderInfoForParticipant(callId,participantKey,streamId){var callRenderInfos=this._remoteRenderInfos.get(callId);if(callRenderInfos){var participantRenderInfos=callRenderInfos.get(participantKey);if(participantRenderInfos)return participantRenderInfos.get(streamId)}}},{key:"setRemoteRenderInfo",value:function setRemoteRenderInfo(callId,participantKey,streamId,stream,status,renderer){var callRenderInfos=this._remoteRenderInfos.get(callId);callRenderInfos||(callRenderInfos=new Map,this._remoteRenderInfos.set(callId,callRenderInfos));var participantRenderInfos=callRenderInfos.get(participantKey);participantRenderInfos||(participantRenderInfos=new Map,callRenderInfos.set(participantKey,participantRenderInfos)),participantRenderInfos.set(streamId,{stream:stream,status:status,renderer:renderer})}},{key:"deleteRemoteRenderInfo",value:function deleteRemoteRenderInfo(callId,participantKey,streamId){var callRenderInfos=this._remoteRenderInfos.get(callId);if(callRenderInfos){var participantRenderInfos=callRenderInfos.get(participantKey);participantRenderInfos&&participantRenderInfos.delete(streamId)}}},{key:"setLocalRenderInfo",value:function setLocalRenderInfo(callId,stream,status,renderer){this._localRenderInfos.set(callId,{stream:stream,status:status,renderer:renderer})}},{key:"getLocalRenderInfo",value:function getLocalRenderInfo(callId){return this._localRenderInfos.get(callId)}},{key:"deleteLocalRenderInfo",value:function deleteLocalRenderInfo(callId){this._localRenderInfos.delete(callId)}},{key:"getUnparentedRenderInfo",value:function getUnparentedRenderInfo(localVideoStream){return this._unparentedRenderInfos.get(localVideoStream)}},{key:"setUnparentedRenderInfo",value:function setUnparentedRenderInfo(statefulStream,stream,status,renderer){this._unparentedRenderInfos.set(statefulStream,{stream:stream,status:status,renderer:renderer})}},{key:"deleteUnparentedRenderInfo",value:function deleteUnparentedRenderInfo(localVideoStream){this._unparentedRenderInfos.delete(localVideoStream)}},{key:"clearCallRelatedState",value:function clearCallRelatedState(){this._remoteRenderInfos.clear(),this._localRenderInfos.clear()}}]),InternalCallContext}();function StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulCallClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function StatefulCallClient_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var StatefulCallClient_ProxyCallClient=function(){function ProxyCallClient(context,internalContext){!function StatefulCallClient_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCallClient),this._context=void 0,this._internalContext=void 0,this._callAgent=void 0,this._deviceManager=void 0,this._sdkDeviceManager=void 0,this._context=context,this._internalContext=internalContext}return function StatefulCallClient_createClass(Constructor,protoProps,staticProps){return protoProps&&StatefulCallClient_defineProperties(Constructor.prototype,protoProps),staticProps&&StatefulCallClient_defineProperties(Constructor,staticProps),Constructor}(ProxyCallClient,[{key:"get",value:function get(target,prop){var _this=this;switch(prop){case"createCallAgent":return StatefulCallClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var callAgent,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,target.createCallAgent.apply(target,_args);case 2:return callAgent=_context.sent,_this._callAgent=CallAgentDeclarative_callAgentDeclaratify(callAgent,_this._context,_this._internalContext),_this._context.setCallAgent({displayName:_this._callAgent.displayName}),_context.abrupt("return",_this._callAgent);case 6:case"end":return _context.stop()}}),_callee)})));case"getDeviceManager":return StatefulCallClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var deviceManager;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,target.getDeviceManager();case 2:if(deviceManager=_context2.sent,!_this._sdkDeviceManager){_context2.next=11;break}if(_this._sdkDeviceManager!==deviceManager){_context2.next=8;break}return _context2.abrupt("return",_this._deviceManager);case 8:throw new Error("Multiple DeviceManager not supported. This means a incompatible version of communication-calling is used OR calling declarative was not properly updated to communication-calling version.");case 9:_context2.next=12;break;case 11:_this._sdkDeviceManager=deviceManager;case 12:return _this._deviceManager=deviceManagerDeclaratify(deviceManager,_this._context),_context2.abrupt("return",_this._deviceManager);case 14:case"end":return _context2.stop()}}),_callee2)})));default:return Reflect.get(target,prop)}}}]),ProxyCallClient}(),StatefulCallClient_createStatefulCallClient=function createStatefulCallClient(args,options){var callClient=new sdk_bundle.CallClient(null==options?void 0:options.callClientOptions),context=new CallContext_CallContext(args.userId,null==options?void 0:options.maxStateChangeListeners),internalContext=new InternalCallContext;return Object.defineProperty(callClient,"getState",{configurable:!1,value:function value(){return context.getState()}}),Object.defineProperty(callClient,"onStateChange",{configurable:!1,value:function value(handler){return context.onStateChange(handler)}}),Object.defineProperty(callClient,"offStateChange",{configurable:!1,value:function value(handler){return context.offStateChange(handler)}}),Object.defineProperty(callClient,"createView",{configurable:!1,value:function value(callId,participantId,stream,options){return createView(context,internalContext,callId,participantId,stream,options)}}),Object.defineProperty(callClient,"disposeView",{configurable:!1,value:function value(callId,participantId,stream){disposeView(context,internalContext,callId,participantId,stream)}}),new Proxy(callClient,new StatefulCallClient_ProxyCallClient(context,internalContext))}},27:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"l",(function(){return TypingIndicator_TypingIndicator})),__webpack_require__.d(__webpack_exports__,"j",(function(){return SendBox_SendBox})),__webpack_require__.d(__webpack_exports__,"e",(function(){return MessageThread_MessageThread})),__webpack_require__.d(__webpack_exports__,"k",(function(){return StreamMedia_StreamMedia})),__webpack_require__.d(__webpack_exports__,"h",(function(){return ParticipantList_ParticipantList})),__webpack_require__.d(__webpack_exports__,"m",(function(){return VideoGallery_VideoGallery})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CameraButton_CameraButton})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ControlBar_ControlBar})),__webpack_require__.d(__webpack_exports__,"c",(function(){return EndCallButton_EndCallButton})),__webpack_require__.d(__webpack_exports__,"f",(function(){return MicrophoneButton_MicrophoneButton})),__webpack_require__.d(__webpack_exports__,"g",(function(){return OptionsButton_OptionsButton})),__webpack_require__.d(__webpack_exports__,"i",(function(){return ScreenShareButton_ScreenShareButton})),__webpack_require__.d(__webpack_exports__,"n",(function(){return VideoTile_VideoTile})),__webpack_require__.d(__webpack_exports__,"d",(function(){return FluentThemeProvider_FluentThemeProvider}));__webpack_require__(61),__webpack_require__(50),__webpack_require__(83),__webpack_require__(20),__webpack_require__(9),__webpack_require__(13),__webpack_require__(24),__webpack_require__(17),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(15),__webpack_require__(16),__webpack_require__(21);var lib=__webpack_require__(34),typingIndicatorContainerStyle=Object(lib.G)({height:"2.125rem",display:"flex",alignItems:"center"}),typingIndicatorListStyle=Object(lib.G)({fontWeight:400,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0.1875rem"}),typingIndicatorVerbStyle=Object(lib.G)({fontWeight:400,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0.1875rem"}),react=(Object(lib.G)({width:"2.125rem",height:"2.125rem",paddingRight:"0.1875rem"}),__webpack_require__(0)),react_default=__webpack_require__.n(react),Stack=__webpack_require__(435);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TypingIndicator_TypingIndicator=function TypingIndicator(props){var typingUsers=props.typingUsers,typingString=props.typingString,onRenderUsers=props.onRenderUsers,styles=props.styles,typingUsersToRender=onRenderUsers?typingUsers:typingUsers.filter((function(typingUser){return void 0!==typingUser.displayName}));return react_default.a.createElement(Stack.a,{horizontal:!0,className:Object(lib.G)(typingIndicatorContainerStyle,null==styles?void 0:styles.root)},onRenderUsers?onRenderUsers(typingUsersToRender):function getDefaultComponents(typingUsers,styles){var _step,displayComponents=[],typingUsersMentioned=[],countOfUsersMentioned=0,totalCharacterCount=0,_iterator=_createForOfIteratorHelper(typingUsers);try{for(_iterator.s();!(_step=_iterator.n()).done;){var typingUser=_step.value,additionalCharCount=2*(countOfUsersMentioned-1)+(typingUser.displayName?typingUser.displayName.length:0);if(!(totalCharacterCount+additionalCharCount<=35||1===countOfUsersMentioned))break;typingUsersMentioned.push(typingUser),totalCharacterCount+=additionalCharCount,countOfUsersMentioned+=1}}catch(err){_iterator.e(err)}finally{_iterator.f()}typingUsersMentioned.forEach((function(typingUser,index){displayComponents.push(react_default.a.createElement("span",{className:Object(lib.G)(typingIndicatorListStyle,null==styles?void 0:styles.typingUserDisplayName),key:"typing indicator display string ".concat(index)},index<typingUsers.length-1?typingUser.displayName+", ":typingUser.displayName))}));var countOfUsersNotMentioned=typingUsers.length-typingUsersMentioned.length;return countOfUsersNotMentioned>0&&displayComponents.push(react_default.a.createElement("span",{className:Object(lib.G)(typingIndicatorVerbStyle,null==styles?void 0:styles.typingString),key:"UsersCountKey"}," and ".concat(countOfUsersNotMentioned," other").concat(1===countOfUsersNotMentioned?"":"s"))),displayComponents}(typingUsersToRender,styles),react_default.a.createElement("span",{className:Object(lib.G)(typingIndicatorVerbStyle,null==styles?void 0:styles.typingString),key:"TypingStringKey"},null!=typingString?typingString:function defaultTypingString(typingUsers){return typingUsers.length>0?typingUsers.length>1?" are typing...":" is typing...":""}(typingUsersToRender)))};TypingIndicator_TypingIndicator.__docgenInfo={description:"Typing Indicator is used to notify users if there are any other users typing in the thread.",methods:[],displayName:"TypingIndicator"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/TypingIndicator.js"]={name:"TypingIndicator",docgenInfo:TypingIndicator_TypingIndicator.__docgenInfo,path:"../react-components/dist/dist-esm/components/TypingIndicator.js"});var gridLayoutStyle=Object(lib.G)({height:"100%",display:"grid",flexGrow:"1",gap:".5rem",padding:".5rem"});function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function GridLayout_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return GridLayout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GridLayout_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GridLayout_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var GridLayout_GridLayout=function GridLayout(props){var _useState2=_slicedToArray(Object(react.useState)(1),2),gridCol=_useState2[0],setGridCol=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(1),2),gridRow=_useState4[0],setGridRow=_useState4[1],children=props.children,_props$layout=props.layout,layout=void 0===_props$layout?"standard":_props$layout,styles=props.styles,numberOfChildren=react_default.a.Children.count(children);switch(layout){case"standard":var numberOfColumns=function calculateStandardLayoutColumns(numberOfItems){return numberOfItems>0?Math.ceil(Math.sqrt(numberOfItems)):1}(numberOfChildren);gridCol!==numberOfColumns&&setGridCol(numberOfColumns);var numberOfRows=function calculateStandardLayoutRows(numberOfItems,gridCol){return Math.ceil(numberOfItems/gridCol)}(numberOfChildren,gridCol);gridRow!==numberOfRows&&setGridRow(numberOfRows)}return react_default.a.createElement("div",{className:Object(lib.G)(gridLayoutStyle,null==styles?void 0:styles.root),style:{gridTemplateRows:"repeat(".concat(gridRow,", minmax(0, 1fr))"),gridTemplateColumns:"repeat(".concat(gridCol,", 1fr)")}},children)};GridLayout_GridLayout.__docgenInfo={description:"",methods:[],displayName:"GridLayout"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/GridLayout.js"]={name:"GridLayout",docgenInfo:GridLayout_GridLayout.__docgenInfo,path:"../react-components/dist/dist-esm/components/GridLayout.js"});var TextField=__webpack_require__(1857),SendIcon=__webpack_require__(1809),sendBoxWrapperStyle=Object(lib.G)({padding:"0.0625rem"}),sendBoxStyle=Object(lib.G)({minHeight:"0",maxHeight:"8.25rem",outline:"red 5px",fontWeight:400,fontSize:"0.875rem",width:"100%",height:"2.25rem",lineHeight:"1.5rem","::-webkit-input-placeholder":{fontSize:"0.875rem"},"::-moz-placeholder":{fontSize:"0.875rem"},":-moz-placeholder":{fontSize:"0.875rem"}}),sendButtonStyle=Object(lib.G)({width:"2.25rem",color:"grey",right:"0.125rem",cursor:"pointer",display:"flex",justifyContent:"center",position:"absolute",top:"0.875rem"}),sendIconStyle=Object(lib.G)({width:"1.0625rem",height:"1.0625rem"}),useTheme=__webpack_require__(402),isDarkThemed=(__webpack_require__(515),__webpack_require__(314),__webpack_require__(371),function isDarkThemed(theme){var themeBlackBrightness=getPerceptualBrightnessOfHexColor(theme.palette.black),themeWhiteBrightness=getPerceptualBrightnessOfHexColor(theme.palette.white);return!Number.isNaN(themeBlackBrightness)&&!Number.isNaN(themeWhiteBrightness)&&themeBlackBrightness>themeWhiteBrightness}),getPerceptualBrightnessOfHexColor=function getPerceptualBrightnessOfHexColor(hexColor){return/^#[0-9A-Fa-f]{6}$/i.test(hexColor)?(parseInt(hexColor.substring(1,3),16)+parseInt(hexColor.substring(3,5),16)+parseInt(hexColor.substring(5,7),16))/3:NaN};function SendBox_slicedToArray(arr,i){return function SendBox_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function SendBox_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function SendBox_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return SendBox_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SendBox_arrayLikeToArray(o,minLen)}(arr,i)||function SendBox_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SendBox_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var EMPTY_MESSAGE_REGEX=/^\s*$/,TEXT_EXCEEDS_LIMIT="Your message is over the limit of ".concat(8e3," characters"),SendBox_SendBox=function SendBox(props){var disabled=props.disabled,systemMessage=props.systemMessage,supportNewline=props.supportNewline,onSendMessage=props.onSendMessage,onTyping=props.onTyping,onRenderIcon=props.onRenderIcon,onRenderSystemMessage=props.onRenderSystemMessage,styles=props.styles,theme=Object(useTheme.a)(),_useState2=SendBox_slicedToArray(Object(react.useState)(""),2),textValue=_useState2[0],setTextValue=_useState2[1],_useState4=SendBox_slicedToArray(Object(react.useState)(!1),2),textValueOverflow=_useState4[0],setTextValueOverflow=_useState4[1],_useState6=SendBox_slicedToArray(Object(react.useState)(!1),2),isMouseOverSendIcon=_useState6[0],setIsMouseOverSendIcon=_useState6[1],sendTextFieldRef=react_default.a.useRef(null),sendMessageOnClick=function sendMessageOnClick(){var _a;disabled||textValueOverflow||(EMPTY_MESSAGE_REGEX.test(textValue)||(onSendMessage&&onSendMessage(textValue),setTextValue("")),null===(_a=sendTextFieldRef.current)||void 0===_a||_a.focus())},errorMessage=null!=systemMessage?systemMessage:textValueOverflow?TEXT_EXCEEDS_LIMIT:void 0,mergedRootStyle=Object(lib.G)(sendBoxWrapperStyle,null==styles?void 0:styles.root),mergedTextFieldStyle=Object(lib.q)(function textFieldStyle(errorColor,hasErrorMessage,disabled){var borderColor=hasErrorMessage?errorColor:"none";return{root:{width:"100%",minHeight:"0",fontSize:"8.25rem"},wrapper:{},fieldGroup:{height:"auto",minHeight:"0",borderRadius:"0.25rem",borderColor:borderColor,borderWidth:disabled?"0px":"1px",selectors:{":hover":{borderColor:borderColor},":active":{borderColor:borderColor},":after":{borderColor:borderColor,borderRadius:"0.25rem"}}},field:{borderRadius:"0.25rem"},errorMessage:{color:errorColor}}}(isDarkThemed(theme)?"#f1707b":"#a80000",!!errorMessage,!!disabled),{fieldGroup:null==styles?void 0:styles.textField,errorMessage:null==styles?void 0:styles.systemMessage}),mergedSendButtonStyle=Object(lib.G)(sendButtonStyle,null==styles?void 0:styles.sendMessageIconContainer),mergedSendIconStyle=Object(lib.G)(sendIconStyle,{color:errorMessage||!textValue&&!isMouseOverSendIcon?theme.palette.neutralTertiary:theme.palette.themePrimary},null==styles?void 0:styles.sendMessageIcon);return react_default.a.createElement(Stack.a,{className:mergedRootStyle},react_default.a.createElement("div",{style:{position:"relative",padding:"0.1875rem"}},react_default.a.createElement(TextField.a,{multiline:!0,autoAdjustHeight:!0,multiple:!1,resizable:!1,componentRef:sendTextFieldRef,id:"sendbox",ariaLabel:"Type",inputClassName:sendBoxStyle,placeholder:"Enter a message",value:textValue,onChange:function setText(e){e.target.value.length>8e3?setTextValueOverflow(!0):setTextValueOverflow(!1),setTextValue(e.target.value)},autoComplete:"off",onKeyDown:function onKeyDown(ev){"Enter"!==ev.key||!1!==ev.shiftKey&&supportNewline||textValueOverflow||(ev.preventDefault(),sendMessageOnClick()),onTyping&&onTyping()},styles:mergedTextFieldStyle,disabled:disabled,errorMessage:onRenderSystemMessage?onRenderSystemMessage(errorMessage):errorMessage}),react_default.a.createElement("div",{className:mergedSendButtonStyle,onClick:function onClick(e){textValueOverflow||sendMessageOnClick(),e.stopPropagation()},id:"sendIconWrapper",onMouseEnter:function onMouseEnter(){setIsMouseOverSendIcon(!0)},onMouseLeave:function onMouseLeave(){setIsMouseOverSendIcon(!1)}},onRenderIcon?onRenderIcon(props,isMouseOverSendIcon):react_default.a.createElement(SendIcon.a,{className:mergedSendIconStyle,outline:!!errorMessage||!(textValue||isMouseOverSendIcon)}))))};SendBox_SendBox.__docgenInfo={description:"`SendBox` is a component for users to send messages and typing notifications. An optional message\ncan also be shown below the `SendBox`.",methods:[],displayName:"SendBox"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/SendBox.js"]={name:"SendBox",docgenInfo:SendBox_SendBox.__docgenInfo,path:"../react-components/dist/dist-esm/components/SendBox.js"});var TooltipHost=__webpack_require__(1856),palette=Object(lib.B)().palette,MessageStatusIndicatorErrorIconStyle=Object(lib.G)({marginRight:"-0.06rem",fontSize:"1.06rem",color:palette.redDark}),MessageStatusIndicatorIconStyle=Object(lib.G)({fontSize:"1rem",color:palette.blue}),ErrorIcon=__webpack_require__(1811),CircleRingIcon=__webpack_require__(1812),CompletedIcon=__webpack_require__(1814),MessageSeenIcon=__webpack_require__(1813),MessageStatusIndicator_MessageStatusIndicator=function MessageStatusIndicator(props){var status=props.status,_props$deliveredToolt=props.deliveredTooltipText,deliveredTooltipText=void 0===_props$deliveredToolt?"Sent":_props$deliveredToolt,_props$seenTooltipTex=props.seenTooltipText,seenTooltipText=void 0===_props$seenTooltipTex?"Seen":_props$seenTooltipTex,_props$sendingTooltip=props.sendingTooltipText,sendingTooltipText=void 0===_props$sendingTooltip?"Sending":_props$sendingTooltip,_props$failedToSendTo=props.failedToSendTooltipText,failedToSendTooltipText=void 0===_props$failedToSendTo?"Failed to send":_props$failedToSendTo,_props$size=props.size,size=void 0===_props$size?"medium":_props$size,styles=props.styles;switch(status){case"failed":return react_default.a.createElement(TooltipHost.a,{content:failedToSendTooltipText},react_default.a.createElement(ErrorIcon.a,{className:Object(lib.G)(MessageStatusIndicatorErrorIconStyle,null==styles?void 0:styles.root)}));case"sending":return react_default.a.createElement(TooltipHost.a,{content:sendingTooltipText},react_default.a.createElement(CircleRingIcon.a,{className:Object(lib.G)(MessageStatusIndicatorIconStyle,null==styles?void 0:styles.root)}));case"seen":return react_default.a.createElement(TooltipHost.a,{content:seenTooltipText},react_default.a.createElement(MessageSeenIcon.a,{size:size,className:Object(lib.G)(null==styles?void 0:styles.root)}));case"delivered":return react_default.a.createElement(TooltipHost.a,{content:deliveredTooltipText},react_default.a.createElement(CompletedIcon.a,{className:Object(lib.G)(MessageStatusIndicatorIconStyle,null==styles?void 0:styles.root)}));default:return react_default.a.createElement(react_default.a.Fragment,null)}};MessageStatusIndicator_MessageStatusIndicator.__docgenInfo={description:"MessageStatusIndicator component.",methods:[],displayName:"MessageStatusIndicator"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/MessageStatusIndicator.js"]={name:"MessageStatusIndicator",docgenInfo:MessageStatusIndicator_MessageStatusIndicator.__docgenInfo,path:"../react-components/dist/dist-esm/components/MessageStatusIndicator.js"});__webpack_require__(45),__webpack_require__(41),__webpack_require__(42),__webpack_require__(39);var dist=__webpack_require__(405),dist_default=__webpack_require__.n(dist),Chat=__webpack_require__(1861),Text=__webpack_require__(240),Flex=__webpack_require__(1873),Ref=__webpack_require__(1862),messageThreadContainerStyle=Object(lib.G)({height:"100%",width:"100%",maxHeight:"100%",overflow:"auto",position:"relative"}),noMessageStatusStyle=Object(lib.G)({width:"1rem"}),chatStyle={paddingBottom:"0.5rem",border:"none",overflow:"auto"},newMessageButtonContainerStyle=Object(lib.G)({position:"absolute",zIndex:1,bottom:0,right:"1.5rem"}),chatMessageStyle={overflowY:"hidden"},chatMessageDateStyle={fontWeight:600},MessageThread_styles_messageStatusContainerStyle=function messageStatusContainerStyle(mine){return Object(lib.G)({marginLeft:mine?"1rem":"0rem"})},newMessageButtonStyle=Object(lib.G)({float:"right",width:"fit-content"}),DownIconStyle=(Object(lib.G)({border:"none",minHeight:"1.5rem",selectors:{"&:hover":{background:"none"},"&:active":{background:"none"}}}),Object(lib.G)({marginRight:"0.5em"})),PrimaryButton=__webpack_require__(1815),Icon_Icon=__webpack_require__(1866),Link=__webpack_require__(1867),Persona=__webpack_require__(1852),Persona_types=__webpack_require__(26),es=__webpack_require__(217),weekDayToDayName=(__webpack_require__(51),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),formatTimeForChatMessage=function formatTimeForChatMessage(messageDate){var hours=messageDate.getHours(),minutes=messageDate.getMinutes().toString(),isAm=hours<12;return hours>12&&(hours-=12),0===hours&&(hours=12),minutes.length<2&&(minutes="0"+minutes),hours.toString()+":"+minutes+" "+(isAm?"a.m.":"p.m.")},formatDateForChatMessage=function formatDateForChatMessage(messageDate){var year=messageDate.getFullYear().toString(),month=(messageDate.getMonth()+1).toString(),day=messageDate.getDate().toString();return 1===month.length&&(month="0"+month),1===day.length&&(day="0"+day),year+"-"+month+"-"+day},formatTimestampForChatMessage=function formatTimestampForChatMessage(messageDate,todayDate){if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()))return formatTimeForChatMessage(messageDate);if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-1))return"Yesterday "+formatTimeForChatMessage(messageDate);var weekDay=todayDate.getDay();return 0===weekDay?formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate):messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-weekDay)?weekDayToDayName[messageDate.getDay()]+" "+formatTimeForChatMessage(messageDate):formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate)},delay=(__webpack_require__(207),function delay(_delay){return new Promise((function(resolve){setTimeout(resolve,_delay)}))}),src=__webpack_require__(35),FontIcon=__webpack_require__(804),systemMessageIconStyle=Object(lib.G)({margin:"0 0.688rem 0 0"}),systemMessageContentStyle=Object(lib.G)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),SystemMessage_SystemMessage=function SystemMessage(props){var iconName=props.iconName,content=props.content,Icon=react_default.a.createElement(FontIcon.a,{iconName:iconName,className:Object(lib.G)(systemMessageIconStyle)});return react_default.a.createElement(Stack.a,{horizontal:!0,className:Object(lib.G)(null==props?void 0:props.containerStyle)},Icon,react_default.a.createElement("span",{className:Object(lib.G)(systemMessageContentStyle)},content))};SystemMessage_SystemMessage.__docgenInfo={description:"",methods:[],displayName:"SystemMessage"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/SystemMessage.js"]={name:"SystemMessage",docgenInfo:SystemMessage_SystemMessage.__docgenInfo,path:"../react-components/dist/dist-esm/components/SystemMessage.js"});var html_to_react=__webpack_require__(406);function MessageThread_slicedToArray(arr,i){return function MessageThread_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MessageThread_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MessageThread_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MessageThread_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MessageThread_arrayLikeToArray(o,minLen)}(arr,i)||function MessageThread_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageThread_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var __awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},isMessageSame=function isMessageSame(first,second){return first.messageId===second.messageId&&first.content===second.content&&first.type===second.type&&JSON.stringify(first.createdOn)===JSON.stringify(second.createdOn)&&first.senderId===second.senderId&&first.senderDisplayName===second.senderDisplayName&&first.status===second.status},getLatestChatMessage=function getLatestChatMessage(messages){for(var latestChatMessage=void 0,i=messages.length-1;i>=0;i--){var message=messages[i];if("chat"===message.type){var payload=message.payload;if(void 0!==payload.createdOn){latestChatMessage=payload;break}}}return latestChatMessage},MessageThread_DefaultJumpToNewMessageButton=function DefaultJumpToNewMessageButton(props){var onClick=props.onClick;return react_default.a.createElement(PrimaryButton.a,{className:newMessageButtonStyle,onClick:onClick},react_default.a.createElement(Icon_Icon.a,{iconName:"Down",className:DownIconStyle}),"New Messages")},MessageThread_DefaultSystemMessageRenderer=function DefaultSystemMessageRenderer(props){var _a,_b;if("system"===props.message.type){var payload=props.message.payload;return react_default.a.createElement(SystemMessage_SystemMessage,{iconName:null!==(_a=payload.iconName)&&void 0!==_a?_a:"",content:null!==(_b=payload.content)&&void 0!==_b?_b:"",containerStyle:null==props?void 0:props.messageContainerStyle})}return react_default.a.createElement(react_default.a.Fragment,null)};var MessageThread_generateRichTextHTMLMessageContent=function generateRichTextHTMLMessageContent(payload){var s,span,htmlToReactParser=new html_to_react.Parser,liveAuthor="".concat(payload.senderDisplayName," says ");return react_default.a.createElement("div",null,react_default.a.createElement(es.b,{message:"".concat(payload.mine?"":liveAuthor," ").concat((s=payload.content,span=document.createElement("span"),span.innerHTML=s,span.textContent||span.innerText)),"aria-live":"polite"}),htmlToReactParser.parse(payload.content))},MessageThread_generateMessageContent=function generateMessageContent(payload){switch(payload.type){case"text":return function generateTextMessageContent(payload){var liveAuthor="".concat(payload.senderDisplayName," says ");return react_default.a.createElement("div",null,react_default.a.createElement(es.b,{message:"".concat(payload.mine?"":liveAuthor," ").concat(payload.content),"aria-live":"polite"}),react_default.a.createElement(dist_default.a,{componentDecorator:function componentDecorator(decoratedHref,decoratedText,key){return react_default.a.createElement(Link.a,{href:decoratedHref,key:key},decoratedText)}},payload.content))}(payload);case"html":case"richtext/html":return MessageThread_generateRichTextHTMLMessageContent(payload);default:return console.warn("unknown message content type"),react_default.a.createElement(react_default.a.Fragment,null)}},MessageThread_DefaultChatMessageRenderer=function DefaultChatMessageRenderer(props){if("chat"===props.message.type){var payload=props.message.payload,messageContentItem=MessageThread_generateMessageContent(payload);return react_default.a.createElement(Chat.a.Message,{className:Object(lib.G)(chatMessageStyle,props.messageContainerStyle),content:messageContentItem,author:react_default.a.createElement(Text.a,{className:Object(lib.G)(chatMessageDateStyle)},payload.senderDisplayName),mine:payload.mine,timestamp:payload.createdOn?props.showDate?formatTimestampForChatMessage(payload.createdOn,new Date):formatTimeForChatMessage(payload.createdOn):void 0})}return react_default.a.createElement(react_default.a.Fragment,null)},memoizeAllMessages=Object(src.b)((function(_messageKey,message,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultChatMessageRenderer,_attached,statusToRender,onRenderMessage){var _a,_b,_c,messageProps={message:message,showDate:showMessageDate};if("chat"===message.type){var payload=message.payload;messageProps.messageContainerStyle=null==styles?void 0:styles.chatMessageContainer;var chatMessageComponent=void 0===onRenderMessage?defaultChatMessageRenderer(messageProps):onRenderMessage(messageProps,MessageThread_DefaultChatMessageRenderer);return{gutter:payload.mine?"":onRenderAvatar?onRenderAvatar(null!==(_a=payload.senderId)&&void 0!==_a?_a:""):react_default.a.createElement(Persona.a,{text:payload.senderDisplayName,hidePersonaDetails:!0,size:Persona_types.c.size32}),contentPosition:payload.mine?"end":"start",message:react_default.a.createElement(Flex.a,{vAlign:"end"},chatMessageComponent,react_default.a.createElement("div",{className:Object(lib.G)(MessageThread_styles_messageStatusContainerStyle(null!==(_b=payload.mine)&&void 0!==_b&&_b),(null==styles?void 0:styles.messageStatusContainer)?styles.messageStatusContainer(null!==(_c=payload.mine)&&void 0!==_c&&_c):"")},showMessageStatus&&statusToRender?onRenderMessageStatus?onRenderMessageStatus({status:statusToRender}):MessageStatusIndicator_MessageStatusIndicator({status:statusToRender}):react_default.a.createElement("div",{className:Object(lib.G)(noMessageStatusStyle)}))),attached:payload.attached,key:_messageKey}}return"system"===message.type?(messageProps.messageContainerStyle=null==styles?void 0:styles.systemMessageContainer,{children:void 0===onRenderMessage?MessageThread_DefaultSystemMessageRenderer(messageProps):onRenderMessage(messageProps,MessageThread_DefaultSystemMessageRenderer),key:_messageKey}):{children:void 0===onRenderMessage?react_default.a.createElement(react_default.a.Fragment,null):onRenderMessage(messageProps),key:_messageKey}})),getLastChatMessageIdWithStatus=function getLastChatMessageIdWithStatus(messages,status){for(var i=messages.length-1;i>=0;i--){var message=messages[i];if("chat"===message.type&&message.payload.status===status&&message.payload.mine)return message.payload.messageId}},MessageThread_MessageThread=function MessageThread(props){var _a,newMessages=props.messages,userId=props.userId,styles=props.styles,_props$disableJumpToN=props.disableJumpToNewMessageButton,disableJumpToNewMessageButton=void 0!==_props$disableJumpToN&&_props$disableJumpToN,_props$showMessageDat=props.showMessageDate,showMessageDate=void 0!==_props$showMessageDat&&_props$showMessageDat,_props$showMessageSta=props.showMessageStatus,showMessageStatus=void 0!==_props$showMessageSta&&_props$showMessageSta,_props$numberOfChatMe=props.numberOfChatMessagesToReload,numberOfChatMessagesToReload=void 0===_props$numberOfChatMe?0:_props$numberOfChatMe,onMessageSeen=props.onMessageSeen,onRenderMessageStatus=props.onRenderMessageStatus,onRenderAvatar=props.onRenderAvatar,onLoadPreviousChatMessages=props.onLoadPreviousChatMessages,onRenderJumpToNewMessageButton=props.onRenderJumpToNewMessageButton,onRenderMessage=props.onRenderMessage,_useState2=MessageThread_slicedToArray(Object(react.useState)([]),2),messages=_useState2[0],setMessages=_useState2[1],_useState4=MessageThread_slicedToArray(Object(react.useState)(!1),2),chatMessagesInitialized=_useState4[0],setChatMessagesInitialized=_useState4[1],_useState6=MessageThread_slicedToArray(Object(react.useState)(!0),2),isAtBottomOfScroll=_useState6[0],setIsAtBottomOfScroll=_useState6[1],_useState8=MessageThread_slicedToArray(Object(react.useState)(!1),2),isAtTopOfScroll=_useState8[0],setIsAtTopOfScroll=_useState8[1],_useState10=MessageThread_slicedToArray(Object(react.useState)(0),2),forceUpdate=_useState10[0],setForceUpdate=_useState10[1],_useState12=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestPreviousChatMessage=_useState12[0],setLatestPreviousChatMessage=_useState12[1],_useState14=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestCurrentChatMessage=_useState14[0],setLatestCurrentChatMessage=_useState14[1],_useState16=MessageThread_slicedToArray(Object(react.useState)(void 0),2),chatMessageIdJustSeen=_useState16[0],setChatMessageIdJustSeen=_useState16[1],_useState18=MessageThread_slicedToArray(Object(react.useState)(!1),2),existsNewChatMessage=_useState18[0],setExistsNewChatMessage=_useState18[1],_useState20=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSeenChatMessage=_useState20[0],setLastSeenChatMessage=_useState20[1],_useState22=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastDeliveredChatMessage=_useState22[0],setLastDeliveredChatMessage=_useState22[1],_useState24=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSendingChatMessage=_useState24[0],setLastSendingChatMessage=_useState24[1],_useState26=MessageThread_slicedToArray(Object(react.useState)(!1),2),isAllChatMessagesLoaded=_useState26[0],setIsAllChatMessagesLoaded=_useState26[1],isAllChatMessagesLoadedRef=Object(react.useRef)(isAllChatMessagesLoaded);isAllChatMessagesLoadedRef.current=isAllChatMessagesLoaded;var chatScrollDivRef=Object(react.useRef)(),chatThreadRef=Object(react.useRef)(),isLoadingChatMessagesRef=Object(react.useRef)(!1),messagesRef=Object(react.useRef)(messages),isAtBottomOfScrollRef=Object(react.useRef)(isAtBottomOfScroll),setIsAtBottomOfScrollRef=function setIsAtBottomOfScrollRef(isAtBottomOfScrollValue){isAtBottomOfScrollRef.current=isAtBottomOfScrollValue,setIsAtBottomOfScroll(isAtBottomOfScrollValue)},isAtTopOfScrollRef=Object(react.useRef)(isAtTopOfScroll),chatMessagesInitializedRef=Object(react.useRef)(chatMessagesInitialized),sendMessageStatusIfAtBottom=Object(react.useCallback)((function(){return __awaiter(void 0,void 0,void 0,regeneratorRuntime.mark((function _callee(){var messagesWithId,lastMessage;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(isAtBottomOfScrollRef.current&&document.hasFocus()&&messagesRef.current&&0!==messagesRef.current.length&&showMessageStatus){_context.next=2;break}return _context.abrupt("return");case 2:if(0!==(messagesWithId=messagesRef.current.filter((function(message){return"chat"===message.type&&!message.payload.mine&&!!message.payload.messageId}))).length){_context.next=5;break}return _context.abrupt("return");case 5:if(lastMessage=messagesWithId[messagesWithId.length-1],_context.prev=6,!(onMessageSeen&&lastMessage&&lastMessage.payload.messageId&&lastMessage.payload.messageId!==chatMessageIdJustSeen)){_context.next=11;break}return _context.next=10,onMessageSeen(lastMessage.payload.messageId);case 10:setChatMessageIdJustSeen(lastMessage.payload.messageId);case 11:_context.next=16;break;case 13:_context.prev=13,_context.t0=_context.catch(6),console.log("onMessageSeen Error",lastMessage,_context.t0);case 16:case"end":return _context.stop()}}),_callee,null,[[6,13]])})))}),[showMessageStatus,onMessageSeen,chatMessageIdJustSeen]),scrollToBottom=Object(react.useCallback)((function(){chatScrollDivRef.current.scrollTop=chatScrollDivRef.current.scrollHeight,setExistsNewChatMessage(!1),setIsAtBottomOfScrollRef(!0),sendMessageStatusIfAtBottom()}),[sendMessageStatusIfAtBottom]),handleScroll=function handleScroll(){var atBottom=Math.floor(chatScrollDivRef.current.scrollTop)>=chatScrollDivRef.current.scrollHeight-chatScrollDivRef.current.clientHeight,atTop=0===chatScrollDivRef.current.scrollTop;atBottom&&(sendMessageStatusIfAtBottom(),isAtBottomOfScrollRef.current||scrollToBottom()),setIsAtBottomOfScrollRef(atBottom),function setIsAtTopOfScrollRef(isAtTopOfScrollValue){isAtTopOfScrollRef.current=isAtTopOfScrollValue,setIsAtTopOfScroll(isAtTopOfScrollValue)}(atTop),0!==chatScrollDivRef.current.scrollTop||isAllChatMessagesLoadedRef.current||(chatScrollDivRef.current.scrollTop=5),__awaiter(void 0,void 0,void 0,regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!(chatScrollDivRef.current.scrollTop<=200)||isAllChatMessagesLoadedRef.current||isLoadingChatMessagesRef.current){_context2.next=9;break}if(!onLoadPreviousChatMessages){_context2.next=9;break}return isLoadingChatMessagesRef.current=!0,_context2.t0=setIsAllChatMessagesLoaded,_context2.next=6,onLoadPreviousChatMessages(numberOfChatMessagesToReload);case 6:_context2.t1=_context2.sent,(0,_context2.t0)(_context2.t1),isLoadingChatMessagesRef.current=!1;case 9:case"end":return _context2.stop()}}),_callee2)})))};Object(react.useEffect)((function(){window&&window.addEventListener("click",sendMessageStatusIfAtBottom),window&&window.addEventListener("focus",sendMessageStatusIfAtBottom),chatScrollDivRef.current&&chatScrollDivRef.current.addEventListener("scroll",handleScroll);var chatScrollDiv=chatScrollDivRef.current;return function(){window&&window.removeEventListener("click",sendMessageStatusIfAtBottom),window&&window.removeEventListener("focus",sendMessageStatusIfAtBottom),chatScrollDiv&&chatScrollDiv.removeEventListener("scroll",handleScroll)}}),[]);var clientHeight=null===(_a=chatThreadRef.current)||void 0===_a?void 0:_a.clientHeight;Object(react.useEffect)((function(){void 0!==clientHeight?isAtBottomOfScrollRef.current&&scrollToBottom():setForceUpdate(forceUpdate+1)}),[clientHeight,forceUpdate,scrollToBottom,chatMessagesInitialized]),Object(react.useEffect)((function(){setLatestPreviousChatMessage(getLatestChatMessage(messagesRef.current)),setLatestCurrentChatMessage(getLatestChatMessage(newMessages)),function setMessagesRef(messagesWithAttachedValue){messagesRef.current=messagesWithAttachedValue,setMessages(messagesWithAttachedValue)}(newMessages),!chatMessagesInitializedRef.current&&function setChatMessagesInitializedRef(chatMessagesInitialized){chatMessagesInitializedRef.current=chatMessagesInitialized,setChatMessagesInitialized(chatMessagesInitialized)}(!0),setLastDeliveredChatMessage(getLastChatMessageIdWithStatus(newMessages,"delivered")),setLastSeenChatMessage(getLastChatMessageIdWithStatus(newMessages,"seen")),setLastSendingChatMessage(getLastChatMessageIdWithStatus(newMessages,"sending"))}),[newMessages]),Object(react.useEffect)((function(){!function isThereNewMessageNotFromCurrentUser(latestMessageFromPreviousMessages,latestMessageFromNewMessages,userId){return void 0!==latestMessageFromNewMessages&&((void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId!==userId)}(latestPreviousChatMessage,latestCurrentChatMessage,userId)||isAtBottomOfScrollRef.current?(function didUserSendTheLatestMessage(latestMessageFromPreviousMessages,latestMessageFromNewMessages,userId){return void 0!==latestMessageFromNewMessages&&((void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId===userId)}(latestPreviousChatMessage,latestCurrentChatMessage,userId)||isAtBottomOfScrollRef.current)&&scrollToBottom():setExistsNewChatMessage(!0)}),[messages]),Object(react.useEffect)((function(){__awaiter(void 0,void 0,void 0,regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!onLoadPreviousChatMessages){_context3.next=11;break}case 1:if(!(chatScrollDivRef.current.scrollTop<=200)||isAllChatMessagesLoadedRef.current){_context3.next=11;break}return _context3.t0=setIsAllChatMessagesLoaded,_context3.next=5,onLoadPreviousChatMessages(numberOfChatMessagesToReload);case 5:return _context3.t1=_context3.sent,(0,_context3.t0)(_context3.t1),_context3.next=9,delay(200);case 9:_context3.next=1;break;case 11:case"end":return _context3.stop()}}),_callee3)})))}),[onLoadPreviousChatMessages,numberOfChatMessagesToReload]);var defaultChatMessageRenderer=Object(react.useCallback)((function(messageProps){return MessageThread_DefaultChatMessageRenderer(messageProps)}),[(new Date).toDateString()]),messagesToDisplay=Object(react.useMemo)((function(){return memoizeAllMessages((function(memoizedMessageFn){return messages.map((function(message,index){var key=message.payload.messageId;"chat"!==message.type||message.payload.messageId&&""!==message.payload.messageId||(key=message.payload.clientMessageId);var statusToRender=void 0;if("chat"===message.type){if(showMessageStatus&&message.payload.mine)switch(message.payload.messageId){case lastSeenChatMessage:statusToRender="seen";break;case lastSendingChatMessage:statusToRender="sending";break;case lastDeliveredChatMessage:statusToRender="delivered"}message.payload.mine&&"failed"===message.payload.status&&(statusToRender="failed")}return memoizedMessageFn(null!=key?key:"id_"+index,message,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultChatMessageRenderer,"chat"===message.type?message.payload.attached:void 0,statusToRender,onRenderMessage)}))}))}),[messages,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultChatMessageRenderer,lastSeenChatMessage,lastSendingChatMessage,lastDeliveredChatMessage,onRenderMessage]),chatBody=Object(react.useMemo)((function(){var _a;return react_default.a.createElement(es.a,null,react_default.a.createElement(Chat.a,{styles:null!==(_a=null==styles?void 0:styles.chatContainer)&&void 0!==_a?_a:chatStyle,items:messagesToDisplay}))}),[null==styles?void 0:styles.chatContainer,messagesToDisplay]);return react_default.a.createElement(Ref.a,{innerRef:chatThreadRef},react_default.a.createElement(Stack.a,{className:Object(lib.G)(messageThreadContainerStyle,null==styles?void 0:styles.root),grow:!0},react_default.a.createElement(Ref.a,{innerRef:chatScrollDivRef},chatBody),existsNewChatMessage&&!disableJumpToNewMessageButton&&react_default.a.createElement("div",{className:Object(lib.G)(newMessageButtonContainerStyle,null==styles?void 0:styles.newMessageButtonContainer)},onRenderJumpToNewMessageButton?onRenderJumpToNewMessageButton({onClick:scrollToBottom}):react_default.a.createElement(MessageThread_DefaultJumpToNewMessageButton,{onClick:scrollToBottom}))))};MessageThread_MessageThread.__docgenInfo={description:"`MessageThread` allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread.\n@param props - of type MessageThreadProps\n\nUsers will need to provide at least chat messages and userId to render the `MessageThread` component.\nUsers can also customize `MessageThread` by passing in their own Avatar, `MessageStatusIndicator` icon, `JumpToNewMessageButton`, `LoadPreviousMessagesButton` and the behavior of these controls.\n\n`MessageThread` internally uses the `Chat` & `Chat.Message` component from `@fluentui/react-northstar`. You can checkout the details about these [two components](https://fluentsite.z22.web.core.windows.net/0.53.0/components/chat/props).",methods:[],displayName:"MessageThread"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/MessageThread.js"]={name:"MessageThread",docgenInfo:MessageThread_MessageThread.__docgenInfo,path:"../react-components/dist/dist-esm/components/MessageThread.js"});var mediaContainer=Object(lib.G)({position:"relative",height:"100%",width:"100%",background:"transparent",display:"flex","& video":{borderRadius:".25rem"}}),invertedVideoStyle=Object(lib.G)(mediaContainer,{transform:"rotateY(180deg)"}),StreamMedia_StreamMedia=function StreamMedia(props){var containerEl=Object(react.useRef)(null),isMirrored=props.isMirrored,videoStreamElement=props.videoStreamElement,styles=props.styles;return Object(react.useEffect)((function(){var container=containerEl.current;if(container)return container.innerHTML="",videoStreamElement&&container.appendChild(videoStreamElement),function(){container.innerHTML=""}}),[videoStreamElement]),react_default.a.createElement("div",{className:Object(lib.G)(isMirrored?invertedVideoStyle:mediaContainer,null==styles?void 0:styles.root),ref:containerEl})};StreamMedia_StreamMedia.__docgenInfo={description:"StreamMedia component converts a HTMLElement to a JSX Element.\nThis component becomes very handy when you get the video stream HTMLElement from the calling sdk and want to render it in components like VideoTile.",methods:[],displayName:"StreamMedia"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/StreamMedia.js"]={name:"StreamMedia",docgenInfo:StreamMedia_StreamMedia.__docgenInfo,path:"../react-components/dist/dist-esm/components/StreamMedia.js"});var ParticipantItem_styles_participantItemContainerStyle=function participantItemContainerStyle(theme){return Object(lib.G)({paddingTop:"0.25rem",paddingBottom:"0.25rem",display:"flex",position:"relative",maxWidth:"20rem",minWidth:"12rem",cursor:"pointer",selectors:{"&:hover":{background:theme.palette.neutralLight}}})},iconContainerStyle=(Object(lib.G)({fontSize:"0.875rem",fontWeight:400,marginTop:"0.3125rem",marginRight:"0.25rem",paddingLeft:"0.25rem",overflowY:"hidden"}),Object(lib.G)({fontSize:"0.875rem",fontWeight:400,color:"#A19F9D",marginTop:"0.3125rem"}),Object(lib.G)({position:"absolute",display:"flex",right:"1rem",top:"50%",msTransform:"translateY(-50%)",transform:"translateY(-50%)"})),ContextualMenu=__webpack_require__(1848),DirectionalHint=__webpack_require__(75);function ParticipantItem_slicedToArray(arr,i){return function ParticipantItem_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ParticipantItem_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ParticipantItem_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantItem_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantItem_arrayLikeToArray(o,minLen)}(arr,i)||function ParticipantItem_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantItem_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantItem_ParticipantItem=function ParticipantItem(props){var displayName=props.displayName,onRenderAvatar=props.onRenderAvatar,menuItems=props.menuItems,onRenderIcon=props.onRenderIcon,presence=props.presence,styles=props.styles,_useState2=ParticipantItem_slicedToArray(Object(react.useState)(),2),clickEvent=_useState2[0],setClickEvent=_useState2[1],_useState4=ParticipantItem_slicedToArray(Object(react.useState)(!0),2),menuHidden=_useState4[0],setMenuHidden=_useState4[1],containerRef=Object(react.useRef)(null),theme=Object(useTheme.a)(),hideMenu=function hideMenu(){setClickEvent(void 0),setMenuHidden(!0)},avatarToUse=react_default.a.createElement(Persona.a,{text:displayName,size:Persona_types.c.size32,presence:presence,onRenderPersonaCoin:onRenderAvatar?function(){return onRenderAvatar(props)}:void 0,className:Object(lib.G)(null==styles?void 0:styles.avatar),initialsTextColor:"white"});return react_default.a.createElement("div",{ref:containerRef,className:Object(lib.G)(ParticipantItem_styles_participantItemContainerStyle(theme),null==styles?void 0:styles.root),onClick:function showMenu(clickEvent){setClickEvent(clickEvent.nativeEvent),setMenuHidden(!1)}},avatarToUse,onRenderIcon&&react_default.a.createElement(Stack.a,{className:Object(lib.G)(iconContainerStyle,null==styles?void 0:styles.iconContainer)},onRenderIcon(props)),menuItems&&react_default.a.createElement(ContextualMenu.a,{items:menuItems,hidden:menuHidden,target:null!=clickEvent?clickEvent:containerRef,onItemClick:hideMenu,onDismiss:hideMenu,directionalHint:DirectionalHint.a.bottomLeftEdge,className:Object(lib.G)(null==styles?void 0:styles.menu)}))};ParticipantItem_ParticipantItem.__docgenInfo={description:"`ParticipantItem` represents a participant in Calling or Chat. `ParticipantItem` displays a participant's avatar,\ndisplayName and status as well as optional icons and context menu.",methods:[],displayName:"ParticipantItem"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/ParticipantItem.js"]={name:"ParticipantItem",docgenInfo:ParticipantItem_ParticipantItem.__docgenInfo,path:"../react-components/dist/dist-esm/components/ParticipantItem.js"});__webpack_require__(10),__webpack_require__(70);var IconButton=__webpack_require__(1877),OverflowSet=__webpack_require__(1868),CallControlPresentNewIcon=__webpack_require__(1827),MicOffIcon=__webpack_require__(1828),participantListStyle=Object(lib.G)({height:"100%",overflow:"auto",paddingLeft:"1.125rem",paddingRight:"1.125rem"}),overFlowButtonStyles={root:{minWidth:0,padding:"0 0.25rem",alignSelf:"stretch",height:"auto"}},overflowSetStyle={item:{width:"100%"}},ParticipantList_onRenderOverflowButton=function onRenderOverflowButton(overflowItems){return react_default.a.createElement(IconButton.a,{role:"menuitem",title:"More options",styles:overFlowButtonStyles,menuIconProps:{iconName:"More"},menuProps:{items:overflowItems}})},ParticipantList_renderParticipants=function renderParticipants(participants,myUserId,onRenderParticipant,onRenderAvatar,onParticipantRemove){var renderParticipant=null!=onRenderParticipant?onRenderParticipant:function getDefaultRenderer(myUserId,onParticipantRemove,onRenderAvatar){return function(participant){var callingParticipant=participant,presence=void 0;callingParticipant&&("Connected"===callingParticipant.state?presence=Persona_types.b.online:"Idle"===callingParticipant.state&&(presence=Persona_types.b.away));var menuItems=[];participant.userId!==myUserId&&onParticipantRemove&&menuItems.push({key:"Remove",text:"Remove",onClick:function onClick(){return onParticipantRemove(participant.userId)}});var onRenderIcon=(null==callingParticipant?void 0:callingParticipant.isScreenSharing)||(null==callingParticipant?void 0:callingParticipant.isMuted)?function(){return react_default.a.createElement(Stack.a,{horizontal:!0,tokens:{childrenGap:"0.5rem"}},callingParticipant.isScreenSharing&&react_default.a.createElement(CallControlPresentNewIcon.a,{size:"small"}),callingParticipant.isMuted&&react_default.a.createElement(MicOffIcon.a,{size:"small"}))}:function(){return react_default.a.createElement(react_default.a.Fragment,null)},renderAvatar=onRenderAvatar?function(){return onRenderAvatar(participant)}:void 0;return participant.displayName?react_default.a.createElement(ParticipantItem_ParticipantItem,{displayName:participant.displayName,me:!!myUserId&&participant.userId===myUserId,menuItems:menuItems,presence:presence,onRenderIcon:onRenderIcon,onRenderAvatar:renderAvatar}):null}}(myUserId,onParticipantRemove,onRenderAvatar),onRenderItem=function onRenderItem(item){var participant={userId:item.userId,displayName:item.displayName,state:item.state,isScreenSharing:item.isScreenSharing,isMuted:item.isMuted,isSpeaking:item.isSpeaking};return renderParticipant(participant)};return participants.map((function(item,i){return react_default.a.createElement(OverflowSet.a,{key:i,items:[Object.assign({key:"".concat(i),displayName:item.displayName,me:item.userId===myUserId},item)],role:"menubar",vertical:!1,onRenderOverflowButton:ParticipantList_onRenderOverflowButton,onRenderItem:onRenderItem,styles:overflowSetStyle})}))},ParticipantList_ParticipantList=function ParticipantList(props){var allParticipants=[];return void 0!==props.participants&&props.participants.forEach((function(participant){return allParticipants.push(participant)})),react_default.a.createElement(Stack.a,{className:participantListStyle},ParticipantList_renderParticipants(allParticipants,props.myUserId,props.onRenderParticipant,props.onRenderAvatar,props.onParticipantRemove))};ParticipantList_ParticipantList.__docgenInfo={description:"`ParticipantList` renders a list of participants in Calling or Chat. If property `onRenderParticipant` is not\nassigned then each participant is rendered with `ParticipantItem`.",methods:[],displayName:"ParticipantList"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/ParticipantList.js"]={name:"ParticipantList",docgenInfo:ParticipantList_ParticipantList.__docgenInfo,path:"../react-components/dist/dist-esm/components/ParticipantList.js"});var videoBaseStyle=Object(lib.G)({border:0}),gridStyle=Object(lib.G)(videoBaseStyle,{width:"100%",height:"100%"}),videoTileStyle={root:{borderRadius:".25rem"}},Text_Text=__webpack_require__(1869),rootStyles={position:"relative",height:"100%",width:"100%"},videoContainerStyles={position:"absolute",top:"0",left:"0",width:"100%",height:"100%",minWidth:"100%",minHeight:"100%",objectPosition:"center",objectFit:"cover",zIndex:0},overlayContainerStyles={width:"100%",height:"100%",zIndex:5},disabledVideoHint=Object(lib.G)({bottom:"0.5rem",boxShadow:"none",textAlign:"left",left:"0.5rem",overflow:"hidden",position:"absolute",padding:"0.25rem",lineHeight:"1.4286rem",whiteSpace:"nowrap",maxWidth:"95%",borderRadius:4}),videoHint=Object(lib.G)(disabledVideoHint,{backgroundColor:"rgba(0, 0, 0, 0.5)",boxShadow:"0 0 1px 0 rgba(0,0,0,.5)"}),VideoTile_DefaultPlaceholder=function DefaultPlaceholder(props){var displayName=props.displayName,noVideoAvailableAriaLabel=props.noVideoAvailableAriaLabel;return react_default.a.createElement(Stack.a,{className:Object(lib.G)({position:"absolute",height:"100%",width:"100%"})},react_default.a.createElement(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size100,hidePersonaDetails:!0,text:displayName,initialsTextColor:"white","aria-label":noVideoAvailableAriaLabel}))},VideoTile_VideoTile=function VideoTile(props){var children=props.children,displayName=props.displayName,isMirrored=props.isMirrored,isVideoReady=props.isVideoReady,onRenderPlaceholder=props.onRenderPlaceholder,renderElement=props.renderElement,_props$showDisplayNam=props.showDisplayName,showDisplayName=void 0===_props$showDisplayNam||_props$showDisplayNam,styles=props.styles,placeHolderProps={userId:props.userId,displayName:displayName,noVideoAvailableAriaLabel:props.noVideoAvailableAriaLabel},theme=Object(useTheme.a)();return react_default.a.createElement(Stack.a,{className:Object(lib.G)(rootStyles,{background:theme.palette.neutralLighter},null==styles?void 0:styles.root)},isVideoReady&&renderElement?react_default.a.createElement(Stack.a,{className:Object(lib.G)(videoContainerStyles,isMirrored&&{transform:"scaleX(-1)"},null==styles?void 0:styles.videoContainer)},renderElement):react_default.a.createElement(Stack.a,{className:Object(lib.G)(videoContainerStyles)},onRenderPlaceholder?onRenderPlaceholder(placeHolderProps,VideoTile_DefaultPlaceholder):react_default.a.createElement(VideoTile_DefaultPlaceholder,Object.assign({},placeHolderProps))),displayName&&showDisplayName&&react_default.a.createElement(Text_Text.a,{className:Object(lib.G)(isVideoReady?videoHint:disabledVideoHint,{color:isVideoReady?"white":theme.palette.neutralPrimaryAlt},null==styles?void 0:styles.displayNameContainer)},displayName),children&&react_default.a.createElement(Stack.a,{className:Object(lib.G)(overlayContainerStyles,null==styles?void 0:styles.overlayContainer)},children))};VideoTile_VideoTile.__docgenInfo={description:"",methods:[],displayName:"VideoTile"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/VideoTile.js"]={name:"VideoTile",docgenInfo:VideoTile_VideoTile.__docgenInfo,path:"../react-components/dist/dist-esm/components/VideoTile.js"});var memoizeAllRemoteParticipants=Object(src.b)((function(userId,onCreateRemoteStreamView,isAvailable,renderElement,displayName,remoteVideoViewOption,onRenderAvatar){return isAvailable&&!renderElement&&onCreateRemoteStreamView&&onCreateRemoteStreamView(userId,remoteVideoViewOption),react_default.a.createElement(Stack.a,{className:gridStyle,key:userId,grow:!0},react_default.a.createElement(VideoTile_VideoTile,{userId:userId,isVideoReady:isAvailable,renderElement:react_default.a.createElement(StreamMedia_StreamMedia,{videoStreamElement:null!=renderElement?renderElement:null}),displayName:displayName,styles:videoTileStyle,onRenderPlaceholder:onRenderAvatar}))})),VideoGallery_VideoGallery=function VideoGallery(props){var localParticipant=props.localParticipant,remoteParticipants=props.remoteParticipants,localVideoViewOption=props.localVideoViewOption,remoteVideoViewOption=props.remoteVideoViewOption,onRenderLocalVideoTile=props.onRenderLocalVideoTile,onRenderRemoteVideoTile=props.onRenderRemoteVideoTile,onCreateLocalStreamView=props.onCreateLocalStreamView,onCreateRemoteStreamView=props.onCreateRemoteStreamView,styles=props.styles,onRenderAvatar=props.onRenderAvatar,defaultOnRenderLocalVideoTile=Object(react.useMemo)((function(){var _a,localVideoStream=null==localParticipant?void 0:localParticipant.videoStream,isLocalVideoReady=null==localVideoStream?void 0:localVideoStream.isAvailable;return onRenderLocalVideoTile?onRenderLocalVideoTile(localParticipant):(localVideoStream&&!localVideoStream.renderElement&&onCreateLocalStreamView&&onCreateLocalStreamView(localVideoViewOption),react_default.a.createElement(VideoTile_VideoTile,{userId:localParticipant.userId,isVideoReady:isLocalVideoReady,renderElement:react_default.a.createElement(StreamMedia_StreamMedia,{videoStreamElement:null!==(_a=null==localVideoStream?void 0:localVideoStream.renderElement)&&void 0!==_a?_a:null}),displayName:null==localParticipant?void 0:localParticipant.displayName,styles:videoTileStyle,onRenderPlaceholder:onRenderAvatar}))}),[localParticipant,localParticipant.videoStream,onCreateLocalStreamView]),defaultOnRenderRemoteParticipants=Object(react.useMemo)((function(){return remoteParticipants?onRenderRemoteVideoTile?remoteParticipants.map((function(participant){return onRenderRemoteVideoTile(participant)})):memoizeAllRemoteParticipants((function(memoizedRemoteParticipantFn){return remoteParticipants.map((function(participant){var remoteVideoStream=participant.videoStream;return memoizedRemoteParticipantFn(participant.userId,onCreateRemoteStreamView,null==remoteVideoStream?void 0:remoteVideoStream.isAvailable,null==remoteVideoStream?void 0:remoteVideoStream.renderElement,participant.displayName,remoteVideoViewOption,onRenderAvatar)}))})):null}),[remoteParticipants,onRenderRemoteVideoTile,onCreateRemoteStreamView,remoteVideoViewOption]);return react_default.a.createElement(GridLayout_GridLayout,{styles:styles},react_default.a.createElement(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:gridStyle,grow:!0},localParticipant&&defaultOnRenderLocalVideoTile),defaultOnRenderRemoteParticipants)};VideoGallery_VideoGallery.__docgenInfo={description:"VideoGallery represents a `GridLayout` of video tiles for a specific call.\nIt displays a `VideoTile` for the local user as well as for each remote participants who joined the call.\n\n@param props - of type `VideoGalleryProps`\n\n@returns a JSX Element",methods:[],displayName:"VideoGallery"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/VideoGallery.js"]={name:"VideoGallery",docgenInfo:VideoGallery_VideoGallery.__docgenInfo,path:"../react-components/dist/dist-esm/components/VideoGallery.js"});var Label=__webpack_require__(1865),DefaultButton=__webpack_require__(425),CallVideoIcon=__webpack_require__(1829),CallVideoOffIcon=__webpack_require__(1830),ControlBar_styles_theme=Object(lib.B)(),ControlBar_styles_palette=ControlBar_styles_theme.palette,controlBarStyles={horizontal:{flexFlow:"row nowrap"},vertical:{flexFlow:"column nowrap",maxWidth:"3.5rem"},dockedTop:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,width:"100%"},dockedBottom:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",bottom:0,left:0,width:"100%"},dockedLeft:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,height:"100%"},dockedRight:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,right:0,height:"100%"},floatingTop:{flexFlow:"row nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"1rem",left:"50%",transform:"translateX(-50%)",zIndex:10},floatingBottom:{flexFlow:"row nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",bottom:"1rem",left:"50%",transform:"translateX(-50%)",zIndex:10},floatingLeft:{flexFlow:"column nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"50%",left:"1rem",transform:"translateY(-50%)",zIndex:10},floatingRight:{flexFlow:"column nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"50%",right:"1rem",transform:"translateY(-50%)",zIndex:10}},controlButtonStyles={root:{background:"none",border:"none",borderRadius:0,minHeight:"3.5rem",minWidth:"3.5rem"},flexContainer:{flexFlow:"column",display:"contents"}},controlButtonLabelStyles={fontSize:"0.625rem",lineHeight:"1rem",marginTop:"0.125rem"},endCallControlButtonStyles=Object(lib.q)(controlButtonStyles,{root:{color:ControlBar_styles_palette.white},rootHovered:{color:ControlBar_styles_palette.white},rootPressed:{color:ControlBar_styles_palette.white},label:{color:ControlBar_styles_palette.whiteTranslucent40}}),CameraButton_CameraButton=function CameraButton(props){var _a,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return react_default.a.createElement(DefaultButton.a,Object.assign({},props,{onClick:null!==(_a=props.onToggleCamera)&&void 0!==_a?_a:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(props){return(null==props?void 0:props.checked)?react_default.a.createElement(CallVideoIcon.a,{key:"videoIconKey"}):react_default.a.createElement(CallVideoOffIcon.a,{key:"videoOffIconKey"})},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _a;return react_default.a.createElement(Label.a,{key:"videoLabelKey",className:Object(lib.G)(controlButtonLabelStyles,null===(_a=null==props?void 0:props.styles)||void 0===_a?void 0:_a.label)},(null==props?void 0:props.checked)?"Turn off":"Turn on")}:void 0}))};CameraButton_CameraButton.__docgenInfo={description:"`CameraButton` allows you to easily create a component for rendering a camera button.\nIt can be used in your ControlBar component for example.\n\n@param props - of type CameraButtonProps",methods:[],displayName:"CameraButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/CameraButton.js"]={name:"CameraButton",docgenInfo:CameraButton_CameraButton.__docgenInfo,path:"../react-components/dist/dist-esm/components/CameraButton.js"});__webpack_require__(199);var mainDivStyle={position:"relative",height:"100%",width:"100%"},ControlBar_ControlBar=function ControlBar(props){var styles=props.styles,layout=props.layout,theme=Object(useTheme.a)(),controlBarStyle=controlBarStyles[null!=layout?layout:"horizontal"];return react_default.a.createElement("div",{className:Object(lib.G)(mainDivStyle)},react_default.a.createElement(Stack.a,{className:Object(lib.G)(controlBarStyle,{background:isDarkThemed(theme)&&(null==layout?void 0:layout.startsWith("floating"))?theme.palette.neutralQuaternaryAlt:theme.palette.white},null==styles?void 0:styles.root)},props.children))};ControlBar_ControlBar.__docgenInfo={description:"`ControlBar` allows you to easily create a component for call controls using\n[Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) component from\nFluent UI. Users will need to provide methods to Button components used inside `ControlBar`\nfor altering call behavior.",methods:[],displayName:"ControlBar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/ControlBar.js"]={name:"ControlBar",docgenInfo:ControlBar_ControlBar.__docgenInfo,path:"../react-components/dist/dist-esm/components/ControlBar.js"});var CallEndIcon=__webpack_require__(1831),lightTheme={palette:{themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#59b0f7",themeDarker:"#004578",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},callingPalette:{callRed:"#c4314b",callRedDark:"#a42e43",callRedDarker:"#8b2c3d"}},darkTheme_callingPalette={callRed:"#a42e43",callRedDark:"#8b2c3d",callRedDarker:"#772a38"},EndCallButton_EndCallButton=function EndCallButton(props){var _a,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,isDarkTheme=isDarkThemed(Object(useTheme.a)()),componentStyles=Object(lib.q)(endCallControlButtonStyles,{root:{background:isDarkTheme?darkTheme_callingPalette.callRed:lightTheme.callingPalette.callRed},rootHovered:{background:isDarkTheme?darkTheme_callingPalette.callRedDark:lightTheme.callingPalette.callRedDark},rootPressed:{background:isDarkTheme?darkTheme_callingPalette.callRedDarker:lightTheme.callingPalette.callRedDarker}},null!=styles?styles:{});return react_default.a.createElement(DefaultButton.a,Object.assign({},props,{onClick:null!==(_a=props.onHangUp)&&void 0!==_a?_a:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(){return react_default.a.createElement(CallEndIcon.a,{key:"callEndIconKey"})},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _a;return react_default.a.createElement(Label.a,{key:"callEndLabelKey",className:Object(lib.G)(controlButtonLabelStyles,null===(_a=null==props?void 0:props.styles)||void 0===_a?void 0:_a.label)},"Leave call")}:void 0}))};EndCallButton_EndCallButton.__docgenInfo={description:"`EndCallButton` allows you to easily create a component for rendering a end call button. It can be used in your ControlBar component for example.\n\n@param props - of type EndCallButtonProps",methods:[],displayName:"EndCallButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/EndCallButton.js"]={name:"EndCallButton",docgenInfo:EndCallButton_EndCallButton.__docgenInfo,path:"../react-components/dist/dist-esm/components/EndCallButton.js"});var MicIcon=__webpack_require__(1832),MicrophoneButton_MicrophoneButton=function MicrophoneButton(props){var _a,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return react_default.a.createElement(DefaultButton.a,Object.assign({},props,{onClick:null!==(_a=props.onToggleMicrophone)&&void 0!==_a?_a:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(props){return(null==props?void 0:props.checked)?react_default.a.createElement(MicIcon.a,{key:"microphoneIconKey"}):react_default.a.createElement(MicOffIcon.a,{key:"microphoneOffIconKey"})},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _a;return react_default.a.createElement(Label.a,{key:"microphoneLabelKey",className:Object(lib.G)(controlButtonLabelStyles,null===(_a=null==props?void 0:props.styles)||void 0===_a?void 0:_a.label)},(null==props?void 0:props.checked)?"Mute":"Unmute")}:void 0}))};MicrophoneButton_MicrophoneButton.__docgenInfo={description:"`MicrophoneButton` allows you to easily create a component for rendering an audio button. It can be used in your ControlBar component for example.\n@param props - of type MicrophoneButtonProps",methods:[],displayName:"MicrophoneButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/MicrophoneButton.js"]={name:"MicrophoneButton",docgenInfo:MicrophoneButton_MicrophoneButton.__docgenInfo,path:"../react-components/dist/dist-esm/components/MicrophoneButton.js"});var MoreIcon=__webpack_require__(1833),OptionsButton_OptionsButton=function OptionsButton(props){var _props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,defaultMenuProps=function generateDefaultMenuProps(props){var microphones=props.microphones,speakers=props.speakers,cameras=props.cameras,selectedMicrophone=props.selectedMicrophone,selectedSpeaker=props.selectedSpeaker,selectedCamera=props.selectedCamera,onSelectCamera=props.onSelectCamera,onSelectMicrophone=props.onSelectMicrophone,onSelectSpeaker=props.onSelectSpeaker,defaultMenuProps={items:[]};return cameras&&selectedCamera&&onSelectCamera&&defaultMenuProps.items.push({key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:cameras.map((function(val){return{key:val.id,text:val.name,title:val.name,canCheck:!0,isChecked:val.id===(null==selectedCamera?void 0:selectedCamera.id),onClick:function onClick(){return!(val.id===(null==selectedCamera?void 0:selectedCamera.id))&&onSelectCamera(val)}}}))}}),microphones&&selectedMicrophone&&onSelectMicrophone&&defaultMenuProps.items.push({key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:microphones.map((function(val){return{key:val.id,text:val.name,title:val.name,canCheck:!0,isChecked:val.id===(null==selectedMicrophone?void 0:selectedMicrophone.id),onClick:function onClick(){return!(val.id===(null==selectedMicrophone?void 0:selectedMicrophone.id))&&onSelectMicrophone(val)}}}))}}),speakers&&selectedSpeaker&&onSelectSpeaker&&defaultMenuProps.items.push({key:"3",name:"Choose Speaker",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:speakers.map((function(val){return{key:val.id,text:val.name,title:val.name,canCheck:!0,isChecked:val.id===(null==selectedSpeaker?void 0:selectedSpeaker.id),onClick:function onClick(){return!(val.id===(null==selectedSpeaker?void 0:selectedSpeaker.id))&&onSelectSpeaker(val)}}}))}}),defaultMenuProps}(props),componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return react_default.a.createElement(DefaultButton.a,Object.assign({},props,{menuProps:null!=defaultMenuProps?defaultMenuProps:props.menuProps,menuIconProps:{hidden:!0},styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(){return react_default.a.createElement(MoreIcon.a,{key:"optionsIconKey"})},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _a;return react_default.a.createElement(Label.a,{key:"optionsLabelKey",className:Object(lib.G)(controlButtonLabelStyles,null===(_a=null==props?void 0:props.styles)||void 0===_a?void 0:_a.label)},"Options")}:void 0}))};OptionsButton_OptionsButton.__docgenInfo={description:"`OptionsButton` allows you to easily create a component for rendering an options button. It can be used in your ControlBar component for example.\nThis button should contain dropdown menu items you can define through its property `menuProps`.\nThis `menuProps` property is of type [IContextualMenuProps](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuProps).\n\n@param props - of type OptionsButtonProps",methods:[],displayName:"OptionsButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/OptionsButton.js"]={name:"OptionsButton",docgenInfo:OptionsButton_OptionsButton.__docgenInfo,path:"../react-components/dist/dist-esm/components/OptionsButton.js"});var CallControlCloseTrayIcon=__webpack_require__(1834),ScreenShareButton_ScreenShareButton=function ScreenShareButton(props){var _a,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return react_default.a.createElement(DefaultButton.a,Object.assign({},props,{onClick:null!==(_a=props.onToggleScreenShare)&&void 0!==_a?_a:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(props){return(null==props?void 0:props.checked)?react_default.a.createElement(CallControlCloseTrayIcon.a,{key:"screenShareIconKey"}):react_default.a.createElement(CallControlPresentNewIcon.a,{key:"screenShareBorderedIconKey",bordered:!1})},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _a;return react_default.a.createElement(Label.a,{key:"screenShareLabelKey",className:Object(lib.G)(controlButtonLabelStyles,null===(_a=null==props?void 0:props.styles)||void 0===_a?void 0:_a.label)},(null==props?void 0:props.checked)?"Stop":"Share")}:void 0}))};ScreenShareButton_ScreenShareButton.__docgenInfo={description:"`ScreenShareButton` allows you to easily create a component for rendering a screen-share button.\nIt can be used in your ControlBar component for example.\n\n@param props - of type ScreenShareButtonProps",methods:[],displayName:"ScreenShareButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/components/ScreenShareButton.js"]={name:"ScreenShareButton",docgenInfo:ScreenShareButton_ScreenShareButton.__docgenInfo,path:"../react-components/dist/dist-esm/components/ScreenShareButton.js"});var ThemeProvider=__webpack_require__(1847),mergeThemes=__webpack_require__(842),teams=__webpack_require__(1694),Provider=__webpack_require__(1695);function FluentThemeProvider_slicedToArray(arr,i){return function FluentThemeProvider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function FluentThemeProvider_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function FluentThemeProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return FluentThemeProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FluentThemeProvider_arrayLikeToArray(o,minLen)}(arr,i)||function FluentThemeProvider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FluentThemeProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var wrapper=Object(lib.G)({height:"100%",width:"100%"}),initialFluentNorthstarTheme=Object(mergeThemes.f)(teams.a,{componentVariables:{ChatMessage:{linkColor:void 0,linkColorMine:void 0}}}),FluentThemeProvider_FluentThemeProvider=function FluentThemeProvider(props){var fluentTheme=props.fluentTheme,children=props.children,fluentUITheme=null!=fluentTheme?fluentTheme:lightTheme,_useState2=FluentThemeProvider_slicedToArray(Object(react.useState)(initialFluentNorthstarTheme),2),fluentNorthstarTheme=_useState2[0],setFluentNorthstarTheme=_useState2[1];return Object(react.useEffect)((function(){var _a,_b,_c,_d,_e,_f;setFluentNorthstarTheme(Object(mergeThemes.f)(initialFluentNorthstarTheme,{componentVariables:{Chat:{backgroundColor:null===(_a=null==fluentUITheme?void 0:fluentUITheme.palette)||void 0===_a?void 0:_a.white},ChatMessage:{authorColor:null===(_b=null==fluentUITheme?void 0:fluentUITheme.palette)||void 0===_b?void 0:_b.neutralPrimary,contentColor:null===(_c=null==fluentUITheme?void 0:fluentUITheme.palette)||void 0===_c?void 0:_c.neutralPrimary,backgroundColor:null===(_d=null==fluentUITheme?void 0:fluentUITheme.palette)||void 0===_d?void 0:_d.neutralLighter,backgroundColorMine:null===(_e=null==fluentUITheme?void 0:fluentUITheme.palette)||void 0===_e?void 0:_e.themeLight}},componentStyles:{ChatMessage:{timestamp:{WebkitTextFillColor:null===(_f=null==fluentUITheme?void 0:fluentUITheme.palette)||void 0===_f?void 0:_f.neutralSecondary}}}}))}),[fluentUITheme]),react_default.a.createElement(ThemeProvider.a,{theme:fluentUITheme,className:wrapper},react_default.a.createElement(Provider.a,{theme:fluentNorthstarTheme,className:wrapper},children))};FluentThemeProvider_FluentThemeProvider.__docgenInfo={description:"@description Provider to apply a Fluent theme across this library's react components.\n@remarks Components in this library are composed primarily from [Fluent UI](https://developer.microsoft.com/en-us/fluentui#/controls/web),\ncontrols, and also from [Fluent React Northstar](https://fluentsite.z22.web.core.windows.net/0.53.0) controls.\nThis provider handles applying any theme provided to both the underlying Fluent UI controls, as well as the Fluent React Northstar controls.",methods:[],displayName:"FluentThemeProvider"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/dist/dist-esm/theming/FluentThemeProvider.js"]={name:"FluentThemeProvider",docgenInfo:FluentThemeProvider_FluentThemeProvider.__docgenInfo,path:"../react-components/dist/dist-esm/theming/FluentThemeProvider.js"})},279:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return permissionsBannerContainerStyle})),__webpack_require__.d(__webpack_exports__,"b",(function(){return permissionsBannerMessageBarStyle}));var permissionsBannerContainerStyle={width:"100%"},permissionsBannerMessageBarStyle={content:{alignItems:"center",justifyContent:"center",position:"relative"},text:{flexGrow:"0"},actions:{position:"absolute",right:"0px"}}},286:function(module,__webpack_exports__,__webpack_require__){"use strict";var _CommunicationUiError__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(33);__webpack_require__.d(__webpack_exports__,"CommunicationUiError",(function(){return _CommunicationUiError__WEBPACK_IMPORTED_MODULE_0__.a})),__webpack_require__.d(__webpack_exports__,"CommunicationUiErrorCode",(function(){return _CommunicationUiError__WEBPACK_IMPORTED_MODULE_0__.b}));__webpack_require__(789)},33:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return CommunicationUiErrorCode})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CommunicationUiError})),__webpack_require__.d(__webpack_exports__,"c",(function(){return CommunicationUiErrorFromError}));var CommunicationUiErrorCode;__webpack_require__(262),__webpack_require__(226),__webpack_require__(40),__webpack_require__(9),__webpack_require__(51),__webpack_require__(42),__webpack_require__(263),__webpack_require__(80),__webpack_require__(113),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(261),__webpack_require__(56),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}!function(CommunicationUiErrorCode){CommunicationUiErrorCode[CommunicationUiErrorCode.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CONFIGURATION_ERROR=1]="CONFIGURATION_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UNAUTHORIZED_ERROR=2]="UNAUTHORIZED_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.FORBIDDEN_ERROR=3]="FORBIDDEN_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.TOO_MANY_REQUESTS_ERROR=4]="TOO_MANY_REQUESTS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SERVICE_UNAVAILABLE_ERROR=5]="SERVICE_UNAVAILABLE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.INTERNAL_SERVER_ERROR=6]="INTERNAL_SERVER_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UNKNOWN_STATUS_CODE_ERROR=7]="UNKNOWN_STATUS_CODE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.MESSAGE_EXCEEDED_RETRY_ERROR=8]="MESSAGE_EXCEEDED_RETRY_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.START_REALTIME_NOTIFICATIONS_ERROR=9]="START_REALTIME_NOTIFICATIONS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CREATE_CHAT_THREAD_CLIENT_ERROR=10]="CREATE_CHAT_THREAD_CLIENT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SEND_READ_RECEIPT_ERROR=11]="SEND_READ_RECEIPT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_READ_RECEIPT_ERROR=12]="GET_READ_RECEIPT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SEND_MESSAGE_ERROR=13]="SEND_MESSAGE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_MESSAGE_ERROR=14]="GET_MESSAGE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SEND_TYPING_NOTIFICATION_ERROR=15]="SEND_TYPING_NOTIFICATION_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_MESSAGES_ERROR=16]="GET_MESSAGES_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.REMOVE_THREAD_PARTICIPANT_ERROR=17]="REMOVE_THREAD_PARTICIPANT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UPDATE_THREAD_ERROR=18]="UPDATE_THREAD_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.GET_THREAD_ERROR=19]="GET_THREAD_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.QUERY_PERMISSIONS_ERROR=20]="QUERY_PERMISSIONS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.ASK_PERMISSIONS_ERROR=21]="ASK_PERMISSIONS_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.SWITCH_VIDEO_SOURCE_ERROR=22]="SWITCH_VIDEO_SOURCE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.UNMUTE_ERROR=23]="UNMUTE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.MUTE_ERROR=24]="MUTE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.START_VIDEO_ERROR=25]="START_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.STOP_VIDEO_ERROR=26]="STOP_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.START_SCREEN_SHARE_ERROR=27]="START_SCREEN_SHARE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.STOP_SCREEN_SHARE_ERROR=28]="STOP_SCREEN_SHARE_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.RENDER_REMOTE_VIDEO_ERROR=29]="RENDER_REMOTE_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.RENDER_LOCAL_VIDEO_ERROR=30]="RENDER_LOCAL_VIDEO_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CREATE_CALL_AGENT_ERROR=31]="CREATE_CALL_AGENT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.CREATE_DEVICE_MANAGER_ERROR=32]="CREATE_DEVICE_MANAGER_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.DISPOSE_CALL_AGENT_ERROR=33]="DISPOSE_CALL_AGENT_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.JOIN_CALL_ERROR=34]="JOIN_CALL_ERROR",CommunicationUiErrorCode[CommunicationUiErrorCode.LEAVE_CALL_ERROR=35]="LEAVE_CALL_ERROR"}(CommunicationUiErrorCode||(CommunicationUiErrorCode={}));var CommunicationUiError=function(_Error){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CommunicationUiError,_Error);var _super=function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}(CommunicationUiError);function CommunicationUiError(args){var _args$message,_args$message2,_args$code,_args$severity,_this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CommunicationUiError),(_this=_super.call(this,null!==(_args$message=args.message)&&void 0!==_args$message?_args$message:"Unknown error"))._code=void 0,_this._severity=void 0,_this._originalError=void 0,_this._errorInfo=void 0,_this.message=null!==(_args$message2=args.message)&&void 0!==_args$message2?_args$message2:"Unknown error",_this._code=null!==(_args$code=args.code)&&void 0!==_args$code?_args$code:CommunicationUiErrorCode.UNKNOWN_ERROR,_this._severity=null!==(_args$severity=args.severity)&&void 0!==_args$severity?_args$severity:"error",_this._originalError=args.error,_this._errorInfo=args.errorInfo,_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(CommunicationUiError,[{key:"code",get:function get(){return this._code}},{key:"severity",get:function get(){return this._severity},set:function set(severity){this._severity=severity}},{key:"originalError",get:function get(){return this._originalError}},{key:"errorInfo",get:function get(){return this._errorInfo},set:function set(errorInfo){this._errorInfo=errorInfo}}]),CommunicationUiError}(_wrapNativeSuper(Error)),CommunicationUiErrorFromError=function CommunicationUiErrorFromError(error){return error instanceof CommunicationUiError?error:new CommunicationUiError({error:error})}},35:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return memoizeFnAll})),__webpack_require__.d(__webpack_exports__,"a",(function(){return fromFlatCommunicationIdentifier})),__webpack_require__.d(__webpack_exports__,"c",(function(){return identifier_toFlatCommunicationIdentifier}));__webpack_require__(257),__webpack_require__(1436),__webpack_require__(113),__webpack_require__(9),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(50),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var argsCmp=function argsCmp(args1,args2,objCmp){return args1.length===args2.length&&args1.every((function(arg1,index){return objCmp(args2[index],arg1)}))},memoizeFnAll=function memoizeFnAll(fnToMemoize){var shouldCacheUpdate=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,cache=new Map,nextCache=new Map;return function(callback){var retValue=callback((function memoizedFn(key){for(var value=cache.get(key),_len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];if(value){var _value=_slicedToArray(value,2),preArgs=_value[0],_ret=_value[1];if(argsCmp(preArgs,args,shouldCacheUpdate))return nextCache.set(key,[args,_ret]),_ret}var ret=fnToMemoize.apply(void 0,[key].concat(args));return nextCache.set(key,[args,ret]),ret}));return cache=nextCache,nextCache=new Map,retValue}},identifierModels=__webpack_require__(386),identifier_toFlatCommunicationIdentifier=function toFlatCommunicationIdentifier(id){return Object(identifierModels.b)(id)?id.communicationUserId:Object(identifierModels.c)(id)?id.microsoftTeamsUserId:Object(identifierModels.d)(id)?id.phoneNumber:id.id},fromFlatCommunicationIdentifier=function fromFlatCommunicationIdentifier(id){return{communicationUserId:id}}},384:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Call_Call})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createAzureCommunicationCallAdapter}));__webpack_require__(41),__webpack_require__(9),__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(45);var react=__webpack_require__(0),Stack=(__webpack_require__(134),__webpack_require__(10),__webpack_require__(435)),Label=__webpack_require__(1865),Spinner=__webpack_require__(1870),lib=__webpack_require__(34),headerStyles={root:{width:"100%"}},headerContainer=Object(lib.G)({width:"100%",height:"3.875rem",padding:"0.0625rem 0",boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2}),headerCenteredContainer=Object(lib.G)(headerContainer,{justifyContent:"center"}),containerStyles={root:{height:"100%",width:"100%",flexDirection:"column",display:"flex"}},subContainerStyles={root:{overflow:"hidden",width:"100%",flexDirection:"column",display:"flex",flexBasis:"0"}},activeContainerClassName={root:{display:"flex",height:"100%",position:"relative"}},loadingStyle=Object(lib.G)({height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),dist_esm=__webpack_require__(27),memoize_one_esm=(__webpack_require__(113),__webpack_require__(174)),jsx_runtime=__webpack_require__(1),CallAdapterContext=Object(react.createContext)(void 0),CallAdapterProvider_CallAdapterProvider=function CallAdapterProvider(props){var adapter=props.adapter;return Object(jsx_runtime.jsx)(CallAdapterContext.Provider,{value:adapter,children:props.children})};CallAdapterProvider_CallAdapterProvider.displayName="CallAdapterProvider";var CallAdapterProvider_useAdapter=function useAdapter(){var adapter=Object(react.useContext)(CallAdapterContext);if(!adapter)throw"Cannot find adapter please initialize before usage.";return adapter};function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CallAdapterProvider_CallAdapterProvider.__docgenInfo={description:"",methods:[],displayName:"CallAdapterProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},adapter:{required:!0,tsType:{name:"CallAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/adapter/CallAdapterProvider.tsx"]={name:"CallAdapterProvider",docgenInfo:CallAdapterProvider_CallAdapterProvider.__docgenInfo,path:"../react-composites/src/composites/CallComposite/adapter/CallAdapterProvider.tsx"});var useAdaptedSelector=function useAdaptedSelector(selector,selectorProps){return useAdaptedSelector_useSelectorWithAdaptation(selector,adaptCompositeState,selectorProps)},useAdaptedSelector_useSelectorWithAdaptation=function useSelectorWithAdaptation(selector,adaptState,selectorProps){var _adapter$getState$cal,adapter=CallAdapterProvider_useAdapter(),mounted=Object(react.useRef)(!1);Object(react.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var callId=null===(_adapter$getState$cal=adapter.getState().call)||void 0===_adapter$getState$cal?void 0:_adapter$getState$cal.id,callConfigProps=Object(react.useMemo)((function(){return{callId:callId}}),[callId]),_useState2=_slicedToArray(Object(react.useState)(selector(adaptState(adapter.getState()),null!=selectorProps?selectorProps:callConfigProps)),2),props=_useState2[0],setProps=_useState2[1],propRef=Object(react.useRef)(props);return propRef.current=props,Object(react.useEffect)((function(){var onStateChange=function onStateChange(state){if(mounted.current){var newProps=selector(adaptState(state),null!=selectorProps?selectorProps:callConfigProps);propRef.current!==newProps&&setProps(newProps)}};return adapter.onStateChange(onStateChange),function(){adapter.offStateChange(onStateChange)}}),[adaptState,adapter,selector,selectorProps,callConfigProps]),props},memoizeState=Object(memoize_one_esm.a)((function(userId,deviceManager,calls,displayName){return{userId:userId,incomingCalls:new Map([]),incomingCallsEnded:[],callsEnded:[],deviceManager:deviceManager,callAgent:{displayName:displayName},calls:calls}})),memoizeCallMap=Object(memoize_one_esm.a)((function(call){return call?new Map([[call.id,call]]):new Map([])})),adaptCompositeState=function adaptCompositeState(compositeState){var call=compositeState.call,callMap=memoizeCallMap(call);return memoizeState(compositeState.userId,compositeState.devices,callMap,compositeState.displayName)},useSelector_useSelector=function useSelector(selector,selectorProps){return useAdaptedSelector_useSelectorWithAdaptation(selector,(function(state){return state}),selectorProps)},src=__webpack_require__(100),acs_ui_common_src=(__webpack_require__(39),__webpack_require__(35));function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var useHandlers_useHandlers=function useHandlers(_component){return createCompositeHandlers(CallAdapterProvider_useAdapter())},createCompositeHandlers=Object(memoize_one_esm.a)((function(adapter){return{onCreateLocalStreamView:(_onCreateLocalStreamView=_asyncToGenerator(regeneratorRuntime.mark((function _callee(options){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,adapter.createStreamView(void 0,options);case 2:case"end":return _context.stop()}}),_callee)}))),function onCreateLocalStreamView(_x){return _onCreateLocalStreamView.apply(this,arguments)}),onCreateRemoteStreamView:(_onCreateRemoteStreamView=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(userId,options){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,adapter.createStreamView(userId,options);case 2:case"end":return _context2.stop()}}),_callee2)}))),function onCreateRemoteStreamView(_x2,_x3){return _onCreateRemoteStreamView.apply(this,arguments)}),onHangUp:(_onHangUp=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,adapter.leaveCall();case 2:case"end":return _context3.stop()}}),_callee3)}))),function onHangUp(){return _onHangUp.apply(this,arguments)}),onParticipantRemove:(_onParticipantRemove=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(userId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,adapter.removeParticipant(userId);case 2:case"end":return _context4.stop()}}),_callee4)}))),function onParticipantRemove(_x4){return _onParticipantRemove.apply(this,arguments)}),onSelectCamera:(_onSelectCamera=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(deviceInfo){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,adapter.setCamera(deviceInfo);case 2:case"end":return _context5.stop()}}),_callee5)}))),function onSelectCamera(_x5){return _onSelectCamera.apply(this,arguments)}),onSelectMicrophone:(_onSelectMicrophone=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(deviceInfo){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,adapter.setMicrophone(deviceInfo);case 2:case"end":return _context6.stop()}}),_callee6)}))),function onSelectMicrophone(_x6){return _onSelectMicrophone.apply(this,arguments)}),onSelectSpeaker:(_onSelectSpeaker=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(deviceInfo){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,adapter.setSpeaker(deviceInfo);case 2:case"end":return _context7.stop()}}),_callee7)}))),function onSelectSpeaker(_x7){return _onSelectSpeaker.apply(this,arguments)}),onStartCall:function onStartCall(participants){var rawIds=participants.map((function(participant){return Object(acs_ui_common_src.c)(participant)}));return adapter.startCall(rawIds)},onStartScreenShare:(_onStartScreenShare=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,adapter.startScreenShare();case 2:case"end":return _context8.stop()}}),_callee8)}))),function onStartScreenShare(){return _onStartScreenShare.apply(this,arguments)}),onStopScreenShare:(_onStopScreenShare=_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,adapter.stopScreenShare();case 2:case"end":return _context9.stop()}}),_callee9)}))),function onStopScreenShare(){return _onStopScreenShare.apply(this,arguments)}),onToggleCamera:(_onToggleCamera=_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,adapter.onToggleCamera();case 2:case"end":return _context10.stop()}}),_callee10)}))),function onToggleCamera(){return _onToggleCamera.apply(this,arguments)}),onToggleMicrophone:(_onToggleMicrophone=_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){var _adapter$getState$cal;return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(null===(_adapter$getState$cal=adapter.getState().call)||void 0===_adapter$getState$cal||!_adapter$getState$cal.isMuted){_context11.next=6;break}return _context11.next=3,adapter.unmute();case 3:_context11.t0=_context11.sent,_context11.next=9;break;case 6:return _context11.next=8,adapter.mute();case 8:_context11.t0=_context11.sent;case 9:return _context11.abrupt("return",_context11.t0);case 10:case"end":return _context11.stop()}}),_callee11)}))),function onToggleMicrophone(){return _onToggleMicrophone.apply(this,arguments)}),onToggleScreenShare:(_onToggleScreenShare=_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){var _adapter$getState$cal2;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:if(null===(_adapter$getState$cal2=adapter.getState().call)||void 0===_adapter$getState$cal2||!_adapter$getState$cal2.isScreenSharingOn){_context12.next=6;break}return _context12.next=3,adapter.stopScreenShare();case 3:_context12.t0=_context12.sent,_context12.next=9;break;case 6:return _context12.next=8,adapter.startScreenShare();case 8:_context12.t0=_context12.sent;case 9:return _context12.abrupt("return",_context12.t0);case 10:case"end":return _context12.stop()}}),_callee12)}))),function onToggleScreenShare(){return _onToggleScreenShare.apply(this,arguments)}),onStartLocalVideo:(_onStartLocalVideo=_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(!adapter.getState().call){_context13.next=2;break}return _context13.abrupt("return",adapter.startCamera());case 2:case"end":return _context13.stop()}}),_callee13)}))),function onStartLocalVideo(){return _onStartLocalVideo.apply(this,arguments)})};var _onStartLocalVideo,_onToggleScreenShare,_onToggleMicrophone,_onToggleCamera,_onStopScreenShare,_onStartScreenShare,_onSelectSpeaker,_onSelectMicrophone,_onSelectCamera,_onParticipantRemove,_onHangUp,_onCreateRemoteStreamView,_onCreateLocalStreamView})),usePropsFor_usePropsFor=function usePropsFor(component){var selector=getSelector(component);return Object.assign({},useAdaptedSelector(selector),useHandlers_useHandlers())},emptySelector=function emptySelector(){return{}},getSelector=function getSelector(component){return usePropsFor_findSelector(component)},usePropsFor_findSelector=function findSelector(component){switch(component){case dist_esm.m:return src.g;case dist_esm.f:return src.d;case dist_esm.a:return src.a;case dist_esm.i:return src.f;case dist_esm.g:return src.e;case dist_esm.c:return emptySelector}throw"Can't find corresponding selector for this component. Please check the supported components from Azure Communication UI Feature Component List."},Spinner_types=(__webpack_require__(83),__webpack_require__(179)),videoBaseStyle=Object(lib.G)({border:0}),aspectRatioBoxStyle=(Object(lib.G)(videoBaseStyle,{width:"100%",height:"100%"}),Object(lib.G)(videoBaseStyle,{width:"100%",height:0,position:"relative",paddingTop:"56.25%"})),aspectRatioBoxContentStyle=Object(lib.G)({position:"absolute",top:0,left:0,width:"100%",height:"100%"}),stackContainerStyle=Object(lib.G)({height:"100%",width:"25%"}),screenShareContainerStyle=Object(lib.G)({height:"100%",width:"75%",position:"relative"}),videoStreamStyle=Object(lib.G)({position:"absolute",bottom:".25rem",right:".25rem",height:"20%",width:"25%"}),ScreenShare_styles_loadingStyle=Object(lib.G)({height:"100%",width:"100%",display:"flex",justifyContent:"center"}),videoTileStyle={root:{borderRadius:".25rem"}},memoizeAllRemoteParticipants=Object(acs_ui_common_src.b)((function(userId,isAvailable,renderElement,displayName){return Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:Object(jsx_runtime.jsx)(dist_esm.n,{userId:userId,isVideoReady:isAvailable,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:null!=renderElement?renderElement:null}),displayName:displayName,styles:videoTileStyle})})},userId)})),ScreenShare_onRenderPlaceholder=function onRenderPlaceholder(props){return Object(jsx_runtime.jsx)("div",{className:ScreenShare_styles_loadingStyle,children:Object(jsx_runtime.jsx)(Spinner.a,{label:"Loading ".concat(props.displayName,"'s screen"),size:Spinner_types.a.xSmall})})};ScreenShare_onRenderPlaceholder.displayName="onRenderPlaceholder";var ScreenShare_ScreenShare=function ScreenShare(props){var screenShareParticipant=props.screenShareParticipant,localParticipant=props.localParticipant,remoteParticipants=props.remoteParticipants,onCreateRemoteStreamView=props.onCreateRemoteStreamView,onCreateLocalStreamView=props.onCreateLocalStreamView,localVideoStream=null==localParticipant?void 0:localParticipant.videoStream,isLocalVideoReady=void 0!==(null==localVideoStream?void 0:localVideoStream.renderElement),isScreenShareAvailable=screenShareParticipant&&screenShareParticipant.screenShareStream&&screenShareParticipant.screenShareStream.isAvailable,screenShareStreamComponent=Object(react.useMemo)((function(){var _screenShareStream$re,_videoStream$renderEl;if(isScreenShareAvailable){var screenShareStream=null==screenShareParticipant?void 0:screenShareParticipant.screenShareStream,videoStream=null==screenShareParticipant?void 0:screenShareParticipant.videoStream;return null==screenShareStream||!screenShareStream.isAvailable||null!=screenShareStream&&screenShareStream.renderElement||screenShareParticipant&&onCreateRemoteStreamView&&onCreateRemoteStreamView(screenShareParticipant.userId,{scalingMode:"Fit"}),null==videoStream||!videoStream.isAvailable||null!=videoStream&&videoStream.renderElement||screenShareParticipant&&onCreateRemoteStreamView&&onCreateRemoteStreamView(screenShareParticipant.userId),Object(jsx_runtime.jsx)(dist_esm.n,{displayName:null==screenShareParticipant?void 0:screenShareParticipant.displayName,isVideoReady:null==screenShareStream?void 0:screenShareStream.isAvailable,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:null!==(_screenShareStream$re=null==screenShareStream?void 0:screenShareStream.renderElement)&&void 0!==_screenShareStream$re?_screenShareStream$re:null}),onRenderPlaceholder:ScreenShare_onRenderPlaceholder,styles:{overlayContainer:videoStreamStyle},children:videoStream&&videoStream.isAvailable&&videoStream.renderElement&&Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:Object(jsx_runtime.jsx)(dist_esm.n,{isVideoReady:videoStream.isAvailable,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:null!==(_videoStream$renderEl=videoStream.renderElement)&&void 0!==_videoStream$renderEl?_videoStream$renderEl:null}),styles:videoTileStyle})})})})}}),[isScreenShareAvailable,onCreateRemoteStreamView,screenShareParticipant]),layoutLocalParticipant=Object(react.useMemo)((function(){var _localVideoStream$ren;return!localVideoStream||null!=localVideoStream&&localVideoStream.renderElement||onCreateLocalStreamView&&onCreateLocalStreamView(),Object(jsx_runtime.jsx)(dist_esm.n,{isVideoReady:isLocalVideoReady,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:null!==(_localVideoStream$ren=null==localVideoStream?void 0:localVideoStream.renderElement)&&void 0!==_localVideoStream$ren?_localVideoStream$ren:null}),displayName:null==localParticipant?void 0:localParticipant.displayName,styles:videoTileStyle})}),[isLocalVideoReady,localParticipant,localVideoStream,onCreateLocalStreamView]),sidePanelRemoteParticipants=Object(react.useMemo)((function(){return memoizeAllRemoteParticipants((function(memoizedRemoteParticipantFn){return remoteParticipants&&screenShareParticipant?remoteParticipants.filter((function(remoteParticipant){return remoteParticipant.userId!==screenShareParticipant.userId})).map((function(participant){var remoteVideoStream=participant.videoStream;return null==remoteVideoStream||!remoteVideoStream.isAvailable||null!=remoteVideoStream&&remoteVideoStream.renderElement||onCreateRemoteStreamView&&onCreateRemoteStreamView(participant.userId),memoizedRemoteParticipantFn(participant.userId,null==remoteVideoStream?void 0:remoteVideoStream.isAvailable,null==remoteVideoStream?void 0:remoteVideoStream.renderElement,participant.displayName)})):[]}))}),[remoteParticipants,onCreateRemoteStreamView,screenShareParticipant]);return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("div",{className:stackContainerStyle,children:Object(jsx_runtime.jsxs)(Stack.a,{grow:!0,className:Object(lib.G)({height:"100%",overflow:"auto"}),children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:layoutLocalParticipant})}),sidePanelRemoteParticipants]})}),Object(jsx_runtime.jsx)("div",{className:screenShareContainerStyle,children:screenShareStreamComponent})]})};ScreenShare_ScreenShare.__docgenInfo={description:"",methods:[],displayName:"ScreenShare",props:{screenShareParticipant:{required:!0,tsType:{name:"union",raw:"VideoGalleryRemoteParticipant | undefined",elements:[{name:"VideoGalleryRemoteParticipant"},{name:"undefined"}]},description:""},localParticipant:{required:!1,tsType:{name:"VideoGalleryLocalParticipant"},description:""},remoteParticipants:{required:!0,tsType:{name:"Array",elements:[{name:"VideoGalleryRemoteParticipant"}],raw:"VideoGalleryRemoteParticipant[]"},description:""},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onCreateRemoteStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/ScreenShare.tsx"]={name:"ScreenShare",docgenInfo:ScreenShare_ScreenShare.__docgenInfo,path:"../react-composites/src/composites/CallComposite/ScreenShare.tsx"});var getCall=function getCall(state){return state.call},getIsPreviewCameraOn=function getIsPreviewCameraOn(state){return isPreviewOn(state.devices)},getPage=function getPage(state){return state.page},getLocalMicrophoneEnabled=function getLocalMicrophoneEnabled(state){return state.isLocalPreviewMicrophoneEnabled},isPreviewOn=function isPreviewOn(deviceManager){var _deviceManager$unpare;return void 0!==(null===(_deviceManager$unpare=deviceManager.unparentedViews.values().next().value)||void 0===_deviceManager$unpare?void 0:_deviceManager$unpare.view)};function MediaGallery_slicedToArray(arr,i){return function MediaGallery_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MediaGallery_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MediaGallery_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MediaGallery_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MediaGallery_arrayLikeToArray(o,minLen)}(arr,i)||function MediaGallery_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MediaGallery_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var VideoGalleryStyles={root:{height:"auto"}},MediaGallery_localVideoViewOption={scalingMode:"Crop",isMirrored:!0},remoteVideoViewOption={scalingMode:"Crop"},MediaGallery_MediaGallery=function MediaGallery(props){var videoGalleryProps=usePropsFor_usePropsFor(dist_esm.m),_useState2=MediaGallery_slicedToArray(Object(react.useState)(!1),2),isButtonStatusSynced=_useState2[0],setIsButtonStatusSynced=_useState2[1],isPreviewCameraOn=useSelector_useSelector(getIsPreviewCameraOn),isScreenShareActive=Object(react.useMemo)((function(){return void 0!==videoGalleryProps.screenShareParticipant}),[videoGalleryProps]);Object(react.useEffect)((function(){!isPreviewCameraOn||props.isVideoStreamOn||isButtonStatusSynced||props.onStartLocalVideo(),setIsButtonStatusSynced(!0)}),[isButtonStatusSynced,isPreviewCameraOn,props]);var VideoGalleryMemoized=Object(react.useMemo)((function(){return Object(jsx_runtime.jsx)(dist_esm.m,Object.assign({},videoGalleryProps,{localVideoViewOption:MediaGallery_localVideoViewOption,remoteVideoViewOption:remoteVideoViewOption,styles:VideoGalleryStyles,onRenderAvatar:props.onRenderAvatar}))}),[props.onRenderAvatar,videoGalleryProps]);return isScreenShareActive?Object(jsx_runtime.jsx)(ScreenShare_ScreenShare,Object.assign({},videoGalleryProps)):VideoGalleryMemoized};MediaGallery_MediaGallery.__docgenInfo={description:"",methods:[],displayName:"MediaGallery",props:{isVideoStreamOn:{required:!1,tsType:{name:"boolean"},description:""},isMicrophoneChecked:{required:!1,tsType:{name:"boolean"},description:""},onStartLocalVideo:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/MediaGallery.tsx"]={name:"MediaGallery",docgenInfo:MediaGallery_MediaGallery.__docgenInfo,path:"../react-composites/src/composites/CallComposite/MediaGallery.tsx"});var SDKUtils=__webpack_require__(137),es=__webpack_require__(62),complianceBannerSelector=es.a([getCall],(function(call){return{callTranscribeState:null==call?void 0:call.transcription.isTranscriptionActive,callRecordState:null==call?void 0:call.recording.isRecordingActive}})),callStatusSelector=Object(es.a)([function getCallStatus(state){var _state$call$state,_state$call;return null!==(_state$call$state=null===(_state$call=state.call)||void 0===_state$call?void 0:_state$call.state)&&void 0!==_state$call$state?_state$call$state:"None"},function getIsScreenShareOn(state){var _state$call$isScreenS,_state$call2;return null!==(_state$call$isScreenS=null===(_state$call2=state.call)||void 0===_state$call2?void 0:_state$call2.isScreenSharingOn)&&void 0!==_state$call$isScreenS&&_state$call$isScreenS}],(function(callStatus,isScreenShareOn){return{callStatus:callStatus,isScreenShareOn:isScreenShareOn}})),mediaGallerySelector=(__webpack_require__(118),es.a([getCall],(function(call){var _call$localVideoStrea,_call$localVideoStrea2;return{isVideoStreamOn:!(null==call||null===(_call$localVideoStrea=call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})))||void 0===_call$localVideoStrea||null===(_call$localVideoStrea2=_call$localVideoStrea.view)||void 0===_call$localVideoStrea2||!_call$localVideoStrea2.target)}}))),groupCallLeaveButtonStyle={root:{border:"0.125rem",borderRadius:2,marginRight:".75rem",height:"2.1875rem",width:"6.5625rem"},flexContainer:{flexFlow:"row"}},groupCallLeaveButtonCompressedStyle={root:{width:"2rem",height:"3.75rem",border:"0.125rem",borderRadius:2,marginRight:"0.4375rem"},flexContainer:{flexFlow:"row"}},controlBarStyle={root:{marginRight:".5rem",float:"right"}};function CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallControls_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CallControls_CallControls=function CallControls(props){var compressedMode=props.compressedMode,onEndCallClick=props.onEndCallClick,microphoneButtonProps=usePropsFor_usePropsFor(dist_esm.f),cameraButtonProps=usePropsFor_usePropsFor(dist_esm.a),screenShareButtonProps=usePropsFor_usePropsFor(dist_esm.i),hangUpButtonProps=usePropsFor_usePropsFor(dist_esm.c),onHangUp=Object(react.useCallback)(CallControls_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,hangUpButtonProps.onHangUp();case 2:onEndCallClick();case 3:case"end":return _context.stop()}}),_callee)}))),[hangUpButtonProps,onEndCallClick]),_useAdaptedSelector=useAdaptedSelector(src.c),cameraPermissionGranted=_useAdaptedSelector.video,microphonePermissionGranted=_useAdaptedSelector.audio;return Object(jsx_runtime.jsxs)(dist_esm.b,{styles:controlBarStyle,children:[Object(jsx_runtime.jsx)(dist_esm.a,Object.assign({},cameraButtonProps,{onToggleCamera:function onToggleCamera(){return cameraButtonProps.onToggleCamera().catch((function(e){return console.log(e)}))},disabled:!cameraPermissionGranted})),Object(jsx_runtime.jsx)(dist_esm.f,Object.assign({},microphoneButtonProps,{disabled:!microphonePermissionGranted})),Object(jsx_runtime.jsx)(dist_esm.i,Object.assign({},screenShareButtonProps)),Object(jsx_runtime.jsx)(dist_esm.c,Object.assign({},hangUpButtonProps,{onHangUp:onHangUp,styles:compressedMode?groupCallLeaveButtonCompressedStyle:groupCallLeaveButtonStyle,text:compressedMode?"":"Leave"}))]})};CallControls_CallControls.displayName="CallControls",CallControls_CallControls.__docgenInfo={description:"",methods:[],displayName:"CallControls",props:{compressedMode:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/CallControls.tsx"]={name:"CallControls",docgenInfo:CallControls_CallControls.__docgenInfo,path:"../react-composites/src/composites/CallComposite/CallControls.tsx"});var Link=__webpack_require__(1867),MessageBar=__webpack_require__(1696);function ComplianceBanner_slicedToArray(arr,i){return function ComplianceBanner_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ComplianceBanner_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ComplianceBanner_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ComplianceBanner_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ComplianceBanner_arrayLikeToArray(o,minLen)}(arr,i)||function ComplianceBanner_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ComplianceBanner_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_ComplianceBanner=function ComplianceBanner(props){var _useState2=ComplianceBanner_slicedToArray(Object(react.useState)(!1),2),previousCallTranscribeState=_useState2[0],setPreviousCallTranscribeState=_useState2[1],_useState4=ComplianceBanner_slicedToArray(Object(react.useState)(!1),2),previousCallRecordState=_useState4[0],setPreviousCallRecordState=_useState4[1],_useState6=ComplianceBanner_slicedToArray(Object(react.useState)(0),2),variant=_useState6[0],setVariant=_useState6[1],callTranscribeState=props.callTranscribeState,callRecordState=props.callRecordState;function PrivacyPolicy(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://privacy.microsoft.com/en-US/privacystatement#mainnoticetoendusersmodule",target:"_blank",underline:!0,children:"Privacy policy"})}function LearnMore(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://support.microsoft.com/en-us/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24",target:"_blank",underline:!0,children:"Learn more"})}return Object(react.useEffect)((function(){previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&!callTranscribeState?1:!callRecordState&&callTranscribeState?2:callRecordState||callTranscribeState?0:3):previousCallRecordState&&!previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?5:callRecordState||callTranscribeState?0:6):!previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?7:callRecordState||callTranscribeState?0:8):previousCallRecordState||previousCallTranscribeState||setVariant(callRecordState&&callTranscribeState?4:callRecordState&&!callTranscribeState?7:!callRecordState&&callTranscribeState?5:0),setPreviousCallTranscribeState(callTranscribeState),setPreviousCallRecordState(callRecordState)}),[callTranscribeState,callRecordState]),0===variant?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(MessageBar.a,{onDismiss:function onDismiss(){setVariant(0)},dismissButtonAriaLabel:"Close",children:function getBannerMessage(variant){switch(variant){case 1:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has stopped."})," You are now only recording this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 2:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has stopped."})," You are now only transcribing this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 3:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription are being saved. "})," Recording and transcription have stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 4:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription have started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 5:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 6:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording is being saved."})," Recording has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 7:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 8:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription is being saved."})," Transcription has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}(variant)})};ComplianceBanner_ComplianceBanner.__docgenInfo={description:"",methods:[],displayName:"ComplianceBanner",props:{callTranscribeState:{required:!1,tsType:{name:"boolean"},description:""},callRecordState:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/ComplianceBanner.tsx"]={name:"ComplianceBanner",docgenInfo:ComplianceBanner_ComplianceBanner.__docgenInfo,path:"../react-composites/src/composites/CallComposite/ComplianceBanner.tsx"});var lobbySelector=es.a([getCall,function getDisplayName(state){return state.displayName},function getIdentifier(state){return state.userId}],(function(call,displayName,identifier){var _localVideoStream$vie,_localVideoStream$vie2,localVideoStream=null==call?void 0:call.localVideoStreams.find((function(i){return"Video"===i.mediaStreamType}));return{localParticipant:{userId:null!=identifier?identifier:"",displayName:null!=displayName?displayName:"",isMuted:null==call?void 0:call.isMuted,isScreenSharingOn:null==call?void 0:call.isScreenSharingOn,videoStream:{isAvailable:!!localVideoStream,isMirrored:null==localVideoStream||null===(_localVideoStream$vie=localVideoStream.view)||void 0===_localVideoStream$vie?void 0:_localVideoStream$vie.isMirrored,renderElement:null==localVideoStream||null===(_localVideoStream$vie2=localVideoStream.view)||void 0===_localVideoStream$vie2?void 0:_localVideoStream$vie2.target}}}})),useTheme=__webpack_require__(402);function LobbyControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function LobbyControlBar_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){LobbyControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){LobbyControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var LobbyControlBar_LobbyCallControlBar=function LobbyCallControlBar(props){var theme=Object(useTheme.a)(),microphoneButtonProps=usePropsFor_usePropsFor(dist_esm.f),cameraButtonProps=usePropsFor_usePropsFor(dist_esm.a),optionsButtonProps=usePropsFor_usePropsFor(dist_esm.g),hangUpButtonProps=usePropsFor_usePropsFor(dist_esm.c),onHangUp=Object(react.useCallback)(LobbyControlBar_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,hangUpButtonProps.onHangUp();case 2:props.onEndCallClick();case 3:case"end":return _context.stop()}}),_callee)}))),[hangUpButtonProps,props]);return Object(jsx_runtime.jsxs)(dist_esm.b,{layout:"dockedBottom",styles:{root:{background:theme.palette.white,minHeight:"4.25rem",alignItems:"center"}},children:[Object(jsx_runtime.jsx)(dist_esm.a,Object.assign({showLabel:!0},cameraButtonProps,{onToggleCamera:LobbyControlBar_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:cameraButtonProps.onToggleCamera();case 1:case"end":return _context2.stop()}}),_callee2)})))})),Object(jsx_runtime.jsx)(dist_esm.f,Object.assign({showLabel:!0},microphoneButtonProps,{checked:props.isMicrophoneChecked})),Object(jsx_runtime.jsx)(dist_esm.g,Object.assign({showLabel:!0},optionsButtonProps)),Object(jsx_runtime.jsx)(dist_esm.c,{showLabel:!0,style:{borderRadius:"0.25rem",marginLeft:"0.25rem"},onHangUp:onHangUp})]})};function Lobby_slicedToArray(arr,i){return function Lobby_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function Lobby_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function Lobby_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Lobby_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lobby_arrayLikeToArray(o,minLen)}(arr,i)||function Lobby_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lobby_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}LobbyControlBar_LobbyCallControlBar.displayName="LobbyCallControlBar",LobbyControlBar_LobbyCallControlBar.__docgenInfo={description:"",methods:[],displayName:"LobbyCallControlBar",props:{isMicrophoneChecked:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/LobbyControlBar.tsx"]={name:"LobbyCallControlBar",docgenInfo:LobbyControlBar_LobbyCallControlBar.__docgenInfo,path:"../react-composites/src/composites/CallComposite/LobbyControlBar.tsx"});var Lobby_onRenderEmptyPlaceholder=function onRenderEmptyPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},Lobby_Lobby=function Lobby(props){var _props$localParticipa,_props$localParticipa2,palette=Object(useTheme.a)().palette,_useState2=Lobby_slicedToArray(Object(react.useState)(!1),2),isButtonStatusSynced=_useState2[0],setIsButtonStatusSynced=_useState2[1],isPreviewCameraOn=useSelector_useSelector(getIsPreviewCameraOn),localVideoStream=null===(_props$localParticipa=props.localParticipant)||void 0===_props$localParticipa?void 0:_props$localParticipa.videoStream,isVideoReady=null==localVideoStream?void 0:localVideoStream.isAvailable,renderElement=null===(_props$localParticipa2=props.localParticipant.videoStream)||void 0===_props$localParticipa2?void 0:_props$localParticipa2.renderElement,callStateText="InLobby"===props.callState?"Waiting to be admitted":"Connecting...";return Object(react.useEffect)((function(){"InLobby"!==props.callState||!isPreviewCameraOn||isButtonStatusSynced||isVideoReady||renderElement||(props.onStartLocalVideo().catch((function(err){return console.log("Can not start video",err)})),setIsButtonStatusSynced(!0))}),[isButtonStatusSynced,isPreviewCameraOn,isVideoReady,props,renderElement]),Object(react.useEffect)((function(){localVideoStream&&isVideoReady&&props.onCreateLocalStreamView&&props.onCreateLocalStreamView(props.localVideoViewOption).catch((function(err){return console.log("Can not render video",err)}))}),[isVideoReady,localVideoStream,props,renderElement]),Object(jsx_runtime.jsxs)(dist_esm.n,{styles:{root:{height:"100%",width:"100%"},overlayContainer:{}},isVideoReady:isVideoReady,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:null!=renderElement?renderElement:null}),onRenderPlaceholder:Lobby_onRenderEmptyPlaceholder,children:[Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",background:isVideoReady?"#201f1e":palette.neutralLight,opacity:.75}}),Object(jsx_runtime.jsx)("div",{style:{textAlign:"center",zIndex:0,width:"50%",height:"25%",overflow:"none",margin:"auto",position:"absolute",top:0,left:0,bottom:0,right:0},children:Object(jsx_runtime.jsxs)("p",{style:{fontSize:"1.75rem",color:isVideoReady?"white":palette.neutralPrimary},children:["☕ ",Object(jsx_runtime.jsx)("br",{})," ",callStateText]})}),Object(jsx_runtime.jsx)(LobbyControlBar_LobbyCallControlBar,{isMicrophoneChecked:props.isMicrophoneChecked,onEndCallClick:props.onEndCallClick})]})};Lobby_Lobby.displayName="Lobby",Lobby_Lobby.__docgenInfo={description:"",methods:[],displayName:"Lobby",props:{callState:{required:!0,tsType:{name:"string"},description:""},localParticipant:{required:!0,tsType:{name:"VideoGalleryLocalParticipant"},description:""},localVideoViewOption:{required:!1,tsType:{name:"VideoStreamOptions"},description:""},isCameraChecked:{required:!1,tsType:{name:"boolean"},description:""},isMicrophoneChecked:{required:!1,tsType:{name:"boolean"},description:""},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions | undefined) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"union",raw:"VideoStreamOptions | undefined",elements:[{name:"VideoStreamOptions"},{name:"undefined"}]}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onStartLocalVideo:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onEndCallClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/Lobby.tsx"]={name:"Lobby",docgenInfo:Lobby_Lobby.__docgenInfo,path:"../react-composites/src/composites/CallComposite/Lobby.tsx"});var PermissionsBanner=__webpack_require__(416),PermissionsBanner_styles=__webpack_require__(279);function CallScreen_slicedToArray(arr,i){return function CallScreen_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallScreen_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallScreen_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallScreen_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallScreen_arrayLikeToArray(o,minLen)}(arr,i)||function CallScreen_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallScreen_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallScreen_CallScreen=function CallScreen(props){var screenWidth=props.screenWidth,endCallHandler=props.endCallHandler,callErrorHandler=props.callErrorHandler,onRenderAvatar=props.onRenderAvatar,_useState2=CallScreen_slicedToArray(Object(react.useState)(!1),2),joinedCall=_useState2[0],setJoinedCall=_useState2[1],_useSelector=useSelector_useSelector(callStatusSelector),callStatus=_useSelector.callStatus,isScreenShareOn=_useSelector.isScreenShareOn,call=useSelector_useSelector(getCall),currentCallId=Object(react.useRef)("");call&&(currentCallId.current=call.id);var mediaGalleryProps=useSelector_useSelector(mediaGallerySelector),mediaGalleryHandlers=useHandlers_useHandlers(),complianceBannerProps=useSelector_useSelector(complianceBannerSelector),lobbyProps=useSelector_useSelector(lobbySelector),lobbyHandlers=useHandlers_useHandlers(),devicePermissions=useAdaptedSelector(src.c),adapter=CallAdapterProvider_useAdapter();if(Object(react.useEffect)((function(){joinedCall||adapter.joinCall(),setJoinedCall(!0)}),[adapter,joinedCall]),Object(react.useEffect)((function(){var _endedCall$callEndRea,_endedCall$callEndRea2,_endedCall$callEndRea3,endedCall=adapter.getState().endedCall;endedCall&&currentCallId.current===(null==endedCall?void 0:endedCall.id)&&(0===(null==endedCall||null===(_endedCall$callEndRea=endedCall.callEndReason)||void 0===_endedCall$callEndRea?void 0:_endedCall$callEndRea.code)&&5854===(null==endedCall?void 0:endedCall.callEndReason.subCode)?callErrorHandler("errorJoiningTeamsMeeting"):0===(null==endedCall||null===(_endedCall$callEndRea2=endedCall.callEndReason)||void 0===_endedCall$callEndRea2?void 0:_endedCall$callEndRea2.code)&&5300===(null==endedCall||null===(_endedCall$callEndRea3=endedCall.callEndReason)||void 0===_endedCall$callEndRea3?void 0:_endedCall$callEndRea3.subCode)&&callErrorHandler("removed"))}),[adapter,call,callErrorHandler]),"isTeamsCall"in adapter){var _azureAdapter$getStat,azureAdapter=adapter,callState=null===(_azureAdapter$getStat=azureAdapter.getState().call)||void 0===_azureAdapter$getStat?void 0:_azureAdapter$getStat.state;if(azureAdapter.isTeamsCall()&&void 0!==callState&&azureAdapter.getState().call&&["Connecting","Ringing","InLobby"].includes(callState))return Object(jsx_runtime.jsx)(Lobby_Lobby,Object.assign({callState:callState},lobbyProps,lobbyHandlers,{onEndCallClick:endCallHandler,isMicrophoneChecked:azureAdapter.getState().isLocalPreviewMicrophoneEnabled,localVideoViewOption:{scalingMode:"Crop",isMirrored:!0}}))}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(SDKUtils.c)(null!=callStatus?callStatus:"None")?Object(jsx_runtime.jsxs)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:containerStyles,grow:!0,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{styles:headerStyles,children:Object(jsx_runtime.jsx)(Stack.a,{className:props.screenWidth>450?headerContainer:headerCenteredContainer,children:Object(jsx_runtime.jsx)(CallControls_CallControls,{onEndCallClick:endCallHandler,compressedMode:screenWidth<=450})})}),Object(jsx_runtime.jsx)(Stack.a.Item,{style:{width:"100%"},children:Object(jsx_runtime.jsx)(ComplianceBanner_ComplianceBanner,Object.assign({},complianceBannerProps))}),Object(jsx_runtime.jsx)(Stack.a.Item,{style:PermissionsBanner_styles.a,children:Object(jsx_runtime.jsx)(PermissionsBanner.a,{microphonePermissionGranted:devicePermissions.audio,cameraPermissionGranted:devicePermissions.video})}),Object(jsx_runtime.jsx)(Stack.a.Item,{styles:subContainerStyles,grow:!0,children:isScreenShareOn?Object(jsx_runtime.jsx)("div",{className:loadingStyle,children:Object(jsx_runtime.jsx)(Label.a,{children:"Your screen is being shared"})}):"Connected"===callStatus&&Object(jsx_runtime.jsx)(Stack.a,{styles:containerStyles,grow:!0,children:Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,styles:activeContainerClassName,children:Object(jsx_runtime.jsx)(MediaGallery_MediaGallery,Object.assign({},mediaGalleryProps,mediaGalleryHandlers,{onRenderAvatar:onRenderAvatar}))})})})]}):Object(jsx_runtime.jsx)(Spinner.a,{label:"Initializing call client...",ariaLive:"assertive",labelPosition:"top"})})};CallScreen_CallScreen.__docgenInfo={description:"",methods:[],displayName:"CallScreen",props:{screenWidth:{required:!0,tsType:{name:"number"},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/CallScreen.tsx"]={name:"CallScreen",docgenInfo:CallScreen_CallScreen.__docgenInfo,path:"../react-composites/src/composites/CallComposite/CallScreen.tsx"});var configurationStackTokens={childrenGap:"3rem"},mainContainerStyle=Object(lib.G)({width:"100%",height:"100%",selectors:{"@media (max-width: 750px)":{padding:"0.625rem",height:"100%"}}}),localSettingsContainerStyle=Object(lib.G)({width:"100%",maxWidth:"18.75rem"}),fullScreenStyle=Object(lib.G)({height:"100%",width:"100%"}),verticalStackStyle=Object(lib.G)({height:"100%",width:"100%",justifyContent:"space-evenly"}),CallVideoOffIcon=__webpack_require__(1830),Text=__webpack_require__(1869),LocalPreview_styles_palette=Object(lib.B)().palette,localPreviewContainerStyle=(Object(lib.G)({width:"100%",height:"100%"}),Object(lib.G)({maxWidth:"25rem",minWidth:"12.5rem",width:"100%",height:"100%",maxHeight:"18.75rem",minHeight:"16.875rem",background:LocalPreview_styles_palette.neutralLighter,color:LocalPreview_styles_palette.neutralPrimaryAlt})),cameraOffLabelStyle=(Object(lib.G)({height:"2.8125rem",width:"100%",backgroundColor:LocalPreview_styles_palette.neutralQuaternaryAlt}),Object(lib.G)({fontFamily:"Segoe UI Regular",fontSize:"0.625rem",color:LocalPreview_styles_palette.neutralTertiary})),localPreviewTileStyle={root:{minHeight:"14rem"}},localPreviewSelector=es.a([function getDeviceManager(state){return state.devices}],(function(deviceManager){var _deviceManager$unpare,view=null===(_deviceManager$unpare=deviceManager.unparentedViews.values().next().value)||void 0===_deviceManager$unpare?void 0:_deviceManager$unpare.view;return{videoStreamElement:view?view.target:null}}));function LocalPreview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function LocalPreview_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){LocalPreview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){LocalPreview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var LocalPreview_onRenderPlaceholder=function onRenderPlaceholder(){return Object(jsx_runtime.jsxs)(Stack.a,{style:{width:"100%",height:"100%"},verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(CallVideoOffIcon.a,{})}),Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Text.a,{className:cameraOffLabelStyle,children:"Your camera is turned off."})})]})};LocalPreview_onRenderPlaceholder.displayName="onRenderPlaceholder";var LocalPreview_LocalPreview=function LocalPreview(){var cameraButtonProps=usePropsFor_usePropsFor(dist_esm.a),localPreviewProps=useSelector_useSelector(localPreviewSelector),_useAdaptedSelector=useAdaptedSelector(src.c),cameraPermissionGranted=_useAdaptedSelector.video,microphonePermissionGranted=_useAdaptedSelector.audio,isLocalMicrophoneEnabled=useSelector_useSelector(getLocalMicrophoneEnabled),adapter=CallAdapterProvider_useAdapter(),onToggleMic=Object(react.useCallback)(LocalPreview_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:isLocalMicrophoneEnabled?adapter.mute():adapter.unmute();case 1:case"end":return _context.stop()}}),_callee)}))),[adapter,isLocalMicrophoneEnabled]);return Object(jsx_runtime.jsx)(Stack.a,{className:localPreviewContainerStyle,children:Object(jsx_runtime.jsx)(dist_esm.n,{styles:localPreviewTileStyle,isVideoReady:!!localPreviewProps.videoStreamElement,renderElement:Object(jsx_runtime.jsx)(dist_esm.k,{videoStreamElement:localPreviewProps.videoStreamElement}),onRenderPlaceholder:LocalPreview_onRenderPlaceholder,children:Object(jsx_runtime.jsxs)(dist_esm.b,{layout:"floatingBottom",children:[Object(jsx_runtime.jsx)(dist_esm.a,Object.assign({},cameraButtonProps,{disabled:!cameraPermissionGranted})),Object(jsx_runtime.jsx)(dist_esm.f,{checked:isLocalMicrophoneEnabled,onToggleMicrophone:onToggleMic,disabled:!microphonePermissionGranted})]})})})};LocalPreview_LocalPreview.displayName="LocalPreview",LocalPreview_LocalPreview.__docgenInfo={description:"",methods:[],displayName:"LocalPreview"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/LocalPreview.tsx"]={name:"LocalPreview",docgenInfo:LocalPreview_LocalPreview.__docgenInfo,path:"../react-composites/src/composites/CallComposite/LocalPreview.tsx"});var CallConfiguration_CallConfiguration=function CallConfiguration(props){var screenWidth=props.screenWidth;return Object(jsx_runtime.jsx)(Stack.a,{className:mainContainerStyle,horizontalAlign:"center",verticalAlign:"center",grow:!0,children:Object(jsx_runtime.jsxs)(Stack.a,{className:screenWidth>750?fullScreenStyle:verticalStackStyle,horizontal:screenWidth>750,horizontalAlign:"center",verticalAlign:"center",tokens:screenWidth>750?configurationStackTokens:void 0,grow:!0,children:[Object(jsx_runtime.jsx)(LocalPreview_LocalPreview,{}),Object(jsx_runtime.jsx)(Stack.a,{className:localSettingsContainerStyle,children:props.children})]})})};CallConfiguration_CallConfiguration.displayName="CallConfiguration",CallConfiguration_CallConfiguration.__docgenInfo={description:"",methods:[],displayName:"CallConfiguration",props:{screenWidth:{required:!0,tsType:{name:"number"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/CallConfiguration.tsx"]={name:"CallConfiguration",docgenInfo:CallConfiguration_CallConfiguration.__docgenInfo,path:"../react-composites/src/composites/CallComposite/CallConfiguration.tsx"});var Dropdown=__webpack_require__(1849),mainStackTokens={childrenGap:"1.5rem"},dropDownStyles=function dropDownStyles(theme){return{caretDownWrapper:{height:"2.5rem",lineHeight:"2.5rem"},dropdownItem:{fontSize:"0.875rem",height:"2.5rem",background:theme.palette.neutralQuaternaryAlt},dropdown:{height:"2.5rem",maxWidth:"20.75rem",minWidth:"12.5rem"},title:{fontSize:"0.875rem",height:"2.5rem",lineHeight:"2.3125rem"},label:{fontWeight:600,fontSize:"0.875rem"},errorMessage:{fontSize:"0.875rem"}}},localSettingsContainer=Object(lib.G)({width:"100%",maxWidth:"18.75rem",minWidth:"12.5rem",maxHeight:"19.125rem",marginTop:"2.125rem"});function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function LocalDeviceSettings_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return LocalDeviceSettings_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LocalDeviceSettings_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function LocalDeviceSettings_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var getDropDownList=function getDropDownList(list){var _step,noDuplicates=new Map,_iterator=_createForOfIteratorHelper(list);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;noDuplicates.set(item.id,item)}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,dropdownList=[],_iterator2=_createForOfIteratorHelper(noDuplicates.values());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _item=_step2.value;dropdownList.push({val:_item,key:_item.id,text:""===_item.name?_item.deviceType:_item.name})}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return dropdownList},LocalDeviceSettings_LocalDeviceSettings=function LocalDeviceSettings(props){var _props$cameras$,_props$microphones$,_props$speakers$,theme=Object(useTheme.a)();return Object(jsx_runtime.jsxs)(Stack.a,{className:localSettingsContainer,tokens:mainStackTokens,children:[Object(jsx_runtime.jsx)(Dropdown.a,{label:"Camera",placeholder:"Select an option",options:props.cameraPermissionGranted?getDropDownList(props.cameras):[{key:"denied",text:""}],styles:dropDownStyles(theme),disabled:!props.cameraPermissionGranted,errorMessage:props.cameraPermissionGranted?void 0:"Your browser is blocking access to your camera.",defaultSelectedKey:props.cameraPermissionGranted?props.selectedCamera?props.selectedCamera.id:props.cameras?null===(_props$cameras$=props.cameras[0])||void 0===_props$cameras$?void 0:_props$cameras$.id:"":"denied",onChange:function onChange(event,option,index){props.onSelectCamera(props.cameras[null!=index?index:0])}}),Object(jsx_runtime.jsx)(Dropdown.a,{label:"Microphone",placeholder:"Select an option",styles:dropDownStyles(theme),disabled:!props.microphonePermissionGranted,errorMessage:props.microphonePermissionGranted?void 0:"Your browser is blocking access to your microphone.",options:props.microphonePermissionGranted?getDropDownList(props.microphones):[{key:"denied",text:""}],defaultSelectedKey:props.microphonePermissionGranted?props.selectedMicrophone?props.selectedMicrophone.id:props.microphones?null===(_props$microphones$=props.microphones[0])||void 0===_props$microphones$?void 0:_props$microphones$.id:"":"denied",onChange:function onChange(event,option,index){props.onSelectMicrophone(props.microphones[null!=index?index:0])}}),Object(jsx_runtime.jsx)(Dropdown.a,{label:"Speaker",placeholder:"Select an option",styles:dropDownStyles(theme),disabled:0===props.speakers.length,options:getDropDownList(props.speakers),defaultSelectedKey:props.selectedSpeaker?props.selectedSpeaker.id:props.speakers?null===(_props$speakers$=props.speakers[0])||void 0===_props$speakers$?void 0:_props$speakers$.id:"",onChange:function onChange(event,option,index){props.onSelectSpeaker(props.speakers[null!=index?index:0])}})]})};LocalDeviceSettings_LocalDeviceSettings.displayName="LocalDeviceSettings",LocalDeviceSettings_LocalDeviceSettings.__docgenInfo={description:"",methods:[],displayName:"LocalDeviceSettings",props:{cameras:{required:!0,tsType:{name:"Array",elements:[{name:"VideoDeviceInfo"}],raw:"VideoDeviceInfo[]"},description:""},microphones:{required:!0,tsType:{name:"Array",elements:[{name:"AudioDeviceInfo"}],raw:"AudioDeviceInfo[]"},description:""},speakers:{required:!0,tsType:{name:"Array",elements:[{name:"AudioDeviceInfo"}],raw:"AudioDeviceInfo[]"},description:""},selectedCamera:{required:!1,tsType:{name:"VideoDeviceInfo"},description:""},selectedMicrophone:{required:!1,tsType:{name:"AudioDeviceInfo"},description:""},selectedSpeaker:{required:!1,tsType:{name:"AudioDeviceInfo"},description:""},microphonePermissionGranted:{required:!0,tsType:{name:"boolean"},description:""},cameraPermissionGranted:{required:!0,tsType:{name:"boolean"},description:""},onSelectCamera:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: VideoDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"VideoDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectMicrophone:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectSpeaker:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/LocalDeviceSettings.tsx"]={name:"LocalDeviceSettings",docgenInfo:LocalDeviceSettings_LocalDeviceSettings.__docgenInfo,path:"../react-composites/src/composites/CallComposite/LocalDeviceSettings.tsx"});var PrimaryButton=__webpack_require__(1815),videoCameraIconStyle=Object(lib.G)({marginRight:"0.375rem",fontSize:"1.375rem"}),buttonStyle=Object(lib.G)({fontWeight:600,fontSize:"0.875rem",height:"2.75rem",width:"100%",marginTop:"2.125rem",maxWidth:"18.75rem",minWidth:"12.5rem"}),VideoCameraEmphasisIcon=__webpack_require__(1836),StartCallButton_StartCallButton=function StartCallButton(props){var isDisabled=props.isDisabled,onClickHandler=props.onClickHandler;return Object(jsx_runtime.jsxs)(PrimaryButton.a,{disabled:isDisabled,className:buttonStyle,onClick:onClickHandler,children:[Object(jsx_runtime.jsx)(VideoCameraEmphasisIcon.a,{className:videoCameraIconStyle,size:"medium"}),"Start call"]})};StartCallButton_StartCallButton.displayName="StartCallButton",StartCallButton_StartCallButton.__docgenInfo={description:"",methods:[],displayName:"StartCallButton",props:{onClickHandler:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},isDisabled:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/StartCallButton.tsx"]={name:"StartCallButton",docgenInfo:StartCallButton_StartCallButton.__docgenInfo,path:"../react-composites/src/composites/CallComposite/StartCallButton.tsx"});var ConfigurationScreen_ConfigurationScreen=function ConfigurationScreen(props){var startCallHandler=props.startCallHandler,options=useAdaptedSelector(src.e),localDeviceSettingsHandlers=useHandlers_useHandlers(),_useAdaptedSelector=useAdaptedSelector(src.c),cameraPermissionGranted=_useAdaptedSelector.video,microphonePermissionGranted=_useAdaptedSelector.audio;return Object(jsx_runtime.jsxs)(CallConfiguration_CallConfiguration,Object.assign({},props,{children:[Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)(LocalDeviceSettings_LocalDeviceSettings,Object.assign({},options,localDeviceSettingsHandlers,{cameraPermissionGranted:cameraPermissionGranted,microphonePermissionGranted:microphonePermissionGranted}))}),Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)(StartCallButton_StartCallButton,{onClickHandler:startCallHandler,isDisabled:!1})})]}))};ConfigurationScreen_ConfigurationScreen.displayName="ConfigurationScreen",ConfigurationScreen_ConfigurationScreen.__docgenInfo={description:"",methods:[],displayName:"ConfigurationScreen",props:{screenWidth:{required:!0,tsType:{name:"number"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/ConfigurationScreen.tsx"]={name:"ConfigurationScreen",docgenInfo:ConfigurationScreen_ConfigurationScreen.__docgenInfo,path:"../react-composites/src/composites/CallComposite/ConfigurationScreen.tsx"});var Error_styles_mainStackTokens={childrenGap:"0.25rem"},buttonsStackTokens={childrenGap:"0.75rem"},upperStackTokens={childrenGap:"1.5rem"},endCallContainerStyle=Object(lib.G)({width:"20.625rem",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto"}),endCallTitleStyle=Object(lib.G)({fontSize:"1.375rem",fontWeight:600}),Error_styles_buttonStyle=Object(lib.G)({fontWeight:600,height:"2.5rem",width:"9.875rem",fontSize:"0.875rem",padding:0}),Error_styles_videoCameraIconStyle=Object(lib.G)({marginRight:"0.375rem",fontSize:"1.375rem"}),bottomStackFooterStyle=Object(lib.G)({fontSize:"0.875 rem"});function Error_Error(props){var _props$title,title=null!==(_props$title=props.title)&&void 0!==_props$title?_props$title:"Error joining the Call";return Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",tokens:Error_styles_mainStackTokens,className:endCallContainerStyle,children:Object(jsx_runtime.jsxs)(Stack.a,{tokens:upperStackTokens,children:[Object(jsx_runtime.jsx)("div",{className:endCallTitleStyle,children:title}),Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,tokens:buttonsStackTokens,children:Object(jsx_runtime.jsxs)(PrimaryButton.a,{className:Error_styles_buttonStyle,onClick:props.rejoinHandler,children:[Object(jsx_runtime.jsx)(VideoCameraEmphasisIcon.a,{className:Error_styles_videoCameraIconStyle,size:"medium"}),"Retry Call"]})}),Object(jsx_runtime.jsx)("div",{className:bottomStackFooterStyle,children:props.reason?props.reason:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Common reasons for this error:",Object(jsx_runtime.jsxs)("ul",{children:[Object(jsx_runtime.jsx)("li",{children:"Incorrect Teams Meeting URL"}),Object(jsx_runtime.jsx)("li",{children:"Incorrect Group Call ID"})]})]})})]})})}Error_Error.displayName="Error",Error_Error.__docgenInfo={description:"",methods:[],displayName:"Error",props:{title:{required:!1,tsType:{name:"string"},description:""},reason:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/Error.tsx"]={name:"Error",docgenInfo:Error_Error.__docgenInfo,path:"../react-composites/src/composites/CallComposite/Error.tsx"});var callContainer=Object(lib.G)({height:"100%",width:"100%",overflow:"auto",minHeight:"30rem",minWidth:"50rem"});function Call_slicedToArray(arr,i){return function Call_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function Call_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function Call_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Call_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Call_arrayLikeToArray(o,minLen)}(arr,i)||function Call_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Call_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Call_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function Call_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){Call_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){Call_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var Call_MainScreen=function MainScreen(_ref){var screenWidth=_ref.screenWidth,onRenderAvatar=_ref.onRenderAvatar,page=useSelector_useSelector(getPage),adapter=CallAdapterProvider_useAdapter();switch(page){case"configuration":return Object(jsx_runtime.jsx)(ConfigurationScreen_ConfigurationScreen,{screenWidth:screenWidth,startCallHandler:function startCallHandler(){return adapter.setPage("call")}});case"error":return Object(jsx_runtime.jsx)(Error_Error,{rejoinHandler:function rejoinHandler(){return adapter.setPage("configuration")}});case"errorJoiningTeamsMeeting":return Object(jsx_runtime.jsx)(Error_Error,{rejoinHandler:function rejoinHandler(){return adapter.setPage("configuration")},title:"Error joining Teams Meeting",reason:"Access to the Teams meeting was denied."});case"removed":return Object(jsx_runtime.jsx)(Error_Error,{rejoinHandler:function rejoinHandler(){return adapter.setPage("configuration")},title:"Oops! You are no longer a participant of the call.",reason:"Access to the meeting has been stopped"});default:return Object(jsx_runtime.jsx)(CallScreen_CallScreen,{endCallHandler:Call_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:adapter.setPage("configuration");case 1:case"end":return _context.stop()}}),_callee)}))),callErrorHandler:function callErrorHandler(customPage){customPage?adapter.setPage(customPage):adapter.setPage("error")},onRenderAvatar:onRenderAvatar,screenWidth:screenWidth})}},Call_Call=function Call(props){var _window$innerWidth,_window,_useState2=Call_slicedToArray(Object(react.useState)(null!==(_window$innerWidth=null===(_window=window)||void 0===_window?void 0:_window.innerWidth)&&void 0!==_window$innerWidth?_window$innerWidth:0),2),screenWidth=_useState2[0],setScreenWidth=_useState2[1];Object(react.useEffect)((function(){var setWindowWidth=function setWindowWidth(){var width="undefined"!=typeof window?window.innerWidth:0;setScreenWidth(width)};return setWindowWidth(),window.addEventListener("resize",setWindowWidth),function(){return window.removeEventListener("resize",setWindowWidth)}}),[]);var adapter=props.adapter,fluentTheme=props.fluentTheme;return Object(react.useEffect)((function(){Call_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,adapter.askDevicePermission({video:!0,audio:!0});case 2:adapter.queryCameras(),adapter.queryMicrophones(),adapter.querySpeakers();case 5:case"end":return _context2.stop()}}),_callee2)})))()}),[adapter]),Object(jsx_runtime.jsx)(dist_esm.d,{fluentTheme:fluentTheme,children:Object(jsx_runtime.jsx)(CallAdapterProvider_CallAdapterProvider,{adapter:adapter,children:Object(jsx_runtime.jsx)(Stack.a,{className:callContainer,grow:!0,children:Object(jsx_runtime.jsx)(Call_MainScreen,{screenWidth:screenWidth,onRenderAvatar:props.onRenderAvatar})})})})};Call_Call.displayName="Call",Call_Call.__docgenInfo={description:"",methods:[],displayName:"Call",props:{adapter:{required:!0,tsType:{name:"CallAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\nDefaults to a light theme if undefined."},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/Call.tsx"]={name:"Call",docgenInfo:Call_Call.__docgenInfo,path:"../react-composites/src/composites/CallComposite/Call.tsx"});__webpack_require__(56),__webpack_require__(61),__webpack_require__(70),__webpack_require__(109),__webpack_require__(51),__webpack_require__(42);var calling_stateful_client_src=__webpack_require__(269),events=__webpack_require__(151),utils=__webpack_require__(84);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ParticipantSubscriber=function(){function ParticipantSubscriber(participant,emitter){var _this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ParticipantSubscriber),this.participant=void 0,this.emitter=void 0,this.isMutedChangedHandler=function(){_this.emitter.emit("isMutedChanged",{participantId:_this.participant.identifier,isMuted:_this.participant.isMuted})},this.displayNameChangedHandler=function(){_this.emitter.emit("displayNameChanged",{participantId:_this.participant.identifier,displayName:_this.participant.displayName})},this.isSpeakingChangedHandler=function(){_this.emitter.emit("isSpeakingChanged",{participantId:_this.participant.identifier,isSpeaking:_this.participant.isSpeaking})},this.videoStreamsUpdatedHandler=function(event){_this.emitter.emit("videoStreamsUpdated",event)},this.participant=participant,this.emitter=emitter,this.subscribeParticipantEvents()}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ParticipantSubscriber,[{key:"subscribeParticipantEvents",value:function subscribeParticipantEvents(){this.participant.on("isMutedChanged",this.isMutedChangedHandler),this.participant.on("displayNameChanged",this.displayNameChangedHandler),this.participant.on("isSpeakingChanged",this.isSpeakingChangedHandler),this.participant.on("videoStreamsUpdated",this.videoStreamsUpdatedHandler)}},{key:"unsubscribeAll",value:function unsubscribeAll(){this.participant.off("isMutedChanged",this.isMutedChangedHandler),this.participant.off("displayNameChanged",this.displayNameChangedHandler),this.participant.off("isSpeakingChanged",this.isSpeakingChangedHandler),this.participant.off("videoStreamsUpdated",this.videoStreamsUpdatedHandler)}}]),ParticipantSubscriber}();function AzureCommunicationCallAdapter_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function AzureCommunicationCallAdapter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return AzureCommunicationCallAdapter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AzureCommunicationCallAdapter_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){function e(_x14){return _e.apply(this,arguments)}return e.toString=function(){return _e.toString()},e}((function(e){throw e})),f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){function e(_x15){return _e2.apply(this,arguments)}return e.toString=function(){return _e2.toString()},e}((function(e){didErr=!0,err=e})),f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function AzureCommunicationCallAdapter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AzureCommunicationCallAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AzureCommunicationCallAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AzureCommunicationCallAdapter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AzureCommunicationCallAdapter_createClass(Constructor,protoProps,staticProps){return protoProps&&AzureCommunicationCallAdapter_defineProperties(Constructor.prototype,protoProps),staticProps&&AzureCommunicationCallAdapter_defineProperties(Constructor,staticProps),Constructor}var AzureCommunicationCallAdapter_CallContext=function(){function CallContext(clientState){var _clientState$callAgen;AzureCommunicationCallAdapter_classCallCheck(this,CallContext),this.emitter=new events.EventEmitter,this.state=void 0,this.callId=void 0,this.state={isLocalPreviewMicrophoneEnabled:!1,userId:clientState.userId,displayName:null===(_clientState$callAgen=clientState.callAgent)||void 0===_clientState$callAgen?void 0:_clientState$callAgen.displayName,devices:clientState.deviceManager,call:void 0,page:"configuration"}}return AzureCommunicationCallAdapter_createClass(CallContext,[{key:"onStateChange",value:function onStateChange(handler){this.emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this.emitter.off("stateChanged",handler)}},{key:"setState",value:function setState(state){this.state=state,this.emitter.emit("stateChanged",this.state)}},{key:"getState",value:function getState(){return this.state}},{key:"setPage",value:function setPage(page){this.setState(Object.assign({},this.state,{page:page}))}},{key:"setError",value:function setError(error){this.setState(Object.assign({},this.state,{error:error}))}},{key:"setIsLocalMicrophoneEnabled",value:function setIsLocalMicrophoneEnabled(isLocalPreviewMicrophoneEnabled){this.setState(Object.assign({},this.state,{isLocalPreviewMicrophoneEnabled:isLocalPreviewMicrophoneEnabled}))}},{key:"setCallId",value:function setCallId(callId){this.callId=callId}},{key:"updateClientState",value:function updateClientState(clientState){var _this$callId,_clientState$callAgen2,call=clientState.calls.get(null!==(_this$callId=this.callId)&&void 0!==_this$callId?_this$callId:""),endedCall=clientState.callsEnded.length>0?clientState.callsEnded[clientState.callsEnded.length-1]:void 0;this.setState(Object.assign({},this.state,{userId:clientState.userId,displayName:null===(_clientState$callAgen2=clientState.callAgent)||void 0===_clientState$callAgen2?void 0:_clientState$callAgen2.displayName,call:call,endedCall:endedCall,devices:clientState.deviceManager,isLocalPreviewMicrophoneEnabled:void 0===(null==call?void 0:call.isMuted)?this.state.isLocalPreviewMicrophoneEnabled:!(null!=call&&call.isMuted)}))}},{key:"setEndedCall",value:function setEndedCall(call){this.setState(Object.assign({},this.state,{endedCall:call}))}}]),CallContext}(),AzureCommunicationCallAdapter_AzureCommunicationCallAdapter=function(){function AzureCommunicationCallAdapter(callClient,locator,callAgent,deviceManager){var _this=this;AzureCommunicationCallAdapter_classCallCheck(this,AzureCommunicationCallAdapter),this.callClient=void 0,this.callAgent=void 0,this.deviceManager=void 0,this.localStream=void 0,this.locator=void 0,this.call=void 0,this.context=void 0,this.handlers=void 0,this.participantSubscribers=new Map,this.emitter=new events.EventEmitter,this.onClientStateChange=void 0,this.isMyMutedChanged=function(){var _this$call;_this.emitter.emit("isMutedChanged",{participantId:createCommunicationIdentifier(_this.getState().userId),isMuted:null===(_this$call=_this.call)||void 0===_this$call?void 0:_this$call.isMuted})},this.setPage=function(page){_this.context.setPage(page)},this.onRemoteParticipantsUpdated=function(_ref){var added=_ref.added,removed=_ref.removed;added&&added.length>0&&_this.emitter.emit("participantsJoined",added),removed&&removed.length>0&&_this.emitter.emit("participantsLeft",removed),added.forEach((function(participant){_this.participantSubscribers.set(Object(acs_ui_common_src.c)(participant.identifier),new ParticipantSubscriber(participant,_this.emitter))})),removed.forEach((function(participant){var subscriber=_this.participantSubscribers.get(Object(acs_ui_common_src.c)(participant.identifier));subscriber&&subscriber.unsubscribeAll(),_this.participantSubscribers.delete(Object(acs_ui_common_src.c)(participant.identifier))}))},this.isScreenSharingOnChanged=function(){var _this$call2;_this.emitter.emit("isLocalScreenSharingActiveChanged",{isScreenSharingOn:null===(_this$call2=_this.call)||void 0===_this$call2?void 0:_this$call2.isScreenSharingOn})},this.callIdChanged=function(){var _this$call3;_this.context.setCallId(null===(_this$call3=_this.call)||void 0===_this$call3?void 0:_this$call3.id),_this.context.updateClientState(_this.callClient.getState()),_this.emitter.emit("callIdChanged",{callId:_this.callIdChanged})},this.callClient=callClient,this.callAgent=callAgent,this.locator=locator,this.deviceManager=deviceManager,this.context=new AzureCommunicationCallAdapter_CallContext(callClient.getState());var onStateChange=function onStateChange(clientState){_this?_this.context.updateClientState(clientState):callClient.offStateChange(onStateChange)};this.handlers=Object(src.b)(callClient,callAgent,deviceManager,void 0),this.onClientStateChange=onStateChange,this.callClient.onStateChange(onStateChange)}var _removeParticipant,_stopScreenShare,_startScreenShare,_unmute,_mute,_stopCamera,_startCamera,_onToggleCamera,_setSpeaker,_setMicrophone,_setCamera,_leaveCall,_createStreamView,_joinCall,_askDevicePermission,_querySpeakers;return AzureCommunicationCallAdapter_createClass(AzureCommunicationCallAdapter,[{key:"dispose",value:function dispose(){this.callClient.offStateChange(this.onClientStateChange),this.callAgent.dispose()}},{key:"isTeamsCall",value:function isTeamsCall(){return"meetingLink"in this.locator}},{key:"queryCameras",value:function queryCameras(){return this.deviceManager.getCameras()}},{key:"queryMicrophones",value:function queryMicrophones(){return this.deviceManager.getMicrophones()}},{key:"querySpeakers",value:(_querySpeakers=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",this.deviceManager.getSpeakers());case 1:case"end":return _context.stop()}}),_callee,this)}))),function querySpeakers(){return _querySpeakers.apply(this,arguments)})},{key:"askDevicePermission",value:(_askDevicePermission=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(constrain){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.deviceManager.askDevicePermission(constrain);case 2:case"end":return _context2.stop()}}),_callee2,this)}))),function askDevicePermission(_x){return _askDevicePermission.apply(this,arguments)})},{key:"joinCall",value:(_joinCall=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(microphoneOn){var _this$getState$call$s,_this$getState$call,audioOptions,videoOptions;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!Object(utils.c)(null!==(_this$getState$call$s=null===(_this$getState$call=this.getState().call)||void 0===_this$getState$call?void 0:_this$getState$call.state)&&void 0!==_this$getState$call$s?_this$getState$call$s:"None")){_context3.next=4;break}throw new Error("You are already in the call!");case 4:audioOptions={muted:null!=microphoneOn?microphoneOn:!this.getState().isLocalPreviewMicrophoneEnabled},videoOptions={localVideoStreams:this.localStream?[this.localStream]:void 0},this.locator,this.call=this.callAgent.join(this.locator,{audioOptions:audioOptions,videoOptions:videoOptions}),this.context.setCallId(this.call.id),this.context.updateClientState(this.callClient.getState()),this.handlers=Object(src.b)(this.callClient,this.callAgent,this.deviceManager,this.call),this.subscribeCallEvents();case 12:case"end":return _context3.stop()}}),_callee3,this)}))),function joinCall(_x2){return _joinCall.apply(this,arguments)})},{key:"createStreamView",value:(_createStreamView=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(userId,options){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(void 0!==userId){_context4.next=5;break}return _context4.next=3,this.handlers.onCreateLocalStreamView(options);case 3:_context4.next=7;break;case 5:return _context4.next=7,this.handlers.onCreateRemoteStreamView(userId,options);case 7:case"end":return _context4.stop()}}),_callee4,this)}))),function createStreamView(_x3,_x4){return _createStreamView.apply(this,arguments)})},{key:"leaveCall",value:(_leaveCall=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _this$call4,callId;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return callId=null===(_this$call4=this.call)||void 0===_this$call4?void 0:_this$call4.id,_context5.next=3,this.handlers.onHangUp();case 3:this.unsubscribeCallEvents(),this.call=void 0,this.handlers=Object(src.b)(this.callClient,this.callAgent,this.deviceManager,void 0),this.context.setCallId(void 0),this.context.updateClientState(this.callClient.getState()),this.stopCamera(),this.mute(),this.emitter.emit("callEnded",{callId:callId});case 11:case"end":return _context5.stop()}}),_callee5,this)}))),function leaveCall(){return _leaveCall.apply(this,arguments)})},{key:"setCamera",value:(_setCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(device){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.handlers.onSelectCamera(device);case 2:case"end":return _context6.stop()}}),_callee6,this)}))),function setCamera(_x5){return _setCamera.apply(this,arguments)})},{key:"setMicrophone",value:(_setMicrophone=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(device){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,this.handlers.onSelectMicrophone(device);case 2:case"end":return _context7.stop()}}),_callee7,this)}))),function setMicrophone(_x6){return _setMicrophone.apply(this,arguments)})},{key:"setSpeaker",value:(_setSpeaker=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(device){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.handlers.onSelectSpeaker(device);case 2:case"end":return _context8.stop()}}),_callee8,this)}))),function setSpeaker(_x7){return _setSpeaker.apply(this,arguments)})},{key:"onToggleCamera",value:(_onToggleCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,this.handlers.onToggleCamera();case 2:case"end":return _context9.stop()}}),_callee9,this)}))),function onToggleCamera(){return _onToggleCamera.apply(this,arguments)})},{key:"startCamera",value:(_startCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(this.isCameraOn()){_context10.next=3;break}return _context10.next=3,this.handlers.onToggleCamera();case 3:case"end":return _context10.stop()}}),_callee10,this)}))),function startCamera(){return _startCamera.apply(this,arguments)})},{key:"stopCamera",value:(_stopCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(!this.isCameraOn()){_context11.next=3;break}return _context11.next=3,this.handlers.onToggleCamera();case 3:case"end":return _context11.stop()}}),_callee11,this)}))),function stopCamera(){return _stopCamera.apply(this,arguments)})},{key:"isCameraOn",value:function isCameraOn(){return this.call?!!this.call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})):!!this.callClient.getState().deviceManager.selectedCamera&&AzureCommunicationCallAdapter_isPreviewOn(this.callClient.getState().deviceManager)}},{key:"mute",value:(_mute=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){var _this$call5;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return this.call||this.context.setIsLocalMicrophoneEnabled(!1),_context12.next=3,null===(_this$call5=this.call)||void 0===_this$call5?void 0:_this$call5.mute();case 3:case"end":return _context12.stop()}}),_callee12,this)}))),function mute(){return _mute.apply(this,arguments)})},{key:"unmute",value:(_unmute=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){var _this$call6;return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return this.call||this.context.setIsLocalMicrophoneEnabled(!0),_context13.next=3,null===(_this$call6=this.call)||void 0===_this$call6?void 0:_this$call6.unmute();case 3:case"end":return _context13.stop()}}),_callee13,this)}))),function unmute(){return _unmute.apply(this,arguments)})},{key:"startScreenShare",value:(_startScreenShare=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee14(){var _this$call7;return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:if(null!==(_this$call7=this.call)&&void 0!==_this$call7&&_this$call7.isScreenSharingOn){_context14.next=3;break}return _context14.next=3,this.handlers.onToggleScreenShare();case 3:case"end":return _context14.stop()}}),_callee14,this)}))),function startScreenShare(){return _startScreenShare.apply(this,arguments)})},{key:"stopScreenShare",value:(_stopScreenShare=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee15(){var _this$call8;return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:if(null===(_this$call8=this.call)||void 0===_this$call8||!_this$call8.isScreenSharingOn){_context15.next=3;break}return _context15.next=3,this.handlers.onToggleScreenShare();case 3:case"end":return _context15.stop()}}),_callee15,this)}))),function stopScreenShare(){return _stopScreenShare.apply(this,arguments)})},{key:"startCall",value:function startCall(participants){var idsToAdd=participants.map((function(participant){return Object(acs_ui_common_src.a)(participant)}));return this.handlers.onStartCall(idsToAdd)}},{key:"removeParticipant",value:(_removeParticipant=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee16(userId){return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:this.handlers.onParticipantRemove(userId);case 1:case"end":return _context16.stop()}}),_callee16,this)}))),function removeParticipant(_x8){return _removeParticipant.apply(this,arguments)})},{key:"getState",value:function getState(){return this.context.getState()}},{key:"onStateChange",value:function onStateChange(handler){this.context.onStateChange(handler)}},{key:"offStateChange",value:function offStateChange(handler){this.context.offStateChange(handler)}},{key:"on",value:function on(event,listener){this.emitter.on(event,listener)}},{key:"subscribeCallEvents",value:function subscribeCallEvents(){var _this$call9,_this$call10,_this$call11,_this$call12;null===(_this$call9=this.call)||void 0===_this$call9||_this$call9.on("remoteParticipantsUpdated",this.onRemoteParticipantsUpdated),null===(_this$call10=this.call)||void 0===_this$call10||_this$call10.on("isMutedChanged",this.isMyMutedChanged),null===(_this$call11=this.call)||void 0===_this$call11||_this$call11.on("isScreenSharingOnChanged",this.isScreenSharingOnChanged),null===(_this$call12=this.call)||void 0===_this$call12||_this$call12.on("idChanged",this.callIdChanged)}},{key:"unsubscribeCallEvents",value:function unsubscribeCallEvents(){var _this$call13,_this$call14,_this$call15,_this$call16,_step,_iterator=AzureCommunicationCallAdapter_createForOfIteratorHelper(this.participantSubscribers.values());try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.unsubscribeAll()}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.participantSubscribers.clear(),null===(_this$call13=this.call)||void 0===_this$call13||_this$call13.off("remoteParticipantsUpdated",this.onRemoteParticipantsUpdated),null===(_this$call14=this.call)||void 0===_this$call14||_this$call14.off("isMutedChanged",this.isMyMutedChanged),null===(_this$call15=this.call)||void 0===_this$call15||_this$call15.off("isScreenSharingOnChanged",this.isScreenSharingOnChanged),null===(_this$call16=this.call)||void 0===_this$call16||_this$call16.off("idChanged",this.callIdChanged)}},{key:"off",value:function off(event,listener){this.emitter.off(event,listener)}}]),AzureCommunicationCallAdapter}(),AzureCommunicationCallAdapter_isPreviewOn=function isPreviewOn(deviceManager){var _deviceManager$unpare;return void 0!==(null===(_deviceManager$unpare=deviceManager.unparentedViews.values().next().value)||void 0===_deviceManager$unpare?void 0:_deviceManager$unpare.view)},createCommunicationIdentifier=function createCommunicationIdentifier(rawId){return{kind:"communicationUser",communicationUserId:rawId}},createAzureCommunicationCallAdapter=function(){var _ref2=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee17(token,locator,displayName,refreshTokenCallback,callClientOptions){var userId,callClient,deviceManager,callAgent,adapter;return regeneratorRuntime.wrap((function _callee17$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return userId=Object(utils.b)(token),callClient=Object(calling_stateful_client_src.a)({userId:userId},{callClientOptions:callClientOptions}),_context17.next=4,callClient.getDeviceManager();case 4:return deviceManager=_context17.sent,_context17.next=7,callClient.createCallAgent(Object(utils.a)(token,refreshTokenCallback),{displayName:displayName});case 7:return callAgent=_context17.sent,adapter=new AzureCommunicationCallAdapter_AzureCommunicationCallAdapter(callClient,locator,callAgent,deviceManager),_context17.abrupt("return",adapter);case 10:case"end":return _context17.stop()}}),_callee17)})));return function createAzureCommunicationCallAdapter(_x9,_x10,_x11,_x12,_x13){return _ref2.apply(this,arguments)}}()},385:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return createAzureCommunicationChatAdapter})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ChatComposite_ChatComposite}));__webpack_require__(45),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(470),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(10),__webpack_require__(42),__webpack_require__(56),__webpack_require__(41);var src=__webpack_require__(387),chat_component_bindings_src=__webpack_require__(188),acs_ui_common_src=__webpack_require__(35),events=__webpack_require__(151),events_default=__webpack_require__.n(events),utils=__webpack_require__(84);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _asyncIterator(iterable){var method;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(method=iterable[Symbol.asyncIterator]))return method.call(iterable);if(Symbol.iterator&&null!=(method=iterable[Symbol.iterator]))return method.call(iterable)}throw new TypeError("Object is not async iterable")}var AzureCommunicationChatAdapter_ChatContext=function(){function ChatContext(clientState,threadId){_classCallCheck(this,ChatContext),this.emitter=new events_default.a,this.state=void 0,this.threadId=void 0;var thread=clientState.threads.get(threadId);if(this.threadId=threadId,!thread)throw"Cannot find threadId, please initialize thread before use!";this.state={userId:Object(acs_ui_common_src.c)(clientState.userId),displayName:clientState.displayName,thread:thread}}return _createClass(ChatContext,[{key:"onStateChange",value:function onStateChange(handler){this.emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this.emitter.off("stateChanged",handler)}},{key:"setState",value:function setState(state){this.state=state,this.emitter.emit("stateChanged",this.state)}},{key:"getState",value:function getState(){return this.state}},{key:"setError",value:function setError(error){this.setState(Object.assign({},this.state,{error:error}))}},{key:"updateClientState",value:function updateClientState(clientState){var thread=clientState.threads.get(this.threadId);if(!thread)throw"Cannot find threadId, please make sure thread state is still in Stateful ChatClient.";this.setState({userId:Object(acs_ui_common_src.c)(clientState.userId),displayName:clientState.displayName,thread:thread})}}]),ChatContext}(),AzureCommunicationChatAdapter_AzureCommunicationChatAdapter=function(){function AzureCommunicationChatAdapter(chatClient,chatThreadClient){var _this=this;_classCallCheck(this,AzureCommunicationChatAdapter),this.chatClient=void 0,this.chatThreadClient=void 0,this.context=void 0,this.handlers=void 0,this.emitter=new events_default.a,this.fetchInitialData=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,_value;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,_this.chatThreadClient.getProperties();case 3:_context.next=8;break;case 5:_context.prev=5,_context.t0=_context.catch(0),console.log(_context.t0);case 8:_context.prev=8,_iteratorNormalCompletion=!0,_didIteratorError=!1,_context.prev=11,_iterator=_asyncIterator(_this.chatThreadClient.listParticipants().byPage({maxPageSize:100}));case 13:return _context.next=15,_iterator.next();case 15:return _step=_context.sent,_iteratorNormalCompletion=_step.done,_context.next=19,_step.value;case 19:if(_value=_context.sent,_iteratorNormalCompletion){_context.next=26;break}_value;case 23:_iteratorNormalCompletion=!0,_context.next=13;break;case 26:_context.next=32;break;case 28:_context.prev=28,_context.t1=_context.catch(11),_didIteratorError=!0,_iteratorError=_context.t1;case 32:if(_context.prev=32,_context.prev=33,_iteratorNormalCompletion||null==_iterator.return){_context.next=37;break}return _context.next=37,_iterator.return();case 37:if(_context.prev=37,!_didIteratorError){_context.next=40;break}throw _iteratorError;case 40:return _context.finish(37);case 41:return _context.finish(32);case 42:_context.next=47;break;case 44:_context.prev=44,_context.t2=_context.catch(8),console.log(_context.t2);case 47:case"end":return _context.stop()}}),_callee,null,[[0,5],[8,44],[11,28,32,42],[33,,37,41]])}))),this.getState=function(){return _this.context.getState()},this.onStateChange=function(handler){_this.context.onStateChange(handler)},this.offStateChange=function(handler){_this.context.offStateChange(handler)},this.sendMessage=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(content){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this.handlers.onSendMessage(content);case 2:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}(),this.sendReadReceipt=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(chatMessageId){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_this.handlers.onMessageSeen(chatMessageId);case 2:case"end":return _context3.stop()}}),_callee3)})));return function(_x2){return _ref3.apply(this,arguments)}}(),this.sendTypingIndicator=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this.handlers.onTyping();case 2:case"end":return _context4.stop()}}),_callee4)}))),this.removeParticipant=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(userId){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,_this.handlers.onParticipantRemove(userId);case 2:case"end":return _context5.stop()}}),_callee5)})));return function(_x3){return _ref5.apply(this,arguments)}}(),this.setTopic=function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(topicName){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,_this.handlers.updateThreadTopicName(topicName);case 2:case"end":return _context6.stop()}}),_callee6)})));return function(_x4){return _ref6.apply(this,arguments)}}(),this.loadPreviousChatMessages=function(){var _ref7=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(messagesToLoad){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this.handlers.onLoadPreviousChatMessages(messagesToLoad);case 2:return _context7.abrupt("return",_context7.sent);case 3:case"end":return _context7.stop()}}),_callee7)})));return function(_x5){return _ref7.apply(this,arguments)}}(),this.messageReceivedListener=function(event){var message=convertEventToChatMessage(event);_this.emitter.emit("messageReceived",{message:message});var currentUserId=Object(acs_ui_common_src.c)(_this.chatClient.getState().userId);null!=message&&message.sender&&Object(acs_ui_common_src.c)(message.sender)===currentUserId&&_this.emitter.emit("messageSent",{message:message})},this.messageReadListener=function(_ref8){var chatMessageId=_ref8.chatMessageId,recipient=_ref8.recipient,message=_this.getState().thread.chatMessages.get(chatMessageId);message&&_this.emitter.emit("messageRead",{message:message,readBy:recipient})},this.participantsAddedListener=function(_ref9){var addedBy=_ref9.addedBy,participantsAdded=_ref9.participantsAdded;_this.emitter.emit("participantsAdded",{addedBy:addedBy,participantsAdded:participantsAdded})},this.participantsRemovedListener=function(_ref10){var removedBy=_ref10.removedBy,participantsRemoved=_ref10.participantsRemoved;_this.emitter.emit("participantsRemoved",{removedBy:removedBy,participantsRemoved:participantsRemoved})},this.chatThreadPropertiesUpdatedListener=function(event){_this.emitter.emit("topicChanged",{topic:event.properties.topic})},this.subscribeAllEvents=function(){_this.chatClient.on("chatThreadPropertiesUpdated",_this.chatThreadPropertiesUpdatedListener),_this.chatClient.on("participantsAdded",_this.participantsAddedListener),_this.chatClient.on("participantsRemoved",_this.participantsRemovedListener),_this.chatClient.on("chatMessageReceived",_this.messageReceivedListener),_this.chatClient.on("readReceiptReceived",_this.messageReadListener),_this.chatClient.on("participantsRemoved",_this.participantsRemovedListener)},this.unsubscribeAllEvents=function(){_this.chatClient.off("chatThreadPropertiesUpdated",_this.chatThreadPropertiesUpdatedListener),_this.chatClient.off("participantsAdded",_this.participantsAddedListener),_this.chatClient.off("participantsRemoved",_this.participantsRemovedListener),_this.chatClient.off("chatMessageReceived",_this.messageReceivedListener),_this.chatClient.off("readReceiptReceived",_this.messageReadListener),_this.chatClient.off("participantsRemoved",_this.participantsRemovedListener)},this.chatClient=chatClient,this.chatThreadClient=chatThreadClient,this.context=new AzureCommunicationChatAdapter_ChatContext(chatClient.getState(),chatThreadClient.threadId);this.handlers=Object(chat_component_bindings_src.c)(chatClient,chatThreadClient),this.chatClient.onStateChange((function onStateChange(clientState){_this?_this.context.updateClientState(clientState):chatClient.offStateChange(onStateChange)})),this.subscribeAllEvents()}return _createClass(AzureCommunicationChatAdapter,[{key:"dispose",value:function dispose(){this.unsubscribeAllEvents()}},{key:"on",value:function on(event,listener){this.emitter.on(event,listener)}},{key:"off",value:function off(event,listener){this.emitter.off(event,listener)}}]),AzureCommunicationChatAdapter}(),convertEventToChatMessage=function convertEventToChatMessage(event){return{id:event.id,version:event.version,content:{message:event.message},type:event.type,sender:event.sender,senderDisplayName:event.senderDisplayName,sequenceId:"",createdOn:new Date(event.createdOn)}},createAzureCommunicationChatAdapter=function(){var _ref11=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(token,endpointUrl,threadId,displayName,refreshTokenCallback){var rawUserId,userId,chatClient,chatThreadClient,adapter;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return rawUserId=Object(utils.b)(token),userId={kind:"communicationUser",communicationUserId:rawUserId},chatClient=Object(src.a)({userId:userId,displayName:displayName,endpoint:endpointUrl,credential:Object(utils.a)(token,refreshTokenCallback)}),_context8.next=5,chatClient.getChatThreadClient(threadId);case 5:return chatThreadClient=_context8.sent,chatClient.startRealtimeNotifications(),adapter=new AzureCommunicationChatAdapter_AzureCommunicationChatAdapter(chatClient,chatThreadClient),_context8.abrupt("return",adapter);case 9:case"end":return _context8.stop()}}),_callee8)})));return function createAzureCommunicationChatAdapter(_x6,_x7,_x8,_x9,_x10){return _ref11.apply(this,arguments)}}(),react=__webpack_require__(0),lib=__webpack_require__(34),Stack=__webpack_require__(435),dist_esm=__webpack_require__(27),jsx_runtime=__webpack_require__(1),ChatAdapterContext=Object(react.createContext)(void 0),ChatAdapterProvider_ChatAdapterProvider=function ChatAdapterProvider(props){var adapter=props.adapter;return Object(jsx_runtime.jsx)(ChatAdapterContext.Provider,{value:adapter,children:props.children})};ChatAdapterProvider_ChatAdapterProvider.displayName="ChatAdapterProvider";var ChatAdapterProvider_useAdapter=function useAdapter(){var adapter=Object(react.useContext)(ChatAdapterContext);if(!adapter)throw"Cannot find adapter please initialize before usage.";return adapter};ChatAdapterProvider_ChatAdapterProvider.__docgenInfo={description:"",methods:[],displayName:"ChatAdapterProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},adapter:{required:!0,tsType:{name:"ChatAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/adapter/ChatAdapterProvider.tsx"]={name:"ChatAdapterProvider",docgenInfo:ChatAdapterProvider_ChatAdapterProvider.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/adapter/ChatAdapterProvider.tsx"});__webpack_require__(113),__webpack_require__(21),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24);var memoize_one_esm=__webpack_require__(174);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var useAdaptedSelector=function useAdaptedSelector(selector,selectorProps){return useAdaptedSelector_useSelectorWithAdaptation(selector,adaptCompositeState,selectorProps)},useAdaptedSelector_useSelectorWithAdaptation=function useSelectorWithAdaptation(selector,adaptState,selectorProps){var adapter=ChatAdapterProvider_useAdapter(),mounted=Object(react.useRef)(!1);Object(react.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var threadId=adapter.getState().thread.threadId,threadConfigProps=Object(react.useMemo)((function(){return{threadId:threadId}}),[threadId]),_useState2=_slicedToArray(Object(react.useState)(selector(adaptState(adapter.getState()),null!=selectorProps?selectorProps:threadConfigProps)),2),props=_useState2[0],setProps=_useState2[1],propRef=Object(react.useRef)(props);return propRef.current=props,Object(react.useEffect)((function(){var onStateChange=function onStateChange(state){if(mounted.current){var newProps=selector(adaptState(state),null!=selectorProps?selectorProps:threadConfigProps);propRef.current!==newProps&&setProps(newProps)}};return adapter.onStateChange(onStateChange),function(){adapter.offStateChange(onStateChange)}}),[adaptState,adapter,selector,selectorProps,threadConfigProps]),props},memoizeState=Object(memoize_one_esm.a)((function(userId,displayName,threads){return{userId:userId,displayName:displayName,threads:threads}})),memoizeThreadMap=Object(memoize_one_esm.a)((function(thread){return new Map([[thread.threadId,thread]])})),adaptCompositeState=function adaptCompositeState(compositeState){var thread=compositeState.thread,threadMap=memoizeThreadMap(thread);return memoizeState({kind:"communicationUser",communicationUserId:compositeState.userId},compositeState.displayName,threadMap)},createCompositeHandlers=Object(memoize_one_esm.a)((function(adapter){return{onSendMessage:adapter.sendMessage,onLoadPreviousChatMessages:adapter.loadPreviousChatMessages,onMessageSeen:adapter.sendReadReceipt,onTyping:adapter.sendTypingIndicator,onParticipantRemove:adapter.removeParticipant,updateThreadTopicName:adapter.setTopic}})),usePropsFor_usePropsFor=function usePropsFor(component){var selector=usePropsFor_getSelector(component);return Object.assign({},useAdaptedSelector(selector),function useHandlers(_component){return createCompositeHandlers(ChatAdapterProvider_useAdapter())}())},usePropsFor_getSelector=function getSelector(component){switch(component){case dist_esm.e:return chat_component_bindings_src.b;case dist_esm.h:return chat_component_bindings_src.a;case dist_esm.j:return chat_component_bindings_src.d;case dist_esm.l:return chat_component_bindings_src.e}throw"Can't find corresponding selector for this component. Please check the supported components from Azure Communication UI Feature Component List."},es=__webpack_require__(62),chatContainer=Object(lib.G)({height:"100%",width:"100%",overflow:"hidden",minHeight:"25rem",minWidth:"25rem","*::-webkit-scrollbar":{width:"0.3rem",height:"0.3rem"},".scroll::-webkit-scrollbar-track":{background:"rgba(150, 150, 150)",borderRadius:"0.3rem"},"*::-webkit-scrollbar-thumb":{borderRadius:"10px",background:"rgba(150, 150, 150)"}}),chatArea=Object(lib.G)({height:"100%",width:"100%",paddingLeft:"1rem",paddingRight:"1rem",paddingBottom:"1rem",overflow:"hidden"}),chatWrapper=Object(lib.G)({height:"100%",width:"100%",paddingBottom:"1rem",overflow:"auto",margin:"0 0.2rem"}),chatHeaderContainerStyle=Object(lib.G)({width:"100%",height:"3rem",paddingLeft:"1.5rem",paddingRight:"3.25rem",selectors:{"@media screen and (max-width: 25rem)":{paddingLeft:"5%",paddingRight:"5%"}},borderBottom:"0.063rem solid #DDDDDD"}),topicNameLabelStyle=Object(lib.G)({fontSize:"1.1rem",lineHeight:"2.5rem",fontWeight:600,marginRight:"0.125rem",textOverflow:"ellipsis",overflowY:"hidden"}),participantListWrapper=Object(lib.G)({boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",width:"15rem",height:"100%"}),listHeader=Object(lib.G)({fontSize:"1rem",margin:"1rem"}),participantListStack=Object(lib.G)({width:"15rem",height:"100%"}),participantListStyle=Object(lib.G)({overflowY:"hidden"}),ChatHeader_ChatHeader=function ChatHeader(props){return Object(jsx_runtime.jsx)(Stack.a,{className:chatHeaderContainerStyle,horizontal:!0,children:Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",style:{minWidth:"12.5rem"},children:Object(jsx_runtime.jsx)("div",{className:topicNameLabelStyle,children:props.topic})})})};ChatHeader_ChatHeader.displayName="ChatHeader";var getHeaderProps=es.a([function getTopicName(state,props){var _state$threads$get,_state$threads$get$pr;return(null===(_state$threads$get=state.threads.get(props.threadId))||void 0===_state$threads$get||null===(_state$threads$get$pr=_state$threads$get.properties)||void 0===_state$threads$get$pr?void 0:_state$threads$get$pr.topic)||""}],(function(topic){return{topic:topic}}));ChatHeader_ChatHeader.__docgenInfo={description:"",methods:[],displayName:"ChatHeader",props:{topic:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatHeader.tsx"]={name:"ChatHeader",docgenInfo:ChatHeader_ChatHeader.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatHeader.tsx"});var MessageBar=__webpack_require__(1696),MessageBar_types=__webpack_require__(57),ThreadStatus_ThreadStatus=function ThreadStatus(props){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:props.amIRemovedFromThread?Object(jsx_runtime.jsx)(MessageBar.a,{messageBarType:MessageBar_types.a.warning,children:"You no longer have access to the chat."}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})})},getThreadStatusProps=es.a([function getUserId(state){return Object(acs_ui_common_src.c)(state.userId)},function getParticipants(state,props){var _state$threads$get;return props.threadId&&(null===(_state$threads$get=state.threads.get(props.threadId))||void 0===_state$threads$get?void 0:_state$threads$get.participants)||new Map}],(function(userId,chatParticipants){return{amIRemovedFromThread:chatParticipants.size>0&&!chatParticipants.has(userId)}}));ThreadStatus_ThreadStatus.__docgenInfo={description:"",methods:[],displayName:"ThreadStatus",props:{amIRemovedFromThread:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ThreadStatus.tsx"]={name:"ThreadStatus",docgenInfo:ThreadStatus_ThreadStatus.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ThreadStatus.tsx"});var ChatScreen_ChatScreen=function ChatScreen(props){var onRenderAvatar=props.onRenderAvatar,sendBoxMaxLength=props.sendBoxMaxLength,sendBoxParentStyle=Object(lib.G)({maxWidth:sendBoxMaxLength?"".concat(sendBoxMaxLength/16,"rem"):"unset",width:"100%"}),adapter=ChatAdapterProvider_useAdapter();Object(react.useEffect)((function(){adapter.fetchInitialData()}),[adapter]);var messageThreadProps=usePropsFor_usePropsFor(dist_esm.e),participantListProps=usePropsFor_usePropsFor(dist_esm.h),sendBoxProps=usePropsFor_usePropsFor(dist_esm.j),typingIndicatorProps=usePropsFor_usePropsFor(dist_esm.l),headerProps=useAdaptedSelector(getHeaderProps),threadStatusProps=useAdaptedSelector(getThreadStatusProps);return Object(jsx_runtime.jsxs)(Stack.a,{className:chatContainer,grow:!0,children:[Object(jsx_runtime.jsx)(ChatHeader_ChatHeader,Object.assign({},headerProps)),Object(jsx_runtime.jsxs)(Stack.a,{className:chatArea,horizontal:!0,grow:!0,children:[Object(jsx_runtime.jsxs)(Stack.a,{className:chatWrapper,grow:!0,children:[Object(jsx_runtime.jsx)(ThreadStatus_ThreadStatus,Object.assign({},threadStatusProps)),Object(jsx_runtime.jsx)(dist_esm.e,Object.assign({},messageThreadProps,{onRenderAvatar:onRenderAvatar,numberOfChatMessagesToReload:5})),Object(jsx_runtime.jsxs)(Stack.a.Item,{align:"center",className:sendBoxParentStyle,children:[Object(jsx_runtime.jsx)("div",{style:{paddingLeft:"0.5rem",paddingRight:"0.5rem"},children:Object(jsx_runtime.jsx)(dist_esm.l,Object.assign({},typingIndicatorProps))}),Object(jsx_runtime.jsx)(dist_esm.j,Object.assign({},sendBoxProps))]})]}),Object(jsx_runtime.jsx)(Stack.a.Item,{className:participantListWrapper,children:Object(jsx_runtime.jsxs)(Stack.a,{className:participantListStack,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{className:listHeader,children:"In this chat"}),Object(jsx_runtime.jsx)(Stack.a.Item,{className:participantListStyle,children:Object(jsx_runtime.jsx)(dist_esm.h,Object.assign({},participantListProps))})]})})]})]})};ChatScreen_ChatScreen.displayName="ChatScreen",ChatScreen_ChatScreen.__docgenInfo={description:"",methods:[],displayName:"ChatScreen",props:{sendBoxMaxLength:{required:!1,tsType:{name:"number"},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"JSX.Element"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatScreen.tsx"]={name:"ChatScreen",docgenInfo:ChatScreen_ChatScreen.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatScreen.tsx"});var ChatComposite_ChatComposite=function ChatComposite(props){var adapter=props.adapter,fluentTheme=props.fluentTheme,options=props.options,onRenderAvatar=props.onRenderAvatar;return Object(jsx_runtime.jsx)(dist_esm.d,{fluentTheme:fluentTheme,children:Object(jsx_runtime.jsxs)(ChatAdapterProvider_ChatAdapterProvider,{adapter:adapter,children:[Object(jsx_runtime.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"}),Object(jsx_runtime.jsx)(ChatScreen_ChatScreen,{sendBoxMaxLength:null==options?void 0:options.sendBoxMaxLength,onRenderAvatar:onRenderAvatar})]})})};ChatComposite_ChatComposite.displayName="ChatComposite",ChatComposite_ChatComposite.__docgenInfo={description:"",methods:[],displayName:"ChatComposite",props:{adapter:{required:!0,tsType:{name:"ChatAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\nDefaults to a light theme if undefined."},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"JSX.Element"}}},description:""},options:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  sendBoxMaxLength?: number; // Limit max send box length, when change viewport size\n  // messagesPerPage?: number; // Number of messages per page - smaller for better perf\n  // supportNewline: boolean; // Whether to support new line (shift+enter) in textArea, disable until ACS backend supports line switch\n}",signature:{properties:[{key:"sendBoxMaxLength",value:{name:"number",required:!1}}]}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatComposite.tsx"]={name:"ChatComposite",docgenInfo:ChatComposite_ChatComposite.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatComposite.tsx"})},387:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return StatefulChatClient_createStatefulChatClient}));__webpack_require__(45),__webpack_require__(234),__webpack_require__(56),__webpack_require__(41),__webpack_require__(9);var src_chatClient=__webpack_require__(1850),events=(__webpack_require__(113),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(42),__webpack_require__(61),__webpack_require__(70),__webpack_require__(207),__webpack_require__(83),__webpack_require__(772),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(21),__webpack_require__(151)),events_default=__webpack_require__.n(events),immer_esm=__webpack_require__(43),src=__webpack_require__(35),Constants_TYPING_INDICATOR_MAINTAIN_TIME=8e3;new Date(0);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object(immer_esm.b)();var ChatContext_ChatContext=function(){function ChatContext(maxListeners){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ChatContext),this._state={userId:{id:""},displayName:"",threads:new Map},this._batchMode=!1,this._emitter=void 0,this.typingIndicatorInterval=void 0,this._emitter=new events_default.a,maxListeners&&this._emitter.setMaxListeners(maxListeners)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ChatContext,[{key:"setState",value:function setState(state){this._state=state,this._batchMode||this._emitter.emit("stateChanged",this._state)}},{key:"getState",value:function getState(){return this._state}},{key:"setThread",value:function setThread(threadId,threadState){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.threads.set(threadId,threadState)})))}},{key:"createThread",value:function createThread(threadId,properties){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.threads.set(threadId,{chatMessages:new Map,threadId:threadId,properties:properties,participants:new Map,readReceipts:[],typingIndicators:[],latestReadTime:new Date(0)})})))}},{key:"updateChatConfig",value:function updateChatConfig(userId,displayName){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.displayName=displayName,draft.userId=userId})))}},{key:"createThreadIfNotExist",value:function createThreadIfNotExist(threadId,properties){return!this.getState().threads.has(threadId)&&(this.createThread(threadId,properties),!0)}},{key:"updateThread",value:function updateThread(threadId,properties){this.setState(Object(immer_esm.a)(this._state,(function(draft){var thread=draft.threads.get(threadId);thread&&(thread.properties=properties)})))}},{key:"updateThreadTopic",value:function updateThreadTopic(threadId,topic){this.setState(Object(immer_esm.a)(this._state,(function(draft){if(void 0!==topic){var thread=draft.threads.get(threadId);thread&&!thread.properties?thread.properties={topic:topic}:thread&&thread.properties&&(thread.properties.topic=topic)}})))}},{key:"deleteThread",value:function deleteThread(threadId){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.threads.get(threadId)&&draft.threads.delete(threadId)})))}},{key:"setChatMessages",value:function setChatMessages(threadId,messages){var _this=this;this.setState(Object(immer_esm.a)(this._state,(function(draft){var threadState=draft.threads.get(threadId);threadState&&(threadState.chatMessages=messages);var thread=draft.threads.get(threadId);if(thread){var _step,_iterator=_createForOfIteratorHelper(messages.values());try{for(_iterator.s();!(_step=_iterator.n()).done;){var message=_step.value;_this.filterTypingIndicatorForUser(thread,message.sender)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})))}},{key:"updateChatMessageContent",value:function updateChatMessageContent(threadId,messagesId,content){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get,chatMessage=null===(_draft$threads$get=draft.threads.get(threadId))||void 0===_draft$threads$get?void 0:_draft$threads$get.chatMessages.get(messagesId);chatMessage&&(chatMessage.content||(chatMessage.content={}),chatMessage.content.message=content)})))}},{key:"deleteLocalMessage",value:function deleteLocalMessage(threadId,localId){var localMessageDeleted=!1;return this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get2,chatMessages=null===(_draft$threads$get2=draft.threads.get(threadId))||void 0===_draft$threads$get2?void 0:_draft$threads$get2.chatMessages,message=chatMessages?chatMessages.get(localId):void 0;chatMessages&&message&&message.clientMessageId&&(chatMessages.delete(message.clientMessageId),localMessageDeleted=!0)}))),localMessageDeleted}},{key:"deleteMessage",value:function deleteMessage(threadId,id){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get3,chatMessages=null===(_draft$threads$get3=draft.threads.get(threadId))||void 0===_draft$threads$get3?void 0:_draft$threads$get3.chatMessages;null==chatMessages||chatMessages.delete(id)})))}},{key:"setParticipant",value:function setParticipant(threadId,participant){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get4,participants=null===(_draft$threads$get4=draft.threads.get(threadId))||void 0===_draft$threads$get4?void 0:_draft$threads$get4.participants;participants&&participants.set(Object(src.c)(participant.id),participant)})))}},{key:"setParticipants",value:function setParticipants(threadId,participants){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get5,participantsMap=null===(_draft$threads$get5=draft.threads.get(threadId))||void 0===_draft$threads$get5?void 0:_draft$threads$get5.participants;if(participantsMap){var _step2,_iterator2=_createForOfIteratorHelper(participants);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var participant=_step2.value;participantsMap.set(Object(src.c)(participant.id),participant)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}})))}},{key:"deleteParticipants",value:function deleteParticipants(threadId,participantIds){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get6,participants=null===(_draft$threads$get6=draft.threads.get(threadId))||void 0===_draft$threads$get6?void 0:_draft$threads$get6.participants;participants&&participantIds.forEach((function(id){participants.delete(Object(src.c)(id))}))})))}},{key:"deleteParticipant",value:function deleteParticipant(threadId,participantId){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get7,participants=null===(_draft$threads$get7=draft.threads.get(threadId))||void 0===_draft$threads$get7?void 0:_draft$threads$get7.participants;null==participants||participants.delete(Object(src.c)(participantId))})))}},{key:"addReadReceipt",value:function addReadReceipt(threadId,readReceipt){var _this2=this;this.setState(Object(immer_esm.a)(this._state,(function(draft){var thread=draft.threads.get(threadId),readReceipts=null==thread?void 0:thread.readReceipts;thread&&readReceipts&&(readReceipt.sender!==_this2.getState().userId&&thread.latestReadTime<readReceipt.readOn&&(thread.latestReadTime=readReceipt.readOn),readReceipts.push(readReceipt))})))}},{key:"startTypingIndicatorCleanUp",value:function startTypingIndicatorCleanUp(){var _this3=this;this.typingIndicatorInterval||(this.typingIndicatorInterval=window.setInterval((function(){var isTypingActive=!1,isStateChanged=!1,newState=Object(immer_esm.a)(_this3._state,(function(draft){var _step3,_iterator3=_createForOfIteratorHelper(draft.threads.values());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var thread=_step3.value,filteredTypingIndicators=thread.typingIndicators.filter((function(typingIndicator){return Date.now()-typingIndicator.receivedOn.getTime()<Constants_TYPING_INDICATOR_MAINTAIN_TIME}));thread.typingIndicators.length!==filteredTypingIndicators.length&&(isStateChanged=!0,thread.typingIndicators=filteredTypingIndicators),thread.typingIndicators.length>0&&(isTypingActive=!0)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}));isStateChanged&&_this3.setState(newState),!isTypingActive&&_this3.typingIndicatorInterval&&(window.clearInterval(_this3.typingIndicatorInterval),_this3.typingIndicatorInterval=void 0)}),1e3))}},{key:"addTypingIndicator",value:function addTypingIndicator(threadId,typingIndicator){this.setState(Object(immer_esm.a)(this._state,(function(draft){var thread=draft.threads.get(threadId);thread&&thread.typingIndicators.push(typingIndicator)}))),this.startTypingIndicatorCleanUp()}},{key:"setChatMessage",value:function setChatMessage(threadId,message){var _this4=this,messageId=message.id,clientMessageId=message.clientMessageId;(messageId||clientMessageId)&&this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$get8,threadMessages=null===(_draft$threads$get8=draft.threads.get(threadId))||void 0===_draft$threads$get8?void 0:_draft$threads$get8.chatMessages,isLocalIdInMap=threadMessages&&clientMessageId&&threadMessages.get(clientMessageId),messageKey=!messageId||isLocalIdInMap?clientMessageId:messageId;threadMessages&&messageKey&&threadMessages.set(messageKey,message);var thread=draft.threads.get(threadId);thread&&_this4.filterTypingIndicatorForUser(thread,message.sender)})))}},{key:"filterTypingIndicatorForUser",value:function filterTypingIndicatorForUser(thread,userId){if(userId){var typingIndicators=thread.typingIndicators,userIdAsKey=Object(src.c)(userId),filteredTypingIndicators=typingIndicators.filter((function(typingIndicator){return Object(src.c)(typingIndicator.sender)!==userIdAsKey}));filteredTypingIndicators.length!==typingIndicators.length&&(thread.typingIndicators=filteredTypingIndicators)}}},{key:"startBatch",value:function startBatch(){this._batchMode=!0}},{key:"endBatch",value:function endBatch(){this._batchMode=!1,this._emitter.emit("stateChanged",this._state)}},{key:"batch",value:function batch(batchFunc){this.startBatch();var backupState=this._state;try{batchFunc()}catch(e){this._state=backupState}finally{this.endBatch()}}},{key:"onStateChange",value:function onStateChange(handler){this._emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this._emitter.off("stateChanged",handler)}}]),ChatContext}(),convertChatMessage=(__webpack_require__(39),__webpack_require__(10),function convertChatMessage(message){var status=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"delivered",clientMessageId=arguments.length>2?arguments[2]:void 0;return Object.assign({},message,{clientMessageId:clientMessageId,status:status})});var EventSubscriber_EventSubscriber=function EventSubscriber(chatClient,chatContext){var _this=this;!function EventSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EventSubscriber),this.chatClient=void 0,this.chatContext=void 0,this.convertEventToChatMessage=function(event){return convertChatMessage({id:event.id,version:event.version,content:{message:event.message},type:event.type,sender:event.sender,senderDisplayName:event.senderDisplayName,sequenceId:"",createdOn:new Date(event.createdOn)})},this.onChatMessageReceived=function(event){var _this$chatContext$get,newMessage=_this.convertEventToChatMessage(event),existingMessage=null===(_this$chatContext$get=_this.chatContext.getState().threads.get(event.threadId))||void 0===_this$chatContext$get?void 0:_this$chatContext$get.chatMessages.get(event.id);existingMessage&&(newMessage.sequenceId=existingMessage.sequenceId),_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.setChatMessage(event.threadId,newMessage)}))},this.onChatMessageDeleted=function(event){_this.chatContext.deleteMessage(event.threadId,event.id)},this.onChatMessageEdited=function(event){var editedMessage=_this.convertEventToChatMessage(event);_this.chatContext.setChatMessage(event.threadId,convertChatMessage(editedMessage))},this.onParticipantsAdded=function(event){var participantsToAdd=event.participantsAdded.map((function(participant){return Object.assign({},participant,{shareHistoryTime:participant.shareHistoryTime?new Date(participant.shareHistoryTime):void 0})}));_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.setParticipants(event.threadId,participantsToAdd)}))},this.onParticipantsRemoved=function(event){var participantIds=event.participantsRemoved.map((function(participant){return participant.id}));_this.chatContext.deleteParticipants(event.threadId,participantIds)},this.onReadReceiptReceived=function(event){var readReceipt=Object.assign({},event,{sender:event.sender,readOn:new Date(event.readOn)});_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.addReadReceipt(event.threadId,readReceipt)}))},this.onTypingIndicatorReceived=function(typingIndicator){_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(typingIndicator.threadId),_this.chatContext.addTypingIndicator(typingIndicator.threadId,typingIndicator)}))},this.onChatThreadCreated=function(event){var properties={topic:event.properties.topic};_this.chatContext.createThreadIfNotExist(event.threadId,properties)||_this.chatContext.updateThread(event.threadId,properties)},this.onChatThreadDeleted=function(event){_this.chatContext.deleteThread(event.threadId)},this.onChatThreadPropertiesUpdated=function(event){_this.chatContext.updateThread(event.threadId,{topic:event.properties.topic})},this.subscribe=function(){_this.chatClient.on("chatMessageReceived",_this.onChatMessageReceived),_this.chatClient.on("chatMessageDeleted",_this.onChatMessageDeleted),_this.chatClient.on("chatMessageEdited",_this.onChatMessageEdited),_this.chatClient.on("participantsAdded",_this.onParticipantsAdded),_this.chatClient.on("participantsRemoved",_this.onParticipantsRemoved),_this.chatClient.on("readReceiptReceived",_this.onReadReceiptReceived),_this.chatClient.on("typingIndicatorReceived",_this.onTypingIndicatorReceived),_this.chatClient.on("chatThreadCreated",_this.onChatThreadCreated),_this.chatClient.on("chatThreadDeleted",_this.onChatThreadDeleted),_this.chatClient.on("chatThreadPropertiesUpdated",_this.onChatThreadPropertiesUpdated)},this.unsubscribe=function(){_this.chatClient.off("chatMessageReceived",_this.onChatMessageReceived),_this.chatClient.off("chatMessageDeleted",_this.onChatMessageDeleted),_this.chatClient.off("chatMessageEdited",_this.onChatMessageEdited),_this.chatClient.off("participantsAdded",_this.onParticipantsAdded),_this.chatClient.off("participantsRemoved",_this.onParticipantsRemoved),_this.chatClient.off("readReceiptReceived",_this.onReadReceiptReceived),_this.chatClient.off("typingIndicatorReceived",_this.onTypingIndicatorReceived),_this.chatClient.off("chatThreadCreated",_this.onChatThreadCreated),_this.chatClient.off("chatThreadDeleted",_this.onChatThreadDeleted),_this.chatClient.off("chatThreadPropertiesUpdated",_this.onChatThreadPropertiesUpdated)},this.chatClient=chatClient,this.chatContext=chatContext,this.subscribe()},identifierModels=__webpack_require__(386),index_browser=__webpack_require__(829);__webpack_require__(80),__webpack_require__(470);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function createDecoratedIterator_createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function createDecoratedIterator_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return createDecoratedIterator_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return createDecoratedIterator_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function createDecoratedIterator_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var createDecoratedIterator=function createDecoratedIterator(iteratorCreator,context,decorateFn){return function(){var _ref2,_next2,threadsIterator=iteratorCreator.apply(void 0,arguments);return _defineProperty(_ref2={next:(_next2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,threadsIterator.next();case 2:return!(result=_context.sent).done&&result.value&&decorateFn(result.value,context),_context.abrupt("return",result);case 5:case"end":return _context.stop()}}),_callee)}))),function next(){return _next2.apply(this,arguments)})},Symbol.asyncIterator,(function(){return this})),_defineProperty(_ref2,"byPage",(function byPage(){var _next3,settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},pages=threadsIterator.byPage(settings);return _defineProperty({next:(_next3=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result,page;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,pages.next();case 2:return result=_context2.sent,page=result.value,!result.done&&result.value&&context.batch((function(){var _step,_iterator=createDecoratedIterator_createForOfIteratorHelper(page);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _item=_step.value;decorateFn(_item,context)}}catch(err){_iterator.e(err)}finally{_iterator.f()}})),_context2.abrupt("return",result);case 6:case"end":return _context2.stop()}}),_callee2)}))),function next(){return _next3.apply(this,arguments)})},Symbol.asyncIterator,(function(){return this}))})),_ref2}};function StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulChatThreadClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function StatefulChatThreadClient_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var StatefulChatThreadClient_ProxyChatThreadClient=function(){function ProxyChatThreadClient(context){!function StatefulChatThreadClient_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyChatThreadClient),this._context=void 0,this._context=context}return function StatefulChatThreadClient_createClass(Constructor,protoProps,staticProps){return protoProps&&StatefulChatThreadClient_defineProperties(Constructor.prototype,protoProps),staticProps&&StatefulChatThreadClient_defineProperties(Constructor,staticProps),Constructor}(ProxyChatThreadClient,[{key:"get",value:function get(chatThreadClient,prop){var _this=this;switch(prop){case"listMessages":return function createDecoratedListMessages(chatThreadClient,context){return createDecoratedIterator(chatThreadClient.listMessages.bind(chatThreadClient),context,(function setMessage(message,context){context.setChatMessage(chatThreadClient.threadId,convertChatMessage(message))}))}(chatThreadClient,this._context);case"getMessage":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var message,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,chatThreadClient.getMessage.apply(chatThreadClient,_args);case 2:return message=_context.sent,_this._context.setChatMessage(chatThreadClient.threadId,convertChatMessage(message)),_context.abrupt("return",message);case 5:case"end":return _context.stop()}}),_callee)})));case"sendMessage":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _result,_ref3,content,clientMessageId,newMessage,result,_args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _ref3=_args2.length<=0?void 0:_args2[0],content=_ref3.content,clientMessageId=Object(index_browser.a)(),newMessage={content:{message:content},clientMessageId:clientMessageId,id:"",type:"text",sequenceId:"",version:"",createdOn:new Date,status:"sending",senderDisplayName:_this._context.getState().displayName,sender:_this._context.getState().userId},_this._context.setChatMessage(chatThreadClient.threadId,newMessage),result=void 0,_context2.prev=5,_context2.next=8,chatThreadClient.sendMessage.apply(chatThreadClient,_args2);case 8:result=_context2.sent,_context2.next=15;break;case 11:throw _context2.prev=11,_context2.t0=_context2.catch(5),_this._context.setChatMessage(chatThreadClient.threadId,Object.assign({},newMessage,{status:"failed"})),_context2.t0;case 15:return null!==(_result=result)&&void 0!==_result&&_result.id&&_this._context.batch((function(){result&&(_this._context.setChatMessage(chatThreadClient.threadId,Object.assign({},newMessage,{clientMessageId:void 0,status:"delivered",id:result.id})),_this._context.deleteLocalMessage(chatThreadClient.threadId,clientMessageId))})),_context2.abrupt("return",result);case 17:case"end":return _context2.stop()}}),_callee2,null,[[5,11]])})));case"addParticipants":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _len,args,_key,result,addRequest,participantsToAdd,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:for(_len=_args3.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=_args3[_key];return _context3.next=3,chatThreadClient.addParticipants.apply(chatThreadClient,args);case 3:return result=_context3.sent,addRequest=args[0],participantsToAdd=addRequest.participants,_this._context.setParticipants(chatThreadClient.threadId,participantsToAdd),_context3.abrupt("return",result);case 8:case"end":return _context3.stop()}}),_callee3)})));case"deleteMessage":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _len2,args,_key2,messageId,result,_args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:for(_len2=_args4.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=_args4[_key2];if(messageId=args[0],!_this._context.deleteLocalMessage(chatThreadClient.threadId,messageId)){_context4.next=4;break}return _context4.abrupt("return",{});case 4:return _context4.next=6,chatThreadClient.deleteMessage.apply(chatThreadClient,args);case 6:return result=_context4.sent,_this._context.deleteMessage(chatThreadClient.threadId,messageId),_context4.abrupt("return",result);case 9:case"end":return _context4.stop()}}),_callee4)})));case"listParticipants":return function createDecoratedListParticipants(chatThreadClient,context){return createDecoratedIterator(chatThreadClient.listParticipants.bind(chatThreadClient),context,(function setParticipant(participant,context){context.setParticipant(chatThreadClient.threadId,participant)}))}(chatThreadClient,this._context);case"listReadReceipts":return function createDecoratedListReadReceipts(chatThreadClient,context){return createDecoratedIterator(chatThreadClient.listReadReceipts.bind(chatThreadClient),context,(function setReadReceipt(readReceipt,context){context.addReadReceipt(chatThreadClient.threadId,Object.assign({},readReceipt))}))}(chatThreadClient,this._context);case"removeParticipant":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _len3,args,_key3,result,removeIdentifier,_args5=arguments;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:for(_len3=_args5.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=_args5[_key3];return _context5.next=3,chatThreadClient.removeParticipant.apply(chatThreadClient,args);case 3:return result=_context5.sent,removeIdentifier=args[0],_this._context.deleteParticipant(chatThreadClient.threadId,Object(identifierModels.a)(removeIdentifier)),_context5.abrupt("return",result);case 7:case"end":return _context5.stop()}}),_callee5)})));case"updateMessage":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var _len4,args,_key4,result,messageId,updateOption,_args6=arguments;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:for(_len4=_args6.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=_args6[_key4];return _context6.next=3,chatThreadClient.updateMessage.apply(chatThreadClient,args);case 3:return result=_context6.sent,messageId=args[0],updateOption=args[1],_this._context.updateChatMessageContent(chatThreadClient.threadId,messageId,null==updateOption?void 0:updateOption.content),_context6.abrupt("return",result);case 7:case"end":return _context6.stop()}}),_callee6)})));case"updateTopic":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){var _len5,args,_key5,result,topic,_args7=arguments;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:for(_len5=_args7.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=_args7[_key5];return _context7.next=3,chatThreadClient.updateTopic.apply(chatThreadClient,args);case 3:return result=_context7.sent,topic=args[0],_this._context.updateThreadTopic(chatThreadClient.threadId,topic),_context7.abrupt("return",result);case 7:case"end":return _context7.stop()}}),_callee7)})));case"getProperties":return StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){var result,_args8=arguments;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,chatThreadClient.getProperties.apply(chatThreadClient,_args8);case 2:return result=_context8.sent,_this._context.updateThread(chatThreadClient.threadId,result),_context8.abrupt("return",result);case 5:case"end":return _context8.stop()}}),_callee8)})));default:return Reflect.get(chatThreadClient,prop)}}}]),ProxyChatThreadClient}(),chatThreadClientDeclaratify=function chatThreadClientDeclaratify(chatThreadClient,context){return context.createThreadIfNotExist(chatThreadClient.threadId),new Proxy(chatThreadClient,new StatefulChatThreadClient_ProxyChatThreadClient(context))};function StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulChatClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var proxyChatClient={get:function get(chatClient,prop,receiver){if("context"===prop)return Reflect.get(chatClient,prop);var context=receiver.context;switch(prop){case"createChatThread":return StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _len,args,_key,result,thread,request,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:for(_len=_args.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=_args[_key];return _context.next=3,chatClient.createChatThread.apply(chatClient,args);case 3:return result=_context.sent,(thread=result.chatThread)&&(request=args[0],context.createThread(thread.id,{topic:request.topic})),_context.abrupt("return",result);case 7:case"end":return _context.stop()}}),_callee)})));case"deleteChatThread":return StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result,_args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,chatClient.deleteChatThread.apply(chatClient,_args2);case 2:return result=_context2.sent,context.deleteThread(_args2.length<=0?void 0:_args2[0]),_context2.abrupt("return",result);case 5:case"end":return _context2.stop()}}),_callee2)})));case"listChatThreads":return function createDecoratedListThreads(chatClient,context){return createDecoratedIterator(chatClient.listChatThreads.bind(chatClient),context,(function setThreadProperties(chatThreadItem,context){var properties={topic:chatThreadItem.topic};context.createThreadIfNotExist(chatThreadItem.id,properties)||context.updateThread(chatThreadItem.id,properties)}))}(chatClient,context);case"getChatThreadClient":return function(){var chatThreadClient=chatClient.getChatThreadClient.apply(chatClient,arguments);return chatThreadClientDeclaratify(chatThreadClient,context)};case"startRealtimeNotifications":return StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var ret,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,chatClient.startRealtimeNotifications.apply(chatClient,_args3);case 2:return ret=_context3.sent,receiver.eventSubscriber||(receiver.eventSubscriber=new EventSubscriber_EventSubscriber(chatClient,context)),_context3.abrupt("return",ret);case 5:case"end":return _context3.stop()}}),_callee3)})));case"stopRealtimeNotifications":return StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var ret,_args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,chatClient.stopRealtimeNotifications.apply(chatClient,_args4);case 2:return ret=_context4.sent,receiver.eventSubscriber&&(receiver.eventSubscriber.unsubscribe(),receiver.eventSubscriber=void 0),_context4.abrupt("return",ret);case 5:case"end":return _context4.stop()}}),_callee4)})));default:return Reflect.get(chatClient,prop)}}},StatefulChatClient_createStatefulChatClient=function createStatefulChatClient(args,options){var eventSubscriber,chatClient=new src_chatClient.a(args.endpoint,args.credential,null==options?void 0:options.chatClientOptions),context=new ChatContext_ChatContext(null==options?void 0:options.maxStateChangeListeners);context.updateChatConfig(args.userId,args.displayName);var proxy=new Proxy(chatClient,proxyChatClient);return Object.defineProperty(proxy,"context",{configurable:!1,get:function get(){return context}}),Object.defineProperty(proxy,"eventSubscriber",{configurable:!1,get:function get(){return eventSubscriber},set:function set(val){eventSubscriber=val}}),Object.defineProperty(proxy,"getState",{configurable:!1,value:function value(){return null==context?void 0:context.getState()}}),Object.defineProperty(proxy,"onStateChange",{configurable:!1,value:function value(handler){return null==context?void 0:context.onStateChange(handler)}}),Object.defineProperty(proxy,"offStateChange",{configurable:!1,value:function value(handler){return null==context?void 0:context.offStateChange(handler)}}),proxy}},416:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PermissionsBanner}));__webpack_require__(21),__webpack_require__(8),__webpack_require__(19),__webpack_require__(9),__webpack_require__(22),__webpack_require__(17),__webpack_require__(15),__webpack_require__(16),__webpack_require__(20),__webpack_require__(13),__webpack_require__(24);var react__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0),_fluentui_react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1696),_fluentui_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(57),_fluentui_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1697),_common_styles_PermissionsBanner_styles__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(279),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var PermissionsBanner=function PermissionsBanner(props){var cameraPermissionGranted=props.cameraPermissionGranted,microphonePermissionGranted=props.microphonePermissionGranted,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_11__.useState)(!1),2),dismissedCameraBanner=_useState2[0],setDismissedCameraBanner=_useState2[1],_useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_11__.useState)(!1),2),dismissedMicrophoneBanner=_useState4[0],setDismissedMicrophoneBanner=_useState4[1],bannerMessage=Object(react__WEBPACK_IMPORTED_MODULE_11__.useMemo)((function(){return function getPermissionsBannerMessage(cameraPermissionGranted,microphonePermissionGranted,dismissedCameraBanner,dismissedMicrophoneBanner){var showCameraMessage=void 0!==cameraPermissionGranted&&!cameraPermissionGranted&&!dismissedCameraBanner,showMicrophoneMessage=void 0!==microphonePermissionGranted&&!microphonePermissionGranted&&!dismissedMicrophoneBanner;return showCameraMessage&&showMicrophoneMessage?"Camera and microphone use is blocked by your browser.":showCameraMessage?"Camera use is blocked by your browser.":showMicrophoneMessage?"Microphone use is blocked by your browser.":""}(cameraPermissionGranted,microphonePermissionGranted,dismissedCameraBanner,dismissedMicrophoneBanner)}),[cameraPermissionGranted,microphonePermissionGranted,dismissedCameraBanner,dismissedMicrophoneBanner]),dismissBanner=Object(react__WEBPACK_IMPORTED_MODULE_11__.useCallback)((function(){void 0===cameraPermissionGranted||cameraPermissionGranted||setDismissedCameraBanner(!0),void 0===microphonePermissionGranted||microphonePermissionGranted||setDismissedMicrophoneBanner(!0)}),[cameraPermissionGranted,microphonePermissionGranted]);return""===bannerMessage?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_12__.a,{styles:_common_styles_PermissionsBanner_styles__WEBPACK_IMPORTED_MODULE_15__.b,messageBarType:_fluentui_react__WEBPACK_IMPORTED_MODULE_13__.a.warning,isMultiline:!1,actions:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_14__.a,{onClick:dismissBanner,children:"Dismiss"}),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("b",{children:bannerMessage})," ","Grant permission by clicking the lock in the address bar and selecting 'Allow'."]})};PermissionsBanner.__docgenInfo={description:"Shows a banner notifying user if camera or microphone permission is denied and also instructions on how to allow the\nnecessary permissions. If either camera or microphone permission is true or undefined then no banner for those items\nare show. This banner will not show anything if the permission (undefined) has been requested but user has not\nresponded to it. Sample app/composite will always request permission so the case of permission not requested is\nassumed to not happen by this component. If the banner was dismissed, it will be dismissed for the current state of\nthe props and stay dismissed even if permission change after dismissal.\n\n@param props {@Link PermissionsBannerProps}",methods:[],displayName:"PermissionsBanner",props:{cameraPermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"If cameraPermission is true or undefined, no banner is shown for camera."},microphonePermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"If microphonePermission is true or undefined, no banner is shown for microphone."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/PermissionsBanner.tsx"]={name:"PermissionsBanner",docgenInfo:PermissionsBanner.__docgenInfo,path:"../react-composites/src/composites/common/PermissionsBanner.tsx"})},417:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return VideoTileExample}));var _azure_communication_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_utils__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(128)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1),VideoTileExample=function VideoTileExample(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.f,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.s,{isVideoReady:!0,renderElement:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.p,{videoStreamElement:Object(_utils__WEBPACK_IMPORTED_MODULE_2__.a)()}),displayName:"Jack Reacher",isMirrored:!0,styles:{root:{height:"300px",width:"400px"},videoContainer:{border:"5px solid firebrick"},overlayContainer:{background:"rgba(165, 13, 13, 0.5)"},displayNameContainer:{top:"1rem",bottom:"auto",right:"1rem",left:"auto",backgroundColor:"blue"}}})})};VideoTileExample.displayName="VideoTileExample",VideoTileExample.__docgenInfo={description:"",methods:[],displayName:"VideoTileExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Styling/snippets/StylingVideoTile.snippet.tsx"]={name:"VideoTileExample",docgenInfo:VideoTileExample.__docgenInfo,path:"stories/Styling/snippets/StylingVideoTile.snippet.tsx"})},419:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(1)),CallComponentText=__webpack_require__(1615).default,ComplianceBannerText=__webpack_require__(1616).default,LobbyComponentText=__webpack_require__(1617).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Title,{children:"Teams Interop"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Description,{children:"Azure Communication Services applications can inter-operate with Microsoft Teams. There are some additional considerations when connecting to a Teams meeting."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Heading,{children:"Compliance notifications for recording and transcription"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Description,{children:"This example shows how you might notify your users when a Teams meeting is being recorded or transcribed. Here, a MessageBar is optionally added to the video frame:"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Subheading,{children:"Create Compliance Banner"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Source,{code:ComplianceBannerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Subheading,{children:"Use Compliance Banner"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Source,{code:CallComponentText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Title,{children:"Lobby Component"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Description,{children:"The Lobby component can be used for scenarios where the call is in a waiting state."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Heading,{children:"Create a Lobby Component"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs_blocks__WEBPACK_IMPORTED_MODULE_0__.Source,{code:LobbyComponentText})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/TeamsInteropDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/Examples/TeamsInterop/TeamsInteropDocs.tsx"})},551:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, StreamMedia, VideoTile, VideoTileStylesProps } from '@azure/communication-react';\nimport React from 'react';\nimport { renderVideoStream } from '../../utils';\n\nexport const VideoTileExample: () => JSX.Element = () => {\n  const customStyles: VideoTileStylesProps = {\n    root: { height: '300px', width: '400px' },\n    videoContainer: { border: '5px solid firebrick' },\n    overlayContainer: { background: 'rgba(165, 13, 13, 0.5)' },\n    displayNameContainer: { top: '1rem', bottom: 'auto', right: '1rem', left: 'auto', backgroundColor: 'blue' }\n  };\n\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        isVideoReady={true}\n        renderElement={\n          // NOTE: Replace with your own video provider. (An html element with video stream)\n          <StreamMedia videoStreamElement={renderVideoStream()} />\n        }\n        displayName={'Jack Reacher'}\n        isMirrored={true}\n        styles={customStyles}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},6:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"x",(function(){return src.c})),__webpack_require__.d(__webpack_exports__,"q",(function(){return TypingIndicator_TypingIndicator})),__webpack_require__.d(__webpack_exports__,"g",(function(){return GridLayout_GridLayout})),__webpack_require__.d(__webpack_exports__,"o",(function(){return SendBox_SendBox})),__webpack_require__.d(__webpack_exports__,"h",(function(){return MessageStatusIndicator_MessageStatusIndicator})),__webpack_require__.d(__webpack_exports__,"i",(function(){return MessageThread_MessageThread})),__webpack_require__.d(__webpack_exports__,"p",(function(){return StreamMedia_StreamMedia})),__webpack_require__.d(__webpack_exports__,"l",(function(){return ParticipantItem_ParticipantItem})),__webpack_require__.d(__webpack_exports__,"m",(function(){return ParticipantList_ParticipantList})),__webpack_require__.d(__webpack_exports__,"r",(function(){return VideoGallery_VideoGallery})),__webpack_require__.d(__webpack_exports__,"b",(function(){return CameraButton_CameraButton})),__webpack_require__.d(__webpack_exports__,"d",(function(){return ControlBar_ControlBar})),__webpack_require__.d(__webpack_exports__,"e",(function(){return EndCallButton_EndCallButton})),__webpack_require__.d(__webpack_exports__,"j",(function(){return MicrophoneButton_MicrophoneButton})),__webpack_require__.d(__webpack_exports__,"k",(function(){return OptionsButton_OptionsButton})),__webpack_require__.d(__webpack_exports__,"n",(function(){return ScreenShareButton_ScreenShareButton})),__webpack_require__.d(__webpack_exports__,"s",(function(){return VideoTile_VideoTile})),__webpack_require__.d(__webpack_exports__,"w",(function(){return lightTheme})),__webpack_require__.d(__webpack_exports__,"v",(function(){return darkTheme})),__webpack_require__.d(__webpack_exports__,"f",(function(){return FluentThemeProvider_FluentThemeProvider})),__webpack_require__.d(__webpack_exports__,"u",(function(){return ChatComposite.b})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ChatComposite.a})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CallComposite.a})),__webpack_require__.d(__webpack_exports__,"t",(function(){return CallComposite.b}));var src=__webpack_require__(35),lib=(__webpack_require__(100),__webpack_require__(188),__webpack_require__(269),__webpack_require__(387),__webpack_require__(61),__webpack_require__(50),__webpack_require__(83),__webpack_require__(20),__webpack_require__(9),__webpack_require__(13),__webpack_require__(24),__webpack_require__(17),__webpack_require__(8),__webpack_require__(19),__webpack_require__(22),__webpack_require__(15),__webpack_require__(16),__webpack_require__(21),__webpack_require__(34)),typingIndicatorContainerStyle=Object(lib.G)({height:"2.125rem",display:"flex",alignItems:"center"}),typingIndicatorListStyle=Object(lib.G)({fontWeight:400,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0.1875rem"}),typingIndicatorVerbStyle=Object(lib.G)({fontWeight:400,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0.1875rem"}),react=(Object(lib.G)({width:"2.125rem",height:"2.125rem",paddingRight:"0.1875rem"}),__webpack_require__(0)),react_default=__webpack_require__.n(react),Stack=__webpack_require__(435),jsx_runtime=__webpack_require__(1);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TypingIndicator_getDefaultComponents=function getDefaultComponents(typingUsers,styles){var _step,displayComponents=[],typingUsersMentioned=[],countOfUsersMentioned=0,totalCharacterCount=0,_iterator=_createForOfIteratorHelper(typingUsers);try{for(_iterator.s();!(_step=_iterator.n()).done;){var typingUser=_step.value,additionalCharCount=2*(countOfUsersMentioned-1)+(typingUser.displayName?typingUser.displayName.length:0);if(!(totalCharacterCount+additionalCharCount<=35||1===countOfUsersMentioned))break;typingUsersMentioned.push(typingUser),totalCharacterCount+=additionalCharCount,countOfUsersMentioned+=1}}catch(err){_iterator.e(err)}finally{_iterator.f()}typingUsersMentioned.forEach((function(typingUser,index){displayComponents.push(Object(jsx_runtime.jsx)("span",{className:Object(lib.G)(typingIndicatorListStyle,null==styles?void 0:styles.typingUserDisplayName),children:index<typingUsers.length-1?typingUser.displayName+", ":typingUser.displayName},"typing indicator display string ".concat(index)))}));var countOfUsersNotMentioned=typingUsers.length-typingUsersMentioned.length;return countOfUsersNotMentioned>0&&displayComponents.push(Object(jsx_runtime.jsx)("span",{className:Object(lib.G)(typingIndicatorVerbStyle,null==styles?void 0:styles.typingString),children:" and ".concat(countOfUsersNotMentioned," other").concat(1===countOfUsersNotMentioned?"":"s")},"UsersCountKey")),displayComponents},defaultTypingString=function defaultTypingString(typingUsers){return typingUsers.length>0?typingUsers.length>1?" are typing...":" is typing...":""},TypingIndicator_TypingIndicator=function TypingIndicator(props){var typingUsers=props.typingUsers,typingString=props.typingString,onRenderUsers=props.onRenderUsers,styles=props.styles,typingUsersToRender=onRenderUsers?typingUsers:typingUsers.filter((function(typingUser){return void 0!==typingUser.displayName}));return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.G)(typingIndicatorContainerStyle,null==styles?void 0:styles.root),children:[onRenderUsers?onRenderUsers(typingUsersToRender):TypingIndicator_getDefaultComponents(typingUsersToRender,styles),Object(jsx_runtime.jsx)("span",{className:Object(lib.G)(typingIndicatorVerbStyle,null==styles?void 0:styles.typingString),children:null!=typingString?typingString:defaultTypingString(typingUsersToRender)},"TypingStringKey")]})};TypingIndicator_TypingIndicator.displayName="TypingIndicator",TypingIndicator_TypingIndicator.__docgenInfo={description:"Typing Indicator is used to notify users if there are any other users typing in the thread.",methods:[],displayName:"TypingIndicator",props:{typingUsers:{required:!0,tsType:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"},description:"List of the typing users."},typingString:{required:!1,tsType:{name:"string"},description:"The string to render after listing all users' display name. For example ' are typing ...'."},onRenderUsers:{required:!1,tsType:{name:"signature",type:"function",raw:"(users: CommunicationParticipant[]) => JSX.Element",signature:{arguments:[{name:"users",type:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"}}],return:{name:"JSX.Element"}}},description:"Callback to render typing users"},styles:{required:!1,tsType:{name:"TypingIndicatorStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<TypingIndicator styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/TypingIndicator.tsx"]={name:"TypingIndicator",docgenInfo:TypingIndicator_TypingIndicator.__docgenInfo,path:"../react-components/src/components/TypingIndicator.tsx"});var gridLayoutStyle=Object(lib.G)({height:"100%",display:"grid",flexGrow:"1",gap:".5rem",padding:".5rem"});function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function GridLayout_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return GridLayout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GridLayout_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GridLayout_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var GridLayout_GridLayout=function GridLayout(props){var _useState2=_slicedToArray(Object(react.useState)(1),2),gridCol=_useState2[0],setGridCol=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(1),2),gridRow=_useState4[0],setGridRow=_useState4[1],children=props.children,_props$layout=props.layout,layout=void 0===_props$layout?"standard":_props$layout,styles=props.styles,numberOfChildren=react_default.a.Children.count(children);switch(layout){case"standard":var numberOfColumns=function calculateStandardLayoutColumns(numberOfItems){return numberOfItems>0?Math.ceil(Math.sqrt(numberOfItems)):1}(numberOfChildren);gridCol!==numberOfColumns&&setGridCol(numberOfColumns);var numberOfRows=function calculateStandardLayoutRows(numberOfItems,gridCol){return Math.ceil(numberOfItems/gridCol)}(numberOfChildren,gridCol);gridRow!==numberOfRows&&setGridRow(numberOfRows)}return Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(gridLayoutStyle,null==styles?void 0:styles.root),style:{gridTemplateRows:"repeat(".concat(gridRow,", minmax(0, 1fr))"),gridTemplateColumns:"repeat(".concat(gridCol,", 1fr)")},children:children})};GridLayout_GridLayout.displayName="GridLayout",GridLayout_GridLayout.__docgenInfo={description:"",methods:[],displayName:"GridLayout",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},layout:{required:!1,tsType:{name:"literal",value:"'standard'"},description:""},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<GridLayout styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/GridLayout.tsx"]={name:"GridLayout",docgenInfo:GridLayout_GridLayout.__docgenInfo,path:"../react-components/src/components/GridLayout.tsx"});var TextField=__webpack_require__(1857),SendIcon=__webpack_require__(1809),sendBoxWrapperStyle=Object(lib.G)({padding:"0.0625rem"}),sendBoxStyle=Object(lib.G)({minHeight:"0",maxHeight:"8.25rem",outline:"red 5px",fontWeight:400,fontSize:"0.875rem",width:"100%",height:"2.25rem",lineHeight:"1.5rem","::-webkit-input-placeholder":{fontSize:"0.875rem"},"::-moz-placeholder":{fontSize:"0.875rem"},":-moz-placeholder":{fontSize:"0.875rem"}}),sendButtonStyle=Object(lib.G)({width:"2.25rem",color:"grey",right:"0.125rem",cursor:"pointer",display:"flex",justifyContent:"center",position:"absolute",top:"0.875rem"}),sendIconStyle=Object(lib.G)({width:"1.0625rem",height:"1.0625rem"}),useTheme=__webpack_require__(402),isDarkThemed=(__webpack_require__(515),__webpack_require__(314),__webpack_require__(371),function isDarkThemed(theme){var themeBlackBrightness=getPerceptualBrightnessOfHexColor(theme.palette.black),themeWhiteBrightness=getPerceptualBrightnessOfHexColor(theme.palette.white);return!Number.isNaN(themeBlackBrightness)&&!Number.isNaN(themeWhiteBrightness)&&themeBlackBrightness>themeWhiteBrightness}),getPerceptualBrightnessOfHexColor=function getPerceptualBrightnessOfHexColor(hexColor){return/^#[0-9A-Fa-f]{6}$/i.test(hexColor)?(parseInt(hexColor.substring(1,3),16)+parseInt(hexColor.substring(3,5),16)+parseInt(hexColor.substring(5,7),16))/3:NaN};function SendBox_slicedToArray(arr,i){return function SendBox_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function SendBox_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function SendBox_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return SendBox_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SendBox_arrayLikeToArray(o,minLen)}(arr,i)||function SendBox_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SendBox_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var EMPTY_MESSAGE_REGEX=/^\s*$/,TEXT_EXCEEDS_LIMIT="Your message is over the limit of ".concat(8e3," characters"),SendBox_SendBox=function SendBox(props){var disabled=props.disabled,systemMessage=props.systemMessage,supportNewline=props.supportNewline,onSendMessage=props.onSendMessage,onTyping=props.onTyping,onRenderIcon=props.onRenderIcon,onRenderSystemMessage=props.onRenderSystemMessage,styles=props.styles,theme=Object(useTheme.a)(),_useState2=SendBox_slicedToArray(Object(react.useState)(""),2),textValue=_useState2[0],setTextValue=_useState2[1],_useState4=SendBox_slicedToArray(Object(react.useState)(!1),2),textValueOverflow=_useState4[0],setTextValueOverflow=_useState4[1],_useState6=SendBox_slicedToArray(Object(react.useState)(!1),2),isMouseOverSendIcon=_useState6[0],setIsMouseOverSendIcon=_useState6[1],sendTextFieldRef=react_default.a.useRef(null),sendMessageOnClick=function sendMessageOnClick(){var _sendTextFieldRef$cur;disabled||textValueOverflow||(EMPTY_MESSAGE_REGEX.test(textValue)||(onSendMessage&&onSendMessage(textValue),setTextValue("")),null===(_sendTextFieldRef$cur=sendTextFieldRef.current)||void 0===_sendTextFieldRef$cur||_sendTextFieldRef$cur.focus())},errorMessage=null!=systemMessage?systemMessage:textValueOverflow?TEXT_EXCEEDS_LIMIT:void 0,mergedRootStyle=Object(lib.G)(sendBoxWrapperStyle,null==styles?void 0:styles.root),mergedTextFieldStyle=Object(lib.q)(function textFieldStyle(errorColor,hasErrorMessage,disabled){var borderColor=hasErrorMessage?errorColor:"none";return{root:{width:"100%",minHeight:"0",fontSize:"8.25rem"},wrapper:{},fieldGroup:{height:"auto",minHeight:"0",borderRadius:"0.25rem",borderColor:borderColor,borderWidth:disabled?"0px":"1px",selectors:{":hover":{borderColor:borderColor},":active":{borderColor:borderColor},":after":{borderColor:borderColor,borderRadius:"0.25rem"}}},field:{borderRadius:"0.25rem"},errorMessage:{color:errorColor}}}(isDarkThemed(theme)?"#f1707b":"#a80000",!!errorMessage,!!disabled),{fieldGroup:null==styles?void 0:styles.textField,errorMessage:null==styles?void 0:styles.systemMessage}),mergedSendButtonStyle=Object(lib.G)(sendButtonStyle,null==styles?void 0:styles.sendMessageIconContainer),mergedSendIconStyle=Object(lib.G)(sendIconStyle,{color:errorMessage||!textValue&&!isMouseOverSendIcon?theme.palette.neutralTertiary:theme.palette.themePrimary},null==styles?void 0:styles.sendMessageIcon);return Object(jsx_runtime.jsx)(Stack.a,{className:mergedRootStyle,children:Object(jsx_runtime.jsxs)("div",{style:{position:"relative",padding:"0.1875rem"},children:[Object(jsx_runtime.jsx)(TextField.a,{multiline:!0,autoAdjustHeight:!0,multiple:!1,resizable:!1,componentRef:sendTextFieldRef,id:"sendbox",ariaLabel:"Type",inputClassName:sendBoxStyle,placeholder:"Enter a message",value:textValue,onChange:function setText(e){e.target.value.length>8e3?setTextValueOverflow(!0):setTextValueOverflow(!1),setTextValue(e.target.value)},autoComplete:"off",onKeyDown:function onKeyDown(ev){"Enter"!==ev.key||!1!==ev.shiftKey&&supportNewline||textValueOverflow||(ev.preventDefault(),sendMessageOnClick()),onTyping&&onTyping()},styles:mergedTextFieldStyle,disabled:disabled,errorMessage:onRenderSystemMessage?onRenderSystemMessage(errorMessage):errorMessage}),Object(jsx_runtime.jsx)("div",{className:mergedSendButtonStyle,onClick:function onClick(e){textValueOverflow||sendMessageOnClick(),e.stopPropagation()},id:"sendIconWrapper",onMouseEnter:function onMouseEnter(){setIsMouseOverSendIcon(!0)},onMouseLeave:function onMouseLeave(){setIsMouseOverSendIcon(!1)},children:onRenderIcon?onRenderIcon(props,isMouseOverSendIcon):Object(jsx_runtime.jsx)(SendIcon.a,{className:mergedSendIconStyle,outline:!!errorMessage||!(textValue||isMouseOverSendIcon)})})]})})};SendBox_SendBox.displayName="SendBox",SendBox_SendBox.__docgenInfo={description:"`SendBox` is a component for users to send messages and typing notifications. An optional message\ncan also be shown below the `SendBox`.",methods:[],displayName:"SendBox",props:{disabled:{required:!1,tsType:{name:"boolean"},description:"Optional boolean to disable text box\n@defaultValue false"},systemMessage:{required:!1,tsType:{name:"string"},description:"Optional text for system message below text box"},onSendMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(content: string) => Promise<void>",signature:{arguments:[{name:"content",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback called when message is sent"},onTyping:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback called when user is typing"},onRenderSystemMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(systemMessage: string | undefined) => React.ReactElement",signature:{arguments:[{name:"systemMessage",type:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}}],return:{name:"ReactReactElement",raw:"React.ReactElement"}}},description:"Optional callback to render system message below the SendBox.\n@defaultValue MessageBar"},supportNewline:{required:!1,tsType:{name:"boolean"},description:"Optional boolean to support new line in SendBox.\n@defaultValue false"},onRenderIcon:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: SendBoxProps, isMouseOverSendIcon: boolean) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"SendBoxProps"}},{name:"isMouseOverSendIcon",type:{name:"boolean"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render send button icon to the right of the SendBox.\n@defaultValue SendIcon"},styles:{required:!1,tsType:{name:"SendBoxStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<SendBox styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/SendBox.tsx"]={name:"SendBox",docgenInfo:SendBox_SendBox.__docgenInfo,path:"../react-components/src/components/SendBox.tsx"});var TooltipHost=__webpack_require__(1856),palette=Object(lib.B)().palette,MessageStatusIndicatorErrorIconStyle=Object(lib.G)({marginRight:"-0.06rem",fontSize:"1.06rem",color:palette.redDark}),MessageStatusIndicatorIconStyle=Object(lib.G)({fontSize:"1rem",color:palette.blue}),ErrorIcon=__webpack_require__(1811),CircleRingIcon=__webpack_require__(1812),CompletedIcon=__webpack_require__(1814),MessageSeenIcon=__webpack_require__(1813),MessageStatusIndicator_MessageStatusIndicator=function MessageStatusIndicator(props){var status=props.status,_props$deliveredToolt=props.deliveredTooltipText,deliveredTooltipText=void 0===_props$deliveredToolt?"Sent":_props$deliveredToolt,_props$seenTooltipTex=props.seenTooltipText,seenTooltipText=void 0===_props$seenTooltipTex?"Seen":_props$seenTooltipTex,_props$sendingTooltip=props.sendingTooltipText,sendingTooltipText=void 0===_props$sendingTooltip?"Sending":_props$sendingTooltip,_props$failedToSendTo=props.failedToSendTooltipText,failedToSendTooltipText=void 0===_props$failedToSendTo?"Failed to send":_props$failedToSendTo,_props$size=props.size,size=void 0===_props$size?"medium":_props$size,styles=props.styles;switch(status){case"failed":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:failedToSendTooltipText,children:Object(jsx_runtime.jsx)(ErrorIcon.a,{className:Object(lib.G)(MessageStatusIndicatorErrorIconStyle,null==styles?void 0:styles.root)})});case"sending":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:sendingTooltipText,children:Object(jsx_runtime.jsx)(CircleRingIcon.a,{className:Object(lib.G)(MessageStatusIndicatorIconStyle,null==styles?void 0:styles.root)})});case"seen":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:seenTooltipText,children:Object(jsx_runtime.jsx)(MessageSeenIcon.a,{size:size,className:Object(lib.G)(null==styles?void 0:styles.root)})});case"delivered":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:deliveredTooltipText,children:Object(jsx_runtime.jsx)(CompletedIcon.a,{className:Object(lib.G)(MessageStatusIndicatorIconStyle,null==styles?void 0:styles.root)})});default:return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}};MessageStatusIndicator_MessageStatusIndicator.__docgenInfo={description:"MessageStatusIndicator component.",methods:[],displayName:"MessageStatusIndicator",props:{status:{required:!1,tsType:{name:"MessageStatus"},description:"Message status that determines the icon to display."},deliveredTooltipText:{required:!1,tsType:{name:"string"},description:"Text to display in the delivered message icon tooltip."},seenTooltipText:{required:!1,tsType:{name:"string"},description:"Text to display in the seen message icon tooltip."},sendingTooltipText:{required:!1,tsType:{name:"string"},description:"Text to display in the sending message icon tooltip."},failedToSendTooltipText:{required:!1,tsType:{name:"string"},description:"Text to display in the failed message icon tooltip."},size:{required:!1,tsType:{name:"SizeValue"},description:"Size of the message status icon."},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<MessageStatus styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MessageStatusIndicator.tsx"]={name:"MessageStatusIndicator",docgenInfo:MessageStatusIndicator_MessageStatusIndicator.__docgenInfo,path:"../react-components/src/components/MessageStatusIndicator.tsx"});__webpack_require__(45),__webpack_require__(42),__webpack_require__(39),__webpack_require__(41);var dist=__webpack_require__(405),dist_default=__webpack_require__.n(dist),Chat=__webpack_require__(1861),Text=__webpack_require__(240),Flex=__webpack_require__(1873),Ref=__webpack_require__(1862),messageThreadContainerStyle=Object(lib.G)({height:"100%",width:"100%",maxHeight:"100%",overflow:"auto",position:"relative"}),noMessageStatusStyle=Object(lib.G)({width:"1rem"}),chatStyle={paddingBottom:"0.5rem",border:"none",overflow:"auto"},newMessageButtonContainerStyle=Object(lib.G)({position:"absolute",zIndex:1,bottom:0,right:"1.5rem"}),chatMessageStyle={overflowY:"hidden"},chatMessageDateStyle={fontWeight:600},MessageThread_styles_messageStatusContainerStyle=function messageStatusContainerStyle(mine){return Object(lib.G)({marginLeft:mine?"1rem":"0rem"})},newMessageButtonStyle=Object(lib.G)({float:"right",width:"fit-content"}),DownIconStyle=(Object(lib.G)({border:"none",minHeight:"1.5rem",selectors:{"&:hover":{background:"none"},"&:active":{background:"none"}}}),Object(lib.G)({marginRight:"0.5em"})),PrimaryButton=__webpack_require__(1815),Icon_Icon=__webpack_require__(1866),Link=__webpack_require__(1867),Persona=__webpack_require__(1852),Persona_types=__webpack_require__(26),es=__webpack_require__(217),weekDayToDayName=(__webpack_require__(51),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),formatTimeForChatMessage=function formatTimeForChatMessage(messageDate){var hours=messageDate.getHours(),minutes=messageDate.getMinutes().toString(),isAm=hours<12;return hours>12&&(hours-=12),0===hours&&(hours=12),minutes.length<2&&(minutes="0"+minutes),hours.toString()+":"+minutes+" "+(isAm?"a.m.":"p.m.")},formatDateForChatMessage=function formatDateForChatMessage(messageDate){var year=messageDate.getFullYear().toString(),month=(messageDate.getMonth()+1).toString(),day=messageDate.getDate().toString();return 1===month.length&&(month="0"+month),1===day.length&&(day="0"+day),year+"-"+month+"-"+day},formatTimestampForChatMessage=function formatTimestampForChatMessage(messageDate,todayDate){if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()))return formatTimeForChatMessage(messageDate);if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-1))return"Yesterday "+formatTimeForChatMessage(messageDate);var weekDay=todayDate.getDay();return 0===weekDay?formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate):messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-weekDay)?weekDayToDayName[messageDate.getDay()]+" "+formatTimeForChatMessage(messageDate):formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate)},delay=(__webpack_require__(207),function delay(_delay){return new Promise((function(resolve){setTimeout(resolve,_delay)}))}),FontIcon=__webpack_require__(804),systemMessageIconStyle=Object(lib.G)({margin:"0 0.688rem 0 0"}),systemMessageContentStyle=Object(lib.G)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),SystemMessage_SystemMessage=function SystemMessage(props){var iconName=props.iconName,content=props.content,Icon=Object(jsx_runtime.jsx)(FontIcon.a,{iconName:iconName,className:Object(lib.G)(systemMessageIconStyle)});return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.G)(null==props?void 0:props.containerStyle),children:[Icon,Object(jsx_runtime.jsx)("span",{className:Object(lib.G)(systemMessageContentStyle),children:content})]})};SystemMessage_SystemMessage.displayName="SystemMessage",SystemMessage_SystemMessage.__docgenInfo={description:"",methods:[],displayName:"SystemMessage",props:{iconName:{required:!0,tsType:{name:"union",raw:"'PeopleAdd' | 'PeopleBlock' | 'Edit'",elements:[{name:"literal",value:"'PeopleAdd'"},{name:"literal",value:"'PeopleBlock'"},{name:"literal",value:"'Edit'"}]},description:"Icon name for the system message. iconName should match the iconName in fluentUI icon."},content:{required:!0,tsType:{name:"string"},description:"Content string for the system message."},containerStyle:{required:!1,tsType:{name:"ComponentSlotStyle"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/SystemMessage.tsx"]={name:"SystemMessage",docgenInfo:SystemMessage_SystemMessage.__docgenInfo,path:"../react-components/src/components/SystemMessage.tsx"});var html_to_react=__webpack_require__(406);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function MessageThread_slicedToArray(arr,i){return function MessageThread_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MessageThread_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MessageThread_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MessageThread_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MessageThread_arrayLikeToArray(o,minLen)}(arr,i)||function MessageThread_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageThread_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isMessageSame=function isMessageSame(first,second){return first.messageId===second.messageId&&first.content===second.content&&first.type===second.type&&JSON.stringify(first.createdOn)===JSON.stringify(second.createdOn)&&first.senderId===second.senderId&&first.senderDisplayName===second.senderDisplayName&&first.status===second.status},getLatestChatMessage=function getLatestChatMessage(messages){for(var latestChatMessage=void 0,i=messages.length-1;i>=0;i--){var message=messages[i];if("chat"===message.type){var payload=message.payload;if(void 0!==payload.createdOn){latestChatMessage=payload;break}}}return latestChatMessage},MessageThread_DefaultJumpToNewMessageButton=function DefaultJumpToNewMessageButton(props){var onClick=props.onClick;return Object(jsx_runtime.jsxs)(PrimaryButton.a,{className:newMessageButtonStyle,onClick:onClick,children:[Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"Down",className:DownIconStyle}),"New Messages"]})};MessageThread_DefaultJumpToNewMessageButton.displayName="DefaultJumpToNewMessageButton";var MessageThread_DefaultSystemMessageRenderer=function DefaultSystemMessageRenderer(props){if("system"===props.message.type){var _payload$iconName,_payload$content,payload=props.message.payload;return Object(jsx_runtime.jsx)(SystemMessage_SystemMessage,{iconName:null!==(_payload$iconName=payload.iconName)&&void 0!==_payload$iconName?_payload$iconName:"",content:null!==(_payload$content=payload.content)&&void 0!==_payload$content?_payload$content:"",containerStyle:null==props?void 0:props.messageContainerStyle})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})};var MessageThread_generateRichTextHTMLMessageContent=function generateRichTextHTMLMessageContent(payload){var s,span,htmlToReactParser=new html_to_react.Parser,liveAuthor="".concat(payload.senderDisplayName," says ");return Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsx)(es.b,{message:"".concat(payload.mine?"":liveAuthor," ").concat((s=payload.content,span=document.createElement("span"),span.innerHTML=s,span.textContent||span.innerText)),"aria-live":"polite"}),htmlToReactParser.parse(payload.content)]})};MessageThread_generateRichTextHTMLMessageContent.displayName="generateRichTextHTMLMessageContent";var MessageThread_generateTextMessageContent=function generateTextMessageContent(payload){var liveAuthor="".concat(payload.senderDisplayName," says ");return Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsx)(es.b,{message:"".concat(payload.mine?"":liveAuthor," ").concat(payload.content),"aria-live":"polite"}),Object(jsx_runtime.jsx)(dist_default.a,{componentDecorator:function componentDecorator(decoratedHref,decoratedText,key){return Object(jsx_runtime.jsx)(Link.a,{href:decoratedHref,children:decoratedText},key)},children:payload.content})]})};MessageThread_generateTextMessageContent.displayName="generateTextMessageContent";var MessageThread_DefaultChatMessageRenderer=function DefaultChatMessageRenderer(props){if("chat"===props.message.type){var payload=props.message.payload,messageContentItem=function generateMessageContent(payload){switch(payload.type){case"text":return MessageThread_generateTextMessageContent(payload);case"html":case"richtext/html":return MessageThread_generateRichTextHTMLMessageContent(payload);default:return console.warn("unknown message content type"),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}}(payload);return Object(jsx_runtime.jsx)(Chat.a.Message,{className:Object(lib.G)(chatMessageStyle,props.messageContainerStyle),content:messageContentItem,author:Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.G)(chatMessageDateStyle),children:payload.senderDisplayName}),mine:payload.mine,timestamp:payload.createdOn?props.showDate?formatTimestampForChatMessage(payload.createdOn,new Date):formatTimeForChatMessage(payload.createdOn):void 0})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},memoizeAllMessages=Object(src.b)((function(_messageKey,message,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultChatMessageRenderer,_attached,statusToRender,onRenderMessage){var messageProps={message:message,showDate:showMessageDate};if("chat"===message.type){var _payload$senderId,_payload$mine,_payload$mine2,payload=message.payload;messageProps.messageContainerStyle=null==styles?void 0:styles.chatMessageContainer;var chatMessageComponent=void 0===onRenderMessage?defaultChatMessageRenderer(messageProps):onRenderMessage(messageProps,MessageThread_DefaultChatMessageRenderer);return{gutter:payload.mine?"":onRenderAvatar?onRenderAvatar(null!==(_payload$senderId=payload.senderId)&&void 0!==_payload$senderId?_payload$senderId:""):Object(jsx_runtime.jsx)(Persona.a,{text:payload.senderDisplayName,hidePersonaDetails:!0,size:Persona_types.c.size32}),contentPosition:payload.mine?"end":"start",message:Object(jsx_runtime.jsxs)(Flex.a,{vAlign:"end",children:[chatMessageComponent,Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(MessageThread_styles_messageStatusContainerStyle(null!==(_payload$mine=payload.mine)&&void 0!==_payload$mine&&_payload$mine),null!=styles&&styles.messageStatusContainer?styles.messageStatusContainer(null!==(_payload$mine2=payload.mine)&&void 0!==_payload$mine2&&_payload$mine2):""),children:showMessageStatus&&statusToRender?onRenderMessageStatus?onRenderMessageStatus({status:statusToRender}):MessageStatusIndicator_MessageStatusIndicator({status:statusToRender}):Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(noMessageStatusStyle)})})]}),attached:payload.attached,key:_messageKey}}return"system"===message.type?(messageProps.messageContainerStyle=null==styles?void 0:styles.systemMessageContainer,{children:void 0===onRenderMessage?MessageThread_DefaultSystemMessageRenderer(messageProps):onRenderMessage(messageProps,MessageThread_DefaultSystemMessageRenderer),key:_messageKey}):{children:void 0===onRenderMessage?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):onRenderMessage(messageProps),key:_messageKey}})),getLastChatMessageIdWithStatus=function getLastChatMessageIdWithStatus(messages,status){for(var i=messages.length-1;i>=0;i--){var message=messages[i];if("chat"===message.type&&message.payload.status===status&&message.payload.mine)return message.payload.messageId}},MessageThread_MessageThread=function MessageThread(props){var _chatThreadRef$curren,newMessages=props.messages,userId=props.userId,styles=props.styles,_props$disableJumpToN=props.disableJumpToNewMessageButton,disableJumpToNewMessageButton=void 0!==_props$disableJumpToN&&_props$disableJumpToN,_props$showMessageDat=props.showMessageDate,showMessageDate=void 0!==_props$showMessageDat&&_props$showMessageDat,_props$showMessageSta=props.showMessageStatus,showMessageStatus=void 0!==_props$showMessageSta&&_props$showMessageSta,_props$numberOfChatMe=props.numberOfChatMessagesToReload,numberOfChatMessagesToReload=void 0===_props$numberOfChatMe?0:_props$numberOfChatMe,onMessageSeen=props.onMessageSeen,onRenderMessageStatus=props.onRenderMessageStatus,onRenderAvatar=props.onRenderAvatar,onLoadPreviousChatMessages=props.onLoadPreviousChatMessages,onRenderJumpToNewMessageButton=props.onRenderJumpToNewMessageButton,onRenderMessage=props.onRenderMessage,_useState2=MessageThread_slicedToArray(Object(react.useState)([]),2),messages=_useState2[0],setMessages=_useState2[1],_useState4=MessageThread_slicedToArray(Object(react.useState)(!1),2),chatMessagesInitialized=_useState4[0],setChatMessagesInitialized=_useState4[1],_useState6=MessageThread_slicedToArray(Object(react.useState)(!0),2),isAtBottomOfScroll=_useState6[0],setIsAtBottomOfScroll=_useState6[1],_useState8=MessageThread_slicedToArray(Object(react.useState)(!1),2),isAtTopOfScroll=_useState8[0],setIsAtTopOfScroll=_useState8[1],_useState10=MessageThread_slicedToArray(Object(react.useState)(0),2),forceUpdate=_useState10[0],setForceUpdate=_useState10[1],_useState12=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestPreviousChatMessage=_useState12[0],setLatestPreviousChatMessage=_useState12[1],_useState14=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestCurrentChatMessage=_useState14[0],setLatestCurrentChatMessage=_useState14[1],_useState16=MessageThread_slicedToArray(Object(react.useState)(void 0),2),chatMessageIdJustSeen=_useState16[0],setChatMessageIdJustSeen=_useState16[1],_useState18=MessageThread_slicedToArray(Object(react.useState)(!1),2),existsNewChatMessage=_useState18[0],setExistsNewChatMessage=_useState18[1],_useState20=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSeenChatMessage=_useState20[0],setLastSeenChatMessage=_useState20[1],_useState22=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastDeliveredChatMessage=_useState22[0],setLastDeliveredChatMessage=_useState22[1],_useState24=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSendingChatMessage=_useState24[0],setLastSendingChatMessage=_useState24[1],_useState26=MessageThread_slicedToArray(Object(react.useState)(!1),2),isAllChatMessagesLoaded=_useState26[0],setIsAllChatMessagesLoaded=_useState26[1],isAllChatMessagesLoadedRef=Object(react.useRef)(isAllChatMessagesLoaded);isAllChatMessagesLoadedRef.current=isAllChatMessagesLoaded;var chatScrollDivRef=Object(react.useRef)(),chatThreadRef=Object(react.useRef)(),isLoadingChatMessagesRef=Object(react.useRef)(!1),messagesRef=Object(react.useRef)(messages),isAtBottomOfScrollRef=Object(react.useRef)(isAtBottomOfScroll),setIsAtBottomOfScrollRef=function setIsAtBottomOfScrollRef(isAtBottomOfScrollValue){isAtBottomOfScrollRef.current=isAtBottomOfScrollValue,setIsAtBottomOfScroll(isAtBottomOfScrollValue)},isAtTopOfScrollRef=Object(react.useRef)(isAtTopOfScroll),chatMessagesInitializedRef=Object(react.useRef)(chatMessagesInitialized),sendMessageStatusIfAtBottom=Object(react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var messagesWithId,lastMessage;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(isAtBottomOfScrollRef.current&&document.hasFocus()&&messagesRef.current&&0!==messagesRef.current.length&&showMessageStatus){_context.next=2;break}return _context.abrupt("return");case 2:if(0!==(messagesWithId=messagesRef.current.filter((function(message){return"chat"===message.type&&!message.payload.mine&&!!message.payload.messageId}))).length){_context.next=5;break}return _context.abrupt("return");case 5:if(lastMessage=messagesWithId[messagesWithId.length-1],_context.prev=6,!(onMessageSeen&&lastMessage&&lastMessage.payload.messageId&&lastMessage.payload.messageId!==chatMessageIdJustSeen)){_context.next=11;break}return _context.next=10,onMessageSeen(lastMessage.payload.messageId);case 10:setChatMessageIdJustSeen(lastMessage.payload.messageId);case 11:_context.next=16;break;case 13:_context.prev=13,_context.t0=_context.catch(6),console.log("onMessageSeen Error",lastMessage,_context.t0);case 16:case"end":return _context.stop()}}),_callee,null,[[6,13]])}))),[showMessageStatus,onMessageSeen,chatMessageIdJustSeen]),scrollToBottom=Object(react.useCallback)((function(){chatScrollDivRef.current.scrollTop=chatScrollDivRef.current.scrollHeight,setExistsNewChatMessage(!1),setIsAtBottomOfScrollRef(!0),sendMessageStatusIfAtBottom()}),[sendMessageStatusIfAtBottom]),handleScroll=function handleScroll(){var atBottom=Math.floor(chatScrollDivRef.current.scrollTop)>=chatScrollDivRef.current.scrollHeight-chatScrollDivRef.current.clientHeight,atTop=0===chatScrollDivRef.current.scrollTop;atBottom&&(sendMessageStatusIfAtBottom(),isAtBottomOfScrollRef.current||scrollToBottom()),setIsAtBottomOfScrollRef(atBottom),function setIsAtTopOfScrollRef(isAtTopOfScrollValue){isAtTopOfScrollRef.current=isAtTopOfScrollValue,setIsAtTopOfScroll(isAtTopOfScrollValue)}(atTop),0!==chatScrollDivRef.current.scrollTop||isAllChatMessagesLoadedRef.current||(chatScrollDivRef.current.scrollTop=5),_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!(chatScrollDivRef.current.scrollTop<=200)||isAllChatMessagesLoadedRef.current||isLoadingChatMessagesRef.current){_context2.next=9;break}if(!onLoadPreviousChatMessages){_context2.next=9;break}return isLoadingChatMessagesRef.current=!0,_context2.t0=setIsAllChatMessagesLoaded,_context2.next=6,onLoadPreviousChatMessages(numberOfChatMessagesToReload);case 6:_context2.t1=_context2.sent,(0,_context2.t0)(_context2.t1),isLoadingChatMessagesRef.current=!1;case 9:case"end":return _context2.stop()}}),_callee2)})))()};Object(react.useEffect)((function(){window&&window.addEventListener("click",sendMessageStatusIfAtBottom),window&&window.addEventListener("focus",sendMessageStatusIfAtBottom),chatScrollDivRef.current&&chatScrollDivRef.current.addEventListener("scroll",handleScroll);var chatScrollDiv=chatScrollDivRef.current;return function(){window&&window.removeEventListener("click",sendMessageStatusIfAtBottom),window&&window.removeEventListener("focus",sendMessageStatusIfAtBottom),chatScrollDiv&&chatScrollDiv.removeEventListener("scroll",handleScroll)}}),[]);var clientHeight=null===(_chatThreadRef$curren=chatThreadRef.current)||void 0===_chatThreadRef$curren?void 0:_chatThreadRef$curren.clientHeight;Object(react.useEffect)((function(){void 0!==clientHeight?isAtBottomOfScrollRef.current&&scrollToBottom():setForceUpdate(forceUpdate+1)}),[clientHeight,forceUpdate,scrollToBottom,chatMessagesInitialized]),Object(react.useEffect)((function(){setLatestPreviousChatMessage(getLatestChatMessage(messagesRef.current)),setLatestCurrentChatMessage(getLatestChatMessage(newMessages)),function setMessagesRef(messagesWithAttachedValue){messagesRef.current=messagesWithAttachedValue,setMessages(messagesWithAttachedValue)}(newMessages),!chatMessagesInitializedRef.current&&function setChatMessagesInitializedRef(chatMessagesInitialized){chatMessagesInitializedRef.current=chatMessagesInitialized,setChatMessagesInitialized(chatMessagesInitialized)}(!0),setLastDeliveredChatMessage(getLastChatMessageIdWithStatus(newMessages,"delivered")),setLastSeenChatMessage(getLastChatMessageIdWithStatus(newMessages,"seen")),setLastSendingChatMessage(getLastChatMessageIdWithStatus(newMessages,"sending"))}),[newMessages]),Object(react.useEffect)((function(){!function isThereNewMessageNotFromCurrentUser(latestMessageFromPreviousMessages,latestMessageFromNewMessages,userId){return void 0!==latestMessageFromNewMessages&&((void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId!==userId)}(latestPreviousChatMessage,latestCurrentChatMessage,userId)||isAtBottomOfScrollRef.current?(function didUserSendTheLatestMessage(latestMessageFromPreviousMessages,latestMessageFromNewMessages,userId){return void 0!==latestMessageFromNewMessages&&((void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId===userId)}(latestPreviousChatMessage,latestCurrentChatMessage,userId)||isAtBottomOfScrollRef.current)&&scrollToBottom():setExistsNewChatMessage(!0)}),[messages]),Object(react.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!onLoadPreviousChatMessages){_context3.next=11;break}case 1:if(!(chatScrollDivRef.current.scrollTop<=200)||isAllChatMessagesLoadedRef.current){_context3.next=11;break}return _context3.t0=setIsAllChatMessagesLoaded,_context3.next=5,onLoadPreviousChatMessages(numberOfChatMessagesToReload);case 5:return _context3.t1=_context3.sent,(0,_context3.t0)(_context3.t1),_context3.next=9,delay(200);case 9:_context3.next=1;break;case 11:case"end":return _context3.stop()}}),_callee3)})))()}),[onLoadPreviousChatMessages,numberOfChatMessagesToReload]);var defaultChatMessageRenderer=Object(react.useCallback)((function(messageProps){return MessageThread_DefaultChatMessageRenderer(messageProps)}),[(new Date).toDateString()]),messagesToDisplay=Object(react.useMemo)((function(){return memoizeAllMessages((function(memoizedMessageFn){return messages.map((function(message,index){var _key,key=message.payload.messageId;"chat"!==message.type||message.payload.messageId&&""!==message.payload.messageId||(key=message.payload.clientMessageId);var statusToRender=void 0;if("chat"===message.type){if(showMessageStatus&&message.payload.mine)switch(message.payload.messageId){case lastSeenChatMessage:statusToRender="seen";break;case lastSendingChatMessage:statusToRender="sending";break;case lastDeliveredChatMessage:statusToRender="delivered"}message.payload.mine&&"failed"===message.payload.status&&(statusToRender="failed")}return memoizedMessageFn(null!==(_key=key)&&void 0!==_key?_key:"id_"+index,message,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultChatMessageRenderer,"chat"===message.type?message.payload.attached:void 0,statusToRender,onRenderMessage)}))}))}),[messages,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultChatMessageRenderer,lastSeenChatMessage,lastSendingChatMessage,lastDeliveredChatMessage,onRenderMessage]),chatBody=Object(react.useMemo)((function(){var _styles$chatContainer;return Object(jsx_runtime.jsx)(es.a,{children:Object(jsx_runtime.jsx)(Chat.a,{styles:null!==(_styles$chatContainer=null==styles?void 0:styles.chatContainer)&&void 0!==_styles$chatContainer?_styles$chatContainer:chatStyle,items:messagesToDisplay})})}),[null==styles?void 0:styles.chatContainer,messagesToDisplay]);return Object(jsx_runtime.jsx)(Ref.a,{innerRef:chatThreadRef,children:Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)(messageThreadContainerStyle,null==styles?void 0:styles.root),grow:!0,children:[Object(jsx_runtime.jsx)(Ref.a,{innerRef:chatScrollDivRef,children:chatBody}),existsNewChatMessage&&!disableJumpToNewMessageButton&&Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(newMessageButtonContainerStyle,null==styles?void 0:styles.newMessageButtonContainer),children:onRenderJumpToNewMessageButton?onRenderJumpToNewMessageButton({onClick:scrollToBottom}):Object(jsx_runtime.jsx)(MessageThread_DefaultJumpToNewMessageButton,{onClick:scrollToBottom})})]})})};MessageThread_MessageThread.displayName="MessageThread",MessageThread_MessageThread.__docgenInfo={description:"`MessageThread` allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread.\n@param props - of type MessageThreadProps\n\nUsers will need to provide at least chat messages and userId to render the `MessageThread` component.\nUsers can also customize `MessageThread` by passing in their own Avatar, `MessageStatusIndicator` icon, `JumpToNewMessageButton`, `LoadPreviousMessagesButton` and the behavior of these controls.\n\n`MessageThread` internally uses the `Chat` & `Chat.Message` component from `@fluentui/react-northstar`. You can checkout the details about these [two components](https://fluentsite.z22.web.core.windows.net/0.53.0/components/chat/props).",methods:[],displayName:"MessageThread",props:{userId:{required:!0,tsType:{name:"string"},description:"UserId of the current user."},messages:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"(ChatMessage | SystemMessage | CustomMessage)[]"},description:"Messages to render in message thread. A message can be of type `ChatMessage`, `SystemMessage` or `CustomMessage`."},styles:{required:!1,tsType:{name:"MessageThreadStylesProps"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<MessageThread styles={{ root: { background: 'blue' } }} />\n```"},disableJumpToNewMessageButton:{required:!1,tsType:{name:"boolean"},description:"Whether the new message button is disabled or not.\n\n@defaultValue `false`"},showMessageDate:{required:!1,tsType:{name:"boolean"},description:"Whether the date of each message is displayed or not.\n\n@defaultValue `false`"},showMessageStatus:{required:!1,tsType:{name:"boolean"},description:"Whether the status indicator for each message is displayed or not.\n\n@defaultValue `false`"},numberOfChatMessagesToReload:{required:!1,tsType:{name:"number"},description:"Number of chat messaegs to reload each time onLoadPreviousChatMessages is called.\n\n@defaultValue 0"},onMessageSeen:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageId: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback to override actions on message being seen.\n\n@param messageId - message Id"},onRenderMessageStatus:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageStatusIndicatorProps: MessageStatusIndicatorProps) => JSX.Element | null",signature:{arguments:[{name:"messageStatusIndicatorProps",type:{name:"MessageStatusIndicatorProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to override render of the message status indicator.\n\n@param messageStatusIndicatorProps - props of type MessageStatusIndicatorProps"},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of the avatar.\n\n@param userId - user Id"},onRenderJumpToNewMessageButton:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMessageButtonProps: JumpToNewMessageButtonProps) => JSX.Element",signature:{arguments:[{name:"newMessageButtonProps",type:{name:"JumpToNewMessageButtonProps"}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of the button for jumping to the new message.\n\n@param newMessageButtonProps - button props of type JumpToNewMessageButtonProps"},onLoadPreviousChatMessages:{required:!1,tsType:{name:"signature",type:"function",raw:"(messagesToLoad: number) => Promise<boolean>",signature:{arguments:[{name:"messagesToLoad",type:{name:"number"}}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Optional callback to override loading of previous messages.\nIt accepts the number of history chat messages that we want to load and return a boolean Promise indicating if we have got all the history messages.\nIf the promise resolves to `true`, we have load all chat messages into the message thread and `loadPreviousMessagesButton` will not be rendered anymore."},onRenderMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType) => JSX.Element",signature:{arguments:[{name:"messageProps",type:{name:"signature",type:"object",raw:"{\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage` or `CustomMessage`.\n   */\n  message: ChatMessage | SystemMessage | CustomMessage;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showDate?: boolean;\n}",signature:{properties:[{key:"message",value:{name:"union",raw:"ChatMessage | SystemMessage | CustomMessage",elements:[{name:"ChatMessage"},{name:"SystemMessage"},{name:"CustomMessage"}],required:!0}},{key:"messageContainerStyle",value:{name:"ComponentSlotStyle",required:!1}},{key:"showDate",value:{name:"boolean",required:!1}}]}}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: MessageProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"signature",type:"object",raw:"{\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage` or `CustomMessage`.\n   */\n  message: ChatMessage | SystemMessage | CustomMessage;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showDate?: boolean;\n}",signature:{properties:[{key:"message",value:{name:"union",raw:"ChatMessage | SystemMessage | CustomMessage",elements:[{name:"ChatMessage"},{name:"SystemMessage"},{name:"CustomMessage"}],required:!0}},{key:"messageContainerStyle",value:{name:"ComponentSlotStyle",required:!1}},{key:"showDate",value:{name:"boolean",required:!1}}]}}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of a message.\n\n@param messageProps - props of type MessageProps\n@param defaultOnRender - default render of type DefaultMessageRendererType\n\n@remarks\n`defaultOnRender` is not provided for `CustomMessage` and thus only available for `ChatMessage` and `SystemMessage`."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MessageThread.tsx"]={name:"MessageThread",docgenInfo:MessageThread_MessageThread.__docgenInfo,path:"../react-components/src/components/MessageThread.tsx"});var mediaContainer=Object(lib.G)({position:"relative",height:"100%",width:"100%",background:"transparent",display:"flex","& video":{borderRadius:".25rem"}}),invertedVideoStyle=Object(lib.G)(mediaContainer,{transform:"rotateY(180deg)"}),StreamMedia_StreamMedia=function StreamMedia(props){var containerEl=Object(react.useRef)(null),isMirrored=props.isMirrored,videoStreamElement=props.videoStreamElement,styles=props.styles;return Object(react.useEffect)((function(){var container=containerEl.current;if(container)return container.innerHTML="",videoStreamElement&&container.appendChild(videoStreamElement),function(){container.innerHTML=""}}),[videoStreamElement]),Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(isMirrored?invertedVideoStyle:mediaContainer,null==styles?void 0:styles.root),ref:containerEl})};StreamMedia_StreamMedia.displayName="StreamMedia",StreamMedia_StreamMedia.__docgenInfo={description:"StreamMedia component converts a HTMLElement to a JSX Element.\nThis component becomes very handy when you get the video stream HTMLElement from the calling sdk and want to render it in components like VideoTile.",methods:[],displayName:"StreamMedia",props:{videoStreamElement:{required:!0,tsType:{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]},description:"Video stream element to render."},isMirrored:{required:!1,tsType:{name:"boolean"},description:"Decides whether to mirror the video or not."},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<StreamMedia styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/StreamMedia.tsx"]={name:"StreamMedia",docgenInfo:StreamMedia_StreamMedia.__docgenInfo,path:"../react-components/src/components/StreamMedia.tsx"});var ParticipantItem_styles_participantItemContainerStyle=function participantItemContainerStyle(theme){return Object(lib.G)({paddingTop:"0.25rem",paddingBottom:"0.25rem",display:"flex",position:"relative",maxWidth:"20rem",minWidth:"12rem",cursor:"pointer",selectors:{"&:hover":{background:theme.palette.neutralLight}}})},iconContainerStyle=(Object(lib.G)({fontSize:"0.875rem",fontWeight:400,marginTop:"0.3125rem",marginRight:"0.25rem",paddingLeft:"0.25rem",overflowY:"hidden"}),Object(lib.G)({fontSize:"0.875rem",fontWeight:400,color:"#A19F9D",marginTop:"0.3125rem"}),Object(lib.G)({position:"absolute",display:"flex",right:"1rem",top:"50%",msTransform:"translateY(-50%)",transform:"translateY(-50%)"})),ContextualMenu=__webpack_require__(1848),DirectionalHint=__webpack_require__(75);function ParticipantItem_slicedToArray(arr,i){return function ParticipantItem_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ParticipantItem_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ParticipantItem_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantItem_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantItem_arrayLikeToArray(o,minLen)}(arr,i)||function ParticipantItem_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantItem_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantItem_ParticipantItem=function ParticipantItem(props){var displayName=props.displayName,onRenderAvatar=props.onRenderAvatar,menuItems=props.menuItems,onRenderIcon=props.onRenderIcon,presence=props.presence,styles=props.styles,_useState2=ParticipantItem_slicedToArray(Object(react.useState)(),2),clickEvent=_useState2[0],setClickEvent=_useState2[1],_useState4=ParticipantItem_slicedToArray(Object(react.useState)(!0),2),menuHidden=_useState4[0],setMenuHidden=_useState4[1],containerRef=Object(react.useRef)(null),theme=Object(useTheme.a)(),hideMenu=function hideMenu(){setClickEvent(void 0),setMenuHidden(!0)},avatarToUse=Object(jsx_runtime.jsx)(Persona.a,{text:displayName,size:Persona_types.c.size32,presence:presence,onRenderPersonaCoin:onRenderAvatar?function(){return onRenderAvatar(props)}:void 0,className:Object(lib.G)(null==styles?void 0:styles.avatar),initialsTextColor:"white"});return Object(jsx_runtime.jsxs)("div",{ref:containerRef,className:Object(lib.G)(ParticipantItem_styles_participantItemContainerStyle(theme),null==styles?void 0:styles.root),onClick:function showMenu(clickEvent){setClickEvent(clickEvent.nativeEvent),setMenuHidden(!1)},children:[avatarToUse,onRenderIcon&&Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(iconContainerStyle,null==styles?void 0:styles.iconContainer),children:onRenderIcon(props)}),menuItems&&Object(jsx_runtime.jsx)(ContextualMenu.a,{items:menuItems,hidden:menuHidden,target:null!=clickEvent?clickEvent:containerRef,onItemClick:hideMenu,onDismiss:hideMenu,directionalHint:DirectionalHint.a.bottomLeftEdge,className:Object(lib.G)(null==styles?void 0:styles.menu)})]})};ParticipantItem_ParticipantItem.displayName="ParticipantItem",ParticipantItem_ParticipantItem.__docgenInfo={description:"`ParticipantItem` represents a participant in Calling or Chat. `ParticipantItem` displays a participant's avatar,\ndisplayName and status as well as optional icons and context menu.",methods:[],displayName:"ParticipantItem",props:{displayName:{required:!0,tsType:{name:"string"},description:"Name of participant."},me:{required:!1,tsType:{name:"boolean"},description:"Optional indicator to show participant is the user."},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props?: ParticipantItemProps) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"ParticipantItemProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback returning a JSX element to override avatar."},menuItems:{required:!1,tsType:{name:"Array",elements:[{name:"IContextualMenuItem"}],raw:"IContextualMenuItem[]"},description:"Optional array of IContextualMenuItem for contextual menu."},onRenderIcon:{required:!1,tsType:{name:"signature",type:"function",raw:"(props?: ParticipantItemProps) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"ParticipantItemProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback returning a JSX element rendered on the right portion of the ParticipantItem. Intended for adding icons."},presence:{required:!1,tsType:{name:"PersonaPresence"},description:"Optional PersonaPresence to show participant presence. This will not have an effect if property avatar is assigned."},styles:{required:!1,tsType:{name:"ParticipantItemStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<ParticipantItem styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantItem.tsx"]={name:"ParticipantItem",docgenInfo:ParticipantItem_ParticipantItem.__docgenInfo,path:"../react-components/src/components/ParticipantItem.tsx"});__webpack_require__(10),__webpack_require__(70);var IconButton=__webpack_require__(1877),OverflowSet=__webpack_require__(1868),CallControlPresentNewIcon=__webpack_require__(1827),MicOffIcon=__webpack_require__(1828),participantListStyle=Object(lib.G)({height:"100%",overflow:"auto",paddingLeft:"1.125rem",paddingRight:"1.125rem"}),overFlowButtonStyles={root:{minWidth:0,padding:"0 0.25rem",alignSelf:"stretch",height:"auto"}},overflowSetStyle={item:{width:"100%"}},ParticipantList_onRenderOverflowButton=function onRenderOverflowButton(overflowItems){return Object(jsx_runtime.jsx)(IconButton.a,{role:"menuitem",title:"More options",styles:overFlowButtonStyles,menuIconProps:{iconName:"More"},menuProps:{items:overflowItems}})};ParticipantList_onRenderOverflowButton.displayName="onRenderOverflowButton";var ParticipantList_renderParticipants=function renderParticipants(participants,myUserId,onRenderParticipant,onRenderAvatar,onParticipantRemove){var renderParticipant=null!=onRenderParticipant?onRenderParticipant:function getDefaultRenderer(myUserId,onParticipantRemove,onRenderAvatar){return function(participant){var callingParticipant=participant,presence=void 0;callingParticipant&&("Connected"===callingParticipant.state?presence=Persona_types.b.online:"Idle"===callingParticipant.state&&(presence=Persona_types.b.away));var menuItems=[];participant.userId!==myUserId&&onParticipantRemove&&menuItems.push({key:"Remove",text:"Remove",onClick:function onClick(){return onParticipantRemove(participant.userId)}});var onRenderIcon=null!=callingParticipant&&callingParticipant.isScreenSharing||null!=callingParticipant&&callingParticipant.isMuted?function(){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:"0.5rem"},children:[callingParticipant.isScreenSharing&&Object(jsx_runtime.jsx)(CallControlPresentNewIcon.a,{size:"small"}),callingParticipant.isMuted&&Object(jsx_runtime.jsx)(MicOffIcon.a,{size:"small"})]})}:function(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},renderAvatar=onRenderAvatar?function(){return onRenderAvatar(participant)}:void 0;return participant.displayName?Object(jsx_runtime.jsx)(ParticipantItem_ParticipantItem,{displayName:participant.displayName,me:!!myUserId&&participant.userId===myUserId,menuItems:menuItems,presence:presence,onRenderIcon:onRenderIcon,onRenderAvatar:renderAvatar}):null}}(myUserId,onParticipantRemove,onRenderAvatar),onRenderItem=function onRenderItem(item){var participant={userId:item.userId,displayName:item.displayName,state:item.state,isScreenSharing:item.isScreenSharing,isMuted:item.isMuted,isSpeaking:item.isSpeaking};return renderParticipant(participant)};return participants.map((function(item,i){return Object(jsx_runtime.jsx)(OverflowSet.a,{items:[Object.assign({key:"".concat(i),displayName:item.displayName,me:item.userId===myUserId},item)],role:"menubar",vertical:!1,onRenderOverflowButton:ParticipantList_onRenderOverflowButton,onRenderItem:onRenderItem,styles:overflowSetStyle},i)}))},ParticipantList_ParticipantList=function ParticipantList(props){var allParticipants=[];return void 0!==props.participants&&props.participants.forEach((function(participant){return allParticipants.push(participant)})),Object(jsx_runtime.jsx)(Stack.a,{className:participantListStyle,children:ParticipantList_renderParticipants(allParticipants,props.myUserId,props.onRenderParticipant,props.onRenderAvatar,props.onParticipantRemove)})};ParticipantList_ParticipantList.displayName="ParticipantList",ParticipantList_ParticipantList.__docgenInfo={description:"`ParticipantList` renders a list of participants in Calling or Chat. If property `onRenderParticipant` is not\nassigned then each participant is rendered with `ParticipantItem`.",methods:[],displayName:"ParticipantList",props:{participants:{required:!0,tsType:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"},description:"Participants in user call or chat"},myUserId:{required:!1,tsType:{name:"string"},description:"User ID of user"},onRenderParticipant:{required:!1,tsType:{name:"signature",type:"function",raw:"(participant: CommunicationParticipant) => JSX.Element | null",signature:{arguments:[{name:"participant",type:{name:"CommunicationParticipant"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render each participant. If no callback is provided, each participant will be rendered with `ParticipantItem`"},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(participant: CommunicationParticipant) => JSX.Element | null",signature:{arguments:[{name:"participant",type:{name:"CommunicationParticipant"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render the avatar for each participant. This property will have no effect if `onRenderParticipant` is assigned."},onParticipantRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => void",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"void"}}},description:"Optional callback to render the context menu for each participant"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantList.tsx"]={name:"ParticipantList",docgenInfo:ParticipantList_ParticipantList.__docgenInfo,path:"../react-components/src/components/ParticipantList.tsx"});var videoBaseStyle=Object(lib.G)({border:0}),gridStyle=Object(lib.G)(videoBaseStyle,{width:"100%",height:"100%"}),videoTileStyle={root:{borderRadius:".25rem"}},Text_Text=__webpack_require__(1869),rootStyles={position:"relative",height:"100%",width:"100%"},videoContainerStyles={position:"absolute",top:"0",left:"0",width:"100%",height:"100%",minWidth:"100%",minHeight:"100%",objectPosition:"center",objectFit:"cover",zIndex:0},overlayContainerStyles={width:"100%",height:"100%",zIndex:5},disabledVideoHint=Object(lib.G)({bottom:"0.5rem",boxShadow:"none",textAlign:"left",left:"0.5rem",overflow:"hidden",position:"absolute",padding:"0.25rem",lineHeight:"1.4286rem",whiteSpace:"nowrap",maxWidth:"95%",borderRadius:4}),videoHint=Object(lib.G)(disabledVideoHint,{backgroundColor:"rgba(0, 0, 0, 0.5)",boxShadow:"0 0 1px 0 rgba(0,0,0,.5)"}),VideoTile_DefaultPlaceholder=function DefaultPlaceholder(props){var displayName=props.displayName,noVideoAvailableAriaLabel=props.noVideoAvailableAriaLabel;return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)({position:"absolute",height:"100%",width:"100%"}),children:Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size100,hidePersonaDetails:!0,text:displayName,initialsTextColor:"white","aria-label":noVideoAvailableAriaLabel})})};VideoTile_DefaultPlaceholder.displayName="DefaultPlaceholder";var VideoTile_VideoTile=function VideoTile(props){var children=props.children,displayName=props.displayName,isMirrored=props.isMirrored,isVideoReady=props.isVideoReady,onRenderPlaceholder=props.onRenderPlaceholder,renderElement=props.renderElement,_props$showDisplayNam=props.showDisplayName,showDisplayName=void 0===_props$showDisplayNam||_props$showDisplayNam,styles=props.styles,placeHolderProps={userId:props.userId,displayName:displayName,noVideoAvailableAriaLabel:props.noVideoAvailableAriaLabel},theme=Object(useTheme.a)();return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)(rootStyles,{background:theme.palette.neutralLighter},null==styles?void 0:styles.root),children:[isVideoReady&&renderElement?Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(videoContainerStyles,isMirrored&&{transform:"scaleX(-1)"},null==styles?void 0:styles.videoContainer),children:renderElement}):Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(videoContainerStyles),children:onRenderPlaceholder?onRenderPlaceholder(placeHolderProps,VideoTile_DefaultPlaceholder):Object(jsx_runtime.jsx)(VideoTile_DefaultPlaceholder,Object.assign({},placeHolderProps))}),displayName&&showDisplayName&&Object(jsx_runtime.jsx)(Text_Text.a,{className:Object(lib.G)(isVideoReady?videoHint:disabledVideoHint,{color:isVideoReady?"white":theme.palette.neutralPrimaryAlt},null==styles?void 0:styles.displayNameContainer),children:displayName}),children&&Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(overlayContainerStyles,null==styles?void 0:styles.overlayContainer),children:children})]})};VideoTile_VideoTile.displayName="VideoTile",VideoTile_VideoTile.__docgenInfo={description:"",methods:[],displayName:"VideoTile",props:{userId:{required:!1,tsType:{name:"string"},description:"user id for the VideoTile placeholder."},displayName:{required:!1,tsType:{name:"string"},description:"Optional participant display name for the VideoTile default placeholder."},noVideoAvailableAriaLabel:{required:!1,tsType:{name:"string"},description:"Optional property to set the aria label of the video tile if there is no available stream."},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"React Child components. Child Components will show as overlay component in the VideoTile."},styles:{required:!1,tsType:{name:"VideoTileStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<VideoTile styles={{ root: { background: 'blue' } }} />\n```"},isVideoReady:{required:!1,tsType:{name:"boolean"},description:"Determines if the static image or video stream should be rendered."},renderElement:{required:!1,tsType:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]},description:"Component with the video stream."},isMirrored:{required:!1,tsType:{name:"boolean"},description:"Determines if the video is mirrored or not."},onRenderPlaceholder:{required:!1,tsType:{name:"signature",type:"function",raw:"(\n  props: PlaceholderProps,\n  defaultOnRender: (props: PlaceholderProps) => JSX.Element\n) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Custom render Component function for no video is available. Render a Persona Icon if undefined."},showDisplayName:{required:!1,tsType:{name:"boolean"},description:"Whether the displayName is displayed or not.\n\n@defaultValue `true`"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/VideoTile.tsx"]={name:"VideoTile",docgenInfo:VideoTile_VideoTile.__docgenInfo,path:"../react-components/src/components/VideoTile.tsx"});var memoizeAllRemoteParticipants=Object(src.b)((function(userId,onCreateRemoteStreamView,isAvailable,renderElement,displayName,remoteVideoViewOption,onRenderAvatar){return isAvailable&&!renderElement&&onCreateRemoteStreamView&&onCreateRemoteStreamView(userId,remoteVideoViewOption),Object(jsx_runtime.jsx)(Stack.a,{className:gridStyle,grow:!0,children:Object(jsx_runtime.jsx)(VideoTile_VideoTile,{userId:userId,isVideoReady:isAvailable,renderElement:Object(jsx_runtime.jsx)(StreamMedia_StreamMedia,{videoStreamElement:null!=renderElement?renderElement:null}),displayName:displayName,styles:videoTileStyle,onRenderPlaceholder:onRenderAvatar})},userId)})),VideoGallery_VideoGallery=function VideoGallery(props){var localParticipant=props.localParticipant,remoteParticipants=props.remoteParticipants,localVideoViewOption=props.localVideoViewOption,remoteVideoViewOption=props.remoteVideoViewOption,onRenderLocalVideoTile=props.onRenderLocalVideoTile,onRenderRemoteVideoTile=props.onRenderRemoteVideoTile,onCreateLocalStreamView=props.onCreateLocalStreamView,onCreateRemoteStreamView=props.onCreateRemoteStreamView,styles=props.styles,onRenderAvatar=props.onRenderAvatar,defaultOnRenderLocalVideoTile=Object(react.useMemo)((function(){var _localVideoStream$ren,localVideoStream=null==localParticipant?void 0:localParticipant.videoStream,isLocalVideoReady=null==localVideoStream?void 0:localVideoStream.isAvailable;return onRenderLocalVideoTile?onRenderLocalVideoTile(localParticipant):(localVideoStream&&!localVideoStream.renderElement&&onCreateLocalStreamView&&onCreateLocalStreamView(localVideoViewOption),Object(jsx_runtime.jsx)(VideoTile_VideoTile,{userId:localParticipant.userId,isVideoReady:isLocalVideoReady,renderElement:Object(jsx_runtime.jsx)(StreamMedia_StreamMedia,{videoStreamElement:null!==(_localVideoStream$ren=null==localVideoStream?void 0:localVideoStream.renderElement)&&void 0!==_localVideoStream$ren?_localVideoStream$ren:null}),displayName:null==localParticipant?void 0:localParticipant.displayName,styles:videoTileStyle,onRenderPlaceholder:onRenderAvatar}))}),[localParticipant,localParticipant.videoStream,onCreateLocalStreamView]),defaultOnRenderRemoteParticipants=Object(react.useMemo)((function(){return remoteParticipants?onRenderRemoteVideoTile?remoteParticipants.map((function(participant){return onRenderRemoteVideoTile(participant)})):memoizeAllRemoteParticipants((function(memoizedRemoteParticipantFn){return remoteParticipants.map((function(participant){var remoteVideoStream=participant.videoStream;return memoizedRemoteParticipantFn(participant.userId,onCreateRemoteStreamView,null==remoteVideoStream?void 0:remoteVideoStream.isAvailable,null==remoteVideoStream?void 0:remoteVideoStream.renderElement,participant.displayName,remoteVideoViewOption,onRenderAvatar)}))})):null}),[remoteParticipants,onRenderRemoteVideoTile,onCreateRemoteStreamView,remoteVideoViewOption]);return Object(jsx_runtime.jsxs)(GridLayout_GridLayout,{styles:styles,children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:gridStyle,grow:!0,children:localParticipant&&defaultOnRenderLocalVideoTile}),defaultOnRenderRemoteParticipants]})};VideoGallery_VideoGallery.displayName="VideoGallery",VideoGallery_VideoGallery.__docgenInfo={description:"VideoGallery represents a `GridLayout` of video tiles for a specific call.\nIt displays a `VideoTile` for the local user as well as for each remote participants who joined the call.\n\n@param props - of type `VideoGalleryProps`\n\n@returns a JSX Element",methods:[],displayName:"VideoGallery",props:{styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass an object containing custom CSS styles for the gallery container.\n\n@Example\n```\n<VideoGallery styles={{ root: { border: 'solid 1px red' } }} />\n```"},localParticipant:{required:!0,tsType:{name:"VideoGalleryLocalParticipant"},description:"Local video particpant"},remoteParticipants:{required:!1,tsType:{name:"Array",elements:[{name:"VideoGalleryRemoteParticipant"}],raw:"VideoGalleryRemoteParticipant[]"},description:"List of remote video particpants"},localVideoViewOption:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Local video view options"},remoteVideoViewOption:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Remote videos view options"},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions | undefined) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"union",raw:"VideoStreamOptions | undefined",elements:[{name:"VideoStreamOptions"},{name:"undefined"}]}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback to create the local video stream view"},onDisposeLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback to dispose of the local video stream view"},onRenderLocalVideoTile:{required:!1,tsType:{name:"signature",type:"function",raw:"(localParticipant: VideoGalleryLocalParticipant) => JSX.Element",signature:{arguments:[{name:"localParticipant",type:{name:"VideoGalleryLocalParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render the local video tile"},onCreateRemoteStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback to create a remote video stream view"},onRenderRemoteVideoTile:{required:!1,tsType:{name:"signature",type:"function",raw:"(remoteParticipant: VideoGalleryRemoteParticipant) => JSX.Element",signature:{arguments:[{name:"remoteParticipant",type:{name:"VideoGalleryRemoteParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render a remote video tile"},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:"Callback to render a particpant avatar"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/VideoGallery.tsx"]={name:"VideoGallery",docgenInfo:VideoGallery_VideoGallery.__docgenInfo,path:"../react-components/src/components/VideoGallery.tsx"});var Label=__webpack_require__(1865),DefaultButton=__webpack_require__(425),CallVideoIcon=__webpack_require__(1829),CallVideoOffIcon=__webpack_require__(1830),ControlBar_styles_theme=Object(lib.B)(),ControlBar_styles_palette=ControlBar_styles_theme.palette,controlBarStyles={horizontal:{flexFlow:"row nowrap"},vertical:{flexFlow:"column nowrap",maxWidth:"3.5rem"},dockedTop:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,width:"100%"},dockedBottom:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",bottom:0,left:0,width:"100%"},dockedLeft:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,height:"100%"},dockedRight:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,right:0,height:"100%"},floatingTop:{flexFlow:"row nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"1rem",left:"50%",transform:"translateX(-50%)",zIndex:10},floatingBottom:{flexFlow:"row nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",bottom:"1rem",left:"50%",transform:"translateX(-50%)",zIndex:10},floatingLeft:{flexFlow:"column nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"50%",left:"1rem",transform:"translateY(-50%)",zIndex:10},floatingRight:{flexFlow:"column nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"50%",right:"1rem",transform:"translateY(-50%)",zIndex:10}},controlButtonStyles={root:{background:"none",border:"none",borderRadius:0,minHeight:"3.5rem",minWidth:"3.5rem"},flexContainer:{flexFlow:"column",display:"contents"}},controlButtonLabelStyles={fontSize:"0.625rem",lineHeight:"1rem",marginTop:"0.125rem"},endCallControlButtonStyles=Object(lib.q)(controlButtonStyles,{root:{color:ControlBar_styles_palette.white},rootHovered:{color:ControlBar_styles_palette.white},rootPressed:{color:ControlBar_styles_palette.white},label:{color:ControlBar_styles_palette.whiteTranslucent40}}),CameraButton_CameraButton=function CameraButton(props){var _props$onToggleCamera,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return Object(jsx_runtime.jsx)(DefaultButton.a,Object.assign({},props,{onClick:null!==(_props$onToggleCamera=props.onToggleCamera)&&void 0!==_props$onToggleCamera?_props$onToggleCamera:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(CallVideoIcon.a,{},"videoIconKey"):Object(jsx_runtime.jsx)(CallVideoOffIcon.a,{},"videoOffIconKey")},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _props$styles;return Object(jsx_runtime.jsx)(Label.a,{className:Object(lib.G)(controlButtonLabelStyles,null==props||null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.label),children:null!=props&&props.checked?"Turn off":"Turn on"},"videoLabelKey")}:void 0}))};CameraButton_CameraButton.displayName="CameraButton",CameraButton_CameraButton.__docgenInfo={description:"`CameraButton` allows you to easily create a component for rendering a camera button.\nIt can be used in your ControlBar component for example.\n\n@param props - of type CameraButtonProps",methods:[],displayName:"CameraButton",props:{showLabel:{required:!1,tsType:{name:"boolean"},description:"Whether the label is displayed or not.\n@defaultValue `false`"},onToggleCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."}},composes:["IButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/CameraButton.tsx"]={name:"CameraButton",docgenInfo:CameraButton_CameraButton.__docgenInfo,path:"../react-components/src/components/CameraButton.tsx"});__webpack_require__(199);var mainDivStyle={position:"relative",height:"100%",width:"100%"},ControlBar_ControlBar=function ControlBar(props){var styles=props.styles,layout=props.layout,theme=Object(useTheme.a)(),controlBarStyle=controlBarStyles[null!=layout?layout:"horizontal"];return Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(mainDivStyle),children:Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(controlBarStyle,{background:isDarkThemed(theme)&&null!=layout&&layout.startsWith("floating")?theme.palette.neutralQuaternaryAlt:theme.palette.white},null==styles?void 0:styles.root),children:props.children})})};ControlBar_ControlBar.displayName="ControlBar",ControlBar_ControlBar.__docgenInfo={description:"`ControlBar` allows you to easily create a component for call controls using\n[Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) component from\nFluent UI. Users will need to provide methods to Button components used inside `ControlBar`\nfor altering call behavior.",methods:[],displayName:"ControlBar",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"React Child components."},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<ControlBar styles={{ root: { background: 'blue' } }} />\n```"},layout:{required:!1,tsType:{name:"union",raw:"| 'horizontal'\n| 'vertical'\n| 'dockedTop'\n| 'dockedBottom'\n| 'dockedLeft'\n| 'dockedRight'\n| 'floatingTop'\n| 'floatingBottom'\n| 'floatingLeft'\n| 'floatingRight'",elements:[{name:"literal",value:"'horizontal'"},{name:"literal",value:"'vertical'"},{name:"literal",value:"'dockedTop'"},{name:"literal",value:"'dockedBottom'"},{name:"literal",value:"'dockedLeft'"},{name:"literal",value:"'dockedRight'"},{name:"literal",value:"'floatingTop'"},{name:"literal",value:"'floatingBottom'"},{name:"literal",value:"'floatingLeft'"},{name:"literal",value:"'floatingRight'"}]},description:"Changes the layout of the control bar.\nAvailable layouts are `horizontal`, `vertical`, `dockedTop`, `dockedBottom`,\n`dockedLeft`, `dockedRight`, `floatingTop`, `floatingBottom`, `floatingLeft`,\n`floatingRight`\nDefaults to a `horizontal` layout."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ControlBar.tsx"]={name:"ControlBar",docgenInfo:ControlBar_ControlBar.__docgenInfo,path:"../react-components/src/components/ControlBar.tsx"});var CallEndIcon=__webpack_require__(1831),lightTheme={palette:{themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#59b0f7",themeDarker:"#004578",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},callingPalette:{callRed:"#c4314b",callRedDark:"#a42e43",callRedDarker:"#8b2c3d"}},darkTheme={palette:{themePrimary:"#2899f5",themeLighterAlt:"#02060a",themeLighter:"#061827",themeLight:"#0c2e49",themeTertiary:"#185b93",themeSecondary:"#2286d7",themeDarkAlt:"#3ca2f6",themeDark:"#59b0f7",themeDarker:"#84c5f9",neutralLighterAlt:"#302e2d",neutralLighter:"#383735",neutralLight:"#464443",neutralQuaternaryAlt:"#4e4d4b",neutralQuaternary:"#4d4b49",neutralTertiaryAlt:"#72706e",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#252423"},callingPalette:{callRed:"#a42e43",callRedDark:"#8b2c3d",callRedDarker:"#772a38"}},EndCallButton_EndCallButton=function EndCallButton(props){var _props$onHangUp,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,isDarkTheme=isDarkThemed(Object(useTheme.a)()),componentStyles=Object(lib.q)(endCallControlButtonStyles,{root:{background:isDarkTheme?darkTheme.callingPalette.callRed:lightTheme.callingPalette.callRed},rootHovered:{background:isDarkTheme?darkTheme.callingPalette.callRedDark:lightTheme.callingPalette.callRedDark},rootPressed:{background:isDarkTheme?darkTheme.callingPalette.callRedDarker:lightTheme.callingPalette.callRedDarker}},null!=styles?styles:{});return Object(jsx_runtime.jsx)(DefaultButton.a,Object.assign({},props,{onClick:null!==(_props$onHangUp=props.onHangUp)&&void 0!==_props$onHangUp?_props$onHangUp:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(){return Object(jsx_runtime.jsx)(CallEndIcon.a,{},"callEndIconKey")},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _props$styles;return Object(jsx_runtime.jsx)(Label.a,{className:Object(lib.G)(controlButtonLabelStyles,null==props||null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.label),children:"Leave call"},"callEndLabelKey")}:void 0}))};EndCallButton_EndCallButton.displayName="EndCallButton",EndCallButton_EndCallButton.__docgenInfo={description:"`EndCallButton` allows you to easily create a component for rendering a end call button. It can be used in your ControlBar component for example.\n\n@param props - of type EndCallButtonProps",methods:[],displayName:"EndCallButton",props:{showLabel:{required:!1,tsType:{name:"boolean"},description:"Whether the label is displayed or not.\n\n@defaultValue `false`"},onHangUp:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."}},composes:["IButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/EndCallButton.tsx"]={name:"EndCallButton",docgenInfo:EndCallButton_EndCallButton.__docgenInfo,path:"../react-components/src/components/EndCallButton.tsx"});var MicIcon=__webpack_require__(1832),MicrophoneButton_MicrophoneButton=function MicrophoneButton(props){var _props$onToggleMicrop,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return Object(jsx_runtime.jsx)(DefaultButton.a,Object.assign({},props,{onClick:null!==(_props$onToggleMicrop=props.onToggleMicrophone)&&void 0!==_props$onToggleMicrop?_props$onToggleMicrop:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(MicIcon.a,{},"microphoneIconKey"):Object(jsx_runtime.jsx)(MicOffIcon.a,{},"microphoneOffIconKey")},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _props$styles;return Object(jsx_runtime.jsx)(Label.a,{className:Object(lib.G)(controlButtonLabelStyles,null==props||null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.label),children:null!=props&&props.checked?"Mute":"Unmute"},"microphoneLabelKey")}:void 0}))};MicrophoneButton_MicrophoneButton.displayName="MicrophoneButton",MicrophoneButton_MicrophoneButton.__docgenInfo={description:"`MicrophoneButton` allows you to easily create a component for rendering an audio button. It can be used in your ControlBar component for example.\n@param props - of type MicrophoneButtonProps",methods:[],displayName:"MicrophoneButton",props:{showLabel:{required:!1,tsType:{name:"boolean"},description:"Whether the label is displayed or not.\n@defaultValue `false`"},onToggleMicrophone:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."}},composes:["IButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MicrophoneButton.tsx"]={name:"MicrophoneButton",docgenInfo:MicrophoneButton_MicrophoneButton.__docgenInfo,path:"../react-components/src/components/MicrophoneButton.tsx"});var MoreIcon=__webpack_require__(1833),OptionsButton_OptionsButton=function OptionsButton(props){var _props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,defaultMenuProps=function generateDefaultMenuProps(props){var microphones=props.microphones,speakers=props.speakers,cameras=props.cameras,selectedMicrophone=props.selectedMicrophone,selectedSpeaker=props.selectedSpeaker,selectedCamera=props.selectedCamera,onSelectCamera=props.onSelectCamera,onSelectMicrophone=props.onSelectMicrophone,onSelectSpeaker=props.onSelectSpeaker,defaultMenuProps={items:[]};return cameras&&selectedCamera&&onSelectCamera&&defaultMenuProps.items.push({key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:cameras.map((function(val){return{key:val.id,text:val.name,title:val.name,canCheck:!0,isChecked:val.id===(null==selectedCamera?void 0:selectedCamera.id),onClick:function onClick(){return!(val.id===(null==selectedCamera?void 0:selectedCamera.id))&&onSelectCamera(val)}}}))}}),microphones&&selectedMicrophone&&onSelectMicrophone&&defaultMenuProps.items.push({key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:microphones.map((function(val){return{key:val.id,text:val.name,title:val.name,canCheck:!0,isChecked:val.id===(null==selectedMicrophone?void 0:selectedMicrophone.id),onClick:function onClick(){return!(val.id===(null==selectedMicrophone?void 0:selectedMicrophone.id))&&onSelectMicrophone(val)}}}))}}),speakers&&selectedSpeaker&&onSelectSpeaker&&defaultMenuProps.items.push({key:"3",name:"Choose Speaker",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:speakers.map((function(val){return{key:val.id,text:val.name,title:val.name,canCheck:!0,isChecked:val.id===(null==selectedSpeaker?void 0:selectedSpeaker.id),onClick:function onClick(){return!(val.id===(null==selectedSpeaker?void 0:selectedSpeaker.id))&&onSelectSpeaker(val)}}}))}}),defaultMenuProps}(props),componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return Object(jsx_runtime.jsx)(DefaultButton.a,Object.assign({},props,{menuProps:null!=defaultMenuProps?defaultMenuProps:props.menuProps,menuIconProps:{hidden:!0},styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(){return Object(jsx_runtime.jsx)(MoreIcon.a,{},"optionsIconKey")},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _props$styles;return Object(jsx_runtime.jsx)(Label.a,{className:Object(lib.G)(controlButtonLabelStyles,null==props||null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.label),children:"Options"},"optionsLabelKey")}:void 0}))};OptionsButton_OptionsButton.displayName="OptionsButton",OptionsButton_OptionsButton.__docgenInfo={description:"`OptionsButton` allows you to easily create a component for rendering an options button. It can be used in your ControlBar component for example.\nThis button should contain dropdown menu items you can define through its property `menuProps`.\nThis `menuProps` property is of type [IContextualMenuProps](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuProps).\n\n@param props - of type OptionsButtonProps",methods:[],displayName:"OptionsButton",props:{showLabel:{required:!1,tsType:{name:"boolean"},description:"Whether the label is displayed or not.\n@defaultValue `false`"},microphones:{required:!1,tsType:{name:"tuple",raw:"[{ id: string; name: string }]",elements:[{name:"signature",type:"object",raw:"{ id: string; name: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}}]}}]},description:"Utility props for stateful props."},speakers:{required:!1,tsType:{name:"tuple",raw:"[{ id: string; name: string }]",elements:[{name:"signature",type:"object",raw:"{ id: string; name: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}}]}}]},description:""},cameras:{required:!1,tsType:{name:"tuple",raw:"[{ id: string; name: string }]",elements:[{name:"signature",type:"object",raw:"{ id: string; name: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}}]}}]},description:""},selectedMicrophone:{required:!1,tsType:{name:"signature",type:"object",raw:"{ id: string; name: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}}]}},description:""},selectedSpeaker:{required:!1,tsType:{name:"signature",type:"object",raw:"{ id: string; name: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}}]}},description:""},selectedCamera:{required:!1,tsType:{name:"signature",type:"object",raw:"{ id: string; name: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"name",value:{name:"string",required:!0}}]}},description:""},onSelectCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: any) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"any"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectMicrophone:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: any) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"any"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectSpeaker:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: any) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"any"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}},composes:["IButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/OptionsButton.tsx"]={name:"OptionsButton",docgenInfo:OptionsButton_OptionsButton.__docgenInfo,path:"../react-components/src/components/OptionsButton.tsx"});var CallControlCloseTrayIcon=__webpack_require__(1834),ScreenShareButton_ScreenShareButton=function ScreenShareButton(props){var _props$onToggleScreen,_props$showLabel=props.showLabel,showLabel=void 0!==_props$showLabel&&_props$showLabel,styles=props.styles,onRenderIcon=props.onRenderIcon,onRenderText=props.onRenderText,componentStyles=Object(lib.q)(controlButtonStyles,null!=styles?styles:{});return Object(jsx_runtime.jsx)(DefaultButton.a,Object.assign({},props,{onClick:null!==(_props$onToggleScreen=props.onToggleScreenShare)&&void 0!==_props$onToggleScreen?_props$onToggleScreen:props.onClick,styles:componentStyles,onRenderIcon:null!=onRenderIcon?onRenderIcon:function defaultRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(CallControlCloseTrayIcon.a,{},"screenShareIconKey"):Object(jsx_runtime.jsx)(CallControlPresentNewIcon.a,{bordered:!1},"screenShareBorderedIconKey")},onRenderText:showLabel?null!=onRenderText?onRenderText:function defaultRenderText(props){var _props$styles;return Object(jsx_runtime.jsx)(Label.a,{className:Object(lib.G)(controlButtonLabelStyles,null==props||null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.label),children:null!=props&&props.checked?"Stop":"Share"},"screenShareLabelKey")}:void 0}))};ScreenShareButton_ScreenShareButton.displayName="ScreenShareButton",ScreenShareButton_ScreenShareButton.__docgenInfo={description:"`ScreenShareButton` allows you to easily create a component for rendering a screen-share button.\nIt can be used in your ControlBar component for example.\n\n@param props - of type ScreenShareButtonProps",methods:[],displayName:"ScreenShareButton",props:{showLabel:{required:!1,tsType:{name:"boolean"},description:"Whether the label is displayed or not.\n@defaultValue `false`"},onToggleScreenShare:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."}},composes:["IButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ScreenShareButton.tsx"]={name:"ScreenShareButton",docgenInfo:ScreenShareButton_ScreenShareButton.__docgenInfo,path:"../react-components/src/components/ScreenShareButton.tsx"});var ThemeProvider=__webpack_require__(1847),mergeThemes=__webpack_require__(842),teams=__webpack_require__(1694),Provider=__webpack_require__(1695);function FluentThemeProvider_slicedToArray(arr,i){return function FluentThemeProvider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function FluentThemeProvider_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function FluentThemeProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return FluentThemeProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FluentThemeProvider_arrayLikeToArray(o,minLen)}(arr,i)||function FluentThemeProvider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FluentThemeProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var wrapper=Object(lib.G)({height:"100%",width:"100%"}),initialFluentNorthstarTheme=Object(mergeThemes.f)(teams.a,{componentVariables:{ChatMessage:{linkColor:void 0,linkColorMine:void 0}}}),FluentThemeProvider_FluentThemeProvider=function FluentThemeProvider(props){var fluentTheme=props.fluentTheme,children=props.children,fluentUITheme=null!=fluentTheme?fluentTheme:lightTheme,_useState2=FluentThemeProvider_slicedToArray(Object(react.useState)(initialFluentNorthstarTheme),2),fluentNorthstarTheme=_useState2[0],setFluentNorthstarTheme=_useState2[1];return Object(react.useEffect)((function(){var _fluentUITheme$palett,_fluentUITheme$palett2,_fluentUITheme$palett3,_fluentUITheme$palett4,_fluentUITheme$palett5,_fluentUITheme$palett6;setFluentNorthstarTheme(Object(mergeThemes.f)(initialFluentNorthstarTheme,{componentVariables:{Chat:{backgroundColor:null==fluentUITheme||null===(_fluentUITheme$palett=fluentUITheme.palette)||void 0===_fluentUITheme$palett?void 0:_fluentUITheme$palett.white},ChatMessage:{authorColor:null==fluentUITheme||null===(_fluentUITheme$palett2=fluentUITheme.palette)||void 0===_fluentUITheme$palett2?void 0:_fluentUITheme$palett2.neutralPrimary,contentColor:null==fluentUITheme||null===(_fluentUITheme$palett3=fluentUITheme.palette)||void 0===_fluentUITheme$palett3?void 0:_fluentUITheme$palett3.neutralPrimary,backgroundColor:null==fluentUITheme||null===(_fluentUITheme$palett4=fluentUITheme.palette)||void 0===_fluentUITheme$palett4?void 0:_fluentUITheme$palett4.neutralLighter,backgroundColorMine:null==fluentUITheme||null===(_fluentUITheme$palett5=fluentUITheme.palette)||void 0===_fluentUITheme$palett5?void 0:_fluentUITheme$palett5.themeLight}},componentStyles:{ChatMessage:{timestamp:{WebkitTextFillColor:null==fluentUITheme||null===(_fluentUITheme$palett6=fluentUITheme.palette)||void 0===_fluentUITheme$palett6?void 0:_fluentUITheme$palett6.neutralSecondary}}}}))}),[fluentUITheme]),Object(jsx_runtime.jsx)(ThemeProvider.a,{theme:fluentUITheme,className:wrapper,children:Object(jsx_runtime.jsx)(Provider.a,{theme:fluentNorthstarTheme,className:wrapper,children:children})})};FluentThemeProvider_FluentThemeProvider.displayName="FluentThemeProvider",FluentThemeProvider_FluentThemeProvider.__docgenInfo={description:"@description Provider to apply a Fluent theme across this library's react components.\n@remarks Components in this library are composed primarily from [Fluent UI](https://developer.microsoft.com/en-us/fluentui#/controls/web),\ncontrols, and also from [Fluent React Northstar](https://fluentsite.z22.web.core.windows.net/0.53.0) controls.\nThis provider handles applying any theme provided to both the underlying Fluent UI controls, as well as the Fluent React Northstar controls.",methods:[],displayName:"FluentThemeProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Children to be themed."},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Optional theme state for FluentThemeProvider. Defaults to a light theme if not provided."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/theming/FluentThemeProvider.tsx"]={name:"FluentThemeProvider",docgenInfo:FluentThemeProvider_FluentThemeProvider.__docgenInfo,path:"../react-components/src/theming/FluentThemeProvider.tsx"});var ChatComposite=__webpack_require__(385),CallComposite=__webpack_require__(384)},789:function(module,exports){},84:function(module,__webpack_exports__,__webpack_require__){"use strict";var _SDKUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(137);__webpack_require__.d(__webpack_exports__,"a",(function(){return _SDKUtils__WEBPACK_IMPORTED_MODULE_0__.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _SDKUtils__WEBPACK_IMPORTED_MODULE_0__.b})),__webpack_require__.d(__webpack_exports__,"c",(function(){return _SDKUtils__WEBPACK_IMPORTED_MODULE_0__.c})),__webpack_require__.d(__webpack_exports__,"d",(function(){return _SDKUtils__WEBPACK_IMPORTED_MODULE_0__.d}))},885:function(module,exports,__webpack_require__){__webpack_require__(886),__webpack_require__(1040),__webpack_require__(1041),__webpack_require__(1181),__webpack_require__(1379),__webpack_require__(1412),__webpack_require__(1417),__webpack_require__(1422),__webpack_require__(1424),__webpack_require__(1433),module.exports=__webpack_require__(1570)},953:function(module,exports){}},[[885,1,2]]]);
//# sourceMappingURL=main.5376d637e1ee147c0bdd.bundle.js.map